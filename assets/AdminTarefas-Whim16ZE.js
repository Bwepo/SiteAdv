import{c as xt,r as o,j as r,e as Z,h as Pr,a5 as V,f as ot,m as pn}from"./index-BQQTb6fi.js";import{E as Fr,A as zr,m as Pn}from"./formatters-Bj0D2YiU.js";import{P as _r,T as Br}from"./TarefaSheet-CFzUDMan.js";import{u as $r,F as Kr,a as Ye,b as Ve,c as Xe,d as qe,e as He,t as Ur}from"./form-hJojq2nQ.js";import{S as Yr,b as Vr,c as Xr,d as Hr,e as Wr,f as qr}from"./sheet-4Od2LD5-.js";import{I as kt}from"./input-CE2c-gnk.js";import{B as We}from"./button-BYLOxE-2.js";import{S as me,a as ge,b as xe,c as pe,d as z}from"./select-DQAAOv5a.js";import{P as Fn,a as zn,b as _n}from"./popover-BKmSsf8O.js";import{g as Bn,S as ut,h as tn,a as Gr,b as Jr,i as It,c as nn,T as Zr,j as Qr}from"./crmTypes-CAMEoS1a.js";import{S as cn}from"./search-CUmnT7KL.js";import{C as es}from"./check-DkMO6O-V.js";import{U as ts}from"./user-BUfEaEVo.js";import{L as ns}from"./loader-circle-xgMqgjFX.js";import{o as rs,s as Ge,e as ss}from"./types-C9wiu8_K.js";import{C as ft,c as ht}from"./card-aso8O70y.js";import{A as $n,a as Kn,b as Un,c as Yn,d as Vn,e as Xn,f as Hn,g as Wn}from"./alert-dialog-ChmPdjXe.js";import{P as qn,B as Ae}from"./badge-AZvcS7pt.js";import{S as it}from"./switch-tQgrs0vF.js";import{L as Gn}from"./list-CanTGTbl.js";import{F as Jn}from"./folder-kanban-CPklJxXh.js";import{U as Zn}from"./users-Dr_w_yN6.js";import{C as Qn}from"./calendar-DF_IPi4K.js";import{P as as}from"./pencil-CSW1l7Ok.js";import{T as os}from"./trash-2-BJDwYsZn.js";import{L as is}from"./label-ULu1cug-.js";import{T as ls,K as cs}from"./CrmSkeletons-BHdwdsjS.js";import{C as ds}from"./clipboard-list-PlZO_TCQ.js";import{F as us}from"./filter-XozgcQzK.js";import{C as er,a as fs}from"./circle-x-D_AeKXof.js";import{C as hs}from"./clock-BDyA_6pe.js";import{C as ms}from"./circle-check-DIlz5WY7.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=xt("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=xt("CircleDot",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=xt("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=xt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=xt("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),ps=rs({title:Ge().trim().min(1,"Título obrigatório").max(200),parentTaskId:Ge().min(1,"Tarefa-mãe obrigatória"),deadline:Ge().optional(),status:ss(["A fazer","Em andamento","Concluído"]),assignee:Ge().optional(),notes:Ge().max(2e3).optional(),numeroProcesso:Ge().max(25).optional()}),vs=Object.entries(ut);function bs({open:e,onOpenChange:t,subtask:n,tasks:s,onSave:a}){const i=!n,[c,l]=o.useState(!1),[u,f]=o.useState(""),[h,m]=o.useState(!1),b=o.useMemo(()=>{if(!u.trim())return s;const x=u.toLowerCase();return s.filter(v=>v.title.toLowerCase().includes(x))},[s,u]),p=$r({resolver:Ur(ps),defaultValues:{title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}});o.useEffect(()=>{e&&(n?p.reset({title:n.title,parentTaskId:n.parentTaskId,deadline:n.dueDate??"",status:n.status,assignee:n.assignee??"",notes:n.notes??"",numeroProcesso:n.numeroProcesso??""}):p.reset({title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:"",numeroProcesso:""}))},[e,n]);const S=async x=>{l(!0);try{await a(x,i,n==null?void 0:n.id),t(!1)}catch(v){Pr.error("Erro ao salvar subtarefa: "+v.message),console.error("Erro ao salvar subtarefa:",v)}finally{l(!1)}};return r.jsx(Yr,{open:e,onOpenChange:t,children:r.jsxs(Vr,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[r.jsxs(Xr,{className:"mb-6",children:[r.jsx(Hr,{children:i?"Nova Subtarefa":"Editar Subtarefa"}),r.jsx(Wr,{children:i?"Preencha os dados e selecione a tarefa-mãe relacionada.":"Altere os campos e salve."})]}),r.jsx(Kr,{...p,children:r.jsxs("form",{onSubmit:p.handleSubmit(S),className:"space-y-5",children:[r.jsx(Ye,{control:p.control,name:"title",render:({field:x})=>r.jsxs(Ve,{children:[r.jsx(Xe,{children:"Título *"}),r.jsx(qe,{children:r.jsx(kt,{placeholder:"Ex: Enviar documento",...x})}),r.jsx(He,{})]})}),r.jsx(Ye,{control:p.control,name:"parentTaskId",render:({field:x})=>{var v;return r.jsxs(Ve,{className:"flex flex-col",children:[r.jsx(Xe,{children:"Tarefa-mãe *"}),r.jsxs(Fn,{open:h,onOpenChange:m,children:[r.jsx(zn,{asChild:!0,children:r.jsx(qe,{children:r.jsxs(We,{variant:"outline",role:"combobox",className:Z("w-full justify-between font-normal",!x.value&&"text-muted-foreground"),children:[r.jsx("span",{className:"truncate",children:x.value?((v=s.find(w=>w.id===x.value))==null?void 0:v.title)??"Tarefa não encontrada":"Selecione a tarefa-mãe..."}),r.jsx(gs,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),r.jsxs(_n,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:[r.jsxs("div",{className:"flex items-center border-b px-3",children:[r.jsx(cn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),r.jsx("input",{className:"flex h-10 w-full bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground",placeholder:"Buscar tarefa...",value:u,onChange:w=>f(w.target.value)})]}),r.jsx("div",{className:"max-h-[200px] overflow-y-auto p-1",children:b.length===0?r.jsx("p",{className:"py-4 text-center text-sm text-muted-foreground",children:"Nenhuma tarefa encontrada."}):b.map(w=>r.jsxs("button",{type:"button",className:Z("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",x.value===w.id&&"bg-accent"),onClick:()=>{x.onChange(w.id),m(!1),f("")},children:[r.jsx(es,{className:Z("mr-2 h-4 w-4",x.value===w.id?"opacity-100":"opacity-0")}),r.jsx("span",{className:"truncate",children:w.title})]},w.id))})]})]}),r.jsx(He,{})]})}}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ye,{control:p.control,name:"deadline",render:({field:x})=>r.jsxs(Ve,{children:[r.jsx(Xe,{children:"Prazo"}),r.jsx(qe,{children:r.jsx(kt,{type:"date",...x})}),r.jsx(He,{})]})}),r.jsx(Ye,{control:p.control,name:"status",render:({field:x})=>r.jsxs(Ve,{children:[r.jsx(Xe,{children:"Status"}),r.jsxs(me,{onValueChange:x.onChange,value:x.value,children:[r.jsx(qe,{children:r.jsx(ge,{children:r.jsx(xe,{})})}),r.jsx(pe,{children:vs.map(([v,w])=>r.jsx(z,{value:v,children:w},v))})]}),r.jsx(He,{})]})})]}),r.jsx(Ye,{control:p.control,name:"assignee",render:({field:x})=>r.jsxs(Ve,{children:[r.jsx(Xe,{children:"Responsável"}),r.jsxs(me,{onValueChange:v=>x.onChange(v==="_none_"?"":v),value:x.value||"_none_",children:[r.jsx(qe,{children:r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ts,{className:"w-3.5 h-3.5 text-muted-foreground"}),r.jsx(xe,{placeholder:"Responsável..."})]})})}),r.jsxs(pe,{children:[r.jsx(z,{value:"_none_",children:"— Sem responsável —"}),Bn.map(v=>r.jsx(z,{value:v,children:v},v))]})]}),r.jsx(He,{})]})}),r.jsx(Ye,{control:p.control,name:"numeroProcesso",render:({field:x})=>r.jsxs(Ve,{children:[r.jsx(Xe,{children:"Processo Judicial"}),r.jsx(_r,{value:x.value??"",onValueChange:x.onChange}),r.jsx(He,{})]})}),r.jsx(Ye,{control:p.control,name:"notes",render:({field:x})=>r.jsxs(Ve,{children:[r.jsx(Xe,{children:"Observações"}),r.jsx(qe,{children:r.jsx(Fr,{value:x.value??"",onChange:x.onChange,placeholder:"Observações...",modalTitle:"Editar Observações da Subtarefa"})}),r.jsx(He,{})]})}),!i&&(n==null?void 0:n.id)&&r.jsx(zr,{folder:`subtarefas/${n.id}`}),r.jsx(qr,{children:r.jsxs(We,{type:"submit",disabled:c,className:"w-full",children:[c&&r.jsx(ns,{className:"w-4 h-4 mr-2 animate-spin"}),i?"Criar Subtarefa":"Salvar Alterações"]})})]})})]})})}function ys(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const Bt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ze(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function dn(e){return"nodeType"in e}function ue(e){var t,n;return e?Ze(e)?e:dn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function un(e){const{Document:t}=ue(e);return e instanceof t}function pt(e){return Ze(e)?!1:e instanceof ue(e).HTMLElement}function rr(e){return e instanceof ue(e).SVGElement}function Qe(e){return e?Ze(e)?e.document:dn(e)?un(e)?e:pt(e)||rr(e)?e.ownerDocument:document:document:document}const Te=Bt?o.useLayoutEffect:o.useEffect;function $t(e){const t=o.useRef(e);return Te(()=>{t.current=e}),o.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function js(){const e=o.useRef(null),t=o.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function mt(e,t){t===void 0&&(t=[e]);const n=o.useRef(e);return Te(()=>{n.current!==e&&(n.current=e)},t),n}function vt(e,t){const n=o.useRef();return o.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Mt(e){const t=$t(e),n=o.useRef(null),s=o.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function Lt(e){const t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}let Jt={};function bt(e,t){return o.useMemo(()=>{if(t)return t;const n=Jt[e]==null?0:Jt[e]+1;return Jt[e]=n,e+"-"+n},[e,t])}function sr(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((i,c)=>{const l=Object.entries(c);for(const[u,f]of l){const h=i[u];h!=null&&(i[u]=h+e*f)}return i},{...t})}}const Je=sr(1),Pt=sr(-1);function ws(e){return"clientX"in e&&"clientY"in e}function Kt(e){if(!e)return!1;const{KeyboardEvent:t}=ue(e.target);return t&&e instanceof t}function Ss(e){if(!e)return!1;const{TouchEvent:t}=ue(e.target);return t&&e instanceof t}function Ft(e){if(Ss(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return ws(e)?{x:e.clientX,y:e.clientY}:null}const Pe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Pe.Translate.toString(e),Pe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),bn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Cs(e){return e.matches(bn)?e:e.querySelector(bn)}const Ns={display:"none"};function Ds(e){let{id:t,value:n}=e;return V.createElement("div",{id:t,style:Ns},n)}function Ts(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return V.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function Es(){const[e,t]=o.useState("");return{announce:o.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const ar=o.createContext(null);function Rs(e){const t=o.useContext(ar);o.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function As(){const[e]=o.useState(()=>new Set),t=o.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[o.useCallback(s=>{let{type:a,event:i}=s;e.forEach(c=>{var l;return(l=c[a])==null?void 0:l.call(c,i)})},[e]),t]}const Os={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ks={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Is(e){let{announcements:t=ks,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=Os}=e;const{announce:i,announcement:c}=Es(),l=bt("DndLiveRegion"),[u,f]=o.useState(!1);if(o.useEffect(()=>{f(!0)},[]),Rs(o.useMemo(()=>({onDragStart(m){let{active:b}=m;i(t.onDragStart({active:b}))},onDragMove(m){let{active:b,over:p}=m;t.onDragMove&&i(t.onDragMove({active:b,over:p}))},onDragOver(m){let{active:b,over:p}=m;i(t.onDragOver({active:b,over:p}))},onDragEnd(m){let{active:b,over:p}=m;i(t.onDragEnd({active:b,over:p}))},onDragCancel(m){let{active:b,over:p}=m;i(t.onDragCancel({active:b,over:p}))}}),[i,t])),!u)return null;const h=V.createElement(V.Fragment,null,V.createElement(Ds,{id:s,value:a.draggable}),V.createElement(Ts,{id:l,announcement:c}));return n?ot.createPortal(h,n):h}var ee;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ee||(ee={}));function zt(){}function or(e,t){return o.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ir(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Ee=Object.freeze({x:0,y:0});function Ms(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Ls(e,t){const n=Ft(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function Ps(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Fs(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function yn(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function zs(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const lr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=yn(t),i=[];for(const c of s){const{id:l}=c,u=n.get(l);if(u){const f=yn(u),h=a.reduce((b,p,S)=>b+Ms(f[S],p),0),m=Number((h/4).toFixed(4));i.push({id:l,data:{droppableContainer:c,value:m}})}}return i.sort(Ps)};function _s(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),c=a-s,l=i-n;if(s<a&&n<i){const u=t.width*t.height,f=e.width*e.height,h=c*l,m=h/(u+f-h);return Number(m.toFixed(4))}return 0}const Bs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const i of s){const{id:c}=i,l=n.get(c);if(l){const u=_s(l,t);u>0&&a.push({id:c,data:{droppableContainer:i,value:u}})}}return a.sort(Fs)};function $s(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function cr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ee}function Ks(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return a.reduce((c,l)=>({...c,top:c.top+e*l.y,bottom:c.bottom+e*l.y,left:c.left+e*l.x,right:c.right+e*l.x}),{...n})}}const Us=Ks(1);function dr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Ys(e,t,n){const s=dr(t);if(!s)return e;const{scaleX:a,scaleY:i,x:c,y:l}=s,u=e.left-c-(1-a)*parseFloat(n),f=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),h=a?e.width/a:e.width,m=i?e.height/i:e.height;return{width:h,height:m,top:f,right:u+h,bottom:f+m,left:u}}const Vs={ignoreTransform:!1};function et(e,t){t===void 0&&(t=Vs);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:h}=ue(e).getComputedStyle(e);f&&(n=Ys(n,f,h))}const{top:s,left:a,width:i,height:c,bottom:l,right:u}=n;return{top:s,left:a,width:i,height:c,bottom:l,right:u}}function jn(e){return et(e,{ignoreTransform:!0})}function Xs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Hs(e,t){return t===void 0&&(t=ue(e).getComputedStyle(e)),t.position==="fixed"}function Ws(e,t){t===void 0&&(t=ue(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?n.test(i):!1})}function fn(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(un(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!pt(a)||rr(a)||n.includes(a))return n;const i=ue(e).getComputedStyle(a);return a!==e&&Ws(a,i)&&n.push(a),Hs(a,i)?n:s(a.parentNode)}return e?s(e):n}function ur(e){const[t]=fn(e,1);return t??null}function Zt(e){return!Bt||!e?null:Ze(e)?e:dn(e)?un(e)||e===Qe(e).scrollingElement?window:pt(e)?e:null:null}function fr(e){return Ze(e)?e.scrollX:e.scrollLeft}function hr(e){return Ze(e)?e.scrollY:e.scrollTop}function rn(e){return{x:fr(e),y:hr(e)}}var re;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(re||(re={}));function mr(e){return!Bt||!e?!1:e===document.scrollingElement}function gr(e){const t={x:0,y:0},n=mr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,c=e.scrollTop>=s.y,l=e.scrollLeft>=s.x;return{isTop:a,isLeft:i,isBottom:c,isRight:l,maxScroll:s,minScroll:t}}const qs={x:.2,y:.2};function Gs(e,t,n,s,a){let{top:i,left:c,right:l,bottom:u}=n;s===void 0&&(s=10),a===void 0&&(a=qs);const{isTop:f,isBottom:h,isLeft:m,isRight:b}=gr(e),p={x:0,y:0},S={x:0,y:0},x={height:t.height*a.y,width:t.width*a.x};return!f&&i<=t.top+x.height?(p.y=re.Backward,S.y=s*Math.abs((t.top+x.height-i)/x.height)):!h&&u>=t.bottom-x.height&&(p.y=re.Forward,S.y=s*Math.abs((t.bottom-x.height-u)/x.height)),!b&&l>=t.right-x.width?(p.x=re.Forward,S.x=s*Math.abs((t.right-x.width-l)/x.width)):!m&&c<=t.left+x.width&&(p.x=re.Backward,S.x=s*Math.abs((t.left+x.width-c)/x.width)),{direction:p,speed:S}}function Js(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:c}=window;return{top:0,left:0,right:i,bottom:c,width:i,height:c}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function xr(e){return e.reduce((t,n)=>Je(t,rn(n)),Ee)}function Zs(e){return e.reduce((t,n)=>t+fr(n),0)}function Qs(e){return e.reduce((t,n)=>t+hr(n),0)}function pr(e,t){if(t===void 0&&(t=et),!e)return;const{top:n,left:s,bottom:a,right:i}=t(e);ur(e)&&(a<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ea=[["x",["left","right"],Zs],["y",["top","bottom"],Qs]];class hn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=fn(n),a=xr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,c,l]of ea)for(const u of c)Object.defineProperty(this,u,{get:()=>{const f=l(s),h=a[i]-f;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class lt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function ta(e){const{EventTarget:t}=ue(e);return e instanceof t?e:Qe(e)}function Qt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var we;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(we||(we={}));function wn(e){e.preventDefault()}function na(e){e.stopPropagation()}var L;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(L||(L={}));const vr={start:[L.Space,L.Enter],cancel:[L.Esc],end:[L.Space,L.Enter,L.Tab]},ra=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case L.Right:return{...n,x:n.x+25};case L.Left:return{...n,x:n.x-25};case L.Down:return{...n,y:n.y+25};case L.Up:return{...n,y:n.y-25}}};class br{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new lt(Qe(n)),this.windowListeners=new lt(ue(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(we.Resize,this.handleCancel),this.windowListeners.add(we.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(we.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&pr(s),n(Ee)}handleKeyDown(t){if(Kt(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:i=vr,coordinateGetter:c=ra,scrollBehavior:l="smooth"}=a,{code:u}=t;if(i.end.includes(u)){this.handleEnd(t);return}if(i.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=s.current,h=f?{x:f.left,y:f.top}:Ee;this.referenceCoordinates||(this.referenceCoordinates=h);const m=c(t,{active:n,context:s.current,currentCoordinates:h});if(m){const b=Pt(m,h),p={x:0,y:0},{scrollableAncestors:S}=s.current;for(const x of S){const v=t.code,{isTop:w,isRight:N,isLeft:D,isBottom:y,maxScroll:R,minScroll:T}=gr(x),E=Js(x),C={x:Math.min(v===L.Right?E.right-E.width/2:E.right,Math.max(v===L.Right?E.left:E.left+E.width/2,m.x)),y:Math.min(v===L.Down?E.bottom-E.height/2:E.bottom,Math.max(v===L.Down?E.top:E.top+E.height/2,m.y))},_=v===L.Right&&!N||v===L.Left&&!D,F=v===L.Down&&!y||v===L.Up&&!w;if(_&&C.x!==m.x){const P=x.scrollLeft+b.x,X=v===L.Right&&P<=R.x||v===L.Left&&P>=T.x;if(X&&!b.y){x.scrollTo({left:P,behavior:l});return}X?p.x=x.scrollLeft-P:p.x=v===L.Right?x.scrollLeft-R.x:x.scrollLeft-T.x,p.x&&x.scrollBy({left:-p.x,behavior:l});break}else if(F&&C.y!==m.y){const P=x.scrollTop+b.y,X=v===L.Down&&P<=R.y||v===L.Up&&P>=T.y;if(X&&!b.x){x.scrollTo({top:P,behavior:l});return}X?p.y=x.scrollTop-P:p.y=v===L.Down?x.scrollTop-R.y:x.scrollTop-T.y,p.y&&x.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,Je(Pt(m,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}br.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=vr,onActivation:a}=t,{active:i}=n;const{code:c}=e.nativeEvent;if(s.start.includes(c)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Sn(e){return!!(e&&"distance"in e)}function Cn(e){return!!(e&&"delay"in e)}class mn{constructor(t,n,s){var a;s===void 0&&(s=ta(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:c}=i;this.props=t,this.events=n,this.document=Qe(c),this.documentListeners=new lt(this.document),this.listeners=new lt(s),this.windowListeners=new lt(ue(c)),this.initialCoordinates=(a=Ft(i))!=null?a:Ee,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(we.Resize,this.handleCancel),this.windowListeners.add(we.DragStart,wn),this.windowListeners.add(we.VisibilityChange,this.handleCancel),this.windowListeners.add(we.ContextMenu,wn),this.documentListeners.add(we.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Cn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Sn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(we.Click,na,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(we.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:i}=this,{onMove:c,options:{activationConstraint:l}}=i;if(!a)return;const u=(n=Ft(t))!=null?n:Ee,f=Pt(a,u);if(!s&&l){if(Sn(l)){if(l.tolerance!=null&&Qt(f,l.tolerance))return this.handleCancel();if(Qt(f,l.distance))return this.handleStart()}if(Cn(l)&&Qt(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}t.cancelable&&t.preventDefault(),c(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===L.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const sa={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ut extends mn{constructor(t){const{event:n}=t,s=Qe(n.target);super(t,sa,s)}}Ut.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const aa={move:{name:"mousemove"},end:{name:"mouseup"}};var sn;(function(e){e[e.RightClick=2]="RightClick"})(sn||(sn={}));class oa extends mn{constructor(t){super(t,aa,Qe(t.event.target))}}oa.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===sn.RightClick?!1:(s==null||s({event:n}),!0)}}];const en={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ia extends mn{constructor(t){super(t,en)}static setup(){return window.addEventListener(en.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(en.move.name,t)};function t(){}}}ia.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var ct;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(ct||(ct={}));var _t;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(_t||(_t={}));function la(e){let{acceleration:t,activator:n=ct.Pointer,canScroll:s,draggingRect:a,enabled:i,interval:c=5,order:l=_t.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:h,delta:m,threshold:b}=e;const p=da({delta:m,disabled:!i}),[S,x]=js(),v=o.useRef({x:0,y:0}),w=o.useRef({x:0,y:0}),N=o.useMemo(()=>{switch(n){case ct.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case ct.DraggableRect:return a}},[n,a,u]),D=o.useRef(null),y=o.useCallback(()=>{const T=D.current;if(!T)return;const E=v.current.x*w.current.x,C=v.current.y*w.current.y;T.scrollBy(E,C)},[]),R=o.useMemo(()=>l===_t.TreeOrder?[...f].reverse():f,[l,f]);o.useEffect(()=>{if(!i||!f.length||!N){x();return}for(const T of R){if((s==null?void 0:s(T))===!1)continue;const E=f.indexOf(T),C=h[E];if(!C)continue;const{direction:_,speed:F}=Gs(T,C,N,t,b);for(const P of["x","y"])p[P][_[P]]||(F[P]=0,_[P]=0);if(F.x>0||F.y>0){x(),D.current=T,S(y,c),v.current=F,w.current=_;return}}v.current={x:0,y:0},w.current={x:0,y:0},x()},[t,y,s,x,i,c,JSON.stringify(N),JSON.stringify(p),S,f,R,h,JSON.stringify(b)])}const ca={x:{[re.Backward]:!1,[re.Forward]:!1},y:{[re.Backward]:!1,[re.Forward]:!1}};function da(e){let{delta:t,disabled:n}=e;const s=Lt(t);return vt(a=>{if(n||!s||!a)return ca;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[re.Backward]:a.x[re.Backward]||i.x===-1,[re.Forward]:a.x[re.Forward]||i.x===1},y:{[re.Backward]:a.y[re.Backward]||i.y===-1,[re.Forward]:a.y[re.Forward]||i.y===1}}},[n,t,s])}function ua(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return vt(a=>{var i;return t==null?null:(i=s??a)!=null?i:null},[s,t])}function fa(e,t){return o.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,i=a.activators.map(c=>({eventName:c.eventName,handler:t(c.handler,s)}));return[...n,...i]},[]),[e,t])}var gt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(gt||(gt={}));var an;(function(e){e.Optimized="optimized"})(an||(an={}));const Nn=new Map;function ha(e,t){let{dragging:n,dependencies:s,config:a}=t;const[i,c]=o.useState(null),{frequency:l,measure:u,strategy:f}=a,h=o.useRef(e),m=v(),b=mt(m),p=o.useCallback(function(w){w===void 0&&(w=[]),!b.current&&c(N=>N===null?w:N.concat(w.filter(D=>!N.includes(D))))},[b]),S=o.useRef(null),x=vt(w=>{if(m&&!n)return Nn;if(!w||w===Nn||h.current!==e||i!=null){const N=new Map;for(let D of e){if(!D)continue;if(i&&i.length>0&&!i.includes(D.id)&&D.rect.current){N.set(D.id,D.rect.current);continue}const y=D.node.current,R=y?new hn(u(y),y):null;D.rect.current=R,R&&N.set(D.id,R)}return N}return w},[e,i,n,m,u]);return o.useEffect(()=>{h.current=e},[e]),o.useEffect(()=>{m||p()},[n,m]),o.useEffect(()=>{i&&i.length>0&&c(null)},[JSON.stringify(i)]),o.useEffect(()=>{m||typeof l!="number"||S.current!==null||(S.current=setTimeout(()=>{p(),S.current=null},l))},[l,m,p,...s]),{droppableRects:x,measureDroppableContainers:p,measuringScheduled:i!=null};function v(){switch(f){case gt.Always:return!1;case gt.BeforeDragging:return n;default:return!n}}}function gn(e,t){return vt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function ma(e,t){return gn(e,t)}function ga(e){let{callback:t,disabled:n}=e;const s=$t(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Yt(e){let{callback:t,disabled:n}=e;const s=$t(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function xa(e){return new hn(et(e),e)}function Dn(e,t,n){t===void 0&&(t=xa);const[s,a]=o.useState(null);function i(){a(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??n)!=null?f:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const c=ga({callback(u){if(e)for(const f of u){const{type:h,target:m}=f;if(h==="childList"&&m instanceof HTMLElement&&m.contains(e)){i();break}}}}),l=Yt({callback:i});return Te(()=>{i(),e?(l==null||l.observe(e),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),c==null||c.disconnect())},[e]),s}function pa(e){const t=gn(e);return cr(e,t)}const Tn=[];function va(e){const t=o.useRef(e),n=vt(s=>e?s&&s!==Tn&&e&&t.current&&e.parentNode===t.current.parentNode?s:fn(e):Tn,[e]);return o.useEffect(()=>{t.current=e},[e]),n}function ba(e){const[t,n]=o.useState(null),s=o.useRef(e),a=o.useCallback(i=>{const c=Zt(i.target);c&&n(l=>l?(l.set(c,rn(c)),new Map(l)):null)},[]);return o.useEffect(()=>{const i=s.current;if(e!==i){c(i);const l=e.map(u=>{const f=Zt(u);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,rn(f)]):null}).filter(u=>u!=null);n(l.length?new Map(l):null),s.current=e}return()=>{c(e),c(i)};function c(l){l.forEach(u=>{const f=Zt(u);f==null||f.removeEventListener("scroll",a)})}},[a,e]),o.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,c)=>Je(i,c),Ee):xr(e):Ee,[e,t])}function En(e,t){t===void 0&&(t=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},t),o.useEffect(()=>{const s=e!==Ee;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Pt(e,n.current):Ee}function ya(e){o.useEffect(()=>{if(!Bt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function ja(e,t){return o.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:i}=s;return n[a]=c=>{i(c,t)},n},{}),[e,t])}function yr(e){return o.useMemo(()=>e?Xs(e):null,[e])}const Rn=[];function wa(e,t){t===void 0&&(t=et);const[n]=e,s=yr(n?ue(n):null),[a,i]=o.useState(Rn);function c(){i(()=>e.length?e.map(u=>mr(u)?s:new hn(t(u),u)):Rn)}const l=Yt({callback:c});return Te(()=>{l==null||l.disconnect(),c(),e.forEach(u=>l==null?void 0:l.observe(u))},[e]),a}function jr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return pt(t)?t:e}function Sa(e){let{measure:t}=e;const[n,s]=o.useState(null),a=o.useCallback(f=>{for(const{target:h}of f)if(pt(h)){s(m=>{const b=t(h);return m?{...m,width:b.width,height:b.height}:b});break}},[t]),i=Yt({callback:a}),c=o.useCallback(f=>{const h=jr(f);i==null||i.disconnect(),h&&(i==null||i.observe(h)),s(h?t(h):null)},[t,i]),[l,u]=Mt(c);return o.useMemo(()=>({nodeRef:l,rect:n,setRef:u}),[n,l,u])}const Ca=[{sensor:Ut,options:{}},{sensor:br,options:{}}],Na={current:{}},Ot={draggable:{measure:jn},droppable:{measure:jn,strategy:gt.WhileDragging,frequency:an.Optimized},dragOverlay:{measure:et}};class dt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Da={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new dt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:zt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ot,measureDroppableContainers:zt,windowRect:null,measuringScheduled:!1},wr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:zt,draggableNodes:new Map,over:null,measureDroppableContainers:zt},yt=o.createContext(wr),Sr=o.createContext(Da);function Ta(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new dt}}}function Ea(e,t){switch(t.type){case ee.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ee.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ee.DragEnd:case ee.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ee.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new dt(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case ee.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const c=new dt(e.droppable.containers);return c.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:c}}}case ee.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const i=new dt(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Ra(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=o.useContext(yt),i=Lt(s),c=Lt(n==null?void 0:n.id);return o.useEffect(()=>{if(!t&&!s&&i&&c!=null){if(!Kt(i)||document.activeElement===i.target)return;const l=a.get(c);if(!l)return;const{activatorNode:u,node:f}=l;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const h of[u.current,f.current]){if(!h)continue;const m=Cs(h);if(m){m.focus();break}}})}},[s,t,a,c,i]),null}function Cr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...s}),n):n}function Aa(e){return o.useMemo(()=>({draggable:{...Ot.draggable,...e==null?void 0:e.draggable},droppable:{...Ot.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Ot.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Oa(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const i=o.useRef(!1),{x:c,y:l}=typeof a=="boolean"?{x:a,y:a}:a;Te(()=>{if(!c&&!l||!t){i.current=!1;return}if(i.current||!s)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const h=n(f),m=cr(h,s);if(c||(m.x=0),l||(m.y=0),i.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const b=ur(f);b&&b.scrollBy({top:m.y,left:m.x})}},[t,c,l,s,n])}const Vt=o.createContext({...Ee,scaleX:1,scaleY:1});var Be;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Be||(Be={}));const Nr=o.memo(function(t){var n,s,a,i;let{id:c,accessibility:l,autoScroll:u=!0,children:f,sensors:h=Ca,collisionDetection:m=Bs,measuring:b,modifiers:p,...S}=t;const x=o.useReducer(Ea,void 0,Ta),[v,w]=x,[N,D]=As(),[y,R]=o.useState(Be.Uninitialized),T=y===Be.Initialized,{draggable:{active:E,nodes:C,translate:_},droppable:{containers:F}}=v,P=E!=null?C.get(E):null,X=o.useRef({initial:null,translated:null}),ce=o.useMemo(()=>{var d;return E!=null?{id:E,data:(d=P==null?void 0:P.data)!=null?d:Na,rect:X}:null},[E,P]),G=o.useRef(null),[be,Se]=o.useState(null),[Q,Oe]=o.useState(null),ie=mt(S,Object.values(S)),ye=bt("DndDescribedBy",c),ke=o.useMemo(()=>F.getEnabled(),[F]),k=Aa(b),{droppableRects:te,measureDroppableContainers:le,measuringScheduled:je}=ha(ke,{dragging:T,dependencies:[_.x,_.y],config:k.droppable}),H=ua(C,E),Fe=o.useMemo(()=>Q?Ft(Q):null,[Q]),fe=qt(),ve=ma(H,k.draggable.measure);Oa({activeNode:E!=null?C.get(E):null,config:fe.layoutShiftCompensation,initialRect:ve,measure:k.draggable.measure});const O=Dn(H,k.draggable.measure,ve),Ie=Dn(H?H.parentElement:null),se=o.useRef({activatorEvent:null,active:null,activeNode:H,collisionRect:null,collisions:null,droppableRects:te,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Re=F.getNodeFor((n=se.current.over)==null?void 0:n.id),ae=Sa({measure:k.dragOverlay.measure}),Ce=(s=ae.nodeRef.current)!=null?s:H,g=T?(a=ae.rect)!=null?a:O:null,I=!!(ae.nodeRef.current&&ae.rect),M=pa(I?null:O),ne=yr(Ce?ue(Ce):null),U=va(T?Re??H:null),Y=wa(U),oe=Cr(p,{transform:{x:_.x-M.x,y:_.y-M.y,scaleX:1,scaleY:1},activatorEvent:Q,active:ce,activeNodeRect:O,containerNodeRect:Ie,draggingNodeRect:g,over:se.current.over,overlayNodeRect:ae.rect,scrollableAncestors:U,scrollableAncestorRects:Y,windowRect:ne}),$e=Fe?Je(Fe,_):null,Me=ba(U),jt=En(Me),Ke=En(Me,[O]),Ne=Je(oe,jt),ze=g?Us(g,oe):null,Ue=ce&&ze?m({active:ce,collisionRect:ze,droppableRects:te,droppableContainers:ke,pointerCoordinates:$e}):null,wt=zs(Ue,"id"),[De,St]=o.useState(null),Xt=I?oe:Je(oe,Ke),Ht=$s(Xt,(i=De==null?void 0:De.rect)!=null?i:null,O),tt=o.useRef(null),Ct=o.useCallback((d,j)=>{let{sensor:A,options:K}=j;if(G.current==null)return;const B=C.get(G.current);if(!B)return;const W=d.nativeEvent,de=new A({active:G.current,activeNode:B,event:W,options:K,context:se,onAbort($){if(!C.get($))return;const{onDragAbort:he}=ie.current,Le={id:$};he==null||he(Le),N({type:"onDragAbort",event:Le})},onPending($,q,he,Le){if(!C.get($))return;const{onDragPending:st}=ie.current,_e={id:$,constraint:q,initialCoordinates:he,offset:Le};st==null||st(_e),N({type:"onDragPending",event:_e})},onStart($){const q=G.current;if(q==null)return;const he=C.get(q);if(!he)return;const{onDragStart:Le}=ie.current,rt={activatorEvent:W,active:{id:q,data:he.data,rect:X}};ot.unstable_batchedUpdates(()=>{Le==null||Le(rt),R(Be.Initializing),w({type:ee.DragStart,initialCoordinates:$,active:q}),N({type:"onDragStart",event:rt}),Se(tt.current),Oe(W)})},onMove($){w({type:ee.DragMove,coordinates:$})},onEnd:J(ee.DragEnd),onCancel:J(ee.DragCancel)});tt.current=de;function J($){return async function(){const{active:he,collisions:Le,over:rt,scrollAdjustedTranslate:st}=se.current;let _e=null;if(he&&st){const{cancelDrop:at}=ie.current;_e={activatorEvent:W,active:he,collisions:Le,delta:st,over:rt},$===ee.DragEnd&&typeof at=="function"&&await Promise.resolve(at(_e))&&($=ee.DragCancel)}G.current=null,ot.unstable_batchedUpdates(()=>{w({type:$}),R(Be.Uninitialized),St(null),Se(null),Oe(null),tt.current=null;const at=$===ee.DragEnd?"onDragEnd":"onDragCancel";if(_e){const Gt=ie.current[at];Gt==null||Gt(_e),N({type:at,event:_e})}})}}},[C]),Wt=o.useCallback((d,j)=>(A,K)=>{const B=A.nativeEvent,W=C.get(K);if(G.current!==null||!W||B.dndKit||B.defaultPrevented)return;const de={active:W};d(A,j.options,de)===!0&&(B.dndKit={capturedBy:j.sensor},G.current=K,Ct(A,j))},[C,Ct]),Nt=fa(h,Wt);ya(h),Te(()=>{O&&y===Be.Initializing&&R(Be.Initialized)},[O,y]),o.useEffect(()=>{const{onDragMove:d}=ie.current,{active:j,activatorEvent:A,collisions:K,over:B}=se.current;if(!j||!A)return;const W={active:j,activatorEvent:A,collisions:K,delta:{x:Ne.x,y:Ne.y},over:B};ot.unstable_batchedUpdates(()=>{d==null||d(W),N({type:"onDragMove",event:W})})},[Ne.x,Ne.y]),o.useEffect(()=>{const{active:d,activatorEvent:j,collisions:A,droppableContainers:K,scrollAdjustedTranslate:B}=se.current;if(!d||G.current==null||!j||!B)return;const{onDragOver:W}=ie.current,de=K.get(wt),J=de&&de.rect.current?{id:de.id,rect:de.rect.current,data:de.data,disabled:de.disabled}:null,$={active:d,activatorEvent:j,collisions:A,delta:{x:B.x,y:B.y},over:J};ot.unstable_batchedUpdates(()=>{St(J),W==null||W($),N({type:"onDragOver",event:$})})},[wt]),Te(()=>{se.current={activatorEvent:Q,active:ce,activeNode:H,collisionRect:ze,collisions:Ue,droppableRects:te,draggableNodes:C,draggingNode:Ce,draggingNodeRect:g,droppableContainers:F,over:De,scrollableAncestors:U,scrollAdjustedTranslate:Ne},X.current={initial:g,translated:ze}},[ce,H,Ue,ze,C,Ce,g,te,F,De,U,Ne]),la({...fe,delta:_,draggingRect:ze,pointerCoordinates:$e,scrollableAncestors:U,scrollableAncestorRects:Y});const Dt=o.useMemo(()=>({active:ce,activeNode:H,activeNodeRect:O,activatorEvent:Q,collisions:Ue,containerNodeRect:Ie,dragOverlay:ae,draggableNodes:C,droppableContainers:F,droppableRects:te,over:De,measureDroppableContainers:le,scrollableAncestors:U,scrollableAncestorRects:Y,measuringConfiguration:k,measuringScheduled:je,windowRect:ne}),[ce,H,O,Q,Ue,Ie,ae,C,F,te,De,le,U,Y,k,je,ne]),nt=o.useMemo(()=>({activatorEvent:Q,activators:Nt,active:ce,activeNodeRect:O,ariaDescribedById:{draggable:ye},dispatch:w,draggableNodes:C,over:De,measureDroppableContainers:le}),[Q,Nt,ce,O,w,ye,C,De,le]);return V.createElement(ar.Provider,{value:D},V.createElement(yt.Provider,{value:nt},V.createElement(Sr.Provider,{value:Dt},V.createElement(Vt.Provider,{value:Ht},f)),V.createElement(Ra,{disabled:(l==null?void 0:l.restoreFocus)===!1})),V.createElement(Is,{...l,hiddenTextDescribedById:ye}));function qt(){const d=(be==null?void 0:be.autoScrollEnabled)===!1,j=typeof u=="object"?u.enabled===!1:u===!1,A=T&&!d&&!j;return typeof u=="object"?{...u,enabled:A}:{enabled:A}}}),ka=o.createContext(null),An="button",Ia="Draggable";function Ma(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const i=bt(Ia),{activators:c,activatorEvent:l,active:u,activeNodeRect:f,ariaDescribedById:h,draggableNodes:m,over:b}=o.useContext(yt),{role:p=An,roleDescription:S="draggable",tabIndex:x=0}=a??{},v=(u==null?void 0:u.id)===t,w=o.useContext(v?Vt:ka),[N,D]=Mt(),[y,R]=Mt(),T=ja(c,t),E=mt(n);Te(()=>(m.set(t,{id:t,key:i,node:N,activatorNode:y,data:E}),()=>{const _=m.get(t);_&&_.key===i&&m.delete(t)}),[m,t]);const C=o.useMemo(()=>({role:p,tabIndex:x,"aria-disabled":s,"aria-pressed":v&&p===An?!0:void 0,"aria-roledescription":S,"aria-describedby":h.draggable}),[s,p,x,v,S,h.draggable]);return{active:u,activatorEvent:l,activeNodeRect:f,attributes:C,isDragging:v,listeners:s?void 0:T,node:N,over:b,setNodeRef:D,setActivatorNodeRef:R,transform:w}}function Dr(){return o.useContext(Sr)}const La="Droppable",Pa={timeout:25};function xn(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const i=bt(La),{active:c,dispatch:l,over:u,measureDroppableContainers:f}=o.useContext(yt),h=o.useRef({disabled:n}),m=o.useRef(!1),b=o.useRef(null),p=o.useRef(null),{disabled:S,updateMeasurementsFor:x,timeout:v}={...Pa,...a},w=mt(x??s),N=o.useCallback(()=>{if(!m.current){m.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{f(Array.isArray(w.current)?w.current:[w.current]),p.current=null},v)},[v]),D=Yt({callback:N,disabled:S||!c}),y=o.useCallback((C,_)=>{D&&(_&&(D.unobserve(_),m.current=!1),C&&D.observe(C))},[D]),[R,T]=Mt(y),E=mt(t);return o.useEffect(()=>{!D||!R.current||(D.disconnect(),m.current=!1,D.observe(R.current))},[R,D]),o.useEffect(()=>(l({type:ee.RegisterDroppable,element:{id:s,key:i,disabled:n,node:R,rect:b,data:E}}),()=>l({type:ee.UnregisterDroppable,key:i,id:s})),[s]),o.useEffect(()=>{n!==h.current.disabled&&(l({type:ee.SetDroppableDisabled,id:s,key:i,disabled:n}),h.current.disabled=n)},[s,i,n,l]),{active:c,rect:b,isOver:(u==null?void 0:u.id)===s,node:R,over:u,setNodeRef:T}}function Fa(e){let{animation:t,children:n}=e;const[s,a]=o.useState(null),[i,c]=o.useState(null),l=Lt(n);return!n&&!s&&l&&a(l),Te(()=>{if(!i)return;const u=s==null?void 0:s.key,f=s==null?void 0:s.props.id;if(u==null||f==null){a(null);return}Promise.resolve(t(f,i)).then(()=>{a(null)})},[t,s,i]),V.createElement(V.Fragment,null,n,s?o.cloneElement(s,{ref:c}):null)}const za={x:0,y:0,scaleX:1,scaleY:1};function _a(e){let{children:t}=e;return V.createElement(yt.Provider,{value:wr},V.createElement(Vt.Provider,{value:za},t))}const Ba={position:"fixed",touchAction:"none"},$a=e=>Kt(e)?"transform 250ms ease":void 0,Ka=o.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:i,className:c,rect:l,style:u,transform:f,transition:h=$a}=e;if(!l)return null;const m=a?f:{...f,scaleX:1,scaleY:1},b={...Ba,width:l.width,height:l.height,top:l.top,left:l.left,transform:Pe.Transform.toString(m),transformOrigin:a&&s?Ls(s,l):void 0,transition:typeof h=="function"?h(s):h,...u};return V.createElement(n,{className:c,style:b,ref:t},i)}),Ua=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:i,className:c}=e;if(i!=null&&i.active)for(const[l,u]of Object.entries(i.active))u!==void 0&&(a[l]=n.node.style.getPropertyValue(l),n.node.style.setProperty(l,u));if(i!=null&&i.dragOverlay)for(const[l,u]of Object.entries(i.dragOverlay))u!==void 0&&s.node.style.setProperty(l,u);return c!=null&&c.active&&n.node.classList.add(c.active),c!=null&&c.dragOverlay&&s.node.classList.add(c.dragOverlay),function(){for(const[u,f]of Object.entries(a))n.node.style.setProperty(u,f);c!=null&&c.active&&n.node.classList.remove(c.active)}},Ya=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Pe.Transform.toString(t)},{transform:Pe.Transform.toString(n)}]},Va={duration:250,easing:"ease",keyframes:Ya,sideEffects:Ua({styles:{active:{opacity:"0"}}})};function Xa(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return $t((i,c)=>{if(t===null)return;const l=n.get(i);if(!l)return;const u=l.node.current;if(!u)return;const f=jr(c);if(!f)return;const{transform:h}=ue(c).getComputedStyle(c),m=dr(h);if(!m)return;const b=typeof t=="function"?t:Ha(t);return pr(u,a.draggable.measure),b({active:{id:i,data:l.data,node:u,rect:a.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:c,rect:a.dragOverlay.measure(f)},droppableContainers:s,measuringConfiguration:a,transform:m})})}function Ha(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...Va,...e};return i=>{let{active:c,dragOverlay:l,transform:u,...f}=i;if(!t)return;const h={x:l.rect.left-c.rect.left,y:l.rect.top-c.rect.top},m={scaleX:u.scaleX!==1?c.rect.width*u.scaleX/l.rect.width:1,scaleY:u.scaleY!==1?c.rect.height*u.scaleY/l.rect.height:1},b={x:u.x-h.x,y:u.y-h.y,...m},p=a({...f,active:c,dragOverlay:l,transform:{initial:u,final:b}}),[S]=p,x=p[p.length-1];if(JSON.stringify(S)===JSON.stringify(x))return;const v=s==null?void 0:s({active:c,dragOverlay:l,...f}),w=l.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(N=>{w.onfinish=()=>{v==null||v(),N()}})}}let On=0;function Wa(e){return o.useMemo(()=>{if(e!=null)return On++,On},[e])}const Tr=V.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:i,modifiers:c,wrapperElement:l="div",className:u,zIndex:f=999}=e;const{activatorEvent:h,active:m,activeNodeRect:b,containerNodeRect:p,draggableNodes:S,droppableContainers:x,dragOverlay:v,over:w,measuringConfiguration:N,scrollableAncestors:D,scrollableAncestorRects:y,windowRect:R}=Dr(),T=o.useContext(Vt),E=Wa(m==null?void 0:m.id),C=Cr(c,{activatorEvent:h,active:m,activeNodeRect:b,containerNodeRect:p,draggingNodeRect:v.rect,over:w,overlayNodeRect:v.rect,scrollableAncestors:D,scrollableAncestorRects:y,transform:T,windowRect:R}),_=gn(b),F=Xa({config:s,draggableNodes:S,droppableContainers:x,measuringConfiguration:N}),P=_?v.setRef:void 0;return V.createElement(_a,null,V.createElement(Fa,{animation:F},m&&E?V.createElement(Ka,{key:E,id:m.id,ref:P,as:l,activatorEvent:h,adjustScale:t,className:u,transition:i,rect:_,style:{zIndex:f,...a},transform:C},n):null))});function Er(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function qa(e,t){return e.reduce((n,s,a)=>{const i=t.get(s);return i&&(n[a]=i),n},Array(e.length))}function Tt(e){return e!==null&&e>=0}function Ga(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ja(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Rr=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const i=Er(t,s,n),c=t[a],l=i[a];return!l||!c?null:{x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height}},Et={scaleX:1,scaleY:1},Ar=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:i,overIndex:c}=e;const l=(t=i[n])!=null?t:s;if(!l)return null;if(a===n){const f=i[c];return f?{x:0,y:n<c?f.top+f.height-(l.top+l.height):f.top-l.top,...Et}:null}const u=Za(i,a,n);return a>n&&a<=c?{x:0,y:-l.height-u,...Et}:a<n&&a>=c?{x:0,y:l.height+u,...Et}:{x:0,y:0,...Et}};function Za(e,t,n){const s=e[t],a=e[t-1],i=e[t+1];return s?n<t?a?s.top-(a.top+a.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const Or="Sortable",kr=V.createContext({activeIndex:-1,containerId:Or,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Rr,disabled:{draggable:!1,droppable:!1}});function Ir(e){let{children:t,id:n,items:s,strategy:a=Rr,disabled:i=!1}=e;const{active:c,dragOverlay:l,droppableRects:u,over:f,measureDroppableContainers:h}=Dr(),m=bt(Or,n),b=l.rect!==null,p=o.useMemo(()=>s.map(T=>typeof T=="object"&&"id"in T?T.id:T),[s]),S=c!=null,x=c?p.indexOf(c.id):-1,v=f?p.indexOf(f.id):-1,w=o.useRef(p),N=!Ga(p,w.current),D=v!==-1&&x===-1||N,y=Ja(i);Te(()=>{N&&S&&h(p)},[N,p,S,h]),o.useEffect(()=>{w.current=p},[p]);const R=o.useMemo(()=>({activeIndex:x,containerId:m,disabled:y,disableTransforms:D,items:p,overIndex:v,useDragOverlay:b,sortedRects:qa(p,u),strategy:a}),[x,m,y.draggable,y.droppable,D,p,v,u,b,a]);return V.createElement(kr.Provider,{value:R},t)}const Qa=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return Er(n,s,a).indexOf(t)},eo=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:i,newIndex:c,previousItems:l,previousContainerId:u,transition:f}=e;return!f||!s||l!==i&&a===c?!1:n?!0:c!==a&&t===u},to={duration:200,easing:"ease"},Mr="transform",no=Pe.Transition.toString({property:Mr,duration:0,easing:"linear"}),ro={roleDescription:"sortable"};function so(e){let{disabled:t,index:n,node:s,rect:a}=e;const[i,c]=o.useState(null),l=o.useRef(n);return Te(()=>{if(!t&&n!==l.current&&s.current){const u=a.current;if(u){const f=et(s.current,{ignoreTransform:!0}),h={x:u.left-f.left,y:u.top-f.top,scaleX:u.width/f.width,scaleY:u.height/f.height};(h.x||h.y)&&c(h)}}n!==l.current&&(l.current=n)},[t,n,s,a]),o.useEffect(()=>{i&&c(null)},[i]),i}function Lr(e){let{animateLayoutChanges:t=eo,attributes:n,disabled:s,data:a,getNewIndex:i=Qa,id:c,strategy:l,resizeObserverConfig:u,transition:f=to}=e;const{items:h,containerId:m,activeIndex:b,disabled:p,disableTransforms:S,sortedRects:x,overIndex:v,useDragOverlay:w,strategy:N}=o.useContext(kr),D=ao(s,p),y=h.indexOf(c),R=o.useMemo(()=>({sortable:{containerId:m,index:y,items:h},...a}),[m,a,y,h]),T=o.useMemo(()=>h.slice(h.indexOf(c)),[h,c]),{rect:E,node:C,isOver:_,setNodeRef:F}=xn({id:c,data:R,disabled:D.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...u}}),{active:P,activatorEvent:X,activeNodeRect:ce,attributes:G,setNodeRef:be,listeners:Se,isDragging:Q,over:Oe,setActivatorNodeRef:ie,transform:ye}=Ma({id:c,data:R,attributes:{...ro,...n},disabled:D.draggable}),ke=ys(F,be),k=!!P,te=k&&!S&&Tt(b)&&Tt(v),le=!w&&Q,je=le&&te?ye:null,Fe=te?je??(l??N)({rects:x,activeNodeRect:ce,activeIndex:b,overIndex:v,index:y}):null,fe=Tt(b)&&Tt(v)?i({id:c,items:h,activeIndex:b,overIndex:v}):y,ve=P==null?void 0:P.id,O=o.useRef({activeId:ve,items:h,newIndex:fe,containerId:m}),Ie=h!==O.current.items,se=t({active:P,containerId:m,isDragging:Q,isSorting:k,id:c,index:y,items:h,newIndex:O.current.newIndex,previousItems:O.current.items,previousContainerId:O.current.containerId,transition:f,wasDragging:O.current.activeId!=null}),Re=so({disabled:!se,index:y,node:C,rect:E});return o.useEffect(()=>{k&&O.current.newIndex!==fe&&(O.current.newIndex=fe),m!==O.current.containerId&&(O.current.containerId=m),h!==O.current.items&&(O.current.items=h)},[k,fe,m,h]),o.useEffect(()=>{if(ve===O.current.activeId)return;if(ve!=null&&O.current.activeId==null){O.current.activeId=ve;return}const Ce=setTimeout(()=>{O.current.activeId=ve},50);return()=>clearTimeout(Ce)},[ve]),{active:P,activeIndex:b,attributes:G,data:R,rect:E,index:y,newIndex:fe,items:h,isOver:_,isSorting:k,isDragging:Q,listeners:Se,node:C,overIndex:v,over:Oe,setNodeRef:ke,setActivatorNodeRef:ie,setDroppableNodeRef:F,setDraggableNodeRef:be,transform:Re??Fe,transition:ae()};function ae(){if(Re||Ie&&O.current.newIndex===y)return no;if(!(le&&!Kt(X)||!f)&&(k||se))return Pe.Transition.toString({...f,property:Mr})}}function ao(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}L.Down,L.Right,L.Up,L.Left;const oo=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"title",label:"Título (A → Z)"},{value:"status",label:"Status"}],kn={"A fazer":0,"Em andamento":1,Concluído:2},Rt=["A fazer","Em andamento","Concluído"],io={"A fazer":"border-t-red-500/60","Em andamento":"border-t-yellow-500/60",Concluído:"border-t-green-500/60"};function lo(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"title":return n.title.localeCompare(s.title,"pt-BR");case"status":return(kn[n.status]??0)-(kn[s.status]??0);default:return 0}})}function co({id:e,children:t}){const{attributes:n,listeners:s,setNodeRef:a,transform:i,transition:c,isDragging:l}=Lr({id:e}),u={transform:Pe.Transform.toString(i),transition:c};return r.jsx("div",{ref:a,style:u,...n,...s,className:Z("touch-none",l&&"opacity-30"),children:t})}function uo({status:e,isOver:t,items:n,itemIds:s,today:a,onEdit:i,onDelete:c,showRichNotes:l}){const{setNodeRef:u}=xn({id:e});return r.jsxs("div",{className:Z("flex flex-col rounded-xl border border-border border-t-4 bg-card/40 min-h-[400px] transition-colors",io[e]||"border-t-muted/60",t&&"bg-card/80 ring-2 ring-primary/20"),children:[r.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border shadow-sm bg-background/50 backdrop-blur-md rounded-t-xl",children:[r.jsx(Ae,{variant:"secondary",className:tn[e],children:ut[e]}),r.jsx(Ae,{variant:"secondary",className:"ml-auto text-xs bg-secondary/50",children:n.length})]}),r.jsxs("div",{ref:u,"data-column-status":e,className:"flex-1 p-3 space-y-3",children:[r.jsx(Ir,{items:s,strategy:Ar,children:n.map(f=>r.jsx(co,{id:f.id,children:r.jsx(on,{sub:f,today:a,onEdit:()=>i(f),onDelete:()=>c(f.id),showRichNotes:l})},f.id))}),n.length===0&&r.jsxs("div",{className:"sticky top-[40vh] flex flex-col items-center justify-center text-xs text-muted-foreground/50 border-2 border-dashed border-border/50 rounded-xl p-4 text-center gap-1",children:[r.jsx(Ae,{variant:"secondary",className:Z("font-medium mb-1",tn[e]),children:ut[e]}),r.jsx("span",{children:"Arraste subtarefas para cá"})]})]})]})}const on=o.memo(function({sub:t,today:n,showStatus:s,onEdit:a,onDelete:i,showRichNotes:c}){const l=t.dueDate&&t.dueDate<n&&t.status!=="Concluído";return r.jsx(ft,{className:Z("transition-shadow duration-150",l&&"border-destructive/50"),children:r.jsx(ht,{className:"p-3",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[s&&r.jsx(Ae,{variant:"secondary",className:Z("text-[10px]",tn[t.status]),children:ut[t.status]}),l&&r.jsx(Ae,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),r.jsx("p",{className:Z("font-medium text-sm",t.completed&&"line-through text-muted-foreground"),children:t.title}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[r.jsx("span",{className:"font-medium",children:"Tarefa:"})," ",t.parentTaskTitle]}),r.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[t.projectName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Jn,{className:"w-3 h-3"}),t.projectName]}),t.assignee&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Zn,{className:"w-3 h-3"}),t.assignee]}),t.dueDate&&r.jsxs("span",{className:Z("flex items-center gap-1",l&&"text-destructive font-medium"),children:[r.jsx(Qn,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]}),t.notes&&c&&r.jsx("div",{className:"text-xs text-muted-foreground mt-1 prose prose-xs max-w-none [&>*]:m-0 [&>*]:text-xs line-clamp-4",dangerouslySetInnerHTML:{__html:Pn(t.notes)||t.notes}}),t.notes&&!c&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.notes.replace(/<[^>]*>/g,"")})]}),r.jsxs("div",{className:"flex gap-1 shrink-0",children:[r.jsx(We,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:a,children:r.jsx(as,{className:"w-3.5 h-3.5"})}),r.jsx(We,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:i,children:r.jsx(os,{className:"w-3.5 h-3.5"})})]})]})})})});function fo({tasks:e,projects:t,loading:n,onCreateSubtask:s,onUpdateSubtask:a,onDeleteSubtask:i}){const[c,l]=o.useState(!1),[u,f]=o.useState(null),[h,m]=o.useState("kanban"),[b,p]=o.useState(""),[S,x]=o.useState("all"),[v,w]=o.useState("all"),[N,D]=o.useState("all"),[y,R]=o.useState("all"),[T,E]=o.useState("all"),[C,_]=o.useState("deadline"),[F,P]=o.useState(!1),[X,ce]=o.useState(!1),[G,be]=o.useState(null),[Se,Q]=o.useState(null),[Oe,ie]=o.useState(null),ye=ir(or(Ut,{activationConstraint:{distance:8}})),ke=o.useMemo(()=>{const g={};return t.forEach(I=>{g[I.id]=I.name}),g},[t]),k=o.useMemo(()=>e.flatMap(g=>g.subtasks.map(I=>({...I,parentTaskTitle:g.title,projectId:g.projectId,projectName:g.projectId?ke[g.projectId]:void 0}))),[e,ke]),te=o.useMemo(()=>{const g=new Date,I=new Date(g.getFullYear(),g.getMonth(),g.getDate()),M=new Date(I);M.setDate(I.getDate()+(7-I.getDay()));const ne=new Date(g.getFullYear(),g.getMonth()+1,0),U=k.filter(Y=>{if(b&&!Y.title.toLowerCase().includes(b.toLowerCase())||S!=="all"&&Y.status!==S||v!=="all"&&Y.assignee!==v||N!=="all"&&Y.projectId!==N||y!=="all"&&Y.parentTaskId!==y)return!1;if(T!=="all"){if(!Y.dueDate)return T==="sem_prazo";const oe=new Date(Y.dueDate+"T23:59:59");switch(T){case"atrasadas":return oe<I&&Y.status!=="Concluído";case"hoje":return Y.dueDate===le;case"esta_semana":return oe>=I&&oe<=M;case"este_mes":return oe>=I&&oe<=ne;case"sem_prazo":return!1}}return!0});return lo(U,C)},[k,b,S,v,N,y,C]),le=o.useMemo(()=>{const g=new Date;return`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}`},[]);o.useMemo(()=>{const g={"A fazer":0,"Em andamento":0,Concluído:0},I=k.filter(M=>M.dueDate&&M.dueDate<le&&M.status!=="Concluído").length;return k.forEach(M=>{g[M.status]!==void 0&&g[M.status]++}),{...g,overdue:I,total:k.length}},[k,le]);const je=o.useCallback(()=>{f(null),l(!0)},[]),H=o.useCallback(g=>{f(g),l(!0)},[]),Fe=o.useCallback(async(g,I,M)=>{I?await s(g.parentTaskId,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0}):M&&await a(M,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0})},[s,a]),fe=o.useCallback(async()=>{G&&(await i(G),be(null))},[G,i]),ve=o.useMemo(()=>{const g={"A fazer":[],"Em andamento":[],Concluído:[]};return te.forEach(I=>{g[I.status]&&g[I.status].push(I)}),g},[te]),O=o.useCallback(g=>{Q(String(g.active.id))},[]),Ie=o.useCallback(g=>{const{over:I}=g;if(!I){ie(null);return}const M=String(I.id),ne=k.find(Y=>Y.id===M),U=ne?ne.status:Rt.includes(M)?M:null;ie(U)},[k]),se=o.useCallback(async g=>{const{active:I,over:M}=g;if(Q(null),ie(null),!M)return;const ne=String(I.id),U=String(M.id);if(ne===U)return;const Y=k.find(Me=>Me.id===ne);if(!Y)return;const oe=k.find(Me=>Me.id===U),$e=oe?oe.status:Rt.includes(U)?U:Y.status;Y.status!==$e&&await a(ne,{status:$e})},[k,a]),Re=o.useCallback(()=>{Q(null),ie(null)},[]),ae=Se?k.find(g=>g.id===Se):null,Ce=o.useMemo(()=>Rt.filter(g=>!F||g!=="Concluído"),[F]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3 glass p-4 rounded-xl border border-border shadow-sm mb-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(cn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(kt,{placeholder:"Buscar subtarefa...",value:b,onChange:g=>p(g.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[r.jsxs(We,{onClick:je,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity h-9",children:[r.jsx(qn,{className:"mr-1.5 h-4 w-4"})," Nova Subtarefa"]}),r.jsxs("div",{className:"flex border border-border rounded-lg overflow-hidden bg-muted/40",children:[r.jsxs("button",{onClick:()=>m("kanban"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",h==="kanban"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(tr,{className:"w-4 h-4"})," Kanban"]}),r.jsxs("button",{onClick:()=>m("list"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",h==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(Gn,{className:"w-4 h-4"})," Lista"]})]})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap flex-1",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Status"}),r.jsxs(me,{value:S,onValueChange:x,children:[r.jsx(ge,{className:"w-[130px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos Status"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todos Status"}),Rt.map(g=>r.jsx(z,{value:g,children:ut[g]},g))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prazo"}),r.jsxs(me,{value:T,onValueChange:E,children:[r.jsx(ge,{className:"w-[120px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todos"}),r.jsx(z,{value:"atrasadas",children:"Atrasadas"}),r.jsx(z,{value:"hoje",children:"Vence hoje"}),r.jsx(z,{value:"esta_semana",children:"Esta semana"}),r.jsx(z,{value:"este_mes",children:"Este mês"}),r.jsx(z,{value:"sem_prazo",children:"Sem prazo"})]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Responsável"}),r.jsxs(me,{value:v,onValueChange:w,children:[r.jsx(ge,{className:"w-[120px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todos"}),Bn.map(g=>r.jsx(z,{value:g,children:g},g))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Tarefa-mãe"}),r.jsxs(me,{value:y,onValueChange:R,children:[r.jsx(ge,{className:"w-[160px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todas"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todas"}),e.map(g=>r.jsx(z,{value:g.id,children:g.title},g.id))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Ordenar por"}),r.jsxs(me,{value:C,onValueChange:g=>_(g),children:[r.jsx(ge,{className:"w-[160px] h-8 text-xs",children:r.jsx(xe,{})}),r.jsx(pe,{children:oo.map(g=>r.jsx(z,{value:g.value,children:g.label},g.value))})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1.5 ml-auto shrink-0",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar concluídas",r.jsx(it,{checked:F,onCheckedChange:P,className:"scale-75"})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Observações formatadas",r.jsx(it,{checked:X,onCheckedChange:ce,className:"scale-75"})]})]})]})]}),r.jsx(bs,{open:c,onOpenChange:l,subtask:u,tasks:e,onSave:Fe}),r.jsx($n,{open:!!G,onOpenChange:g=>!g&&be(null),children:r.jsxs(Kn,{children:[r.jsxs(Un,{children:[r.jsx(Yn,{children:"Remover subtarefa?"}),r.jsx(Vn,{children:"Esta ação não pode ser desfeita. A subtarefa será removida permanentemente."})]}),r.jsxs(Xn,{children:[r.jsx(Hn,{children:"Cancelar"}),r.jsx(Wn,{onClick:fe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?r.jsx("div",{className:"space-y-3",children:[1,2,3].map(g=>r.jsx(ft,{children:r.jsx(ht,{className:"p-4",children:r.jsx("div",{className:"h-16 bg-muted animate-pulse rounded"})})},g))}):h==="list"?r.jsx("div",{className:"space-y-3",children:te.length===0?r.jsx(ft,{children:r.jsx(ht,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma subtarefa encontrada."})}):te.map(g=>r.jsx(on,{sub:g,today:le,showStatus:!0,onEdit:()=>H(g),onDelete:()=>be(g.id),showRichNotes:X},g.id))}):r.jsxs(Nr,{sensors:ye,collisionDetection:lr,onDragStart:O,onDragOver:Ie,onDragEnd:se,onDragCancel:Re,children:[r.jsx("div",{className:"overflow-x-auto -mx-2 px-2 pb-4",children:r.jsx("div",{className:"flex gap-4",style:{minWidth:`${Ce.length*300}px`},children:Ce.map(g=>{const I=Oe===g,M=ve[g],ne=M.map(U=>U.id);return r.jsx("div",{className:"flex-1 min-w-[260px]",children:r.jsx(uo,{status:g,isOver:I,items:M,itemIds:ne,today:le,onEdit:H,onDelete:be,showRichNotes:X})},g)})})}),r.jsx(Tr,{children:ae&&r.jsx("div",{className:"shadow-xl ring-2 ring-primary/30 rotate-[2deg] scale-105",children:r.jsx(on,{sub:ae,today:le,showStatus:!0,onEdit:()=>{},onDelete:()=>{},showRichNotes:X})})})]})]})}const ho=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"priority",label:"Prioridade (Alta → Baixa)"},{value:"title",label:"Título (A → Z)"},{value:"client",label:"Cliente (A → Z)"}],In={alta:0,media:1,baixa:2};function Mn(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"priority":return(In[n.priority]??1)-(In[s.priority]??1);case"title":return n.title.localeCompare(s.title,"pt-BR");case"client":return(n.client??"").localeCompare(s.client??"","pt-BR");default:return 0}})}const mo={client:!0,dueDate:!0,priority:!0,subtasks:!0,tags:!0,description:!0,richDescription:!1},Ln={client:"Cliente",dueDate:"Data de entrega",priority:"Prioridade",subtasks:"Subtarefas",tags:"Tags",description:"Descrição",richDescription:"Observação formatada"},At=["pendente","agendado","em_andamento","em_tramite","concluida","cancelada"],go={pendente:"border-t-red-500/60",agendado:"border-t-blue-500/60",em_andamento:"border-t-yellow-500/60",em_tramite:"border-t-orange-500/60",concluida:"border-t-green-500/60",cancelada:"border-t-muted/60"},xo={pendente:er,agendado:hs,em_andamento:vn,em_tramite:vn,concluida:ms,cancelada:fs},po=[{value:"all",label:"Todos"},{value:"today",label:"Hoje"},{value:"this_week",label:"Esta semana"},{value:"this_month",label:"Este mês"},{value:"overdue",label:"Atrasadas"},{value:"no_deadline",label:"Sem prazo"}],ln=o.memo(function({task:t,cardFields:n,today:s,isExpanded:a,onToggleExpand:i,onToggleSubtask:c,onEdit:l,onDelete:u,showStatus:f,isDragging:h,isOverlay:m,projectName:b}){const p=t.subtasks.filter(v=>v.completed).length,S=t.subtasks.length,x=t.dueDate&&t.dueDate<s&&t.status!=="concluida"&&t.status!=="cancelada";return r.jsx(ft,{className:Z("relative group transition-all duration-200 hover:shadow-md cursor-pointer",h?"opacity-40 scale-95":"",m&&"shadow-2xl ring-2 ring-primary/40 rotate-[2deg] scale-105 cursor-grabbing","border-border/50 bg-card"),onClick:()=>l==null?void 0:l(t),children:r.jsxs(ht,{className:"p-3.5",children:[b&&r.jsx("div",{className:"mb-2",children:r.jsxs(Ae,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1 font-normal",children:[r.jsx(Jn,{className:"w-3 h-3"}),b]})}),r.jsx("p",{className:"font-medium text-sm mb-1",children:t.title}),n.description&&t.description&&!n.richDescription&&r.jsx("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-2",children:t.description.replace(/<[^>]*>/g,"")}),n.richDescription&&t.description&&r.jsx("div",{className:"text-xs text-muted-foreground mb-2 prose prose-xs max-w-none [&>*]:m-0 [&>*]:text-xs line-clamp-4",dangerouslySetInnerHTML:{__html:Pn(t.description)||t.description}}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[n.priority&&r.jsx(Ae,{variant:"secondary",className:`text-[10px] ${Zr[t.priority]}`,children:nn[t.priority]}),f&&r.jsx(Ae,{variant:"secondary",className:`text-[10px] ${Qr[t.status]}`,children:It[t.status]}),n.dueDate&&t.dueDate&&r.jsxs("span",{className:Z("flex items-center gap-1",x&&"text-destructive font-medium"),children:[x?r.jsx(er,{className:"w-3 h-3"}):r.jsx(Qn,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]}),x&&r.jsx("span",{className:"text-destructive font-medium",children:"Atrasada"}),t.assignee&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Zn,{className:"w-3 h-3"}),t.assignee]})]}),n.subtasks&&S>0&&!m&&r.jsx("div",{className:"flex justify-end mt-2",children:r.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:[r.jsx(nr,{className:"w-3 h-3"}),p,"/",S]})}),n.tags&&t.tags&&t.tags.length>0&&!m&&r.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.map(v=>r.jsx(Ae,{variant:"outline",className:"text-[10px]",children:v},v))})]})})});function vo(e){const{attributes:t,listeners:n,setNodeRef:s,transform:a,transition:i,isDragging:c}=Lr({id:e.task.id}),l={transform:Pe.Transform.toString(a),transition:i};return r.jsx("div",{ref:s,style:l,...t,...n,children:r.jsx(ln,{...e,isDragging:c})})}function bo({status:e,tasks:t,isOver:n,cardFields:s,today:a,expandedTasks:i,onToggleExpand:c,onToggleSubtask:l,onEdit:u,onDelete:f,projectMap:h}){const m=o.useMemo(()=>t.map(S=>S.id),[t]),{setNodeRef:b}=xn({id:e}),p=xo[e];return r.jsxs("div",{className:Z("flex flex-col rounded-xl border border-border border-t-4 bg-card/40 min-h-[400px] transition-colors",go[e]||"border-t-muted/60",n&&"bg-card/80 ring-2 ring-primary/20"),children:[r.jsxs("div",{className:"flex items-center gap-2 p-3 px-4",children:[r.jsx(p,{className:Z("w-4 h-4",{"text-red-500":e==="pendente","text-blue-500":e==="agendado","text-yellow-500":e==="em_andamento","text-orange-500":e==="em_tramite","text-green-500":e==="concluida","text-muted-foreground":e==="cancelada"})}),r.jsx("span",{className:"text-sm font-medium",children:It[e]}),r.jsx(Ae,{variant:"secondary",className:"ml-auto text-xs bg-secondary/50 tabular-nums",children:t.length})]}),r.jsxs("div",{ref:b,"data-column-status":e,className:"flex-1 p-3 pt-0 space-y-3",children:[r.jsx(Ir,{items:m,strategy:Ar,children:t.map(S=>r.jsx(vo,{task:S,cardFields:s,today:a,isExpanded:i.has(S.id),onToggleExpand:c,onToggleSubtask:l,onEdit:u,onDelete:f,projectName:h.get(S.projectId||"")},S.id))}),t.length===0&&r.jsx("div",{className:"flex flex-col items-center justify-center text-xs text-muted-foreground/50 border-2 border-dashed border-border/50 rounded-xl p-4 text-center gap-1 min-h-[100px]",children:r.jsx("span",{children:"Arraste tarefas para cá"})})]})]})}function yo({projectId:e,clientNameFilter:t,hideHeader:n,forceTab:s}={}){const{tasks:a,setTasks:i,loading:c,error:l,updateTaskStatus:u,deleteTask:f,createTask:h,updateTask:m,createSubtask:b,updateSubtask:p,deleteSubtask:S}=Gr(),{projects:x}=Jr(),[v,w]=o.useState(!1),[N,D]=o.useState(null),[y,R]=o.useState([]),[T,E]=o.useState("kanban"),[C,_]=o.useState(""),[F,P]=o.useState("all"),[X,ce]=o.useState("all"),[G,be]=o.useState("all"),[Se,Q]=o.useState(e||"all"),[Oe,ie]=o.useState(new Set),[ye,ke]=o.useState(mo),[k,te]=o.useState(null),[le,je]=o.useState(null),[H,Fe]=o.useState("deadline"),[fe,ve]=o.useState(!1),[O,Ie]=o.useState(!1),[se,Re]=o.useState("all"),[ae,Ce]=o.useState("all");o.useEffect(()=>{a.length>0&&R(t?a.filter(d=>{var j;return(j=d.client)==null?void 0:j.toLowerCase().includes(t.toLowerCase())}):a)},[a,t]);const g=o.useMemo(()=>{const d=new Date;return`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`},[]),I=o.useMemo(()=>[...new Set(y.map(d=>d.assignee).filter(Boolean))],[y]),M=o.useMemo(()=>{const d=e||Se,j=new Date,A=new Date(j);A.setDate(j.getDate()+7);const K=new Date(j.getFullYear(),j.getMonth()+1,0),B=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}-${String(A.getDate()).padStart(2,"0")}`,W=`${K.getFullYear()}-${String(K.getMonth()+1).padStart(2,"0")}-${String(K.getDate()).padStart(2,"0")}`,de=y.filter(J=>{var $;if(C&&!J.title.toLowerCase().includes(C.toLowerCase())||F!=="all"&&J.status!==F||X!=="all"&&J.priority!==X||G!=="all"&&J.client!==G||ae!=="all"&&J.assignee!==ae||d!=="all"&&J.projectId!==d)return!1;if(se!=="all"){const q=($=J.dueDate)==null?void 0:$.split("T")[0];switch(se){case"today":if(q!==g)return!1;break;case"this_week":if(!q||q<g||q>B)return!1;break;case"this_month":if(!q||q<g||q>W)return!1;break;case"overdue":if(!q||q>=g||J.status==="concluida"||J.status==="cancelada")return!1;break;case"no_deadline":if(q)return!1;break}}return!0});return Mn(de,H)},[y,C,F,X,G,ae,Se,H,se,g]),ne=g,U=o.useMemo(()=>k?y.find(d=>d.id===k):null,[k,y]),Y=o.useMemo(()=>[...new Set(y.map(d=>d.client).filter(Boolean))],[y]),oe=o.useMemo(()=>{const d=new Map;return x.forEach(j=>d.set(j.id,j.name)),d},[x]),$e=o.useMemo(()=>y.reduce((d,j)=>d+j.subtasks.length,0),[y]),Me=o.useCallback(d=>{ie(j=>{const A=new Set(j);return A.has(d)?A.delete(d):A.add(d),A})},[]),jt=o.useCallback((d,j)=>{R(A=>A.map(K=>K.id===d?{...K,subtasks:K.subtasks.map(B=>B.id===j?{...B,completed:!B.completed}:B)}:K))},[]),[Ke,Ne]=o.useState(null),ze=o.useCallback(async()=>{Ke&&(f(Ke),R(d=>d.filter(j=>j.id!==Ke)),Ne(null))},[Ke,f]),Ue=o.useCallback(d=>{ke(j=>({...j,[d]:!j[d]}))},[]),wt=o.useCallback(()=>{D(null),w(!0)},[]),De=o.useCallback(d=>{D(d),w(!0)},[]),St=o.useCallback(async(d,j,A)=>{j?await h({title:d.title,deadline:d.deadline,priority:d.priority,status:d.status,clientName:d.clientName,projectId:d.projectId,assignee:d.assignee,description:d.description,numeroProcesso:d.numeroProcesso}):A&&await m(A,{title:d.title,deadline:d.deadline,priority:d.priority,status:d.status,clientName:d.clientName,projectId:d.projectId,assignee:d.assignee,description:d.description,numeroProcesso:d.numeroProcesso})},[h,m]),Xt=ir(or(Ut,{activationConstraint:{distance:8}}));o.useCallback(d=>{const j=y.find(A=>A.id===d);return j==null?void 0:j.status},[y]);const Ht=o.useCallback(d=>{te(d.active.id)},[]),tt=o.useCallback(d=>{const{over:j}=d;if(!j){je(null);return}const A=j.id,K=y.find(W=>W.id===A),B=K?K.status:At.includes(A)?A:null;je(B)},[y]),Ct=o.useCallback(d=>{const{active:j,over:A}=d;if(te(null),je(null),!A)return;const K=j.id,B=A.id;if(K===B)return;const W=y.find($=>$.id===K);if(!W)return;const de=y.find($=>$.id===B),J=de?de.status:At.includes(B)?B:W.status;W.status!==J&&(R($=>{const q=$.map(he=>he.id===K?{...he,status:J}:he);return Mn(q,H)}),u(K,J))},[y,u,H]),Wt=o.useCallback(()=>{te(null),je(null)},[]),Nt=o.useMemo(()=>{const d={};return At.forEach(j=>{d[j]=[]}),M.forEach(j=>{d[j.status]&&d[j.status].push(j)}),d},[M]),Dt=o.useMemo(()=>At.filter(d=>!(fe&&d==="concluida"||O&&d==="cancelada")),[fe,O]),[nt,qt]=o.useState(s||"tarefas");return r.jsxs(pn.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[!s&&r.jsx("div",{className:"flex items-center gap-1 rounded-2xl border border-border bg-muted/40 p-1 w-fit backdrop-blur-sm mb-5",children:[{id:"tarefas",label:"Tarefas",icon:ds,count:M.length},{id:"subtarefas",label:"Subtarefas",icon:nr,count:$e}].map(d=>{const j=nt===d.id,A=d.icon;return r.jsxs("button",{onClick:()=>qt(d.id),className:Z("relative flex items-center gap-2 rounded-xl px-5 py-2.5 text-sm font-medium transition-all duration-200",j?"text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-background/50"),children:[j&&r.jsx(pn.div,{layoutId:"tarefas-tab-bg",className:"absolute inset-0 rounded-xl gold-gradient shadow-sm",transition:{type:"spring",bounce:.15,duration:.5}}),r.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[r.jsx(A,{className:"h-4 w-4"}),d.label,r.jsx("span",{className:Z("inline-flex items-center justify-center rounded-full px-2 py-0.5 text-[10px] font-semibold tabular-nums min-w-[22px] transition-colors",j?"bg-primary-foreground/20 text-primary-foreground":"bg-secondary text-muted-foreground"),children:d.count})]})]},d.id)})}),nt==="tarefas"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3 glass p-4 rounded-xl border border-border shadow-sm mb-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(cn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(kt,{placeholder:"Buscar tarefas...",value:C,onChange:d=>_(d.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[r.jsxs(We,{onClick:wt,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity h-9",children:[r.jsx(qn,{className:"mr-1.5 h-4 w-4"})," Nova Tarefa"]}),r.jsxs("div",{className:"flex border border-border rounded-lg overflow-hidden bg-muted/40",children:[r.jsxs("button",{onClick:()=>E("kanban"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",T==="kanban"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(tr,{className:"w-4 h-4"})," Kanban"]}),r.jsxs("button",{onClick:()=>E("list"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",T==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(Gn,{className:"w-4 h-4"})," Lista"]})]}),l&&r.jsx("span",{className:"text-xs text-destructive",children:"Erro ao carregar"}),r.jsxs(Fn,{children:[r.jsx(zn,{asChild:!0,children:r.jsx(We,{variant:"outline",size:"icon",className:"h-9 w-9",children:r.jsx(xs,{className:"w-4 h-4"})})}),r.jsx(_n,{className:"w-56",align:"end",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm font-medium mb-2",children:"Mostrar nos cards"}),Object.keys(Ln).map(d=>r.jsxs("div",{className:"flex items-center justify-between py-1",children:[r.jsx(is,{htmlFor:`field-${d}`,className:"text-sm cursor-pointer",children:Ln[d]}),r.jsx(it,{id:`field-${d}`,checked:ye[d],onCheckedChange:()=>Ue(d)})]},d))]})})]})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-end",children:[r.jsx(us,{className:"w-4 h-4 text-muted-foreground shrink-0 mb-2"}),r.jsxs("div",{className:"flex items-end gap-2 flex-wrap flex-1",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Status"}),r.jsxs(me,{value:F,onValueChange:P,children:[r.jsx(ge,{className:"w-[130px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos Status"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todos Status"}),Object.keys(It).map(d=>r.jsx(z,{value:d,children:It[d]},d))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prioridade"}),r.jsxs(me,{value:X,onValueChange:ce,children:[r.jsx(ge,{className:"w-[110px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todas"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todas"}),Object.keys(nn).map(d=>r.jsx(z,{value:d,children:nn[d]},d))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prazo"}),r.jsxs(me,{value:se,onValueChange:d=>Re(d),children:[r.jsx(ge,{className:"w-[110px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos"})}),r.jsx(pe,{children:po.map(d=>r.jsx(z,{value:d.value,children:d.label},d.value))})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Responsável"}),r.jsxs(me,{value:ae,onValueChange:Ce,children:[r.jsx(ge,{className:"w-[120px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todos"}),I.map(d=>r.jsx(z,{value:d,children:d},d))]})]})]}),!e&&r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Projeto"}),r.jsxs(me,{value:Se,onValueChange:Q,children:[r.jsx(ge,{className:"w-[150px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todos Projetos"}),x.map(d=>r.jsx(z,{value:d.id,children:d.name},d.id))]})]})]}),Y.length>0&&r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Cliente"}),r.jsxs(me,{value:G,onValueChange:be,children:[r.jsx(ge,{className:"w-[130px] h-8 text-xs",children:r.jsx(xe,{placeholder:"Todos"})}),r.jsxs(pe,{children:[r.jsx(z,{value:"all",children:"Todos Clientes"}),Y.map(d=>r.jsx(z,{value:d,children:d},d))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Ordenar por"}),r.jsxs(me,{value:H,onValueChange:d=>Fe(d),children:[r.jsx(ge,{className:"w-[160px] h-8 text-xs",children:r.jsx(xe,{})}),r.jsxs(pe,{children:[r.jsx(z,{value:"deadline",children:"Sem ordenação"}),ho.map(d=>r.jsx(z,{value:d.value,children:d.label},d.value))]})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1.5 ml-auto shrink-0",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar canceladas",r.jsx(it,{checked:O,onCheckedChange:Ie,className:"scale-75"})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar concluídas",r.jsx(it,{checked:fe,onCheckedChange:ve,className:"scale-75"})]})]})]})]}),r.jsx(Br,{open:v,onOpenChange:w,task:N,onSave:St,onCreateSubtask:b,onUpdateSubtask:p,onDeleteSubtask:S}),r.jsx($n,{open:!!Ke,onOpenChange:d=>!d&&Ne(null),children:r.jsxs(Kn,{children:[r.jsxs(Un,{children:[r.jsx(Yn,{children:"Remover tarefa?"}),r.jsx(Vn,{children:"Esta ação não pode ser desfeita. A tarefa será removida permanentemente."})]}),r.jsxs(Xn,{children:[r.jsx(Hn,{children:"Cancelar"}),r.jsx(Wn,{onClick:ze,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),c?T==="list"?r.jsx(ls,{}):r.jsx(cs,{}):T==="list"?r.jsx("div",{className:"space-y-3",children:M.length===0?r.jsx(ft,{children:r.jsx(ht,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma tarefa encontrada."})}):M.map(d=>r.jsx(ln,{task:d,cardFields:ye,today:ne,isExpanded:Oe.has(d.id),onToggleExpand:Me,onToggleSubtask:jt,onEdit:De,onDelete:Ne,showStatus:!0,projectName:oe.get(d.projectId||"")},d.id))}):r.jsxs(Nr,{sensors:Xt,collisionDetection:lr,onDragStart:Ht,onDragOver:tt,onDragEnd:Ct,onDragCancel:Wt,children:[r.jsx("div",{className:"overflow-x-auto -mx-2 px-2 pb-4",children:r.jsx("div",{className:"flex gap-4",style:{minWidth:`${Dt.length*280}px`},children:Dt.map(d=>r.jsx("div",{className:"flex-1 min-w-[260px]",children:r.jsx(bo,{status:d,tasks:Nt[d],isOver:le===d&&k!==null,cardFields:ye,today:ne,expandedTasks:Oe,onToggleExpand:Me,onToggleSubtask:jt,onEdit:De,onDelete:Ne,projectMap:oe})},d))})}),r.jsx(Tr,{dropAnimation:{duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)"},children:U?r.jsx("div",{className:"w-[260px]",children:r.jsx(ln,{task:U,cardFields:ye,today:ne,isExpanded:!1,onToggleExpand:()=>{},onToggleSubtask:()=>{},onDelete:()=>{},isOverlay:!0,projectName:oe.get(U.projectId||"")})}):null})]})]}),nt==="subtarefas"&&r.jsx(fo,{tasks:e?y.filter(d=>d.projectId===e):y,projects:x,loading:c,onCreateSubtask:b,onUpdateSubtask:p,onDeleteSubtask:S})]})}const Qo=Object.freeze(Object.defineProperty({__proto__:null,default:yo},Symbol.toStringTag,{value:"Module"}));export{yo as A,nr as L,Qo as a};
