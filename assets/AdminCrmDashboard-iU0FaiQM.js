import{r as g,j as e,m as i,e as o,L as C}from"./index-CBKbDdfZ.js";import{C as c,c as m,a as T,b as S}from"./card-CniWIzj0.js";import{B as A}from"./badge-Dvw6CZT0.js";import{B as k}from"./button-D7qP377h.js";import{S as f}from"./skeleton-COHRbcjA.js";import{S as I,a as $,b as z,c as M,d as v}from"./select-Bz0W1g4z.js";import{u as X,a as ee,f as se,b as ae,E as re,d as te,T as le,c as ie}from"./crmTypes-BpGos2A4.js";import{F as ne}from"./filter-y5qTSu27.js";import{F as de}from"./folder-kanban-DuFl4cJ_.js";import{C as w}from"./calendar-CCaD6yKu.js";import{L as D}from"./list-todo-C0iBtZs4.js";import{C as oe}from"./clock-BvXn9V7q.js";import{T as H}from"./triangle-alert-DhtLOse5.js";import{a as Y,C as ce}from"./circle-check-CXtfdKLY.js";import{A as K}from"./arrow-right-Cvz8veuD.js";import{U as E}from"./users-xLb9jbXT.js";import"./index-3ILgmRwk.js";import"./index-CefIVmab.js";import"./index-BEiXu-g4.js";import"./chevron-up-BDobxoab.js";import"./check-CZDoyK01.js";import"./useQuery-BJ8xkWow.js";function me(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[1,2,3,4].map(n=>e.jsx(c,{className:"glass-card",children:e.jsxs(m,{className:"p-4 flex items-center gap-3",children:[e.jsx(f,{className:"h-10 w-10 rounded-lg"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"h-7 w-8"}),e.jsx(f,{className:"h-3 w-20"})]})]})},n))}),e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:[1,2].map(n=>e.jsx(c,{className:"glass-card",children:e.jsxs(m,{className:"p-6 space-y-3",children:[e.jsx(f,{className:"h-5 w-40 mb-2"}),[1,2,3].map(y=>e.jsx(f,{className:"h-16 w-full rounded-lg"},y))]})},n))})]})}function xe(){return new Intl.DateTimeFormat("sv-SE",{timeZone:"America/Sao_Paulo"}).format(new Date)}const F={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.06}}},j={hidden:{opacity:0,y:12},show:{opacity:1,y:0,transition:{duration:.35,ease:[0,0,.2,1]}}};function _e(){const{events:n,loading:y}=X(),{tasks:b,loading:U}=ee(),{clients:ue,loading:Z}=se(),{projects:x,loading:q}=ae(),[t,B]=g.useState("all"),[d,L]=g.useState("all"),G=y||U||Z||q,N=xe(),J=g.useMemo(()=>{const s=new Set;return b.forEach(a=>{a.client&&s.add(a.client)}),n.forEach(a=>{a.client&&s.add(a.client)}),[...s].sort()},[b,n]),l=g.useMemo(()=>{let s=b;if(t!=="all"&&(s=s.filter(a=>a.client===t)),d!=="all"){const a=x.find(r=>r.id===d);a&&(s=s.filter(r=>r.client===a.name))}return s},[b,t,d,x]),P=g.useMemo(()=>{let s=n;if(t!=="all"&&(s=s.filter(a=>a.client===t)),d!=="all"){const a=x.find(r=>r.id===d);a&&(s=s.filter(r=>r.client===a.name))}return s},[n,t,d,x]),Q=P.filter(s=>s.date===N).length,R=l.filter(s=>s.dueDate&&s.dueDate<N&&s.status!=="concluida"&&s.status!=="cancelada").length,u=l.filter(s=>s.status==="em_andamento").length,h=l.filter(s=>s.status==="concluida").length,p=l.filter(s=>s.status==="pendente"||s.status==="agendado").length,_=P.filter(s=>s.date>=N&&s.status!=="cancelado").sort((s,a)=>s.date.localeCompare(a.date)||(s.time||"").localeCompare(a.time||"")).slice(0,6),V=l.filter(s=>s.status!=="concluida"&&s.status!=="cancelada").sort((s,a)=>{const r={alta:0,media:1,baixa:2};return r[s.priority]-r[a.priority]||(s.dueDate||"").localeCompare(a.dueDate||"")}).slice(0,6),W=s=>{const a=new Date(s+"T12:00:00"),r=new Date;r.setHours(12,0,0,0);const O=Math.round((a.getTime()-r.getTime())/864e5);return O===0?"Hoje":O===1?"Amanhã":a.toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"short"})};return e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:G?e.jsx(me,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[e.jsx(ne,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs(I,{value:t,onValueChange:B,children:[e.jsx($,{className:"w-[220px] glass-card border-border/40",children:e.jsx(z,{placeholder:"Filtrar por cliente"})}),e.jsxs(M,{children:[e.jsx(v,{value:"all",children:"Todos os clientes"}),J.map(s=>e.jsx(v,{value:s,children:s},s))]})]}),e.jsxs(I,{value:d,onValueChange:L,children:[e.jsxs($,{className:"w-[220px] glass-card border-border/40",children:[e.jsx(de,{className:"w-4 h-4 mr-1.5 text-muted-foreground"}),e.jsx(z,{placeholder:"Filtrar por projeto"})]}),e.jsxs(M,{children:[e.jsx(v,{value:"all",children:"Todos os projetos"}),x.map(s=>e.jsx(v,{value:s.id,children:s.name},s.id))]})]}),(t!=="all"||d!=="all")&&e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>{B("all"),L("all")},className:"text-xs",children:"Limpar filtros"})]}),e.jsx(i.div,{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-8",variants:F,initial:"hidden",animate:"show",children:[{icon:w,value:Q,label:"Hoje",gradient:"from-background to-primary/5",iconBg:"bg-primary/10 text-primary ring-primary/20"},{icon:D,value:p,label:"A Fazer",gradient:"from-background to-muted/30",iconBg:"bg-muted text-muted-foreground ring-muted-foreground/10"},{icon:oe,value:u,label:"Em andamento",gradient:"from-background to-accent/5",iconBg:"bg-accent/10 text-accent ring-accent/20"},{icon:H,value:R,label:"Atrasadas",gradient:"from-background to-destructive/5",iconBg:"bg-destructive/10 text-destructive ring-destructive/20",valueColor:"text-destructive/90"},{icon:Y,value:h,label:"Concluídas",gradient:"from-background to-emerald-500/5",iconBg:"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 ring-emerald-500/20"}].map((s,a)=>e.jsx(i.div,{variants:j,children:e.jsx(c,{className:o("glass-card bg-gradient-to-br hover:shadow-md transition-all",s.gradient),children:e.jsxs(m,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:o("p-2.5 rounded-xl ring-1 ring-inset",s.iconBg),children:e.jsx(s.icon,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:o("text-2xl font-bold font-serif tracking-tight",s.valueColor||"text-foreground/90"),children:s.value}),e.jsx("p",{className:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground",children:s.label})]})]})})},s.label))}),e.jsx(i.div,{variants:j,initial:"hidden",animate:"show",children:e.jsxs(c,{className:"mb-6 glass-card",children:[e.jsx(T,{className:"pb-3 border-b border-border/40",children:e.jsxs(S,{className:"text-[15px] font-semibold flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4 text-primary"}),"Distribuição de Tarefas",t!=="all"&&e.jsx(A,{variant:"secondary",className:"text-[10px] ml-2 font-medium bg-primary/10 text-primary",children:t})]})}),e.jsxs(m,{className:"pt-4",children:[e.jsx("div",{className:"flex gap-1.5 h-3.5 rounded-full overflow-hidden bg-muted/50 p-0.5 border border-border/50",children:l.length>0&&e.jsxs(e.Fragment,{children:[p>0&&e.jsx("div",{className:"bg-muted-foreground/40 transition-all rounded-full",style:{width:`${p/l.length*100}%`},title:`A Fazer: ${p}`}),u>0&&e.jsx("div",{className:"bg-accent transition-all rounded-full",style:{width:`${u/l.length*100}%`},title:`Em Andamento: ${u}`}),h>0&&e.jsx("div",{className:"bg-emerald-500 transition-all rounded-full",style:{width:`${h/l.length*100}%`},title:`Concluídas: ${h}`})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-muted-foreground/40 shadow-sm"})," A Fazer (",p,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-accent shadow-sm"})," Andamento (",u,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500 shadow-sm"})," Concluídas (",h,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-destructive/80 shadow-sm"})," Atrasadas (",R,")"]})]})]})]})}),e.jsxs(i.div,{className:"grid lg:grid-cols-2 gap-6",variants:F,initial:"hidden",animate:"show",children:[e.jsx(i.div,{variants:j,children:e.jsxs(c,{className:"glass-card h-full",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"text-base flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-primary"}),"Próximos Compromissos"]}),e.jsx(C,{to:"/admin/agenda",children:e.jsxs(k,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todos ",e.jsx(K,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(m,{className:"space-y-3",children:_.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum compromisso próximo."}):_.map(s=>e.jsxs("div",{className:"flex items-start gap-3.5 p-3 rounded-xl border border-border/40 hover:bg-muted/40 hover:border-border/80 transition-all group",children:[e.jsxs("div",{className:"text-center min-w-[3.5rem] p-1.5 rounded-lg bg-background shadow-sm border border-border/30 group-hover:border-primary/20 transition-colors",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:W(s.date).split(" ")[0]}),s.time&&e.jsx("p",{className:"text-sm font-bold text-foreground/90",children:s.time})]}),e.jsxs("div",{className:"flex-1 min-w-0 py-0.5",children:[e.jsx("p",{className:"text-sm font-semibold truncate group-hover:text-primary transition-colors",children:s.title}),s.client&&e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1.5 mt-1",children:[e.jsx(E,{className:"w-3 h-3 opacity-70"}),s.client]})]}),e.jsx(A,{variant:"secondary",className:o("text-[9px] uppercase tracking-widest shrink-0 py-0.5 font-semibold",re[s.type]),children:te[s.type]})]},s.id))})]})}),e.jsx(i.div,{variants:j,children:e.jsxs(c,{className:"glass-card h-full",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"text-base flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4 text-primary"}),"Tarefas Pendentes"]}),e.jsx(C,{to:"/admin/tarefas",children:e.jsxs(k,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todas ",e.jsx(K,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(m,{className:"space-y-3",children:V.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma tarefa pendente."}):V.map(s=>{const a=s.dueDate&&s.dueDate<N;return e.jsxs("div",{className:o("p-3.5 rounded-xl border transition-all duration-200 group",a?"border-destructive/30 bg-destructive/5 hover:border-destructive/50":"border-border/40 hover:bg-muted/40 hover:border-border/80"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[13px] font-semibold truncate group-hover:text-primary transition-colors",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5 flex-wrap",children:[s.client&&e.jsxs("span",{className:"text-[11px] text-muted-foreground bg-background px-1.5 py-0.5 rounded shadow-sm border border-border/30 flex items-center gap-1.5",children:[e.jsx(E,{className:"w-3 h-3 opacity-70"}),s.client]}),s.dueDate&&e.jsxs("span",{className:o("text-[11px] font-medium flex items-center gap-1",a?"text-destructive":"text-muted-foreground"),children:[a?e.jsx(H,{className:"w-3 h-3"}):e.jsx(w,{className:"w-3 h-3"}),new Date(s.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]})]}),e.jsx(A,{variant:"secondary",className:o("text-[9px] uppercase font-semibold tracking-wider shrink-0",le[s.priority]),children:ie[s.priority]})]}),s.subtasks.length>0&&e.jsxs("div",{className:"mt-3 bg-background/50 rounded-lg p-2 border border-border/20",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] text-muted-foreground mb-1.5 font-medium",children:[e.jsxs("span",{children:["Subtarefas (",s.subtasks.filter(r=>r.completed).length,"/",s.subtasks.length,")"]}),e.jsxs("span",{children:[Math.round(s.subtasks.filter(r=>r.completed).length/s.subtasks.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-muted/50 rounded-full h-1.5 p-[1px] border border-border/30",children:e.jsx("div",{className:"bg-primary/90 rounded-full h-full transition-all duration-500 ease-out",style:{width:`${s.subtasks.filter(r=>r.completed).length/s.subtasks.length*100}%`}})})]})]},s.id)})})]})})]}),e.jsx(i.div,{className:"mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3",variants:F,initial:"hidden",animate:"show",children:[{href:"/admin/agenda",icon:w,label:"Agenda"},{href:"/admin/tarefas",icon:D,label:"Tarefas"},{href:"/admin/bosi",icon:E,label:"BOSI"},{href:"/admin/posts/new",icon:Y,label:"Novo Post"}].map(s=>e.jsx(i.div,{variants:j,children:e.jsx(C,{to:s.href,children:e.jsx(c,{className:"glass-card hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(m,{className:"p-4 text-center",children:[e.jsx(s.icon,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:s.label})]})})})},s.href))})]})})}export{_e as default};
