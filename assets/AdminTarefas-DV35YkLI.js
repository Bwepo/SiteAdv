import{c as He,r as o,j as r,e as q,h as Pr,ak as Y,f as it,a4 as Fr,ai as zr,m as xn}from"./index-BvZpt6_-.js";import{E as _r,m as Pn,T as Br}from"./TarefaSheet-ia5Qn-5e.js";import{u as $r,F as Kr,a as We,b as qe,c as Ge,d as Je,e as Ze,S as ve,f as be,g as ye,h as we,i as F,t as Ur}from"./form-DA8uyQD9.js";import{S as Yr,b as Vr,c as Xr,d as Hr,e as Wr,f as qr}from"./sheet-DkUNjpgs.js";import{I as At}from"./input-Ch28ePyu.js";import{B as Xe}from"./button-BHZQesTD.js";import{P as Fn,a as zn,b as _n}from"./popover-Be5YWT34.js";import{d as Bn,S as ft,e as tn,P as Gr,f as kt,a as nn,T as Jr,g as Zr}from"./crmTypes-CmvVoXTp.js";import{S as cn}from"./search-qPONIH4P.js";import{C as Qr}from"./check-C3OwxVEn.js";import{U as es}from"./separator-CM9NCm4e.js";import{L as ts}from"./loader-circle-C3zyyxlp.js";import{o as ns,s as ot,e as rs}from"./types-C9wiu8_K.js";import{C as ht,c as mt}from"./card-T5pU5rJX.js";import{A as $n,a as Kn,b as Un,c as Yn,d as Vn,e as Xn,f as Hn,g as Wn}from"./alert-dialog-EqxRRR-f.js";import{B as Oe}from"./badge-BTeKtkMP.js";import{S as lt}from"./switch-CSM11sWw.js";import{P as qn}from"./plus-BrCCLAJz.js";import{L as Gn}from"./list-CsRPJUtj.js";import{F as Jn}from"./folder-kanban-OZuDAg_Z.js";import{U as Zn}from"./users-Boy2e3hN.js";import{C as Qn}from"./calendar-LLDtZzQU.js";import{T as ss}from"./trash-2-BTUNUdsR.js";import{L as as}from"./label-Cqqg89wQ.js";import{S as os,T as is,K as ls}from"./CrmSkeletons-BTPS5WLV.js";import{C as er}from"./circle-alert-BQ1Mf2t-.js";import{C as cs}from"./clock-DDH2SH-p.js";import{C as ds}from"./circle-check-C2weMQaH.js";import{C as us}from"./circle-x-Du8EXv9k.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=He("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=He("CircleDot",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=He("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=He("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=He("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=He("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=He("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),ps=ns({title:ot().trim().min(1,"Título obrigatório").max(200),parentTaskId:ot().min(1,"Tarefa-mãe obrigatória"),deadline:ot().optional(),status:rs(["A fazer","Em andamento","Concluído"]),assignee:ot().optional(),notes:ot().max(2e3).optional()}),xs=Object.entries(ft);function vs({open:e,onOpenChange:t,subtask:n,tasks:s,onSave:a}){const i=!n,[c,l]=o.useState(!1),[d,f]=o.useState(""),[m,h]=o.useState(!1),b=o.useMemo(()=>{if(!d.trim())return s;const x=d.toLowerCase();return s.filter(v=>v.title.toLowerCase().includes(x))},[s,d]),p=$r({resolver:Ur(ps),defaultValues:{title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}});o.useEffect(()=>{e&&(n?p.reset({title:n.title,parentTaskId:n.parentTaskId,deadline:n.dueDate??"",status:n.status,assignee:n.assignee??"",notes:n.notes??""}):p.reset({title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}))},[e,n]);const j=async x=>{l(!0);try{await a(x,i,n==null?void 0:n.id),t(!1)}catch(v){Pr.error("Erro ao salvar subtarefa: "+v.message),console.error("Erro ao salvar subtarefa:",v)}finally{l(!1)}};return r.jsx(Yr,{open:e,onOpenChange:t,children:r.jsxs(Vr,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[r.jsxs(Xr,{className:"mb-6",children:[r.jsx(Hr,{children:i?"Nova Subtarefa":"Editar Subtarefa"}),r.jsx(Wr,{children:i?"Preencha os dados e selecione a tarefa-mãe relacionada.":"Altere os campos e salve."})]}),r.jsx(Kr,{...p,children:r.jsxs("form",{onSubmit:p.handleSubmit(j),className:"space-y-5",children:[r.jsx(We,{control:p.control,name:"title",render:({field:x})=>r.jsxs(qe,{children:[r.jsx(Ge,{children:"Título *"}),r.jsx(Je,{children:r.jsx(At,{placeholder:"Ex: Enviar documento",...x})}),r.jsx(Ze,{})]})}),r.jsx(We,{control:p.control,name:"parentTaskId",render:({field:x})=>{var v;return r.jsxs(qe,{className:"flex flex-col",children:[r.jsx(Ge,{children:"Tarefa-mãe *"}),r.jsxs(Fn,{open:m,onOpenChange:h,children:[r.jsx(zn,{asChild:!0,children:r.jsx(Je,{children:r.jsxs(Xe,{variant:"outline",role:"combobox",className:q("w-full justify-between font-normal",!x.value&&"text-muted-foreground"),children:[r.jsx("span",{className:"truncate",children:x.value?((v=s.find(S=>S.id===x.value))==null?void 0:v.title)??"Tarefa não encontrada":"Selecione a tarefa-mãe..."}),r.jsx(fs,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),r.jsxs(_n,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:[r.jsxs("div",{className:"flex items-center border-b px-3",children:[r.jsx(cn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),r.jsx("input",{className:"flex h-10 w-full bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground",placeholder:"Buscar tarefa...",value:d,onChange:S=>f(S.target.value)})]}),r.jsx("div",{className:"max-h-[200px] overflow-y-auto p-1",children:b.length===0?r.jsx("p",{className:"py-4 text-center text-sm text-muted-foreground",children:"Nenhuma tarefa encontrada."}):b.map(S=>r.jsxs("button",{type:"button",className:q("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",x.value===S.id&&"bg-accent"),onClick:()=>{x.onChange(S.id),h(!1),f("")},children:[r.jsx(Qr,{className:q("mr-2 h-4 w-4",x.value===S.id?"opacity-100":"opacity-0")}),r.jsx("span",{className:"truncate",children:S.title})]},S.id))})]})]}),r.jsx(Ze,{})]})}}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(We,{control:p.control,name:"deadline",render:({field:x})=>r.jsxs(qe,{children:[r.jsx(Ge,{children:"Prazo"}),r.jsx(Je,{children:r.jsx(At,{type:"date",...x})}),r.jsx(Ze,{})]})}),r.jsx(We,{control:p.control,name:"status",render:({field:x})=>r.jsxs(qe,{children:[r.jsx(Ge,{children:"Status"}),r.jsxs(ve,{onValueChange:x.onChange,value:x.value,children:[r.jsx(Je,{children:r.jsx(be,{children:r.jsx(ye,{})})}),r.jsx(we,{children:xs.map(([v,S])=>r.jsx(F,{value:v,children:S},v))})]}),r.jsx(Ze,{})]})})]}),r.jsx(We,{control:p.control,name:"assignee",render:({field:x})=>r.jsxs(qe,{children:[r.jsx(Ge,{children:"Responsável"}),r.jsxs(ve,{onValueChange:v=>x.onChange(v==="_none_"?"":v),value:x.value||"_none_",children:[r.jsx(Je,{children:r.jsx(be,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(es,{className:"w-3.5 h-3.5 text-muted-foreground"}),r.jsx(ye,{placeholder:"Responsável..."})]})})}),r.jsxs(we,{children:[r.jsx(F,{value:"_none_",children:"— Sem responsável —"}),Bn.map(v=>r.jsx(F,{value:v,children:v},v))]})]}),r.jsx(Ze,{})]})}),r.jsx(We,{control:p.control,name:"notes",render:({field:x})=>r.jsxs(qe,{children:[r.jsx(Ge,{children:"Observações"}),r.jsx(Je,{children:r.jsx(_r,{value:x.value??"",onChange:x.onChange,placeholder:"Observações...",modalTitle:"Editar Observações da Subtarefa"})}),r.jsx(Ze,{})]})}),r.jsx(qr,{children:r.jsxs(Xe,{type:"submit",disabled:c,className:"w-full",children:[c&&r.jsx(ts,{className:"w-4 h-4 mr-2 animate-spin"}),i?"Criar Subtarefa":"Salvar Alterações"]})})]})})]})})}function bs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const zt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function et(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function dn(e){return"nodeType"in e}function me(e){var t,n;return e?et(e)?e:dn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function un(e){const{Document:t}=me(e);return e instanceof t}function xt(e){return et(e)?!1:e instanceof me(e).HTMLElement}function rr(e){return e instanceof me(e).SVGElement}function tt(e){return e?et(e)?e.document:dn(e)?un(e)?e:xt(e)||rr(e)?e.ownerDocument:document:document:document}const Ee=zt?o.useLayoutEffect:o.useEffect;function _t(e){const t=o.useRef(e);return Ee(()=>{t.current=e}),o.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function ys(){const e=o.useRef(null),t=o.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function gt(e,t){t===void 0&&(t=[e]);const n=o.useRef(e);return Ee(()=>{n.current!==e&&(n.current=e)},t),n}function vt(e,t){const n=o.useRef();return o.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Ot(e){const t=_t(e),n=o.useRef(null),s=o.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function It(e){const t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}let Jt={};function bt(e,t){return o.useMemo(()=>{if(t)return t;const n=Jt[e]==null?0:Jt[e]+1;return Jt[e]=n,e+"-"+n},[e,t])}function sr(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((i,c)=>{const l=Object.entries(c);for(const[d,f]of l){const m=i[d];m!=null&&(i[d]=m+e*f)}return i},{...t})}}const Qe=sr(1),Mt=sr(-1);function ws(e){return"clientX"in e&&"clientY"in e}function Bt(e){if(!e)return!1;const{KeyboardEvent:t}=me(e.target);return t&&e instanceof t}function js(e){if(!e)return!1;const{TouchEvent:t}=me(e.target);return t&&e instanceof t}function Lt(e){if(js(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return ws(e)?{x:e.clientX,y:e.clientY}:null}const Be=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Be.Translate.toString(e),Be.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),bn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ss(e){return e.matches(bn)?e:e.querySelector(bn)}const Cs={display:"none"};function Ns(e){let{id:t,value:n}=e;return Y.createElement("div",{id:t,style:Cs},n)}function Ds(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Y.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function Ts(){const[e,t]=o.useState("");return{announce:o.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const ar=o.createContext(null);function Es(e){const t=o.useContext(ar);o.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Rs(){const[e]=o.useState(()=>new Set),t=o.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[o.useCallback(s=>{let{type:a,event:i}=s;e.forEach(c=>{var l;return(l=c[a])==null?void 0:l.call(c,i)})},[e]),t]}const As={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ks={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Os(e){let{announcements:t=ks,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=As}=e;const{announce:i,announcement:c}=Ts(),l=bt("DndLiveRegion"),[d,f]=o.useState(!1);if(o.useEffect(()=>{f(!0)},[]),Es(o.useMemo(()=>({onDragStart(h){let{active:b}=h;i(t.onDragStart({active:b}))},onDragMove(h){let{active:b,over:p}=h;t.onDragMove&&i(t.onDragMove({active:b,over:p}))},onDragOver(h){let{active:b,over:p}=h;i(t.onDragOver({active:b,over:p}))},onDragEnd(h){let{active:b,over:p}=h;i(t.onDragEnd({active:b,over:p}))},onDragCancel(h){let{active:b,over:p}=h;i(t.onDragCancel({active:b,over:p}))}}),[i,t])),!d)return null;const m=Y.createElement(Y.Fragment,null,Y.createElement(Ns,{id:s,value:a.draggable}),Y.createElement(Ds,{id:l,announcement:c}));return n?it.createPortal(m,n):m}var Q;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Q||(Q={}));function Pt(){}function or(e,t){return o.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ir(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Re=Object.freeze({x:0,y:0});function Is(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Ms(e,t){const n=Lt(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function Ls(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Ps(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function yn(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function Fs(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const lr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=yn(t),i=[];for(const c of s){const{id:l}=c,d=n.get(l);if(d){const f=yn(d),m=a.reduce((b,p,j)=>b+Is(f[j],p),0),h=Number((m/4).toFixed(4));i.push({id:l,data:{droppableContainer:c,value:h}})}}return i.sort(Ls)};function zs(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),c=a-s,l=i-n;if(s<a&&n<i){const d=t.width*t.height,f=e.width*e.height,m=c*l,h=m/(d+f-m);return Number(h.toFixed(4))}return 0}const _s=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const i of s){const{id:c}=i,l=n.get(c);if(l){const d=zs(l,t);d>0&&a.push({id:c,data:{droppableContainer:i,value:d}})}}return a.sort(Ps)};function Bs(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function cr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Re}function $s(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return a.reduce((c,l)=>({...c,top:c.top+e*l.y,bottom:c.bottom+e*l.y,left:c.left+e*l.x,right:c.right+e*l.x}),{...n})}}const Ks=$s(1);function dr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Us(e,t,n){const s=dr(t);if(!s)return e;const{scaleX:a,scaleY:i,x:c,y:l}=s,d=e.left-c-(1-a)*parseFloat(n),f=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),m=a?e.width/a:e.width,h=i?e.height/i:e.height;return{width:m,height:h,top:f,right:d+m,bottom:f+h,left:d}}const Ys={ignoreTransform:!1};function nt(e,t){t===void 0&&(t=Ys);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:m}=me(e).getComputedStyle(e);f&&(n=Us(n,f,m))}const{top:s,left:a,width:i,height:c,bottom:l,right:d}=n;return{top:s,left:a,width:i,height:c,bottom:l,right:d}}function wn(e){return nt(e,{ignoreTransform:!0})}function Vs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Xs(e,t){return t===void 0&&(t=me(e).getComputedStyle(e)),t.position==="fixed"}function Hs(e,t){t===void 0&&(t=me(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?n.test(i):!1})}function fn(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(un(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!xt(a)||rr(a)||n.includes(a))return n;const i=me(e).getComputedStyle(a);return a!==e&&Hs(a,i)&&n.push(a),Xs(a,i)?n:s(a.parentNode)}return e?s(e):n}function ur(e){const[t]=fn(e,1);return t??null}function Zt(e){return!zt||!e?null:et(e)?e:dn(e)?un(e)||e===tt(e).scrollingElement?window:xt(e)?e:null:null}function fr(e){return et(e)?e.scrollX:e.scrollLeft}function hr(e){return et(e)?e.scrollY:e.scrollTop}function rn(e){return{x:fr(e),y:hr(e)}}var ae;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ae||(ae={}));function mr(e){return!zt||!e?!1:e===document.scrollingElement}function gr(e){const t={x:0,y:0},n=mr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,c=e.scrollTop>=s.y,l=e.scrollLeft>=s.x;return{isTop:a,isLeft:i,isBottom:c,isRight:l,maxScroll:s,minScroll:t}}const Ws={x:.2,y:.2};function qs(e,t,n,s,a){let{top:i,left:c,right:l,bottom:d}=n;s===void 0&&(s=10),a===void 0&&(a=Ws);const{isTop:f,isBottom:m,isLeft:h,isRight:b}=gr(e),p={x:0,y:0},j={x:0,y:0},x={height:t.height*a.y,width:t.width*a.x};return!f&&i<=t.top+x.height?(p.y=ae.Backward,j.y=s*Math.abs((t.top+x.height-i)/x.height)):!m&&d>=t.bottom-x.height&&(p.y=ae.Forward,j.y=s*Math.abs((t.bottom-x.height-d)/x.height)),!b&&l>=t.right-x.width?(p.x=ae.Forward,j.x=s*Math.abs((t.right-x.width-l)/x.width)):!h&&c<=t.left+x.width&&(p.x=ae.Backward,j.x=s*Math.abs((t.left+x.width-c)/x.width)),{direction:p,speed:j}}function Gs(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:c}=window;return{top:0,left:0,right:i,bottom:c,width:i,height:c}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function pr(e){return e.reduce((t,n)=>Qe(t,rn(n)),Re)}function Js(e){return e.reduce((t,n)=>t+fr(n),0)}function Zs(e){return e.reduce((t,n)=>t+hr(n),0)}function xr(e,t){if(t===void 0&&(t=nt),!e)return;const{top:n,left:s,bottom:a,right:i}=t(e);ur(e)&&(a<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Qs=[["x",["left","right"],Js],["y",["top","bottom"],Zs]];class hn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=fn(n),a=pr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,c,l]of Qs)for(const d of c)Object.defineProperty(this,d,{get:()=>{const f=l(s),m=a[i]-f;return this.rect[d]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ct{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function ea(e){const{EventTarget:t}=me(e);return e instanceof t?e:tt(e)}function Qt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var Ne;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ne||(Ne={}));function jn(e){e.preventDefault()}function ta(e){e.stopPropagation()}var M;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(M||(M={}));const vr={start:[M.Space,M.Enter],cancel:[M.Esc],end:[M.Space,M.Enter,M.Tab]},na=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case M.Right:return{...n,x:n.x+25};case M.Left:return{...n,x:n.x-25};case M.Down:return{...n,y:n.y+25};case M.Up:return{...n,y:n.y-25}}};class br{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new ct(tt(n)),this.windowListeners=new ct(me(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ne.Resize,this.handleCancel),this.windowListeners.add(Ne.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ne.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&xr(s),n(Re)}handleKeyDown(t){if(Bt(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:i=vr,coordinateGetter:c=na,scrollBehavior:l="smooth"}=a,{code:d}=t;if(i.end.includes(d)){this.handleEnd(t);return}if(i.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:f}=s.current,m=f?{x:f.left,y:f.top}:Re;this.referenceCoordinates||(this.referenceCoordinates=m);const h=c(t,{active:n,context:s.current,currentCoordinates:m});if(h){const b=Mt(h,m),p={x:0,y:0},{scrollableAncestors:j}=s.current;for(const x of j){const v=t.code,{isTop:S,isRight:N,isLeft:T,isBottom:D,maxScroll:A,minScroll:R}=gr(x),y=Gs(x),C={x:Math.min(v===M.Right?y.right-y.width/2:y.right,Math.max(v===M.Right?y.left:y.left+y.width/2,h.x)),y:Math.min(v===M.Down?y.bottom-y.height/2:y.bottom,Math.max(v===M.Down?y.top:y.top+y.height/2,h.y))},L=v===M.Right&&!N||v===M.Left&&!T,z=v===M.Down&&!D||v===M.Up&&!S;if(L&&C.x!==h.x){const O=x.scrollLeft+b.x,ee=v===M.Right&&O<=A.x||v===M.Left&&O>=R.x;if(ee&&!b.y){x.scrollTo({left:O,behavior:l});return}ee?p.x=x.scrollLeft-O:p.x=v===M.Right?x.scrollLeft-A.x:x.scrollLeft-R.x,p.x&&x.scrollBy({left:-p.x,behavior:l});break}else if(z&&C.y!==h.y){const O=x.scrollTop+b.y,ee=v===M.Down&&O<=A.y||v===M.Up&&O>=R.y;if(ee&&!b.x){x.scrollTo({top:O,behavior:l});return}ee?p.y=x.scrollTop-O:p.y=v===M.Down?x.scrollTop-A.y:x.scrollTop-R.y,p.y&&x.scrollBy({top:-p.y,behavior:l});break}}this.handleMove(t,Qe(Mt(h,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}br.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=vr,onActivation:a}=t,{active:i}=n;const{code:c}=e.nativeEvent;if(s.start.includes(c)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Sn(e){return!!(e&&"distance"in e)}function Cn(e){return!!(e&&"delay"in e)}class mn{constructor(t,n,s){var a;s===void 0&&(s=ea(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:c}=i;this.props=t,this.events=n,this.document=tt(c),this.documentListeners=new ct(this.document),this.listeners=new ct(s),this.windowListeners=new ct(me(c)),this.initialCoordinates=(a=Lt(i))!=null?a:Re,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ne.Resize,this.handleCancel),this.windowListeners.add(Ne.DragStart,jn),this.windowListeners.add(Ne.VisibilityChange,this.handleCancel),this.windowListeners.add(Ne.ContextMenu,jn),this.documentListeners.add(Ne.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Cn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Sn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ne.Click,ta,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ne.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:i}=this,{onMove:c,options:{activationConstraint:l}}=i;if(!a)return;const d=(n=Lt(t))!=null?n:Re,f=Mt(a,d);if(!s&&l){if(Sn(l)){if(l.tolerance!=null&&Qt(f,l.tolerance))return this.handleCancel();if(Qt(f,l.distance))return this.handleStart()}if(Cn(l)&&Qt(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}t.cancelable&&t.preventDefault(),c(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===M.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const ra={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class $t extends mn{constructor(t){const{event:n}=t,s=tt(n.target);super(t,ra,s)}}$t.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const sa={move:{name:"mousemove"},end:{name:"mouseup"}};var sn;(function(e){e[e.RightClick=2]="RightClick"})(sn||(sn={}));class aa extends mn{constructor(t){super(t,sa,tt(t.event.target))}}aa.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===sn.RightClick?!1:(s==null||s({event:n}),!0)}}];const en={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class oa extends mn{constructor(t){super(t,en)}static setup(){return window.addEventListener(en.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(en.move.name,t)};function t(){}}}oa.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var dt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(dt||(dt={}));var Ft;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ft||(Ft={}));function ia(e){let{acceleration:t,activator:n=dt.Pointer,canScroll:s,draggingRect:a,enabled:i,interval:c=5,order:l=Ft.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:m,delta:h,threshold:b}=e;const p=ca({delta:h,disabled:!i}),[j,x]=ys(),v=o.useRef({x:0,y:0}),S=o.useRef({x:0,y:0}),N=o.useMemo(()=>{switch(n){case dt.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case dt.DraggableRect:return a}},[n,a,d]),T=o.useRef(null),D=o.useCallback(()=>{const R=T.current;if(!R)return;const y=v.current.x*S.current.x,C=v.current.y*S.current.y;R.scrollBy(y,C)},[]),A=o.useMemo(()=>l===Ft.TreeOrder?[...f].reverse():f,[l,f]);o.useEffect(()=>{if(!i||!f.length||!N){x();return}for(const R of A){if((s==null?void 0:s(R))===!1)continue;const y=f.indexOf(R),C=m[y];if(!C)continue;const{direction:L,speed:z}=qs(R,C,N,t,b);for(const O of["x","y"])p[O][L[O]]||(z[O]=0,L[O]=0);if(z.x>0||z.y>0){x(),T.current=R,j(D,c),v.current=z,S.current=L;return}}v.current={x:0,y:0},S.current={x:0,y:0},x()},[t,D,s,x,i,c,JSON.stringify(N),JSON.stringify(p),j,f,A,m,JSON.stringify(b)])}const la={x:{[ae.Backward]:!1,[ae.Forward]:!1},y:{[ae.Backward]:!1,[ae.Forward]:!1}};function ca(e){let{delta:t,disabled:n}=e;const s=It(t);return vt(a=>{if(n||!s||!a)return la;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[ae.Backward]:a.x[ae.Backward]||i.x===-1,[ae.Forward]:a.x[ae.Forward]||i.x===1},y:{[ae.Backward]:a.y[ae.Backward]||i.y===-1,[ae.Forward]:a.y[ae.Forward]||i.y===1}}},[n,t,s])}function da(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return vt(a=>{var i;return t==null?null:(i=s??a)!=null?i:null},[s,t])}function ua(e,t){return o.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,i=a.activators.map(c=>({eventName:c.eventName,handler:t(c.handler,s)}));return[...n,...i]},[]),[e,t])}var pt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(pt||(pt={}));var an;(function(e){e.Optimized="optimized"})(an||(an={}));const Nn=new Map;function fa(e,t){let{dragging:n,dependencies:s,config:a}=t;const[i,c]=o.useState(null),{frequency:l,measure:d,strategy:f}=a,m=o.useRef(e),h=v(),b=gt(h),p=o.useCallback(function(S){S===void 0&&(S=[]),!b.current&&c(N=>N===null?S:N.concat(S.filter(T=>!N.includes(T))))},[b]),j=o.useRef(null),x=vt(S=>{if(h&&!n)return Nn;if(!S||S===Nn||m.current!==e||i!=null){const N=new Map;for(let T of e){if(!T)continue;if(i&&i.length>0&&!i.includes(T.id)&&T.rect.current){N.set(T.id,T.rect.current);continue}const D=T.node.current,A=D?new hn(d(D),D):null;T.rect.current=A,A&&N.set(T.id,A)}return N}return S},[e,i,n,h,d]);return o.useEffect(()=>{m.current=e},[e]),o.useEffect(()=>{h||p()},[n,h]),o.useEffect(()=>{i&&i.length>0&&c(null)},[JSON.stringify(i)]),o.useEffect(()=>{h||typeof l!="number"||j.current!==null||(j.current=setTimeout(()=>{p(),j.current=null},l))},[l,h,p,...s]),{droppableRects:x,measureDroppableContainers:p,measuringScheduled:i!=null};function v(){switch(f){case pt.Always:return!1;case pt.BeforeDragging:return n;default:return!n}}}function gn(e,t){return vt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function ha(e,t){return gn(e,t)}function ma(e){let{callback:t,disabled:n}=e;const s=_t(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Kt(e){let{callback:t,disabled:n}=e;const s=_t(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function ga(e){return new hn(nt(e),e)}function Dn(e,t,n){t===void 0&&(t=ga);const[s,a]=o.useState(null);function i(){a(d=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=d??n)!=null?f:null}const m=t(e);return JSON.stringify(d)===JSON.stringify(m)?d:m})}const c=ma({callback(d){if(e)for(const f of d){const{type:m,target:h}=f;if(m==="childList"&&h instanceof HTMLElement&&h.contains(e)){i();break}}}}),l=Kt({callback:i});return Ee(()=>{i(),e?(l==null||l.observe(e),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),c==null||c.disconnect())},[e]),s}function pa(e){const t=gn(e);return cr(e,t)}const Tn=[];function xa(e){const t=o.useRef(e),n=vt(s=>e?s&&s!==Tn&&e&&t.current&&e.parentNode===t.current.parentNode?s:fn(e):Tn,[e]);return o.useEffect(()=>{t.current=e},[e]),n}function va(e){const[t,n]=o.useState(null),s=o.useRef(e),a=o.useCallback(i=>{const c=Zt(i.target);c&&n(l=>l?(l.set(c,rn(c)),new Map(l)):null)},[]);return o.useEffect(()=>{const i=s.current;if(e!==i){c(i);const l=e.map(d=>{const f=Zt(d);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,rn(f)]):null}).filter(d=>d!=null);n(l.length?new Map(l):null),s.current=e}return()=>{c(e),c(i)};function c(l){l.forEach(d=>{const f=Zt(d);f==null||f.removeEventListener("scroll",a)})}},[a,e]),o.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,c)=>Qe(i,c),Re):pr(e):Re,[e,t])}function En(e,t){t===void 0&&(t=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},t),o.useEffect(()=>{const s=e!==Re;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Mt(e,n.current):Re}function ba(e){o.useEffect(()=>{if(!zt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function ya(e,t){return o.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:i}=s;return n[a]=c=>{i(c,t)},n},{}),[e,t])}function yr(e){return o.useMemo(()=>e?Vs(e):null,[e])}const Rn=[];function wa(e,t){t===void 0&&(t=nt);const[n]=e,s=yr(n?me(n):null),[a,i]=o.useState(Rn);function c(){i(()=>e.length?e.map(d=>mr(d)?s:new hn(t(d),d)):Rn)}const l=Kt({callback:c});return Ee(()=>{l==null||l.disconnect(),c(),e.forEach(d=>l==null?void 0:l.observe(d))},[e]),a}function wr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return xt(t)?t:e}function ja(e){let{measure:t}=e;const[n,s]=o.useState(null),a=o.useCallback(f=>{for(const{target:m}of f)if(xt(m)){s(h=>{const b=t(m);return h?{...h,width:b.width,height:b.height}:b});break}},[t]),i=Kt({callback:a}),c=o.useCallback(f=>{const m=wr(f);i==null||i.disconnect(),m&&(i==null||i.observe(m)),s(m?t(m):null)},[t,i]),[l,d]=Ot(c);return o.useMemo(()=>({nodeRef:l,rect:n,setRef:d}),[n,l,d])}const Sa=[{sensor:$t,options:{}},{sensor:br,options:{}}],Ca={current:{}},Rt={draggable:{measure:wn},droppable:{measure:wn,strategy:pt.WhileDragging,frequency:an.Optimized},dragOverlay:{measure:nt}};class ut extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Na={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ut,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Pt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Rt,measureDroppableContainers:Pt,windowRect:null,measuringScheduled:!1},jr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Pt,draggableNodes:new Map,over:null,measureDroppableContainers:Pt},yt=o.createContext(jr),Sr=o.createContext(Na);function Da(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ut}}}function Ta(e,t){switch(t.type){case Q.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Q.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Q.DragEnd:case Q.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Q.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new ut(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case Q.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const c=new ut(e.droppable.containers);return c.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:c}}}case Q.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const i=new ut(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Ea(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=o.useContext(yt),i=It(s),c=It(n==null?void 0:n.id);return o.useEffect(()=>{if(!t&&!s&&i&&c!=null){if(!Bt(i)||document.activeElement===i.target)return;const l=a.get(c);if(!l)return;const{activatorNode:d,node:f}=l;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const m of[d.current,f.current]){if(!m)continue;const h=Ss(m);if(h){h.focus();break}}})}},[s,t,a,c,i]),null}function Cr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...s}),n):n}function Ra(e){return o.useMemo(()=>({draggable:{...Rt.draggable,...e==null?void 0:e.draggable},droppable:{...Rt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Rt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Aa(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const i=o.useRef(!1),{x:c,y:l}=typeof a=="boolean"?{x:a,y:a}:a;Ee(()=>{if(!c&&!l||!t){i.current=!1;return}if(i.current||!s)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const m=n(f),h=cr(m,s);if(c||(h.x=0),l||(h.y=0),i.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const b=ur(f);b&&b.scrollBy({top:h.y,left:h.x})}},[t,c,l,s,n])}const Ut=o.createContext({...Re,scaleX:1,scaleY:1});var Ye;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ye||(Ye={}));const Nr=o.memo(function(t){var n,s,a,i;let{id:c,accessibility:l,autoScroll:d=!0,children:f,sensors:m=Sa,collisionDetection:h=_s,measuring:b,modifiers:p,...j}=t;const x=o.useReducer(Ta,void 0,Da),[v,S]=x,[N,T]=Rs(),[D,A]=o.useState(Ye.Uninitialized),R=D===Ye.Initialized,{draggable:{active:y,nodes:C,translate:L},droppable:{containers:z}}=v,O=y!=null?C.get(y):null,ee=o.useRef({initial:null,translated:null}),te=o.useMemo(()=>{var Z;return y!=null?{id:y,data:(Z=O==null?void 0:O.data)!=null?Z:Ca,rect:ee}:null},[y,O]),oe=o.useRef(null),[ue,Ie]=o.useState(null),[V,$e]=o.useState(null),ne=gt(j,Object.values(j)),Me=bt("DndDescribedBy",c),Ae=o.useMemo(()=>z.getEnabled(),[z]),P=Ra(b),{droppableRects:G,measureDroppableContainers:de,measuringScheduled:Se}=fa(Ae,{dragging:R,dependencies:[L.x,L.y],config:P.droppable}),J=da(C,y),Ke=o.useMemo(()=>V?Lt(V):null,[V]),fe=qt(),ie=ha(J,P.draggable.measure);Aa({activeNode:y!=null?C.get(y):null,config:fe.layoutShiftCompensation,initialRect:ie,measure:P.draggable.measure});const I=Dn(J,P.draggable.measure,ie),De=Dn(J?J.parentElement:null),ge=o.useRef({activatorEvent:null,active:null,activeNode:J,collisionRect:null,collisions:null,droppableRects:G,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:z,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ce=z.getNodeFor((n=ge.current.over)==null?void 0:n.id),pe=ja({measure:P.dragOverlay.measure}),xe=(s=pe.nodeRef.current)!=null?s:J,g=R?(a=pe.rect)!=null?a:I:null,k=!!(pe.nodeRef.current&&pe.rect),_=pa(k?null:I),X=yr(xe?me(xe):null),H=xa(R?Ce??J:null),$=wa(H),le=Cr(p,{transform:{x:L.x-_.x,y:L.y-_.y,scaleX:1,scaleY:1},activatorEvent:V,active:te,activeNodeRect:I,containerNodeRect:De,draggingNodeRect:g,over:ge.current.over,overlayNodeRect:pe.rect,scrollableAncestors:H,scrollableAncestorRects:$,windowRect:X}),Le=Ke?Qe(Ke,L):null,Pe=va(H),rt=En(Pe),Yt=En(Pe,[I]),Fe=Qe(le,rt),ze=g?Ks(g,le):null,Te=te&&ze?h({active:te,collisionRect:ze,droppableRects:G,droppableContainers:Ae,pointerCoordinates:Le}):null,Ve=Fs(Te,"id"),[ke,wt]=o.useState(null),Vt=k?le:Qe(le,Yt),jt=Bs(Vt,(i=ke==null?void 0:ke.rect)!=null?i:null,I),st=o.useRef(null),St=o.useCallback((Z,ce)=>{let{sensor:he,options:u}=ce;if(oe.current==null)return;const w=C.get(oe.current);if(!w)return;const E=Z.nativeEvent,B=new he({active:oe.current,activeNode:w,event:E,options:u,context:ge,onAbort(K){if(!C.get(K))return;const{onDragAbort:U}=ne.current,re={id:K};U==null||U(re),N({type:"onDragAbort",event:re})},onPending(K,je,U,re){if(!C.get(K))return;const{onDragPending:_e}=ne.current,Ue={id:K,constraint:je,initialCoordinates:U,offset:re};_e==null||_e(Ue),N({type:"onDragPending",event:Ue})},onStart(K){const je=oe.current;if(je==null)return;const U=C.get(je);if(!U)return;const{onDragStart:re}=ne.current,se={activatorEvent:E,active:{id:je,data:U.data,rect:ee}};it.unstable_batchedUpdates(()=>{re==null||re(se),A(Ye.Initializing),S({type:Q.DragStart,initialCoordinates:K,active:je}),N({type:"onDragStart",event:se}),Ie(st.current),$e(E)})},onMove(K){S({type:Q.DragMove,coordinates:K})},onEnd:W(Q.DragEnd),onCancel:W(Q.DragCancel)});st.current=B;function W(K){return async function(){const{active:U,collisions:re,over:se,scrollAdjustedTranslate:_e}=ge.current;let Ue=null;if(U&&_e){const{cancelDrop:at}=ne.current;Ue={activatorEvent:E,active:U,collisions:re,delta:_e,over:se},K===Q.DragEnd&&typeof at=="function"&&await Promise.resolve(at(Ue))&&(K=Q.DragCancel)}oe.current=null,it.unstable_batchedUpdates(()=>{S({type:K}),A(Ye.Uninitialized),wt(null),Ie(null),$e(null),st.current=null;const at=K===Q.DragEnd?"onDragEnd":"onDragCancel";if(Ue){const Gt=ne.current[at];Gt==null||Gt(Ue),N({type:at,event:Ue})}})}}},[C]),Xt=o.useCallback((Z,ce)=>(he,u)=>{const w=he.nativeEvent,E=C.get(u);if(oe.current!==null||!E||w.dndKit||w.defaultPrevented)return;const B={active:E};Z(he,ce.options,B)===!0&&(w.dndKit={capturedBy:ce.sensor},oe.current=u,St(he,ce))},[C,St]),Ct=ua(m,Xt);ba(m),Ee(()=>{I&&D===Ye.Initializing&&A(Ye.Initialized)},[I,D]),o.useEffect(()=>{const{onDragMove:Z}=ne.current,{active:ce,activatorEvent:he,collisions:u,over:w}=ge.current;if(!ce||!he)return;const E={active:ce,activatorEvent:he,collisions:u,delta:{x:Fe.x,y:Fe.y},over:w};it.unstable_batchedUpdates(()=>{Z==null||Z(E),N({type:"onDragMove",event:E})})},[Fe.x,Fe.y]),o.useEffect(()=>{const{active:Z,activatorEvent:ce,collisions:he,droppableContainers:u,scrollAdjustedTranslate:w}=ge.current;if(!Z||oe.current==null||!ce||!w)return;const{onDragOver:E}=ne.current,B=u.get(Ve),W=B&&B.rect.current?{id:B.id,rect:B.rect.current,data:B.data,disabled:B.disabled}:null,K={active:Z,activatorEvent:ce,collisions:he,delta:{x:w.x,y:w.y},over:W};it.unstable_batchedUpdates(()=>{wt(W),E==null||E(K),N({type:"onDragOver",event:K})})},[Ve]),Ee(()=>{ge.current={activatorEvent:V,active:te,activeNode:J,collisionRect:ze,collisions:Te,droppableRects:G,draggableNodes:C,draggingNode:xe,draggingNodeRect:g,droppableContainers:z,over:ke,scrollableAncestors:H,scrollAdjustedTranslate:Fe},ee.current={initial:g,translated:ze}},[te,J,Te,ze,C,xe,g,G,z,ke,H,Fe]),ia({...fe,delta:L,draggingRect:ze,pointerCoordinates:Le,scrollableAncestors:H,scrollableAncestorRects:$});const Ht=o.useMemo(()=>({active:te,activeNode:J,activeNodeRect:I,activatorEvent:V,collisions:Te,containerNodeRect:De,dragOverlay:pe,draggableNodes:C,droppableContainers:z,droppableRects:G,over:ke,measureDroppableContainers:de,scrollableAncestors:H,scrollableAncestorRects:$,measuringConfiguration:P,measuringScheduled:Se,windowRect:X}),[te,J,I,V,Te,De,pe,C,z,G,ke,de,H,$,P,Se,X]),Wt=o.useMemo(()=>({activatorEvent:V,activators:Ct,active:te,activeNodeRect:I,ariaDescribedById:{draggable:Me},dispatch:S,draggableNodes:C,over:ke,measureDroppableContainers:de}),[V,Ct,te,I,S,Me,C,ke,de]);return Y.createElement(ar.Provider,{value:T},Y.createElement(yt.Provider,{value:Wt},Y.createElement(Sr.Provider,{value:Ht},Y.createElement(Ut.Provider,{value:jt},f)),Y.createElement(Ea,{disabled:(l==null?void 0:l.restoreFocus)===!1})),Y.createElement(Os,{...l,hiddenTextDescribedById:Me}));function qt(){const Z=(ue==null?void 0:ue.autoScrollEnabled)===!1,ce=typeof d=="object"?d.enabled===!1:d===!1,he=R&&!Z&&!ce;return typeof d=="object"?{...d,enabled:he}:{enabled:he}}}),ka=o.createContext(null),An="button",Oa="Draggable";function Ia(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const i=bt(Oa),{activators:c,activatorEvent:l,active:d,activeNodeRect:f,ariaDescribedById:m,draggableNodes:h,over:b}=o.useContext(yt),{role:p=An,roleDescription:j="draggable",tabIndex:x=0}=a??{},v=(d==null?void 0:d.id)===t,S=o.useContext(v?Ut:ka),[N,T]=Ot(),[D,A]=Ot(),R=ya(c,t),y=gt(n);Ee(()=>(h.set(t,{id:t,key:i,node:N,activatorNode:D,data:y}),()=>{const L=h.get(t);L&&L.key===i&&h.delete(t)}),[h,t]);const C=o.useMemo(()=>({role:p,tabIndex:x,"aria-disabled":s,"aria-pressed":v&&p===An?!0:void 0,"aria-roledescription":j,"aria-describedby":m.draggable}),[s,p,x,v,j,m.draggable]);return{active:d,activatorEvent:l,activeNodeRect:f,attributes:C,isDragging:v,listeners:s?void 0:R,node:N,over:b,setNodeRef:T,setActivatorNodeRef:A,transform:S}}function Dr(){return o.useContext(Sr)}const Ma="Droppable",La={timeout:25};function pn(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const i=bt(Ma),{active:c,dispatch:l,over:d,measureDroppableContainers:f}=o.useContext(yt),m=o.useRef({disabled:n}),h=o.useRef(!1),b=o.useRef(null),p=o.useRef(null),{disabled:j,updateMeasurementsFor:x,timeout:v}={...La,...a},S=gt(x??s),N=o.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{f(Array.isArray(S.current)?S.current:[S.current]),p.current=null},v)},[v]),T=Kt({callback:N,disabled:j||!c}),D=o.useCallback((C,L)=>{T&&(L&&(T.unobserve(L),h.current=!1),C&&T.observe(C))},[T]),[A,R]=Ot(D),y=gt(t);return o.useEffect(()=>{!T||!A.current||(T.disconnect(),h.current=!1,T.observe(A.current))},[A,T]),o.useEffect(()=>(l({type:Q.RegisterDroppable,element:{id:s,key:i,disabled:n,node:A,rect:b,data:y}}),()=>l({type:Q.UnregisterDroppable,key:i,id:s})),[s]),o.useEffect(()=>{n!==m.current.disabled&&(l({type:Q.SetDroppableDisabled,id:s,key:i,disabled:n}),m.current.disabled=n)},[s,i,n,l]),{active:c,rect:b,isOver:(d==null?void 0:d.id)===s,node:A,over:d,setNodeRef:R}}function Pa(e){let{animation:t,children:n}=e;const[s,a]=o.useState(null),[i,c]=o.useState(null),l=It(n);return!n&&!s&&l&&a(l),Ee(()=>{if(!i)return;const d=s==null?void 0:s.key,f=s==null?void 0:s.props.id;if(d==null||f==null){a(null);return}Promise.resolve(t(f,i)).then(()=>{a(null)})},[t,s,i]),Y.createElement(Y.Fragment,null,n,s?o.cloneElement(s,{ref:c}):null)}const Fa={x:0,y:0,scaleX:1,scaleY:1};function za(e){let{children:t}=e;return Y.createElement(yt.Provider,{value:jr},Y.createElement(Ut.Provider,{value:Fa},t))}const _a={position:"fixed",touchAction:"none"},Ba=e=>Bt(e)?"transform 250ms ease":void 0,$a=o.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:i,className:c,rect:l,style:d,transform:f,transition:m=Ba}=e;if(!l)return null;const h=a?f:{...f,scaleX:1,scaleY:1},b={..._a,width:l.width,height:l.height,top:l.top,left:l.left,transform:Be.Transform.toString(h),transformOrigin:a&&s?Ms(s,l):void 0,transition:typeof m=="function"?m(s):m,...d};return Y.createElement(n,{className:c,style:b,ref:t},i)}),Ka=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:i,className:c}=e;if(i!=null&&i.active)for(const[l,d]of Object.entries(i.active))d!==void 0&&(a[l]=n.node.style.getPropertyValue(l),n.node.style.setProperty(l,d));if(i!=null&&i.dragOverlay)for(const[l,d]of Object.entries(i.dragOverlay))d!==void 0&&s.node.style.setProperty(l,d);return c!=null&&c.active&&n.node.classList.add(c.active),c!=null&&c.dragOverlay&&s.node.classList.add(c.dragOverlay),function(){for(const[d,f]of Object.entries(a))n.node.style.setProperty(d,f);c!=null&&c.active&&n.node.classList.remove(c.active)}},Ua=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Be.Transform.toString(t)},{transform:Be.Transform.toString(n)}]},Ya={duration:250,easing:"ease",keyframes:Ua,sideEffects:Ka({styles:{active:{opacity:"0"}}})};function Va(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return _t((i,c)=>{if(t===null)return;const l=n.get(i);if(!l)return;const d=l.node.current;if(!d)return;const f=wr(c);if(!f)return;const{transform:m}=me(c).getComputedStyle(c),h=dr(m);if(!h)return;const b=typeof t=="function"?t:Xa(t);return xr(d,a.draggable.measure),b({active:{id:i,data:l.data,node:d,rect:a.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:c,rect:a.dragOverlay.measure(f)},droppableContainers:s,measuringConfiguration:a,transform:h})})}function Xa(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...Ya,...e};return i=>{let{active:c,dragOverlay:l,transform:d,...f}=i;if(!t)return;const m={x:l.rect.left-c.rect.left,y:l.rect.top-c.rect.top},h={scaleX:d.scaleX!==1?c.rect.width*d.scaleX/l.rect.width:1,scaleY:d.scaleY!==1?c.rect.height*d.scaleY/l.rect.height:1},b={x:d.x-m.x,y:d.y-m.y,...h},p=a({...f,active:c,dragOverlay:l,transform:{initial:d,final:b}}),[j]=p,x=p[p.length-1];if(JSON.stringify(j)===JSON.stringify(x))return;const v=s==null?void 0:s({active:c,dragOverlay:l,...f}),S=l.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(N=>{S.onfinish=()=>{v==null||v(),N()}})}}let kn=0;function Ha(e){return o.useMemo(()=>{if(e!=null)return kn++,kn},[e])}const Tr=Y.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:i,modifiers:c,wrapperElement:l="div",className:d,zIndex:f=999}=e;const{activatorEvent:m,active:h,activeNodeRect:b,containerNodeRect:p,draggableNodes:j,droppableContainers:x,dragOverlay:v,over:S,measuringConfiguration:N,scrollableAncestors:T,scrollableAncestorRects:D,windowRect:A}=Dr(),R=o.useContext(Ut),y=Ha(h==null?void 0:h.id),C=Cr(c,{activatorEvent:m,active:h,activeNodeRect:b,containerNodeRect:p,draggingNodeRect:v.rect,over:S,overlayNodeRect:v.rect,scrollableAncestors:T,scrollableAncestorRects:D,transform:R,windowRect:A}),L=gn(b),z=Va({config:s,draggableNodes:j,droppableContainers:x,measuringConfiguration:N}),O=L?v.setRef:void 0;return Y.createElement(za,null,Y.createElement(Pa,{animation:z},h&&y?Y.createElement($a,{key:y,id:h.id,ref:O,as:l,activatorEvent:m,adjustScale:t,className:d,transition:i,rect:L,style:{zIndex:f,...a},transform:C},n):null))});function Er(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Wa(e,t){return e.reduce((n,s,a)=>{const i=t.get(s);return i&&(n[a]=i),n},Array(e.length))}function Nt(e){return e!==null&&e>=0}function qa(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ga(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Rr=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const i=Er(t,s,n),c=t[a],l=i[a];return!l||!c?null:{x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height}},Dt={scaleX:1,scaleY:1},Ar=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:i,overIndex:c}=e;const l=(t=i[n])!=null?t:s;if(!l)return null;if(a===n){const f=i[c];return f?{x:0,y:n<c?f.top+f.height-(l.top+l.height):f.top-l.top,...Dt}:null}const d=Ja(i,a,n);return a>n&&a<=c?{x:0,y:-l.height-d,...Dt}:a<n&&a>=c?{x:0,y:l.height+d,...Dt}:{x:0,y:0,...Dt}};function Ja(e,t,n){const s=e[t],a=e[t-1],i=e[t+1];return s?n<t?a?s.top-(a.top+a.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const kr="Sortable",Or=Y.createContext({activeIndex:-1,containerId:kr,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Rr,disabled:{draggable:!1,droppable:!1}});function Ir(e){let{children:t,id:n,items:s,strategy:a=Rr,disabled:i=!1}=e;const{active:c,dragOverlay:l,droppableRects:d,over:f,measureDroppableContainers:m}=Dr(),h=bt(kr,n),b=l.rect!==null,p=o.useMemo(()=>s.map(R=>typeof R=="object"&&"id"in R?R.id:R),[s]),j=c!=null,x=c?p.indexOf(c.id):-1,v=f?p.indexOf(f.id):-1,S=o.useRef(p),N=!qa(p,S.current),T=v!==-1&&x===-1||N,D=Ga(i);Ee(()=>{N&&j&&m(p)},[N,p,j,m]),o.useEffect(()=>{S.current=p},[p]);const A=o.useMemo(()=>({activeIndex:x,containerId:h,disabled:D,disableTransforms:T,items:p,overIndex:v,useDragOverlay:b,sortedRects:Wa(p,d),strategy:a}),[x,h,D.draggable,D.droppable,T,p,v,d,b,a]);return Y.createElement(Or.Provider,{value:A},t)}const Za=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return Er(n,s,a).indexOf(t)},Qa=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:i,newIndex:c,previousItems:l,previousContainerId:d,transition:f}=e;return!f||!s||l!==i&&a===c?!1:n?!0:c!==a&&t===d},eo={duration:200,easing:"ease"},Mr="transform",to=Be.Transition.toString({property:Mr,duration:0,easing:"linear"}),no={roleDescription:"sortable"};function ro(e){let{disabled:t,index:n,node:s,rect:a}=e;const[i,c]=o.useState(null),l=o.useRef(n);return Ee(()=>{if(!t&&n!==l.current&&s.current){const d=a.current;if(d){const f=nt(s.current,{ignoreTransform:!0}),m={x:d.left-f.left,y:d.top-f.top,scaleX:d.width/f.width,scaleY:d.height/f.height};(m.x||m.y)&&c(m)}}n!==l.current&&(l.current=n)},[t,n,s,a]),o.useEffect(()=>{i&&c(null)},[i]),i}function Lr(e){let{animateLayoutChanges:t=Qa,attributes:n,disabled:s,data:a,getNewIndex:i=Za,id:c,strategy:l,resizeObserverConfig:d,transition:f=eo}=e;const{items:m,containerId:h,activeIndex:b,disabled:p,disableTransforms:j,sortedRects:x,overIndex:v,useDragOverlay:S,strategy:N}=o.useContext(Or),T=so(s,p),D=m.indexOf(c),A=o.useMemo(()=>({sortable:{containerId:h,index:D,items:m},...a}),[h,a,D,m]),R=o.useMemo(()=>m.slice(m.indexOf(c)),[m,c]),{rect:y,node:C,isOver:L,setNodeRef:z}=pn({id:c,data:A,disabled:T.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...d}}),{active:O,activatorEvent:ee,activeNodeRect:te,attributes:oe,setNodeRef:ue,listeners:Ie,isDragging:V,over:$e,setActivatorNodeRef:ne,transform:Me}=Ia({id:c,data:A,attributes:{...no,...n},disabled:T.draggable}),Ae=bs(z,ue),P=!!O,G=P&&!j&&Nt(b)&&Nt(v),de=!S&&V,Se=de&&G?Me:null,Ke=G?Se??(l??N)({rects:x,activeNodeRect:te,activeIndex:b,overIndex:v,index:D}):null,fe=Nt(b)&&Nt(v)?i({id:c,items:m,activeIndex:b,overIndex:v}):D,ie=O==null?void 0:O.id,I=o.useRef({activeId:ie,items:m,newIndex:fe,containerId:h}),De=m!==I.current.items,ge=t({active:O,containerId:h,isDragging:V,isSorting:P,id:c,index:D,items:m,newIndex:I.current.newIndex,previousItems:I.current.items,previousContainerId:I.current.containerId,transition:f,wasDragging:I.current.activeId!=null}),Ce=ro({disabled:!ge,index:D,node:C,rect:y});return o.useEffect(()=>{P&&I.current.newIndex!==fe&&(I.current.newIndex=fe),h!==I.current.containerId&&(I.current.containerId=h),m!==I.current.items&&(I.current.items=m)},[P,fe,h,m]),o.useEffect(()=>{if(ie===I.current.activeId)return;if(ie!=null&&I.current.activeId==null){I.current.activeId=ie;return}const xe=setTimeout(()=>{I.current.activeId=ie},50);return()=>clearTimeout(xe)},[ie]),{active:O,activeIndex:b,attributes:oe,data:A,rect:y,index:D,newIndex:fe,items:m,isOver:L,isSorting:P,isDragging:V,listeners:Ie,node:C,overIndex:v,over:$e,setNodeRef:Ae,setActivatorNodeRef:ne,setDroppableNodeRef:z,setDraggableNodeRef:ue,transform:Ce??Ke,transition:pe()};function pe(){if(Ce||De&&I.current.newIndex===D)return to;if(!(de&&!Bt(ee)||!f)&&(P||ge))return Be.Transition.toString({...f,property:Mr})}}function so(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}M.Down,M.Right,M.Up,M.Left;const ao=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"title",label:"Título (A → Z)"},{value:"status",label:"Status"}],On={"A fazer":0,"Em andamento":1,Concluído:2},Tt=["A fazer","Em andamento","Concluído"],oo={"A fazer":"border-t-red-500/60","Em andamento":"border-t-yellow-500/60",Concluído:"border-t-green-500/60"};function io(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"title":return n.title.localeCompare(s.title,"pt-BR");case"status":return(On[n.status]??0)-(On[s.status]??0);default:return 0}})}function lo({id:e,children:t}){const{attributes:n,listeners:s,setNodeRef:a,transform:i,transition:c,isDragging:l}=Lr({id:e}),d={transform:Be.Transform.toString(i),transition:c};return r.jsx("div",{ref:a,style:d,...n,...s,className:q("touch-none",l&&"opacity-30"),children:t})}function co({status:e,isOver:t,items:n,itemIds:s,today:a,onEdit:i,onDelete:c,showRichNotes:l}){const{setNodeRef:d}=pn({id:e});return r.jsxs("div",{className:q("flex flex-col rounded-xl border border-border border-t-4 bg-card/40 min-h-[400px] transition-colors",oo[e]||"border-t-muted/60",t&&"bg-card/80 ring-2 ring-primary/20"),children:[r.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border shadow-sm bg-background/50 backdrop-blur-md rounded-t-xl",children:[r.jsx(Oe,{variant:"secondary",className:tn[e],children:ft[e]}),r.jsx(Oe,{variant:"secondary",className:"ml-auto text-xs bg-secondary/50",children:n.length})]}),r.jsxs("div",{ref:d,"data-column-status":e,className:"flex-1 p-3 space-y-3",children:[r.jsx(Ir,{items:s,strategy:Ar,children:n.map(f=>r.jsx(lo,{id:f.id,children:r.jsx(on,{sub:f,today:a,onEdit:()=>i(f),onDelete:()=>c(f.id),showRichNotes:l})},f.id))}),n.length===0&&r.jsxs("div",{className:"sticky top-[40vh] flex flex-col items-center justify-center text-xs text-muted-foreground/50 border-2 border-dashed border-border/50 rounded-xl p-4 text-center gap-1",children:[r.jsx(Oe,{variant:"secondary",className:q("font-medium mb-1",tn[e]),children:ft[e]}),r.jsx("span",{children:"Arraste subtarefas para cá"})]})]})]})}const on=o.memo(function({sub:t,today:n,showStatus:s,onEdit:a,onDelete:i,showRichNotes:c}){const l=t.dueDate&&t.dueDate<n&&t.status!=="Concluído";return r.jsx(ht,{className:q("transition-shadow duration-150",l&&"border-destructive/50"),children:r.jsx(mt,{className:"p-3",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[s&&r.jsx(Oe,{variant:"secondary",className:q("text-[10px]",tn[t.status]),children:ft[t.status]}),l&&r.jsx(Oe,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),r.jsx("p",{className:q("font-medium text-sm",t.completed&&"line-through text-muted-foreground"),children:t.title}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[r.jsx("span",{className:"font-medium",children:"Tarefa:"})," ",t.parentTaskTitle]}),r.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[t.projectName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Jn,{className:"w-3 h-3"}),t.projectName]}),t.assignee&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Zn,{className:"w-3 h-3"}),t.assignee]}),t.dueDate&&r.jsxs("span",{className:q("flex items-center gap-1",l&&"text-destructive font-medium"),children:[r.jsx(Qn,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]}),t.notes&&c&&r.jsx("div",{className:"text-xs text-muted-foreground mt-1 prose prose-xs max-w-none [&>*]:m-0 [&>*]:text-xs line-clamp-4",dangerouslySetInnerHTML:{__html:Pn(t.notes)||t.notes}}),t.notes&&!c&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.notes.replace(/<[^>]*>/g,"")})]}),r.jsxs("div",{className:"flex gap-1 shrink-0",children:[r.jsx(Xe,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:a,children:r.jsx(Gr,{className:"w-3.5 h-3.5"})}),r.jsx(Xe,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:i,children:r.jsx(ss,{className:"w-3.5 h-3.5"})})]})]})})})});function uo({tasks:e,projects:t,loading:n,onCreateSubtask:s,onUpdateSubtask:a,onDeleteSubtask:i}){const[c,l]=o.useState(!1),[d,f]=o.useState(null),[m,h]=o.useState("kanban"),[b,p]=o.useState(""),[j,x]=o.useState("all"),[v,S]=o.useState("all"),[N,T]=o.useState("all"),[D,A]=o.useState("all"),[R,y]=o.useState("all"),[C,L]=o.useState("deadline"),[z,O]=o.useState(!1),[ee,te]=o.useState(!1),[oe,ue]=o.useState(null),[Ie,V]=o.useState(null),[$e,ne]=o.useState(null),Me=ir(or($t,{activationConstraint:{distance:8}})),Ae=o.useMemo(()=>{const g={};return t.forEach(k=>{g[k.id]=k.name}),g},[t]),P=o.useMemo(()=>e.flatMap(g=>g.subtasks.map(k=>({...k,parentTaskTitle:g.title,projectId:g.projectId,projectName:g.projectId?Ae[g.projectId]:void 0}))),[e,Ae]),G=o.useMemo(()=>{const g=new Date,k=new Date(g.getFullYear(),g.getMonth(),g.getDate()),_=new Date(k);_.setDate(k.getDate()+(7-k.getDay()));const X=new Date(g.getFullYear(),g.getMonth()+1,0),H=P.filter($=>{if(b&&!$.title.toLowerCase().includes(b.toLowerCase())||j!=="all"&&$.status!==j||v!=="all"&&$.assignee!==v||N!=="all"&&$.projectId!==N||D!=="all"&&$.parentTaskId!==D)return!1;if(R!=="all"){if(!$.dueDate)return R==="sem_prazo";const le=new Date($.dueDate+"T23:59:59");switch(R){case"atrasadas":return le<k&&$.status!=="Concluído";case"hoje":return $.dueDate===de;case"esta_semana":return le>=k&&le<=_;case"este_mes":return le>=k&&le<=X;case"sem_prazo":return!1}}return!0});return io(H,C)},[P,b,j,v,N,D,C]),de=o.useMemo(()=>{const g=new Date;return`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}`},[]);o.useMemo(()=>{const g={"A fazer":0,"Em andamento":0,Concluído:0},k=P.filter(_=>_.dueDate&&_.dueDate<de&&_.status!=="Concluído").length;return P.forEach(_=>{g[_.status]!==void 0&&g[_.status]++}),{...g,overdue:k,total:P.length}},[P,de]);const Se=o.useCallback(()=>{f(null),l(!0)},[]),J=o.useCallback(g=>{f(g),l(!0)},[]),Ke=o.useCallback(async(g,k,_)=>{k?await s(g.parentTaskId,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0}):_&&await a(_,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0})},[s,a]),fe=o.useCallback(async()=>{oe&&(await i(oe),ue(null))},[oe,i]),ie=o.useMemo(()=>{const g={"A fazer":[],"Em andamento":[],Concluído:[]};return G.forEach(k=>{g[k.status]&&g[k.status].push(k)}),g},[G]),I=o.useCallback(g=>{V(String(g.active.id))},[]),De=o.useCallback(g=>{const{over:k}=g;if(!k){ne(null);return}const _=String(k.id),X=P.find($=>$.id===_),H=X?X.status:Tt.includes(_)?_:null;ne(H)},[P]),ge=o.useCallback(async g=>{const{active:k,over:_}=g;if(V(null),ne(null),!_)return;const X=String(k.id),H=String(_.id);if(X===H)return;const $=P.find(Pe=>Pe.id===X);if(!$)return;const le=P.find(Pe=>Pe.id===H),Le=le?le.status:Tt.includes(H)?H:$.status;$.status!==Le&&await a(X,{status:Le})},[P,a]),Ce=o.useCallback(()=>{V(null),ne(null)},[]),pe=Ie?P.find(g=>g.id===Ie):null,xe=o.useMemo(()=>Tt.filter(g=>!z||g!=="Concluído"),[z]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3 glass p-4 rounded-xl border border-border shadow-sm mb-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(cn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(At,{placeholder:"Buscar subtarefa...",value:b,onChange:g=>p(g.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[r.jsxs(Xe,{onClick:Se,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity h-9",children:[r.jsx(qn,{className:"mr-1.5 h-4 w-4"})," Nova Subtarefa"]}),r.jsxs("div",{className:"flex border border-border rounded-lg overflow-hidden bg-muted/40",children:[r.jsxs("button",{onClick:()=>h("kanban"),className:q("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",m==="kanban"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(tr,{className:"w-4 h-4"})," Kanban"]}),r.jsxs("button",{onClick:()=>h("list"),className:q("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",m==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(Gn,{className:"w-4 h-4"})," Lista"]})]})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap flex-1",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Status"}),r.jsxs(ve,{value:j,onValueChange:x,children:[r.jsx(be,{className:"w-[130px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos Status"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todos Status"}),Tt.map(g=>r.jsx(F,{value:g,children:ft[g]},g))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prazo"}),r.jsxs(ve,{value:R,onValueChange:y,children:[r.jsx(be,{className:"w-[120px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todos"}),r.jsx(F,{value:"atrasadas",children:"Atrasadas"}),r.jsx(F,{value:"hoje",children:"Vence hoje"}),r.jsx(F,{value:"esta_semana",children:"Esta semana"}),r.jsx(F,{value:"este_mes",children:"Este mês"}),r.jsx(F,{value:"sem_prazo",children:"Sem prazo"})]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Responsável"}),r.jsxs(ve,{value:v,onValueChange:S,children:[r.jsx(be,{className:"w-[120px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todos"}),Bn.map(g=>r.jsx(F,{value:g,children:g},g))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Tarefa-mãe"}),r.jsxs(ve,{value:D,onValueChange:A,children:[r.jsx(be,{className:"w-[160px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todas"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todas"}),e.map(g=>r.jsx(F,{value:g.id,children:g.title},g.id))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Ordenar por"}),r.jsxs(ve,{value:C,onValueChange:g=>L(g),children:[r.jsx(be,{className:"w-[160px] h-8 text-xs",children:r.jsx(ye,{})}),r.jsx(we,{children:ao.map(g=>r.jsx(F,{value:g.value,children:g.label},g.value))})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1.5 ml-auto shrink-0",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar concluídas",r.jsx(lt,{checked:z,onCheckedChange:O,className:"scale-75"})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Observações formatadas",r.jsx(lt,{checked:ee,onCheckedChange:te,className:"scale-75"})]})]})]})]}),r.jsx(vs,{open:c,onOpenChange:l,subtask:d,tasks:e,onSave:Ke}),r.jsx($n,{open:!!oe,onOpenChange:g=>!g&&ue(null),children:r.jsxs(Kn,{children:[r.jsxs(Un,{children:[r.jsx(Yn,{children:"Remover subtarefa?"}),r.jsx(Vn,{children:"Esta ação não pode ser desfeita. A subtarefa será removida permanentemente."})]}),r.jsxs(Xn,{children:[r.jsx(Hn,{children:"Cancelar"}),r.jsx(Wn,{onClick:fe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?r.jsx("div",{className:"space-y-3",children:[1,2,3].map(g=>r.jsx(ht,{children:r.jsx(mt,{className:"p-4",children:r.jsx("div",{className:"h-16 bg-muted animate-pulse rounded"})})},g))}):m==="list"?r.jsx("div",{className:"space-y-3",children:G.length===0?r.jsx(ht,{children:r.jsx(mt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma subtarefa encontrada."})}):G.map(g=>r.jsx(on,{sub:g,today:de,showStatus:!0,onEdit:()=>J(g),onDelete:()=>ue(g.id),showRichNotes:ee},g.id))}):r.jsxs(Nr,{sensors:Me,collisionDetection:lr,onDragStart:I,onDragOver:De,onDragEnd:ge,onDragCancel:Ce,children:[r.jsx("div",{className:"overflow-x-auto -mx-2 px-2 pb-4",children:r.jsx("div",{className:"flex gap-4",style:{minWidth:`${xe.length*300}px`},children:xe.map(g=>{const k=$e===g,_=ie[g],X=_.map(H=>H.id);return r.jsx("div",{className:"flex-1 min-w-[260px]",children:r.jsx(co,{status:g,isOver:k,items:_,itemIds:X,today:de,onEdit:J,onDelete:ue,showRichNotes:ee})},g)})})}),r.jsx(Tr,{children:pe&&r.jsx("div",{className:"shadow-xl ring-2 ring-primary/30 rotate-[2deg] scale-105",children:r.jsx(on,{sub:pe,today:de,showStatus:!0,onEdit:()=>{},onDelete:()=>{},showRichNotes:ee})})})]})]})}const fo=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"priority",label:"Prioridade (Alta → Baixa)"},{value:"title",label:"Título (A → Z)"},{value:"client",label:"Cliente (A → Z)"}],In={alta:0,media:1,baixa:2};function Mn(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"priority":return(In[n.priority]??1)-(In[s.priority]??1);case"title":return n.title.localeCompare(s.title,"pt-BR");case"client":return(n.client??"").localeCompare(s.client??"","pt-BR");default:return 0}})}const ho={client:!0,dueDate:!0,priority:!0,subtasks:!0,tags:!0,description:!0,richDescription:!1},Ln={client:"Cliente",dueDate:"Data de entrega",priority:"Prioridade",subtasks:"Subtarefas",tags:"Tags",description:"Descrição",richDescription:"Observação formatada"},Et=["pendente","agendado","em_andamento","em_tramite","concluida","cancelada"],mo={pendente:"border-t-red-500/60",agendado:"border-t-blue-500/60",em_andamento:"border-t-yellow-500/60",em_tramite:"border-t-orange-500/60",concluida:"border-t-green-500/60",cancelada:"border-t-muted/60"},go={pendente:er,agendado:cs,em_andamento:vn,em_tramite:vn,concluida:ds,cancelada:us},po=[{value:"all",label:"Todos"},{value:"today",label:"Hoje"},{value:"this_week",label:"Esta semana"},{value:"this_month",label:"Este mês"},{value:"overdue",label:"Atrasadas"},{value:"no_deadline",label:"Sem prazo"}],ln=o.memo(function({task:t,cardFields:n,today:s,isExpanded:a,onToggleExpand:i,onToggleSubtask:c,onEdit:l,onDelete:d,showStatus:f,isDragging:m,isOverlay:h,projectName:b}){const p=t.subtasks.filter(v=>v.completed).length,j=t.subtasks.length,x=t.dueDate&&t.dueDate<s&&t.status!=="concluida"&&t.status!=="cancelada";return r.jsx(ht,{className:q("relative group transition-all duration-200 hover:shadow-md cursor-pointer",m?"opacity-40 scale-95":"",h&&"shadow-2xl ring-2 ring-primary/40 rotate-[2deg] scale-105 cursor-grabbing","border-border/50 bg-card"),onClick:()=>l==null?void 0:l(t),children:r.jsxs(mt,{className:"p-3.5",children:[b&&r.jsx("div",{className:"mb-2",children:r.jsxs(Oe,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1 font-normal",children:[r.jsx(Jn,{className:"w-3 h-3"}),b]})}),r.jsx("p",{className:"font-medium text-sm mb-1",children:t.title}),n.description&&t.description&&!n.richDescription&&r.jsx("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-2",children:t.description.replace(/<[^>]*>/g,"")}),n.richDescription&&t.description&&r.jsx("div",{className:"text-xs text-muted-foreground mb-2 prose prose-xs max-w-none [&>*]:m-0 [&>*]:text-xs line-clamp-4",dangerouslySetInnerHTML:{__html:Pn(t.description)||t.description}}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[n.priority&&r.jsx(Oe,{variant:"secondary",className:`text-[10px] ${Jr[t.priority]}`,children:nn[t.priority]}),f&&r.jsx(Oe,{variant:"secondary",className:`text-[10px] ${Zr[t.status]}`,children:kt[t.status]}),n.dueDate&&t.dueDate&&r.jsxs("span",{className:q("flex items-center gap-1",x&&"text-destructive font-medium"),children:[x?r.jsx(er,{className:"w-3 h-3"}):r.jsx(Qn,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]}),x&&r.jsx("span",{className:"text-destructive font-medium",children:"Atrasada"}),t.assignee&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Zn,{className:"w-3 h-3"}),t.assignee]})]}),n.subtasks&&j>0&&!h&&r.jsx("div",{className:"flex justify-end mt-2",children:r.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:[r.jsx(nr,{className:"w-3 h-3"}),p,"/",j]})}),n.tags&&t.tags&&t.tags.length>0&&!h&&r.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.map(v=>r.jsx(Oe,{variant:"outline",className:"text-[10px]",children:v},v))})]})})});function xo(e){const{attributes:t,listeners:n,setNodeRef:s,transform:a,transition:i,isDragging:c}=Lr({id:e.task.id}),l={transform:Be.Transform.toString(a),transition:i};return r.jsx("div",{ref:s,style:l,...t,...n,children:r.jsx(ln,{...e,isDragging:c})})}function vo({status:e,tasks:t,isOver:n,cardFields:s,today:a,expandedTasks:i,onToggleExpand:c,onToggleSubtask:l,onEdit:d,onDelete:f,projectMap:m}){const h=o.useMemo(()=>t.map(j=>j.id),[t]),{setNodeRef:b}=pn({id:e}),p=go[e];return r.jsxs("div",{className:q("flex flex-col rounded-xl border border-border border-t-4 bg-card/40 min-h-[400px] transition-colors",mo[e]||"border-t-muted/60",n&&"bg-card/80 ring-2 ring-primary/20"),children:[r.jsxs("div",{className:"flex items-center gap-2 p-3 px-4",children:[r.jsx(p,{className:q("w-4 h-4",{"text-red-500":e==="pendente","text-blue-500":e==="agendado","text-yellow-500":e==="em_andamento","text-orange-500":e==="em_tramite","text-green-500":e==="concluida","text-muted-foreground":e==="cancelada"})}),r.jsx("span",{className:"text-sm font-medium",children:kt[e]}),r.jsx(Oe,{variant:"secondary",className:"ml-auto text-xs bg-secondary/50 tabular-nums",children:t.length})]}),r.jsxs("div",{ref:b,"data-column-status":e,className:"flex-1 p-3 pt-0 space-y-3",children:[r.jsx(Ir,{items:h,strategy:Ar,children:t.map(j=>r.jsx(xo,{task:j,cardFields:s,today:a,isExpanded:i.has(j.id),onToggleExpand:c,onToggleSubtask:l,onEdit:d,onDelete:f,projectName:m.get(j.projectId||"")},j.id))}),t.length===0&&r.jsx("div",{className:"flex flex-col items-center justify-center text-xs text-muted-foreground/50 border-2 border-dashed border-border/50 rounded-xl p-4 text-center gap-1 min-h-[100px]",children:r.jsx("span",{children:"Arraste tarefas para cá"})})]})]})}function bo({projectId:e,clientNameFilter:t,hideHeader:n,forceTab:s}={}){const{tasks:a,setTasks:i,loading:c,syncing:l,error:d,lastSync:f,sync:m,updateTaskStatus:h,deleteTask:b,createTask:p,updateTask:j,createSubtask:x,updateSubtask:v,deleteSubtask:S}=Fr(),{projects:N}=zr(),[T,D]=o.useState(!1),[A,R]=o.useState(null),[y,C]=o.useState([]),[L,z]=o.useState("kanban"),[O,ee]=o.useState(""),[te,oe]=o.useState("all"),[ue,Ie]=o.useState("all"),[V,$e]=o.useState("all"),[ne,Me]=o.useState(e||"all"),[Ae,P]=o.useState(new Set),[G,de]=o.useState(ho),[Se,J]=o.useState(null),[Ke,fe]=o.useState(null),[ie,I]=o.useState("deadline"),[De,ge]=o.useState(!1),[Ce,pe]=o.useState(!1),[xe,g]=o.useState("all"),[k,_]=o.useState("all");o.useEffect(()=>{a.length>0&&C(t?a.filter(u=>{var w;return(w=u.client)==null?void 0:w.toLowerCase().includes(t.toLowerCase())}):a)},[a,t]);const X=o.useMemo(()=>{const u=new Date;return`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")}`},[]),H=o.useMemo(()=>[...new Set(y.map(u=>u.assignee).filter(Boolean))],[y]),$=o.useMemo(()=>{const u=e||ne,w=new Date,E=new Date(w);E.setDate(w.getDate()+7);const B=new Date(w.getFullYear(),w.getMonth()+1,0),W=`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(E.getDate()).padStart(2,"0")}`,K=`${B.getFullYear()}-${String(B.getMonth()+1).padStart(2,"0")}-${String(B.getDate()).padStart(2,"0")}`,je=y.filter(U=>{var re;if(O&&!U.title.toLowerCase().includes(O.toLowerCase())||te!=="all"&&U.status!==te||ue!=="all"&&U.priority!==ue||V!=="all"&&U.client!==V||k!=="all"&&U.assignee!==k||u!=="all"&&U.projectId!==u)return!1;if(xe!=="all"){const se=(re=U.dueDate)==null?void 0:re.split("T")[0];switch(xe){case"today":if(se!==X)return!1;break;case"this_week":if(!se||se<X||se>W)return!1;break;case"this_month":if(!se||se<X||se>K)return!1;break;case"overdue":if(!se||se>=X||U.status==="concluida"||U.status==="cancelada")return!1;break;case"no_deadline":if(se)return!1;break}}return!0});return Mn(je,ie)},[y,O,te,ue,V,k,ne,ie,xe,X]),le=X,Le=o.useMemo(()=>Se?y.find(u=>u.id===Se):null,[Se,y]),Pe=o.useMemo(()=>[...new Set(y.map(u=>u.client).filter(Boolean))],[y]),rt=o.useMemo(()=>{const u=new Map;return N.forEach(w=>u.set(w.id,w.name)),u},[N]),Yt=o.useMemo(()=>y.reduce((u,w)=>u+w.subtasks.length,0),[y]),Fe=o.useCallback(u=>{P(w=>{const E=new Set(w);return E.has(u)?E.delete(u):E.add(u),E})},[]),ze=o.useCallback((u,w)=>{C(E=>E.map(B=>B.id===u?{...B,subtasks:B.subtasks.map(W=>W.id===w?{...W,completed:!W.completed}:W)}:B))},[]),[Te,Ve]=o.useState(null),ke=o.useCallback(async()=>{Te&&(b(Te),C(u=>u.filter(w=>w.id!==Te)),Ve(null))},[Te,b]),wt=o.useCallback(u=>{de(w=>({...w,[u]:!w[u]}))},[]),Vt=o.useCallback(()=>{R(null),D(!0)},[]),jt=o.useCallback(u=>{R(u),D(!0)},[]),st=o.useCallback(async(u,w,E)=>{w?await p({title:u.title,deadline:u.deadline,priority:u.priority,status:u.status,clientName:u.clientName,projectId:u.projectId,assignee:u.assignee,description:u.description}):E&&await j(E,{title:u.title,deadline:u.deadline,priority:u.priority,status:u.status,clientName:u.clientName,projectId:u.projectId,assignee:u.assignee,description:u.description})},[p,j]),St=ir(or($t,{activationConstraint:{distance:8}}));o.useCallback(u=>{const w=y.find(E=>E.id===u);return w==null?void 0:w.status},[y]);const Xt=o.useCallback(u=>{J(u.active.id)},[]),Ct=o.useCallback(u=>{const{over:w}=u;if(!w){fe(null);return}const E=w.id,B=y.find(K=>K.id===E),W=B?B.status:Et.includes(E)?E:null;fe(W)},[y]),Ht=o.useCallback(u=>{const{active:w,over:E}=u;if(J(null),fe(null),!E)return;const B=w.id,W=E.id;if(B===W)return;const K=y.find(re=>re.id===B);if(!K)return;const je=y.find(re=>re.id===W),U=je?je.status:Et.includes(W)?W:K.status;K.status!==U&&(C(re=>{const se=re.map(_e=>_e.id===B?{..._e,status:U}:_e);return Mn(se,ie)}),h(B,U))},[y,h,ie]),Wt=o.useCallback(()=>{J(null),fe(null)},[]),qt=o.useMemo(()=>{const u={};return Et.forEach(w=>{u[w]=[]}),$.forEach(w=>{u[w.status]&&u[w.status].push(w)}),u},[$]),Z=o.useMemo(()=>Et.filter(u=>!(De&&u==="concluida"||Ce&&u==="cancelada")),[De,Ce]),[ce,he]=o.useState(s||"tarefas");return r.jsxs(xn.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[!s&&r.jsx("div",{className:"flex items-center gap-1 rounded-2xl border border-border bg-muted/40 p-1 w-fit backdrop-blur-sm mb-5",children:[{id:"tarefas",label:"Tarefas",icon:hs,count:$.length},{id:"subtarefas",label:"Subtarefas",icon:nr,count:Yt}].map(u=>{const w=ce===u.id,E=u.icon;return r.jsxs("button",{onClick:()=>he(u.id),className:q("relative flex items-center gap-2 rounded-xl px-5 py-2.5 text-sm font-medium transition-all duration-200",w?"text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-background/50"),children:[w&&r.jsx(xn.div,{layoutId:"tarefas-tab-bg",className:"absolute inset-0 rounded-xl gold-gradient shadow-sm",transition:{type:"spring",bounce:.15,duration:.5}}),r.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[r.jsx(E,{className:"h-4 w-4"}),u.label,r.jsx("span",{className:q("inline-flex items-center justify-center rounded-full px-2 py-0.5 text-[10px] font-semibold tabular-nums min-w-[22px] transition-colors",w?"bg-primary-foreground/20 text-primary-foreground":"bg-secondary text-muted-foreground"),children:u.count})]})]},u.id)})}),ce==="tarefas"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3 glass p-4 rounded-xl border border-border shadow-sm mb-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(cn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(At,{placeholder:"Buscar tarefas...",value:O,onChange:u=>ee(u.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[r.jsxs(Xe,{onClick:Vt,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity h-9",children:[r.jsx(qn,{className:"mr-1.5 h-4 w-4"})," Nova Tarefa"]}),r.jsxs("div",{className:"flex border border-border rounded-lg overflow-hidden bg-muted/40",children:[r.jsxs("button",{onClick:()=>z("kanban"),className:q("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",L==="kanban"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(tr,{className:"w-4 h-4"})," Kanban"]}),r.jsxs("button",{onClick:()=>z("list"),className:q("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",L==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(Gn,{className:"w-4 h-4"})," Lista"]})]}),r.jsx(os,{syncing:l,lastSync:f,onSync:m,error:d}),r.jsxs(Fn,{children:[r.jsx(zn,{asChild:!0,children:r.jsx(Xe,{variant:"outline",size:"icon",className:"h-9 w-9",children:r.jsx(gs,{className:"w-4 h-4"})})}),r.jsx(_n,{className:"w-56",align:"end",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm font-medium mb-2",children:"Mostrar nos cards"}),Object.keys(Ln).map(u=>r.jsxs("div",{className:"flex items-center justify-between py-1",children:[r.jsx(as,{htmlFor:`field-${u}`,className:"text-sm cursor-pointer",children:Ln[u]}),r.jsx(lt,{id:`field-${u}`,checked:G[u],onCheckedChange:()=>wt(u)})]},u))]})})]})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-end",children:[r.jsx(ms,{className:"w-4 h-4 text-muted-foreground shrink-0 mb-2"}),r.jsxs("div",{className:"flex items-end gap-2 flex-wrap flex-1",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Status"}),r.jsxs(ve,{value:te,onValueChange:oe,children:[r.jsx(be,{className:"w-[130px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos Status"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todos Status"}),Object.keys(kt).map(u=>r.jsx(F,{value:u,children:kt[u]},u))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prioridade"}),r.jsxs(ve,{value:ue,onValueChange:Ie,children:[r.jsx(be,{className:"w-[110px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todas"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todas"}),Object.keys(nn).map(u=>r.jsx(F,{value:u,children:nn[u]},u))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prazo"}),r.jsxs(ve,{value:xe,onValueChange:u=>g(u),children:[r.jsx(be,{className:"w-[110px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos"})}),r.jsx(we,{children:po.map(u=>r.jsx(F,{value:u.value,children:u.label},u.value))})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Responsável"}),r.jsxs(ve,{value:k,onValueChange:_,children:[r.jsx(be,{className:"w-[120px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todos"}),H.map(u=>r.jsx(F,{value:u,children:u},u))]})]})]}),!e&&r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Projeto"}),r.jsxs(ve,{value:ne,onValueChange:Me,children:[r.jsx(be,{className:"w-[150px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todos Projetos"}),N.map(u=>r.jsx(F,{value:u.id,children:u.name},u.id))]})]})]}),Pe.length>0&&r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Cliente"}),r.jsxs(ve,{value:V,onValueChange:$e,children:[r.jsx(be,{className:"w-[130px] h-8 text-xs",children:r.jsx(ye,{placeholder:"Todos"})}),r.jsxs(we,{children:[r.jsx(F,{value:"all",children:"Todos Clientes"}),Pe.map(u=>r.jsx(F,{value:u,children:u},u))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Ordenar por"}),r.jsxs(ve,{value:ie,onValueChange:u=>I(u),children:[r.jsx(be,{className:"w-[160px] h-8 text-xs",children:r.jsx(ye,{})}),r.jsxs(we,{children:[r.jsx(F,{value:"deadline",children:"Sem ordenação"}),fo.map(u=>r.jsx(F,{value:u.value,children:u.label},u.value))]})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1.5 ml-auto shrink-0",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar canceladas",r.jsx(lt,{checked:Ce,onCheckedChange:pe,className:"scale-75"})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar concluídas",r.jsx(lt,{checked:De,onCheckedChange:ge,className:"scale-75"})]})]})]})]}),r.jsx(Br,{open:T,onOpenChange:D,task:A,onSave:st,onCreateSubtask:x,onUpdateSubtask:v,onDeleteSubtask:S}),r.jsx($n,{open:!!Te,onOpenChange:u=>!u&&Ve(null),children:r.jsxs(Kn,{children:[r.jsxs(Un,{children:[r.jsx(Yn,{children:"Remover tarefa?"}),r.jsx(Vn,{children:"Esta ação não pode ser desfeita. A tarefa será removida permanentemente do Airtable e do banco local."})]}),r.jsxs(Xn,{children:[r.jsx(Hn,{children:"Cancelar"}),r.jsx(Wn,{onClick:ke,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),c?L==="list"?r.jsx(is,{}):r.jsx(ls,{}):L==="list"?r.jsx("div",{className:"space-y-3",children:$.length===0?r.jsx(ht,{children:r.jsx(mt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma tarefa encontrada."})}):$.map(u=>r.jsx(ln,{task:u,cardFields:G,today:le,isExpanded:Ae.has(u.id),onToggleExpand:Fe,onToggleSubtask:ze,onEdit:jt,onDelete:Ve,showStatus:!0,projectName:rt.get(u.projectId||"")},u.id))}):r.jsxs(Nr,{sensors:St,collisionDetection:lr,onDragStart:Xt,onDragOver:Ct,onDragEnd:Ht,onDragCancel:Wt,children:[r.jsx("div",{className:"overflow-x-auto -mx-2 px-2 pb-4",children:r.jsx("div",{className:"flex gap-4",style:{minWidth:`${Z.length*280}px`},children:Z.map(u=>r.jsx("div",{className:"flex-1 min-w-[260px]",children:r.jsx(vo,{status:u,tasks:qt[u],isOver:Ke===u&&Se!==null,cardFields:G,today:le,expandedTasks:Ae,onToggleExpand:Fe,onToggleSubtask:ze,onEdit:jt,onDelete:Ve,projectMap:rt})},u))})}),r.jsx(Tr,{dropAnimation:{duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)"},children:Le?r.jsx("div",{className:"w-[260px]",children:r.jsx(ln,{task:Le,cardFields:G,today:le,isExpanded:!1,onToggleExpand:()=>{},onToggleSubtask:()=>{},onDelete:()=>{},isOverlay:!0,projectName:rt.get(Le.projectId||"")})}):null})]})]}),ce==="subtarefas"&&r.jsx(uo,{tasks:e?y.filter(u=>u.projectId===e):y,projects:N,loading:c,onCreateSubtask:x,onUpdateSubtask:v,onDeleteSubtask:S})]})}const qo=Object.freeze(Object.defineProperty({__proto__:null,default:bo},Symbol.toStringTag,{value:"Module"}));export{bo as A,hs as C,nr as L,qo as a};
