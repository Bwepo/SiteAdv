import{i as p,r as c,j as e}from"./index-CwJZnsy0.js";import{B as _}from"./button-jgiyF501.js";import{I as m}from"./input-QeC9eq_U.js";import{L as l}from"./label-CVFZtsWF.js";import{C as u,a as f,b as g,d as y,c as j}from"./card-BxNrRLkk.js";import{S as n}from"./skeleton-C7nUvcb2.js";import{l as v,m as N}from"./useNewsletter-Bbh29_tx.js";import{g as b}from"./supabaseErrors-eYWJjREL.js";import{S as C}from"./settings-D1OSen8C.js";import{L as w}from"./loader-circle-BI40QLfp.js";import{S}from"./save-fGNpBSa4.js";import"./useMutation-C8eoQVA8.js";const Q=()=>{const{toast:o}=p(),{data:i,isLoading:h}=v(),d=N(),[a,r]=c.useState({from_name:"",from_email:"",reply_to:"",batch_size:100,daily_send_limit:100,monthly_send_limit:3e3});c.useEffect(()=>{i&&r({from_name:i.from_name||"",from_email:i.from_email||"",reply_to:i.reply_to||"",batch_size:i.batch_size||100,daily_send_limit:i.daily_send_limit||100,monthly_send_limit:i.monthly_send_limit||3e3})},[i]);const x=async s=>{if(s.preventDefault(),!a.from_email.trim()){o({title:"E-mail obrigatório",description:"Informe o e-mail remetente.",variant:"destructive"});return}try{await d.mutateAsync({from_name:a.from_name.trim(),from_email:a.from_email.trim(),reply_to:a.reply_to.trim()||null,batch_size:Math.max(1,Math.min(500,a.batch_size)),daily_send_limit:Math.max(1,Math.min(1e4,a.daily_send_limit)),monthly_send_limit:Math.max(1,Math.min(1e5,a.monthly_send_limit))}),o({title:"Configurações salvas",description:"As configurações de newsletter foram atualizadas."})}catch(t){o({title:"Erro ao salvar",description:b(t,"Não foi possível salvar."),variant:"destructive"})}};return e.jsx(e.Fragment,{children:e.jsxs(u,{className:"max-w-2xl",children:[e.jsxs(f,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),"Configurações de envio"]}),e.jsx(y,{children:"Configure os dados do remetente e parâmetros de envio das campanhas de newsletter."})]}),e.jsx(j,{children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsx(n,{className:"h-10 w-full"}),e.jsx(n,{className:"h-10 w-full"}),e.jsx(n,{className:"h-10 w-full"}),e.jsx(n,{className:"h-10 w-1/2"})]}):e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"from_name",children:"Nome do remetente"}),e.jsx(m,{id:"from_name",value:a.from_name,onChange:s=>r(t=>({...t,from_name:s.target.value})),placeholder:"Mariana Lima",maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"from_email",children:"E-mail remetente *"}),e.jsx(m,{id:"from_email",type:"email",value:a.from_email,onChange:s=>r(t=>({...t,from_email:s.target.value})),placeholder:"no-reply@marianalima.adv.br",required:!0,maxLength:255}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Deve ser um domínio verificado no Resend."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"reply_to",children:"Responder para (opcional)"}),e.jsx(m,{id:"reply_to",type:"email",value:a.reply_to,onChange:s=>r(t=>({...t,reply_to:s.target.value})),placeholder:"contato@marianalima.adv.br",maxLength:255}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Quando o leitor clicar em "Responder", o e-mail será enviado para este endereço.'})]}),e.jsxs("div",{className:"space-y-2 max-w-[200px]",children:[e.jsx(l,{htmlFor:"batch_size",children:"Tamanho do lote"}),e.jsx(m,{id:"batch_size",type:"number",min:1,max:500,value:a.batch_size,onChange:s=>r(t=>({...t,batch_size:parseInt(s.target.value,10)||100}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Quantos e-mails enviar por execução da função (1–500). O cron automático executa a cada 2 minutos."})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"daily_send_limit",children:"Limite diário"}),e.jsx(m,{id:"daily_send_limit",type:"number",min:1,max:1e4,value:a.daily_send_limit,onChange:s=>r(t=>({...t,daily_send_limit:parseInt(s.target.value,10)||100}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Máximo de e-mails por dia. Padrão: 100 (plano gratuito do Resend)."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"monthly_send_limit",children:"Limite mensal"}),e.jsx(m,{id:"monthly_send_limit",type:"number",min:1,max:1e5,value:a.monthly_send_limit,onChange:s=>r(t=>({...t,monthly_send_limit:parseInt(s.target.value,10)||3e3}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Máximo de e-mails por mês. Padrão: 3.000 (plano gratuito do Resend)."})]})]}),e.jsxs(_,{type:"submit",disabled:d.isPending,children:[d.isPending?e.jsx(w,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(S,{className:"w-4 h-4 mr-2"}),"Salvar configurações"]})]})})]})})};export{Q as default};
