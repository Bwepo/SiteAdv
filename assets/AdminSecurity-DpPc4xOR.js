import{a as j,E as A,r,j as e,I as d}from"./index-5uJrY_2o.js";import{A as P,S as k}from"./AdminLayout-DlRP9nsR.js";import{B as z}from"./button-CQpJ96y6.js";import{C as I,a as q,b as E,d as L,c as F}from"./card-KXKzodmH.js";import{I as l}from"./input-Bo8kxHwJ.js";import{L as c}from"./label-N_ctAmE5.js";import"./chevron-left-Dw4ABrh3.js";import"./mail-AxYyUXl0.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=j("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=j("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),U=[{label:"Pelo menos 8 caracteres",test:a=>a.length>=8},{label:"Uma letra maiúscula",test:a=>/[A-Z]/.test(a)},{label:"Um número",test:a=>/\d/.test(a)},{label:"Um caractere especial",test:a=>/[^A-Za-z0-9]/.test(a)}],G=()=>{const{toast:a}=A(),[n,m]=r.useState(""),[t,u]=r.useState(""),[i,p]=r.useState(""),[h,o]=r.useState(!1),x=r.useMemo(()=>U.map(s=>({...s,valid:s.test(t)})),[t]),y=x.every(s=>s.valid),v=n.trim().length>0&&t.trim().length>0&&i.trim().length>0&&t===i&&y,C=async s=>{var f,g;if(s.preventDefault(),!v){a({title:"Revise os dados",description:"Preencha todos os campos e atenda aos requisitos da senha.",variant:"destructive"});return}o(!0);const{data:w,error:b}=await d.auth.getSession();if(b||!((g=(f=w.session)==null?void 0:f.user)!=null&&g.email)){a({title:"Sessão inválida",description:"Faça login novamente para alterar sua senha.",variant:"destructive"}),o(!1);return}const{error:N}=await d.auth.signInWithPassword({email:w.session.user.email,password:n});if(N){a({title:"Senha atual incorreta",description:"Confira sua senha atual e tente novamente.",variant:"destructive"}),o(!1);return}const{error:S}=await d.auth.updateUser({password:t});S?a({title:"Não foi possível atualizar",description:"Tente novamente em instantes.",variant:"destructive"}):(a({title:"Senha atualizada",description:"Sua senha foi alterada com sucesso."}),m(""),u(""),p("")),o(!1)};return e.jsx(P,{title:"Segurança",children:e.jsx("div",{className:"max-w-2xl",children:e.jsxs(I,{children:[e.jsxs(q,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-primary"}),"Alterar senha"]}),e.jsx(L,{children:"Atualize sua senha seguindo as regras de segurança abaixo."})]}),e.jsxs(F,{className:"space-y-6",children:[e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"current-password",children:"Senha atual"}),e.jsx(l,{id:"current-password",type:"password",autoComplete:"current-password",value:n,onChange:s=>m(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"new-password",children:"Nova senha"}),e.jsx(l,{id:"new-password",type:"password",autoComplete:"new-password",value:t,onChange:s=>u(s.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"confirm-password",children:"Confirmar nova senha"}),e.jsx(l,{id:"confirm-password",type:"password",autoComplete:"new-password",value:i,onChange:s=>p(s.target.value),required:!0})]}),e.jsx(z,{type:"submit",disabled:!v||h,children:h?"Salvando...":"Atualizar senha"})]}),e.jsxs("div",{className:"rounded-lg border border-border/60 bg-muted/40 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground"}),"Requisitos da senha"]}),e.jsx("ul",{className:"mt-3 space-y-2 text-sm text-muted-foreground",children:x.map(s=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(T,{className:`h-4 w-4 ${s.valid?"text-emerald-500":"text-muted-foreground/60"}`}),e.jsx("span",{className:s.valid?"text-foreground":void 0,children:s.label})]},s.label))})]})]})]})})})};export{G as default};
