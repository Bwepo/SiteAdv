import{c as zs,r as l,a0 as dt,j as e,e as b,s as mt,_ as xt,$ as ut,ao as ht,l as qe}from"./index-DqjVZIxP.js";import{A as pt,L as gt,B as V,P as ps}from"./AdminLayout-CpX5iM5c.js";import{C as D,c as E,a as Ue,b as Ge}from"./card-Bsb_HUEZ.js";import{B as w}from"./button-BMeQXNVu.js";import{I as gs}from"./input-CQ2ioTgL.js";import{S as ft,C as jt}from"./checkbox-CwS6BEHL.js";import{T as bt,a as Nt,b as oe,c as ce}from"./tabs-CGKjUP8_.js";import{P as vt}from"./progress-DC8aHDuh.js";import{S as q,a as U,b as G,d as Q,e as R}from"./select-CzJW8N-Z.js";import{A as fs,a as js,b as bs,c as Ns,d as vs,e as ys,f as ws,g as Ss}from"./alert-dialog-Bs7KRURt.js";import{T as me,E as Qe,a as De,c as Je,e as We,b as yt,d as ts}from"./crmTypes-C2SECzd8.js";import{S as wt}from"./SyncToolbar-BGFtfclw.js";import{B as St,a as ks}from"./CrmSkeletons-CVoHtDHp.js";import{T as kt}from"./TarefaSheet-CjuQHQU1.js";import{A as Ct}from"./AgendaEventSheet-CaOzYDyb.js";import{u as Tt,a as Dt,C as Et,A as At,D as Mt,c as Lt,b as Bt,S as It,G as Ot,d as zt,e as Rt,v as _t,P as Pt,f as $t,g as Ft}from"./SubtarefasTab-BXKtYU9J.js";import{S as Ze}from"./skeleton-BdnDEGuz.js";import{C as Rs}from"./dialog-CGW_A-78.js";import{C as as}from"./chevron-right-DIpw3WYk.js";import{E as Vt}from"./eye-DxM2slkf.js";import{B as Kt}from"./building-2-DCropQ6T.js";import{C as Le}from"./calendar-DqMUm5iJ.js";import{C as Cs}from"./clock-BsTksLib.js";import{T as Ts}from"./triangle-alert-Dd7fjlOO.js";import{C as Ds}from"./circle-check-CDqV2N4j.js";import{T as Yt}from"./trending-up-D5x7T6RC.js";import{C as Ht}from"./chart-column-CL8ubh-G.js";import{F as qt}from"./file-text-B-rpCXRq.js";import{S as Es}from"./search-RG8tp9w-.js";import{L as As}from"./list-Qs0okASP.js";import{M as Ut}from"./map-pin-DhQJJCJ0.js";import{P as _s}from"./pencil-Bizca9Jb.js";import{T as Ps}from"./trash-2-BepnxGeB.js";import{C as Gt}from"./chevron-up-jCkh-002.js";import"./heart-CD0_zNWT.js";import"./sparkles-GqGU_gKP.js";import"./house-BXf0BJqK.js";import"./menu-DatBmJmQ.js";import"./users-BVlTdyty.js";import"./index-CapdahaV.js";import"./check-BHGSVogc.js";import"./index-CYfdI1jE.js";import"./index-DCXTzfoF.js";import"./index-viEduoD9.js";import"./form-CcCCbx69.js";import"./label-eFcpkiQ1.js";import"./textarea-DUxgKph-.js";import"./separator-DdedgjNn.js";import"./loader-circle-C_mWTOYZ.js";import"./circle-CF3Zblvg.js";import"./types-C9wiu8_K.js";import"./popover-DjUQ9hvj.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=zs("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=zs("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),Zt=n=>mt.from(n),de=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];function Xe(n){if(!n)return"";const t=String(n).slice(0,10);return/^\d{4}-\d{2}-\d{2}$/.test(t)?t:""}function Ms(n){const t=Xe(n);return t?`${t.slice(8,10)}/${t.slice(5,7)}/${t.slice(0,4)}`:String(n||"")}function Ls(n){if(typeof n=="boolean")return n;if(typeof n=="number")return n!==0;const t=String(n??"").trim().toLowerCase();return["true","yes","sim","1","checked","on","x"].includes(t)}function Bs(n){const t=Number(n.slice(0,4));let d=Number(n.slice(5,7))-1+1,u=t;return d>11&&(d=0,u=t+1),{anoRef:u,mesRef:d}}function Jt(n){const t=String(n||"").trim().toLowerCase();return t.includes("conclu")||t.includes("finaliz")||t.includes("encerrad")?{label:"Concluído",kind:"done",order:0}:t.includes("andamento")||t.includes("trâmite")||t.includes("tramite")||t.includes("process")?{label:t.includes("trâmite")||t.includes("tramite")?"Em trâmite":"Em andamento",kind:"wip",order:1}:t.includes("agend")?{label:"Agendado",kind:"sched",order:2}:{label:n||"—",kind:"other",order:3}}function Xt(n){const t=n.match(/\s*\(([^)]+)\)\s*$/);return t?{titulo:n.replace(/\s*\(([^)]+)\)\s*$/,"").trim(),projeto:t[1].trim()}:{titulo:n,projeto:""}}function ea(n){if(!n)return"";const t=String(n).split(/\r?\n/).map(c=>c.trim()).filter(Boolean);for(let c of t){c=c.replace(/^#{1,6}\s+/,"").replace(/^\d+\)\s+/,"").replace(/^(-|•|o)\s+/i,"");const d=c.replace(/\*\*(.+?)\*\*/g,"$1").replace(/[_`]+/g,"").replace(/\s+/g," ").trim();if(d)return d.length>140?d.slice(0,137).trim()+"...":d}return""}function sa(n){if(!n)return e.jsx("span",{className:"text-muted-foreground text-xs italic",children:"Sem observações registradas."});const t=String(n).split(/\r?\n/).map(h=>h.trim()).filter(Boolean),c=[];let d=[],u=0;const p=h=>h.split(/\*\*(.+?)\*\*/g).map((S,C)=>C%2===1?e.jsx("strong",{children:S},C):S),N=()=>{d.length&&(c.push(e.jsx("ul",{className:"list-disc list-inside space-y-0.5 text-xs leading-relaxed ml-2",children:d.map((h,k)=>e.jsx("li",{children:p(h)},k))},u++)),d=[])};for(const h of t){const k=h.match(/^#{1,6}\s+(.+)$/);if(k){N(),c.push(e.jsx("p",{className:"text-xs font-bold mt-2 mb-1",children:p(k[1])},u++));continue}const S=h.match(/^(\d+)\)\s+(.+)$/);if(S){N(),c.push(e.jsxs("p",{className:"text-xs font-bold mt-2 mb-1",children:[S[1],") ",p(S[2])]},u++));continue}const C=h.match(/^\*\*(.+?)\*\*:?$/);if(C){N(),c.push(e.jsx("p",{className:"text-xs font-bold mt-2 mb-1",children:p(C[1])},u++));continue}if(/^(-|•|o)\s+/i.test(h)){d.push(h.replace(/^(-|•|o)\s+/i,""));continue}N(),c.push(e.jsx("p",{className:"text-xs leading-relaxed",children:p(h)},u++))}return N(),e.jsx(e.Fragment,{children:c})}const $s={done:"bg-green-100 text-green-800 border-green-200",wip:"bg-amber-100 text-amber-800 border-amber-200",sched:"bg-orange-100 text-orange-700 border-orange-200",other:"bg-muted text-muted-foreground border-border"};async function ta(){const{data:n,error:t}=await Zt("mladv_crm_tarefas").select("titulo, status, deadline, descricao, raw_fields").ilike("cliente","%bosi%");if(t)throw t;return n||[]}function aa(){const n=l.useRef(null),t=new Date,[c,d]=l.useState(t.getFullYear()),[u,p]=l.useState(t.getMonth()),{data:N,isLoading:h}=dt({queryKey:["crm","bosi-report"],queryFn:ta}),k=l.useMemo(()=>{if(!N)return[];const r=new Set;return N.forEach(g=>{const T=g.raw_fields||{};if(!Ls(T.Bosi))return;const f=Xe(T.Date);if(!f)return;const z=Bs(f);r.add(`${z.anoRef}-${String(z.mesRef).padStart(2,"0")}`)}),Array.from(r).sort().reverse()},[N]),S=()=>{u===0?(p(11),d(r=>r-1)):p(r=>r-1)},C=()=>{u===11?(p(0),d(r=>r+1)):p(r=>r+1)},M=c===t.getFullYear()&&u===t.getMonth(),i=l.useMemo(()=>{if(!N)return null;const r=c,g=u,T=N.filter(m=>{const A=m.raw_fields||{};if(!Ls(A.Bosi))return!1;const _=Xe(A.Date);if(!_)return!1;const Y=Bs(_);return Y.anoRef===r&&Y.mesRef===g});if(T.length===0)return null;const f=T.filter(m=>m.titulo&&m.titulo.toLowerCase()!=="tarefa sem nome").map(m=>{var ee;const A=Jt(m.status),_=((ee=m.raw_fields)==null?void 0:ee.Observações)||m.descricao||null,{titulo:Y,projeto:H}=Xt(m.titulo);return{titulo:m.titulo,observacoes:_,deadline:m.deadline,statusLabel:A.label,statusKind:A.kind,statusOrder:A.order,projeto:H,tituloClean:Y}}).sort((m,A)=>m.statusOrder!==A.statusOrder?m.statusOrder-A.statusOrder:m.tituloClean.localeCompare(A.tituloClean,"pt-BR"));let z=g-1,Z=r;z<0&&(z=11,Z=r-1);const I=new Date(Z,z+1,0).getDate(),Oe=f.length,J=f.filter(m=>m.statusKind==="done").length,ze=f.filter(m=>m.statusKind==="wip").length,fe=f.filter(m=>m.statusKind==="sched").length,je=f.filter(m=>m.observacoes).slice(0,3).map(m=>({titulo:m.tituloClean,projeto:m.projeto,impacto:ea(m.observacoes),statusLabel:m.statusLabel,statusKind:m.statusKind})),X=new Date;return{tasks:f,periodoTxt:`01 a ${String(I).padStart(2,"0")} de ${de[z]} de ${Z}`,mesAno:`${de[g]} de ${r}`,geradoEm:Ms(`${X.getFullYear()}-${String(X.getMonth()+1).padStart(2,"0")}-${String(X.getDate()).padStart(2,"0")}`),reportId:`${r}-${String(g+1).padStart(2,"0")}`,total:Oe,concluidas:J,emAndamento:ze,agendado:fe,destaques:je}},[N,c,u]),O=l.useCallback(()=>{if(!n.current)return;const r=window.open("","_blank");if(!r)return;const g=n.current.innerHTML;r.document.write(`
      <!DOCTYPE html>
      <html lang="pt-br">
      <head>
        <meta charset="UTF-8">
        <title>Relatório Executivo – ${(i==null?void 0:i.mesAno)||""}</title>
        <style>
          @page { size: A4; margin: 12mm; }
          * { -webkit-print-color-adjust: exact; print-color-adjust: exact; box-sizing: border-box; }
          body { margin: 0; padding: 16px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; color: #0f172a; font-size: 13px; line-height: 1.5; }
          .report-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 2px solid #e2e8f0; }
          .report-header h1 { font-size: 18px; font-weight: 800; margin: 0; }
          .report-header .subtitle { font-size: 12px; color: #64748b; margin-top: 4px; }
          .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 16px; }
          .kpi-card { padding: 10px 12px; border-radius: 8px; border: 1px solid; }
          .kpi-card .value { font-size: 24px; font-weight: 900; }
          .kpi-card .label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; }
          .kpi-done { background: #ecfdf3; border-color: #bbf7d0; color: #14532d; }
          .kpi-wip { background: #fef3c7; border-color: #fde68a; color: #7c2d12; }
          .kpi-sched { background: #ffedd5; border-color: #fed7aa; color: #7a4a00; }
          .kpi-other { background: #e2e8f0; border-color: #cbd5e1; color: #0f172a; }
          .badge { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 11px; font-weight: 700; border: 1px solid; }
          .badge-done { background: #ecfdf3; color: #14532d; border-color: #bbf7d0; }
          .badge-wip { background: #fef3c7; color: #7c2d12; border-color: #fde68a; }
          .badge-sched { background: #ffedd5; color: #7a4a00; border-color: #fed7aa; }
          .badge-other { background: #e2e8f0; color: #0f172a; border-color: #cbd5e1; }
          .section-title { font-size: 14px; font-weight: 800; margin: 16px 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e2e8f0; }
          .task-detail { padding: 12px 0; border-bottom: 1px solid #f1f5f9; }
          .task-detail:last-child { border-bottom: none; }
          .task-title { font-size: 13px; font-weight: 800; }
          .task-projeto { color: #64748b; font-weight: 700; }
          .task-obs { font-size: 12px; line-height: 1.6; margin-top: 6px; }
          .task-obs ul { margin: 4px 0 4px 16px; padding: 0; }
          .task-obs li { margin: 2px 0; }
          .footer { margin-top: 24px; padding-top: 12px; border-top: 2px solid #e2e8f0; font-size: 11px; color: #64748b; }
          .page-break { page-break-before: always; break-before: page; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>${g}</body>
      </html>
    `),r.document.close(),setTimeout(()=>{r.print()},300)},[i]);if(h)return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ze,{className:"h-8 w-48"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:[1,2,3,4].map(r=>e.jsx(Ze,{className:"h-20"},r))}),e.jsx(Ze,{className:"h-64"})]});const K=!i||i.total===0,L=(i==null?void 0:i.tasks)??[],B=(i==null?void 0:i.periodoTxt)??"",W=(i==null?void 0:i.mesAno)??"",xe=(i==null?void 0:i.geradoEm)??"",ue=(i==null?void 0:i.reportId)??"",he=(i==null?void 0:i.total)??0,pe=(i==null?void 0:i.concluidas)??0,Be=(i==null?void 0:i.emAndamento)??0,Ie=(i==null?void 0:i.agendado)??0,ge=(i==null?void 0:i.destaques)??[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:S,children:e.jsx(Rs,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(q,{value:String(u),onValueChange:r=>p(Number(r)),children:[e.jsx(U,{className:"w-[130px] h-8 text-xs capitalize",children:e.jsx(G,{})}),e.jsx(Q,{children:de.map((r,g)=>e.jsx(R,{value:String(g),className:"capitalize",children:r},g))})]}),e.jsxs(q,{value:String(c),onValueChange:r=>d(Number(r)),children:[e.jsx(U,{className:"w-[80px] h-8 text-xs",children:e.jsx(G,{})}),e.jsx(Q,{children:Array.from({length:5},(r,g)=>t.getFullYear()-g).map(r=>e.jsx(R,{value:String(r),children:r},r))})]})]}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:C,disabled:M,children:e.jsx(as,{className:"w-4 h-4"})}),!M&&e.jsx(w,{variant:"outline",size:"sm",className:"text-xs h-8",onClick:()=>{d(t.getFullYear()),p(t.getMonth())},children:"Mês atual"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:O,className:"gap-1.5",disabled:K,children:[e.jsx(Qt,{className:"w-3.5 h-3.5"}),"Exportar PDF"]}),e.jsxs(w,{variant:"outline",size:"sm",disabled:K,onClick:()=>{if(n.current){const r=window.open("","_blank");r&&(r.document.write(n.current.innerHTML),r.document.close())}},className:"gap-1.5",children:[e.jsx(Wt,{className:"w-3.5 h-3.5"}),"Imprimir"]})]})]}),K?e.jsx(D,{children:e.jsxs(E,{className:"p-8 text-center text-muted-foreground",children:[e.jsx(Vt,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsxs("p",{className:"text-sm font-medium",children:["Nenhuma tarefa BOSI encontrada para ",de[u]," de ",c,"."]}),e.jsx("p",{className:"text-xs mt-1",children:'Verifique se as tarefas possuem o campo "Bosi" marcado e "Date" preenchido no Airtable.'}),k.length>0&&e.jsxs("p",{className:"text-xs mt-2 text-muted-foreground",children:["Meses com dados: ",k.slice(0,6).map(r=>{const[g,T]=r.split("-");return`${de[Number(T)]}/${g}`}).join(", ")]})]})}):e.jsx(e.Fragment,{children:e.jsx(D,{className:"overflow-hidden",children:e.jsx(E,{className:"p-0",children:e.jsxs("div",{ref:n,className:"bg-white text-slate-900 p-6 sm:p-8 max-w-[680px] mx-auto",children:[e.jsxs("div",{className:"report-header pb-3 mb-4 border-b-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/logo-horizontal_transparent.png",alt:"Mariana Lima Advocacia",style:{maxHeight:70}}),e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/bosi_logo.png",alt:"BOSI",style:{maxHeight:34}})]}),e.jsxs("h1",{className:"text-lg font-extrabold text-slate-900",children:["Atuação jurídica do período – ",W]}),e.jsxs("p",{className:"subtitle text-xs text-slate-500 mt-1",children:["Período: ",B]})]}),e.jsxs("div",{className:"kpi-grid grid grid-cols-2 sm:grid-cols-4 gap-2.5 mb-5",children:[e.jsx(Ee,{label:"Total",value:he,kind:"other"}),e.jsx(Ee,{label:"Concluídas",value:pe,kind:"done"}),e.jsx(Ee,{label:"Em andamento",value:Be,kind:"wip"}),e.jsx(Ee,{label:"Agendadas",value:Ie,kind:"sched"})]}),ge.length>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("h2",{className:"section-title text-sm font-extrabold text-slate-900 mb-2 pb-1 border-b border-slate-200",children:"Destaques estratégicos"}),e.jsx("div",{className:"space-y-2",children:ge.map((r,g)=>e.jsxs("div",{className:"flex items-start justify-between gap-3 py-2 border-b border-slate-100 last:border-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-xs font-extrabold text-slate-900",children:[r.titulo,r.projeto&&e.jsxs("span",{className:"text-slate-500 font-bold",children:[" · ",r.projeto]})]}),e.jsx("p",{className:"text-xs text-slate-600 font-semibold mt-0.5 leading-snug",children:r.impacto||"Atualização registrada no período."})]}),e.jsx(es,{label:r.statusLabel,kind:r.statusKind})]},g))})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("h2",{className:"section-title text-sm font-extrabold text-slate-900 mb-2 pb-1 border-b border-slate-200",children:"Frentes acompanhadas"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4",children:[e.jsx(Ae,{title:"Concluídas",kind:"done",tasks:L.filter(r=>r.statusKind==="done")}),e.jsx(Ae,{title:"Em andamento / Em trâmite",kind:"wip",tasks:L.filter(r=>r.statusKind==="wip")}),e.jsx(Ae,{title:"Agendadas",kind:"sched",tasks:L.filter(r=>r.statusKind==="sched")}),e.jsx(Ae,{title:"Outras",kind:"other",tasks:L.filter(r=>r.statusKind==="other")})]})]}),e.jsx("div",{className:"page-break"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-center py-4 mb-4 bg-slate-50 rounded-lg",children:[e.jsx("h2",{className:"text-base font-extrabold text-slate-900",children:"Detalhamento das Tarefas"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Resumo técnico e jurídico de cada frente acompanhada em ",e.jsx("strong",{children:W}),"."]})]}),e.jsx("div",{className:"space-y-0",children:L.map((r,g)=>e.jsxs("div",{className:"task-detail py-3 border-b border-slate-100 last:border-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("p",{className:"task-title text-xs font-extrabold text-slate-900",children:[g+1,". ",r.tituloClean,r.projeto&&e.jsxs("span",{className:"task-projeto text-slate-500 font-bold",children:[" · ",r.projeto]})]}),e.jsx(es,{label:r.statusLabel,kind:r.statusKind})]}),r.deadline&&e.jsxs("p",{className:"text-[11px] text-slate-600 font-semibold mt-1",children:["Prazo: ",Ms(r.deadline)]}),e.jsx("div",{className:"task-obs mt-2",children:sa(r.observacoes)})]},g))})]}),e.jsxs("div",{className:"footer mt-6 pt-3 border-t-2 border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-extrabold text-slate-700",children:"Mariana Lima Advocacia"}),e.jsxs("p",{className:"text-[11px] text-slate-500 mt-1",children:["Telefone: (31) 99404-8797",e.jsx("br",{}),"E-mail: contato@marianalima.adv.br",e.jsx("br",{}),"Rua Hugo Santos Silva, nº 100 – Centro, Sete Lagoas – MG"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/logo-horizontal_transparent.png",alt:"Mariana Lima Advocacia",style:{maxHeight:70,marginLeft:"auto"},className:"mb-2"}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:["Gerado em: ",xe]}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:["Relatório #",ue]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-2 border-t border-slate-100",children:[e.jsx("p",{className:"text-[10px] text-slate-400 italic",children:"Este relatório é confidencial e destinado exclusivamente ao destinatário."}),e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/bosi_logo.png",alt:"BOSI",style:{maxHeight:28}})]})]})]})})})})]})}function Ee({label:n,value:t,kind:c}){const d={done:"bg-green-50 border-green-200 text-green-900",wip:"bg-amber-50 border-amber-200 text-amber-900",sched:"bg-orange-50 border-orange-200 text-orange-900",other:"bg-slate-50 border-slate-200 text-slate-900"};return e.jsxs("div",{className:b("kpi-card rounded-lg border p-3",d[c]),children:[e.jsx("p",{className:"value text-2xl font-black leading-none",children:t}),e.jsx("p",{className:"label text-[10px] font-bold uppercase tracking-wide mt-1.5",children:n})]})}function es({label:n,kind:t}){return e.jsx("span",{className:b("badge inline-block px-2 py-0.5 rounded-full text-[10px] font-bold border shrink-0 whitespace-nowrap",$s[t]),children:n})}function Ae({title:n,kind:t,tasks:c}){return c.length===0?null:e.jsxs("div",{className:"mb-3 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 pb-1",children:[e.jsx("p",{className:"text-xs font-extrabold text-slate-900",children:n}),e.jsx("span",{className:b("badge inline-block px-1.5 py-0 rounded-full text-[10px] font-black border",$s[t]),children:c.length})]}),e.jsx("div",{className:"border-t border-slate-100",children:c.map((d,u)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 py-1 border-b border-slate-50 last:border-0",children:[e.jsxs("p",{className:"text-[11px] font-bold text-slate-900 leading-tight flex-1 min-w-0",children:[d.tituloClean,d.projeto&&e.jsxs("span",{className:"text-slate-500 font-bold",children:[" · ",d.projeto]})]}),e.jsx(es,{label:d.statusLabel,kind:d.statusKind})]},u))})]})}const ra=["pendente","agendado","em_andamento","em_tramite"],Me=["pendente","agendado","em_andamento","em_tramite","concluida","cancelada"],na=[{value:"deadline",label:"Prazo"},{value:"priority",label:"Prioridade"},{value:"title",label:"Título"}],Is={alta:0,media:1,baixa:2};function Os(n,t){return[...n].sort((c,d)=>{switch(t){case"deadline":return!c.dueDate&&!d.dueDate?0:c.dueDate?d.dueDate?c.dueDate.localeCompare(d.dueDate):-1:1;case"priority":return(Is[c.priority]??1)-(Is[d.priority]??1);case"title":return c.title.localeCompare(d.title,"pt-BR");default:return 0}})}const la={dueDate:!0,priority:!0,subtasks:!0,description:!1},ss=l.memo(function({task:t,cardFields:c,today:d,isExpanded:u,onToggleExpand:p,onToggleSubtask:N,onEdit:h,onDelete:k,showStatus:S,isDragging:C,isOverlay:M}){const i=t.subtasks.filter(B=>B.completed).length,O=t.subtasks.length,K=O>0?Math.round(i/O*100):0,L=t.dueDate&&t.dueDate<d&&t.status!=="concluida"&&t.status!=="cancelada";return e.jsx(D,{className:b("transition-shadow duration-150",C&&"opacity-40",M&&"shadow-xl ring-2 ring-primary/30 rotate-[2deg]",L&&"border-destructive/50"),children:e.jsxs(E,{className:"p-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[!M&&e.jsx(Ot,{className:"w-4 h-4 text-muted-foreground mt-0.5 shrink-0 cursor-grab active:cursor-grabbing"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[c.priority&&e.jsx(V,{variant:"secondary",className:b("text-[10px]",yt[t.priority]),children:Je[t.priority]}),S&&e.jsx(V,{variant:"secondary",className:b("text-[10px]",ts[t.status]),children:me[t.status]}),L&&e.jsx(V,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),e.jsx("p",{className:"font-medium text-sm",children:t.title}),c.description&&t.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.description}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:c.dueDate&&t.dueDate&&e.jsxs("span",{className:b("flex items-center gap-1",L&&"text-destructive font-medium"),children:[e.jsx(Le,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})})]}),!M&&e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(w,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>h==null?void 0:h(t),children:e.jsx(_s,{className:"w-3.5 h-3.5"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>k(t.id),children:e.jsx(Ps,{className:"w-3.5 h-3.5"})})]})]}),c.subtasks&&O>0&&!M&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{className:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full",onClick:()=>p(t.id),children:[u?e.jsx(Gt,{className:"w-3 h-3"}):e.jsx(as,{className:"w-3 h-3"}),e.jsxs("span",{children:[i,"/",O," subtarefas"]}),e.jsx("div",{className:"flex-1 mx-2 bg-muted rounded-full h-1.5",children:e.jsx("div",{className:"bg-primary rounded-full h-1.5 transition-all",style:{width:`${K}%`}})}),e.jsxs("span",{className:"text-[10px]",children:[K,"%"]})]}),u&&e.jsx("div",{className:"mt-2 space-y-1 pl-4",children:t.subtasks.map(B=>e.jsxs("label",{className:"flex items-center gap-2 text-xs cursor-pointer hover:bg-muted/50 rounded p-1 -ml-1",children:[e.jsx(jt,{checked:B.completed,onCheckedChange:()=>N(t.id,B.id)}),e.jsx("span",{className:b(B.completed&&"line-through text-muted-foreground"),children:B.title})]},B.id))})]})]})})});function ia(n){const{attributes:t,listeners:c,setNodeRef:d,transform:u,transition:p,isDragging:N}=$t({id:n.task.id}),h={transform:Ft.Transform.toString(u),transition:p};return e.jsx("div",{ref:d,style:h,...t,...c,children:e.jsx(ss,{...n,isDragging:N})})}function oa({status:n,tasks:t,isOver:c,cardFields:d,today:u,expandedTasks:p,onToggleExpand:N,onToggleSubtask:h,onEdit:k,onDelete:S}){const C=l.useMemo(()=>t.map(i=>i.id),[t]),{setNodeRef:M}=zt({id:n});return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(V,{variant:"secondary",className:ts[n],children:me[n]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.length,")"]})]}),e.jsx("div",{ref:M,"data-column-status":n,className:b("space-y-3 min-h-[400px] p-2 rounded-lg transition-colors duration-150",c?"bg-primary/10 border-2 border-dashed border-primary/40":"bg-muted/30 border-2 border-transparent"),children:e.jsx(Rt,{items:C,strategy:_t,children:t.length===0?e.jsx("p",{className:b("text-xs text-center py-8 transition-colors",c?"text-primary font-medium":"text-muted-foreground"),children:c?"↓ Soltar aqui":"Vazio"}):t.map(i=>e.jsx(ia,{task:i,cardFields:d,today:u,isExpanded:p.has(i.id),onToggleExpand:N,onToggleSubtask:h,onEdit:k,onDelete:S},i.id))})})]})}function or(){const n=new Date,t=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`,{events:c,loading:d,syncing:u,lastSync:p,sync:N,deleteEvent:h,createEvent:k,updateEvent:S}=xt(),{tasks:C,loading:M,syncing:i,lastSync:O,sync:K,updateTaskStatus:L,deleteTask:B,createTask:W,updateTask:xe,createSubtask:ue,updateSubtask:he,deleteSubtask:pe}=ut(),{projects:Be}=ht(),Ie=()=>{N(),K()},ge=u||i,r=p&&O?p>O?O:p:p||O,g=d||M,T=l.useMemo(()=>c.filter(s=>{var a;return(a=s.client)==null?void 0:a.toLowerCase().includes("bosi")}).sort((s,a)=>s.date.localeCompare(a.date)),[c]),f=l.useMemo(()=>C.filter(s=>{var a;return(a=s.client)==null?void 0:a.toLowerCase().includes("bosi")}),[C]),z=l.useMemo(()=>T.filter(s=>s.date>=t&&s.status!=="cancelado"),[T,t]),Z=f.filter(s=>ra.includes(s.status)),I=f.filter(s=>s.dueDate&&s.dueDate<t&&s.status!=="concluida"&&s.status!=="cancelada"),Oe=f.filter(s=>s.status==="concluida"),J=l.useMemo(()=>f.flatMap(s=>s.subtasks),[f]),ze=J.filter(s=>s.completed),fe=J.length>0?Math.round(ze.length/J.length*100):0,je=l.useMemo(()=>{const s={};return f.forEach(a=>{s[a.status]=(s[a.status]||0)+1}),s},[f]),X=s=>{const a=new Date(s+"T12:00:00"),o=new Date;return o.setHours(12,0,0,0),Math.round((a.getTime()-o.getTime())/(1e3*60*60*24))},[m,A]=l.useState("kanban"),[_,Y]=l.useState(""),[H,ee]=l.useState("all"),[se,rs]=l.useState("all"),[te,Fs]=l.useState("deadline"),[Re,Vs]=l.useState(!1),[ns,Ks]=l.useState(new Set),[_e,ca]=l.useState(la),[be,Pe]=l.useState(null),[Ys,Ne]=l.useState(null),[Hs,ve]=l.useState(!1),[qs,$e]=l.useState(null),[ae,ye]=l.useState(null),[F,we]=l.useState([]);l.useEffect(()=>{we(f)},[f]);const Se=l.useMemo(()=>{const s=F.filter(a=>!(_&&!a.title.toLowerCase().includes(_.toLowerCase())||H!=="all"&&a.status!==H||se!=="all"&&a.priority!==se));return Os(s,te)},[F,_,H,se,te]),Us=l.useMemo(()=>{const s={};return Me.forEach(a=>{s[a]=[]}),Se.forEach(a=>{s[a.status]&&s[a.status].push(a)}),s},[Se]),ls=l.useMemo(()=>be?F.find(s=>s.id===be):null,[be,F]),Gs=Tt(Dt(Pt,{activationConstraint:{distance:8}})),is=l.useCallback(s=>{Ks(a=>{const o=new Set(a);return o.has(s)?o.delete(s):o.add(s),o})},[]),os=l.useCallback((s,a)=>{we(o=>o.map(x=>x.id===s?{...x,subtasks:x.subtasks.map(v=>v.id===a?{...v,completed:!v.completed}:v)}:x))},[]),Qs=l.useCallback(s=>{Pe(s.active.id)},[]),Ws=l.useCallback(s=>{const{over:a}=s;if(!a){Ne(null);return}const o=a.id,x=F.find(v=>v.id===o);Ne(x?x.status:Me.includes(o)?o:null)},[F]),Zs=l.useCallback(s=>{const{active:a,over:o}=s;if(Pe(null),Ne(null),!o)return;const x=a.id,v=o.id;if(x===v)return;const j=F.find($=>$.id===x);if(!j)return;const P=F.find($=>$.id===v),y=P?P.status:Me.includes(v)?v:j.status;j.status!==y&&(we($=>Os($.map(He=>He.id===x?{...He,status:y}:He),te)),L(x,y))},[F,L,te]),Js=l.useCallback(()=>{Pe(null),Ne(null)},[]),Xs=l.useCallback(async(s,a,o)=>{a?await W({title:s.title,deadline:s.deadline,priority:s.priority,status:s.status,clientName:s.clientName||"BOSI Empreendimentos",projectId:s.projectId,assignee:s.assignee,description:s.description}):o&&await xe(o,{title:s.title,deadline:s.deadline,priority:s.priority,status:s.status,clientName:s.clientName,projectId:s.projectId,assignee:s.assignee,description:s.description})},[W,xe]),et=l.useCallback(async()=>{ae&&(B(ae),we(s=>s.filter(a=>a.id!==ae)),ye(null))},[ae,B]),[Fe,cs]=l.useState("calendar"),[re,ds]=l.useState(""),[ne,ms]=l.useState("all"),[le,xs]=l.useState("all"),[ke,us]=l.useState(()=>({year:n.getFullYear(),month:n.getMonth()})),[st,ie]=l.useState(!1),[Ve,Ce]=l.useState(null),[Ke,Ye]=l.useState(null),Te=l.useMemo(()=>T.filter(s=>!(re&&!s.title.toLowerCase().includes(re.toLowerCase())||ne!=="all"&&s.type!==ne||le!=="all"&&s.status!==le)),[T,re,ne,le]),tt=l.useMemo(()=>{const s=new Map;return Te.forEach(a=>{s.has(a.date)||s.set(a.date,[]),s.get(a.date).push(a)}),s},[Te]),at=l.useMemo(()=>{const{year:s,month:a}=ke,o=new Date(s,a,1),x=new Date(s,a+1,0),v=o.getDay(),j=[],P=y=>`${y.getFullYear()}-${String(y.getMonth()+1).padStart(2,"0")}-${String(y.getDate()).padStart(2,"0")}`;for(let y=v-1;y>=0;y--){const $=new Date(s,a,-y);j.push({date:P($),day:$.getDate(),isCurrentMonth:!1})}for(let y=1;y<=x.getDate();y++){const $=new Date(s,a,y);j.push({date:P($),day:y,isCurrentMonth:!0})}for(;j.length<42;){const y=new Date(s,a+1,j.length-v-x.getDate()+1);j.push({date:P(y),day:y.getDate(),isCurrentMonth:!1})}return j},[ke]),rt=new Date(ke.year,ke.month).toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),nt=()=>us(s=>s.month===0?{year:s.year-1,month:11}:{...s,month:s.month-1}),lt=()=>us(s=>s.month===11?{year:s.year+1,month:0}:{...s,month:s.month+1}),it=async(s,a)=>{const o={...s,clientName:s.clientName||"BOSI Empreendimentos"};a?await k(o):Ve&&await S(Ve.id,o)},ot=async()=>{if(Ke)try{await h(Ke)}catch{qe.error("Erro ao remover.")}finally{Ye(null)}},hs=l.useMemo(()=>{const s=new Map;return Te.forEach(a=>{s.has(a.date)||s.set(a.date,[]),s.get(a.date).push(a)}),Array.from(s.entries())},[Te]),ct=l.useCallback(async(s,a)=>{s.preventDefault();const o=s.dataTransfer.getData("eventId");if(!o)return;const x=T.find(v=>v.id===o);if(!(!x||x.date===a))try{await S(o,{title:x.title,date:a,time:x.time,endTime:x.endTime,type:x.type,status:x.status,clientName:x.client,location:x.location,description:x.description,projectAirtableId:x.projectId}),qe.success(`"${x.title}" reagendado`)}catch{qe.error("Erro ao reagendar")}},[T,S]);return e.jsxs(pt,{title:"",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-primary/10 border border-primary/20",children:e.jsx(Kt,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"BOSI Empreendimentos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Painel exclusivo do cliente"})]})]}),e.jsx(wt,{syncing:ge,lastSync:r,onSync:Ie})]}),g?e.jsxs(e.Fragment,{children:[e.jsx(St,{}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsx(ks,{}),e.jsx(ks,{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3 mb-6",children:[e.jsx(D,{className:"border-l-4 border-l-blue-500",children:e.jsx(E,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:z.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Compromissos"})]}),e.jsx(Le,{className:"w-5 h-5 text-blue-500"})]})})}),e.jsx(D,{className:"border-l-4 border-l-amber-500",children:e.jsx(E,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Z.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Em andamento"})]}),e.jsx(Cs,{className:"w-5 h-5 text-amber-500"})]})})}),e.jsx(D,{className:b("border-l-4",I.length>0?"border-l-destructive":"border-l-muted"),children:e.jsx(E,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:I.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Atrasadas"})]}),e.jsx(Ts,{className:b("w-5 h-5",I.length>0?"text-destructive":"text-muted-foreground")})]})})}),e.jsx(D,{className:"border-l-4 border-l-green-500",children:e.jsx(E,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Oe.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Concluídas"})]}),e.jsx(Ds,{className:"w-5 h-5 text-green-500"})]})})}),e.jsx(D,{className:"border-l-4 border-l-primary",children:e.jsxs(E,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[fe,"%"]}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Progresso geral"})]}),e.jsx(Yt,{className:"w-5 h-5 text-primary"})]}),e.jsx(vt,{value:fe,className:"h-1.5 mt-2"})]})})]}),I.length>0&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-6 rounded-lg bg-destructive/10 border border-destructive/20",children:[e.jsx(Ts,{className:"w-4 h-4 text-destructive shrink-0"}),e.jsxs("p",{className:"text-xs font-medium text-destructive",children:[I.length," tarefa",I.length>1?"s":""," atrasada",I.length>1?"s":"",":"," ",I.slice(0,3).map(s=>s.title).join(", "),I.length>3&&` e mais ${I.length-3}`]})]}),e.jsxs(bt,{defaultValue:"overview",className:"w-full",children:[e.jsxs(Nt,{className:"mb-4",children:[e.jsxs(oe,{value:"overview",className:"gap-1.5",children:[e.jsx(Ht,{className:"w-3.5 h-3.5"}),"Visão Geral"]}),e.jsxs(oe,{value:"tarefas",className:"gap-1.5",children:[e.jsx(gt,{className:"w-3.5 h-3.5"}),"Tarefas"]}),e.jsxs(oe,{value:"subtarefas",className:"gap-1.5",children:[e.jsx(Ds,{className:"w-3.5 h-3.5"}),"Subtarefas"]}),e.jsxs(oe,{value:"agenda",className:"gap-1.5",children:[e.jsx(Le,{className:"w-3.5 h-3.5"}),"Agenda"]}),e.jsxs(oe,{value:"relatorio",className:"gap-1.5",children:[e.jsx(qt,{className:"w-3.5 h-3.5"}),"Relatório"]})]}),e.jsx(ce,{value:"overview",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(D,{children:[e.jsx(Ue,{className:"pb-3",children:e.jsx(Ge,{className:"text-sm",children:"Distribuição de Tarefas"})}),e.jsxs(E,{className:"space-y-2.5",children:[Object.entries(je).map(([s,a])=>{const o=f.length>0?Math.round(a/f.length*100):0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{variant:"secondary",className:b("text-[10px] w-24 justify-center",ts[s]),children:me[s]}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:b("h-2 rounded-full transition-all",s==="concluida"?"bg-green-500":s==="cancelada"?"bg-muted-foreground/30":"bg-primary"),style:{width:`${o}%`}})})}),e.jsxs("span",{className:"text-xs text-muted-foreground w-12 text-right",children:[a," (",o,"%)"]})]},s)}),Object.keys(je).length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Sem tarefas"})]})]}),e.jsxs(D,{children:[e.jsx(Ue,{className:"pb-3",children:e.jsx(Ge,{className:"text-sm",children:"Próximos Compromissos"})}),e.jsx(E,{children:z.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum compromisso futuro"}):e.jsx("div",{className:"space-y-3",children:z.slice(0,6).map(s=>{const a=X(s.date),o=a===0?"Hoje":a===1?"Amanhã":`Em ${a}d`;return e.jsxs("div",{className:"flex items-center gap-3 p-2.5 rounded-lg border border-border/60 hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center min-w-[40px] rounded bg-muted px-1.5 py-1",children:[e.jsx("span",{className:"text-[9px] uppercase text-muted-foreground leading-none",children:new Date(s.date+"T12:00:00").toLocaleDateString("pt-BR",{month:"short"})}),e.jsx("span",{className:"text-base font-bold leading-tight",children:new Date(s.date+"T12:00:00").getDate()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx(V,{variant:"outline",className:b("text-[10px] px-1.5 py-0",Qe[s.type]),children:De[s.type]}),s.time&&e.jsx("span",{className:"text-[10px] text-muted-foreground",children:s.time})]})]}),e.jsx("span",{className:b("text-[10px] font-medium shrink-0 px-2 py-0.5 rounded-full",a<=1?"bg-destructive/10 text-destructive":a<=3?"bg-amber-100 text-amber-700":"bg-muted text-muted-foreground"),children:o})]},s.id)})})})]})]})}),e.jsxs(ce,{value:"tarefas",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[e.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[e.jsx(Es,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),e.jsx(gs,{placeholder:"Buscar tarefa...",value:_,onChange:s=>Y(s.target.value),className:"pl-9 w-full text-sm"})]}),e.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[e.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[e.jsx(w,{variant:m==="list"?"default":"ghost",size:"sm",onClick:()=>A("list"),className:"rounded-none",children:e.jsx(As,{className:"w-4 h-4"})}),e.jsx(w,{variant:m==="kanban"?"default":"ghost",size:"sm",onClick:()=>A("kanban"),className:"rounded-none",children:e.jsx(Et,{className:"w-4 h-4"})})]}),m==="kanban"&&e.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-muted-foreground cursor-pointer select-none",children:[e.jsx(ft,{checked:Re,onCheckedChange:Vs,className:"scale-75"}),"Ocultar concluídas"]}),e.jsxs(w,{size:"sm",onClick:()=>{$e(null),ve(!0)},className:"gap-1.5",children:[e.jsx(ps,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Nova"})]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsxs(q,{value:H,onValueChange:ee,children:[e.jsx(U,{className:"w-[130px] h-8 text-xs",children:e.jsx(G,{placeholder:"Status"})}),e.jsxs(Q,{children:[e.jsx(R,{value:"all",children:"Todos"}),Object.keys(me).map(s=>e.jsx(R,{value:s,children:me[s]},s))]})]}),e.jsxs(q,{value:se,onValueChange:rs,children:[e.jsx(U,{className:"w-[110px] h-8 text-xs",children:e.jsx(G,{placeholder:"Prioridade"})}),e.jsxs(Q,{children:[e.jsx(R,{value:"all",children:"Todas"}),Object.keys(Je).map(s=>e.jsx(R,{value:s,children:Je[s]},s))]})]}),e.jsxs(q,{value:te,onValueChange:s=>Fs(s),children:[e.jsxs(U,{className:"w-[130px] h-8 text-xs gap-1.5",children:[e.jsx(At,{className:"w-3.5 h-3.5 shrink-0 text-muted-foreground"}),e.jsx(G,{})]}),e.jsx(Q,{children:na.map(s=>e.jsx(R,{value:s.value,children:s.label},s.value))})]}),(H!=="all"||se!=="all"||_)&&e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{ee("all"),rs("all"),Y("")},className:"text-xs gap-1 h-8",children:"✕ Limpar"})]})]}),e.jsx(kt,{open:Hs,onOpenChange:ve,task:qs,onSave:Xs,onCreateSubtask:ue,onUpdateSubtask:he,onDeleteSubtask:pe}),e.jsx(fs,{open:!!ae,onOpenChange:s=>!s&&ye(null),children:e.jsxs(js,{children:[e.jsxs(bs,{children:[e.jsx(Ns,{children:"Remover tarefa?"}),e.jsx(vs,{children:"Esta ação não pode ser desfeita."})]}),e.jsxs(ys,{children:[e.jsx(ws,{children:"Cancelar"}),e.jsx(Ss,{onClick:et,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),m==="list"?e.jsx("div",{className:"space-y-3",children:Se.length===0?e.jsx(D,{children:e.jsx(E,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma tarefa encontrada."})}):Se.map(s=>e.jsx(ss,{task:s,cardFields:_e,today:t,isExpanded:ns.has(s.id),onToggleExpand:is,onToggleSubtask:os,onEdit:a=>{$e(a),ve(!0)},onDelete:ye,showStatus:!0},s.id))}):e.jsxs(Mt,{sensors:Gs,collisionDetection:Lt,onDragStart:Qs,onDragOver:Ws,onDragEnd:Zs,onDragCancel:Js,children:[e.jsx("div",{className:b("grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",Re?"xl:grid-cols-4":"xl:grid-cols-6"),children:Me.filter(s=>!Re||s!=="concluida"&&s!=="cancelada").map(s=>e.jsx(oa,{status:s,tasks:Us[s],isOver:Ys===s&&be!==null,cardFields:_e,today:t,expandedTasks:ns,onToggleExpand:is,onToggleSubtask:os,onEdit:a=>{$e(a),ve(!0)},onDelete:ye},s))}),e.jsx(Bt,{dropAnimation:{duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)"},children:ls?e.jsx("div",{className:"w-[260px]",children:e.jsx(ss,{task:ls,cardFields:_e,today:t,isExpanded:!1,onToggleExpand:()=>{},onToggleSubtask:()=>{},onDelete:()=>{},isOverlay:!0})}):null})]})]}),e.jsx(ce,{value:"subtarefas",children:e.jsx(It,{tasks:f,projects:Be,loading:M,onCreateSubtask:ue,onUpdateSubtask:he,onDeleteSubtask:pe})}),e.jsxs(ce,{value:"agenda",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[e.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[e.jsx(Es,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),e.jsx(gs,{placeholder:"Buscar compromisso...",value:re,onChange:s=>ds(s.target.value),className:"pl-9 w-full text-sm"})]}),e.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[e.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[e.jsx(w,{variant:Fe==="list"?"default":"ghost",size:"sm",onClick:()=>cs("list"),className:"rounded-none",children:e.jsx(As,{className:"w-4 h-4"})}),e.jsx(w,{variant:Fe==="calendar"?"default":"ghost",size:"sm",onClick:()=>cs("calendar"),className:"rounded-none",children:e.jsx(Le,{className:"w-4 h-4"})})]}),e.jsxs(w,{size:"sm",onClick:()=>{Ce(null),ie(!0)},className:"gap-1.5",children:[e.jsx(ps,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Novo"})]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsxs(q,{value:ne,onValueChange:ms,children:[e.jsx(U,{className:"w-[130px] h-8 text-xs",children:e.jsx(G,{placeholder:"Tipo"})}),e.jsxs(Q,{children:[e.jsx(R,{value:"all",children:"Todos"}),Object.keys(De).map(s=>e.jsx(R,{value:s,children:De[s]},s))]})]}),e.jsxs(q,{value:le,onValueChange:xs,children:[e.jsx(U,{className:"w-[130px] h-8 text-xs",children:e.jsx(G,{placeholder:"Status"})}),e.jsxs(Q,{children:[e.jsx(R,{value:"all",children:"Todos"}),Object.keys(We).map(s=>e.jsx(R,{value:s,children:We[s]},s))]})]}),(ne!=="all"||le!=="all"||re)&&e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{ms("all"),xs("all"),ds("")},className:"text-xs gap-1 h-8",children:"✕ Limpar"})]})]}),e.jsx(Ct,{open:st,onOpenChange:ie,event:Ve,onSave:it}),e.jsx(fs,{open:!!Ke,onOpenChange:s=>!s&&Ye(null),children:e.jsxs(js,{children:[e.jsxs(bs,{children:[e.jsx(Ns,{children:"Remover compromisso?"}),e.jsx(vs,{children:"Esta ação não pode ser desfeita."})]}),e.jsxs(ys,{children:[e.jsx(ws,{children:"Cancelar"}),e.jsx(Ss,{onClick:ot,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),Fe==="list"?e.jsx("div",{className:"space-y-6",children:hs.length===0?e.jsx(D,{children:e.jsx(E,{className:"p-8 text-center text-muted-foreground",children:"Nenhum compromisso encontrado."})}):hs.map(([s,a])=>e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground mb-2 capitalize",children:[new Date(s+"T12:00:00").toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"long"}),s===t&&e.jsx(V,{variant:"secondary",className:"ml-2 text-[10px]",children:"Hoje"})]}),e.jsx("div",{className:"space-y-2",children:a.map(o=>e.jsx(D,{className:"hover:border-primary/30 transition-colors",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(V,{variant:"secondary",className:b("text-[10px]",Qe[o.type]),children:De[o.type]}),e.jsx(V,{variant:"outline",className:"text-[10px]",children:We[o.status]})]}),e.jsx("p",{className:"font-medium text-sm",children:o.title}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-1.5 text-xs text-muted-foreground",children:[o.time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Cs,{className:"w-3 h-3"}),o.time]}),o.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ut,{className:"w-3 h-3"}),o.location]})]})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(w,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{Ce(o),ie(!0)},children:e.jsx(_s,{className:"w-3.5 h-3.5"})}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>Ye(o.id),children:e.jsx(Ps,{className:"w-3.5 h-3.5"})})]})]})})},o.id))})]},s))}):e.jsxs(D,{children:[e.jsx(Ue,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{variant:"ghost",size:"icon",onClick:nt,children:e.jsx(Rs,{className:"w-4 h-4"})}),e.jsx(Ge,{className:"text-base capitalize",children:rt}),e.jsx(w,{variant:"ghost",size:"icon",onClick:lt,children:e.jsx(as,{className:"w-4 h-4"})})]})}),e.jsxs(E,{children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map(s=>e.jsx("div",{className:"text-center text-[10px] font-medium text-muted-foreground py-1",children:s},s))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:at.map(({date:s,day:a,isCurrentMonth:o})=>{const x=tt.get(s)||[],v=s===t;return e.jsxs("div",{className:b("min-h-[80px] p-1.5 rounded-lg border transition-colors cursor-pointer hover:bg-muted/30",!o&&"opacity-40",v?"bg-primary/5 border-primary/30":"border-border/30"),onClick:()=>{x.length===0&&(Ce(null),ie(!0))},onDragOver:j=>{j.preventDefault()},onDrop:j=>ct(j,s),children:[e.jsx("p",{className:b("text-xs font-medium mb-1",v&&"text-primary"),children:a}),e.jsxs("div",{className:"space-y-0.5",children:[x.slice(0,3).map(j=>e.jsxs("div",{className:b("text-[10px] leading-tight px-1 py-0.5 rounded truncate cursor-move",Qe[j.type]),draggable:!0,onDragStart:P=>P.dataTransfer.setData("eventId",j.id),onClick:P=>{P.stopPropagation(),Ce(j),ie(!0)},children:[j.time&&e.jsxs("span",{className:"font-medium",children:[j.time," "]}),j.title]},j.id)),x.length>3&&e.jsxs("p",{className:"text-[9px] text-muted-foreground text-center",children:["+",x.length-3]})]})]},s)})})]})]})]}),e.jsx(ce,{value:"relatorio",children:e.jsx(aa,{})})]})]})]})}export{or as default};
