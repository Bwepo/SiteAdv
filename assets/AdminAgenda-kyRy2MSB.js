import{aj as se,r as n,j as e,e as N}from"./index-CXIpuz_-.js";import{A as te}from"./AdminLayout-D1SuZYWo.js";import{C as y,c as w,a as A,b as B}from"./card-DBAmFPwO.js";import{B as v}from"./badge-DWz80jRg.js";import{B as c}from"./button-DsftJtE4.js";import{I as ae}from"./input--GVCOrrz.js";import{S as z,a as O,b as I,d as P,e as S}from"./select-p3gbrp5J.js";import{a as C,c as b,E as D}from"./crmTypes-D5hDkvdS.js";import{S as re,A as ne,C as le}from"./CrmSkeletons-CxxGKYRq.js";import{S as ie}from"./search-2qiqBA4X.js";import{L as oe}from"./list-C_t4Cl6v.js";import{C as ce}from"./calendar-C3zWe-GW.js";import{C as T}from"./clock-D6Fq1koZ.js";import{U as R}from"./users-CilgE17M.js";import{M as me}from"./map-pin-B8-d-_d_.js";import{P as de}from"./pencil-Ce4ZneaA.js";import{T as xe}from"./trash-2-BMxd3kqF.js";import{C as he}from"./index-gWbUSHUY.js";import{C as pe}from"./chevron-right-D-gsW5a9.js";import"./house-BdN2o6Mm.js";import"./menu-CUUPlfG5.js";import"./file-text-DN8kTDfl.js";import"./index-DZvgWwp4.js";import"./index-BpCwBHQg.js";import"./index-C7PGZYHI.js";import"./chevron-up-D-fx7Pib.js";import"./check-DAq3pg4s.js";import"./skeleton-CFbITS2I.js";function $e(){const{events:d,loading:V,syncing:_,error:F,lastSync:H,sync:$,deleteEvent:U}=se(),[x,E]=n.useState("calendar"),[m,Y]=n.useState(""),[h,Q]=n.useState("all"),[p,q]=n.useState("all"),[u,L]=n.useState(()=>{const s=new Date;return{year:s.getFullYear(),month:s.getMonth()}}),j=n.useMemo(()=>d.filter(s=>{var t;return!(m&&!s.title.toLowerCase().includes(m.toLowerCase())&&!((t=s.client)!=null&&t.toLowerCase().includes(m.toLowerCase()))||h!=="all"&&s.type!==h||p!=="all"&&s.status!==p)}).sort((s,t)=>s.date.localeCompare(t.date)||(s.time||"").localeCompare(t.time||"")),[d,m,h,p]),G=s=>{U(s)},J=s=>new Date(s+"T12:00:00").toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"long"}),K=n.useMemo(()=>{const{year:s,month:t}=u,a=new Date(s,t,1),i=new Date(s,t+1,0),l=a.getDay(),o=[];for(let r=l-1;r>=0;r--){const g=new Date(s,t,-r);o.push({date:g.toISOString().split("T")[0],day:g.getDate(),isCurrentMonth:!1})}for(let r=1;r<=i.getDate();r++){const g=new Date(s,t,r);o.push({date:g.toISOString().split("T")[0],day:r,isCurrentMonth:!0})}for(;o.length<42;){const r=new Date(s,t+1,o.length-l-i.getDate()+1);o.push({date:r.toISOString().split("T")[0],day:r.getDate(),isCurrentMonth:!1})}return o},[u]),W=n.useMemo(()=>{const s=new Map;return j.forEach(t=>{s.has(t.date)||s.set(t.date,[]),s.get(t.date).push(t)}),s},[j]),f=new Date().toISOString().split("T")[0],M=n.useMemo(()=>d.filter(s=>s.date>=f).sort((s,t)=>s.date.localeCompare(t.date)||(s.time||"").localeCompare(t.time||"")).slice(0,8),[d,f]),X=new Date(u.year,u.month).toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),Z=()=>L(s=>s.month===0?{year:s.year-1,month:11}:{...s,month:s.month-1}),ee=()=>L(s=>s.month===11?{year:s.year+1,month:0}:{...s,month:s.month+1}),k=n.useMemo(()=>{const s=new Map;return j.forEach(t=>{s.has(t.date)||s.set(t.date,[]),s.get(t.date).push(t)}),Array.from(s.entries())},[j]);return e.jsxs(te,{title:"Agenda",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(ae,{placeholder:"Buscar compromisso ou cliente...",value:m,onChange:s=>Y(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsxs(z,{value:h,onValueChange:Q,children:[e.jsx(O,{className:"w-[130px]",children:e.jsx(I,{placeholder:"Tipo"})}),e.jsxs(P,{children:[e.jsx(S,{value:"all",children:"Todos"}),Object.keys(C).map(s=>e.jsx(S,{value:s,children:C[s]},s))]})]}),e.jsxs(z,{value:p,onValueChange:q,children:[e.jsx(O,{className:"w-[130px]",children:e.jsx(I,{placeholder:"Status"})}),e.jsxs(P,{children:[e.jsx(S,{value:"all",children:"Todos"}),Object.keys(b).map(s=>e.jsx(S,{value:s,children:b[s]},s))]})]}),e.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[e.jsx(c,{variant:x==="list"?"default":"ghost",size:"sm",onClick:()=>E("list"),className:"rounded-none",children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(c,{variant:x==="calendar"?"default":"ghost",size:"sm",onClick:()=>E("calendar"),className:"rounded-none",children:e.jsx(ce,{className:"w-4 h-4"})})]}),e.jsx(re,{syncing:_,lastSync:H,onSync:$,error:F})]})]}),V?x==="list"?e.jsx(ne,{}):e.jsx(le,{}):x==="list"?e.jsx("div",{className:"space-y-6",children:k.length===0?e.jsx(y,{children:e.jsx(w,{className:"p-8 text-center text-muted-foreground",children:"Nenhum compromisso encontrado."})}):k.map(([s,t])=>e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground mb-2 capitalize",children:[J(s),s===f&&e.jsx(v,{variant:"secondary",className:"ml-2 text-[10px]",children:"Hoje"})]}),e.jsx("div",{className:"space-y-2",children:t.map(a=>e.jsx(y,{className:"hover:border-primary/30 transition-colors",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(v,{variant:"secondary",className:`text-[10px] ${D[a.type]}`,children:C[a.type]}),e.jsx(v,{variant:"outline",className:"text-[10px]",children:b[a.status]})]}),e.jsx("p",{className:"font-medium text-sm",children:a.title}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-1.5 text-xs text-muted-foreground",children:[a.time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),a.time,a.endTime&&` — ${a.endTime}`]}),a.client&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),a.client]}),a.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"w-3 h-3"}),a.location]})]}),a.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a.description})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(c,{variant:"ghost",size:"icon",className:"h-7 w-7",children:e.jsx(de,{className:"w-3.5 h-3.5"})}),e.jsx(c,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>G(a.id),children:e.jsx(xe,{className:"w-3.5 h-3.5"})})]})]})})},a.id))})]},s))}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-6",children:[e.jsxs(y,{children:[e.jsx(A,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:Z,children:e.jsx(he,{className:"w-4 h-4"})}),e.jsx(B,{className:"text-base capitalize",children:X}),e.jsx(c,{variant:"ghost",size:"icon",onClick:ee,children:e.jsx(pe,{className:"w-4 h-4"})})]})}),e.jsx(w,{children:e.jsxs("div",{className:"grid grid-cols-7 gap-px",children:[["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map(s=>e.jsx("div",{className:"text-center text-xs font-medium text-muted-foreground py-2",children:s},s)),K.map((s,t)=>{const a=W.get(s.date)||[],i=s.date===f;return e.jsxs("div",{className:N("min-h-[80px] p-1 border border-border/50 rounded-sm",!s.isCurrentMonth&&"opacity-40",i&&"bg-primary/5 border-primary/30"),children:[e.jsx("p",{className:N("text-xs font-medium mb-0.5",i&&"text-primary font-bold"),children:s.day}),e.jsxs("div",{className:"space-y-0.5",children:[a.slice(0,2).map(l=>e.jsxs("div",{className:N("text-[9px] px-1 py-0.5 rounded truncate",D[l.type]),title:l.title,children:[l.time&&e.jsxs("span",{className:"font-medium",children:[l.time," "]}),l.title]},l.id)),a.length>2&&e.jsxs("p",{className:"text-[9px] text-muted-foreground pl-1",children:["+",a.length-2," mais"]})]})]},t)})]})})]}),e.jsxs(y,{className:"h-fit lg:sticky lg:top-4",children:[e.jsx(A,{className:"pb-3",children:e.jsxs(B,{className:"text-sm flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-primary"}),"Próximos Compromissos"]})}),e.jsx(w,{className:"space-y-3",children:M.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum compromisso futuro"}):M.map(s=>{const t=new Date(s.date+"T12:00:00"),a=Math.ceil((t.getTime()-new Date().setHours(0,0,0,0))/(1e3*60*60*24)),i=a===0?"Hoje":a===1?"Amanhã":`Em ${a} dias`;return e.jsxs("div",{className:"flex gap-3 p-2 rounded-md border border-border/60 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center min-w-[44px] rounded bg-muted px-1 py-1",children:[e.jsx("span",{className:"text-[10px] uppercase text-muted-foreground leading-none",children:t.toLocaleDateString("pt-BR",{month:"short"})}),e.jsx("span",{className:"text-lg font-bold leading-tight",children:t.getDate()}),e.jsx("span",{className:"text-[10px] capitalize text-muted-foreground leading-none",children:t.toLocaleDateString("pt-BR",{weekday:"short"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 flex-wrap",children:[e.jsx(v,{variant:"outline",className:N("text-[10px] px-1.5 py-0",D[s.type]),children:C[s.type]}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:i})]}),s.time&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[e.jsx(T,{className:"w-3 h-3 inline mr-1"}),s.time,s.endTime?` – ${s.endTime}`:""]}),s.client&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[e.jsx(R,{className:"w-3 h-3 inline mr-1"}),s.client]})]})]},s.id)})})]})]})]})}export{$e as default};
