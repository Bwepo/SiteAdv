import{c as q,Z as G,_ as J,am as Q,an as W,r as j,j as e,L as o}from"./index-BbYBTSnr.js";import{A as X,F as ee,L as v,B as w}from"./AdminLayout-96K9ZAW6.js";import{C as l,c as r,a as y,b as C}from"./card-BrKoq-Dh.js";import{B as T}from"./button-A1Qu9K1N.js";import{S as u}from"./skeleton-DW_q9c4W.js";import{S as $,a as B,b as k,d as I,e as N}from"./select-CXp2WOl0.js";import{E as se,a as ae,b as te,c as le}from"./crmTypes-C2SECzd8.js";import{C as A}from"./calendar-Bdfdodqk.js";import{C as re}from"./clock-BWCSRoEN.js";import{T as ne}from"./triangle-alert-DeOibraT.js";import{C as O}from"./circle-check-Ca1wjF8M.js";import{C as ie}from"./chart-column-DBRQ1Wc6.js";import{A as z}from"./arrow-right-U5iJRVkp.js";import{U as S}from"./users-BPns1ADy.js";import"./dialog-CA-CmOks.js";import"./index-C9pD9JTc.js";import"./heart-B3wopCk0.js";import"./sparkles-Dg2vWfD2.js";import"./ThemeToggle-Qn75DwrM.js";import"./search-AxxJVOh1.js";import"./house-BFexXjjp.js";import"./file-text-nOCnpWv9.js";import"./index-DqC36S2S.js";import"./index-BtZmYU82.js";import"./chevron-up-B4A-Sec2.js";import"./check-2jopwpsj.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=q("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function de(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[1,2,3,4].map(c=>e.jsx(l,{children:e.jsxs(r,{className:"p-4 flex items-center gap-3",children:[e.jsx(u,{className:"h-10 w-10 rounded-lg"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{className:"h-7 w-8"}),e.jsx(u,{className:"h-3 w-20"})]})]})},c))}),e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:[1,2].map(c=>e.jsx(l,{children:e.jsxs(r,{className:"p-6 space-y-3",children:[e.jsx(u,{className:"h-5 w-40 mb-2"}),[1,2,3].map(b=>e.jsx(u,{className:"h-16 w-full rounded-lg"},b))]})},c))})]})}function oe(){return new Intl.DateTimeFormat("sv-SE",{timeZone:"America/Sao_Paulo"}).format(new Date)}function Ie(){const{events:c,loading:b}=G(),{tasks:g,loading:V}=J(),{clients:me,loading:M}=Q(),{projects:m,loading:Y}=W(),[n,E]=j.useState("all"),[d,D]=j.useState("all"),H=b||V||M||Y,f=oe(),K=j.useMemo(()=>{const s=new Set;return g.forEach(a=>{a.client&&s.add(a.client)}),c.forEach(a=>{a.client&&s.add(a.client)}),[...s].sort()},[g,c]),i=j.useMemo(()=>{let s=g;if(n!=="all"&&(s=s.filter(a=>a.client===n)),d!=="all"){const a=m.find(t=>t.id===d);a&&(s=s.filter(t=>t.client===a.name))}return s},[g,n,d,m]),F=j.useMemo(()=>{let s=c;if(n!=="all"&&(s=s.filter(a=>a.client===n)),d!=="all"){const a=m.find(t=>t.id===d);a&&(s=s.filter(t=>t.client===a.name))}return s},[c,n,d,m]),U=F.filter(s=>s.date===f).length,L=i.filter(s=>s.dueDate&&s.dueDate<f&&s.status!=="concluida"&&s.status!=="cancelada").length,x=i.filter(s=>s.status==="em_andamento").length,h=i.filter(s=>s.status==="concluida").length,p=i.filter(s=>s.status==="pendente"||s.status==="agendado").length,P=F.filter(s=>s.date>=f&&s.status!=="cancelado").sort((s,a)=>s.date.localeCompare(a.date)||(s.time||"").localeCompare(a.time||"")).slice(0,6),R=i.filter(s=>s.status!=="concluida"&&s.status!=="cancelada").sort((s,a)=>{const t={alta:0,media:1,baixa:2};return t[s.priority]-t[a.priority]||(s.dueDate||"").localeCompare(a.dueDate||"")}).slice(0,6),Z=s=>{const a=new Date(s+"T12:00:00"),t=new Date;t.setHours(12,0,0,0);const _=Math.round((a.getTime()-t.getTime())/864e5);return _===0?"Hoje":_===1?"Amanhã":a.toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"short"})};return e.jsx(X,{title:"CRM — Painel",children:H?e.jsx(de,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[e.jsx(ce,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs($,{value:n,onValueChange:E,children:[e.jsx(B,{className:"w-[220px]",children:e.jsx(k,{placeholder:"Filtrar por cliente"})}),e.jsxs(I,{children:[e.jsx(N,{value:"all",children:"Todos os clientes"}),K.map(s=>e.jsx(N,{value:s,children:s},s))]})]}),e.jsxs($,{value:d,onValueChange:D,children:[e.jsxs(B,{className:"w-[220px]",children:[e.jsx(ee,{className:"w-4 h-4 mr-1.5 text-muted-foreground"}),e.jsx(k,{placeholder:"Filtrar por projeto"})]}),e.jsxs(I,{children:[e.jsx(N,{value:"all",children:"Todos os projetos"}),m.map(s=>e.jsx(N,{value:s.id,children:s.name},s.id))]})]}),(n!=="all"||d!=="all")&&e.jsx(T,{variant:"ghost",size:"sm",onClick:()=>{E("all"),D("all")},className:"text-xs",children:"Limpar filtros"})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[e.jsx(l,{children:e.jsxs(r,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 text-blue-700",children:e.jsx(A,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:U}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Compromissos hoje"})]})]})}),e.jsx(l,{children:e.jsxs(r,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-100 text-slate-700",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:p}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"A Fazer"})]})]})}),e.jsx(l,{children:e.jsxs(r,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-amber-100 text-amber-700",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:x}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Em andamento"})]})]})}),e.jsx(l,{children:e.jsxs(r,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-100 text-red-700",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:L}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Atrasadas"})]})]})}),e.jsx(l,{children:e.jsxs(r,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-100 text-green-700",children:e.jsx(O,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Concluídas"})]})]})})]}),e.jsxs(l,{className:"mb-6",children:[e.jsx(y,{className:"pb-3",children:e.jsxs(C,{className:"text-base flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Distribuição de Tarefas",n!=="all"&&e.jsx(w,{variant:"secondary",className:"text-[10px] ml-2",children:n})]})}),e.jsxs(r,{children:[e.jsx("div",{className:"flex gap-2 h-3 rounded-full overflow-hidden bg-muted",children:i.length>0&&e.jsxs(e.Fragment,{children:[p>0&&e.jsx("div",{className:"bg-slate-400 transition-all",style:{width:`${p/i.length*100}%`},title:`A Fazer: ${p}`}),x>0&&e.jsx("div",{className:"bg-blue-500 transition-all",style:{width:`${x/i.length*100}%`},title:`Em Andamento: ${x}`}),h>0&&e.jsx("div",{className:"bg-green-500 transition-all",style:{width:`${h/i.length*100}%`},title:`Concluídas: ${h}`})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-slate-400"})," A Fazer (",p,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-blue-500"})," Em Andamento (",x,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-green-500"})," Concluídas (",h,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-red-400"})," Atrasadas (",L,")"]})]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsx(y,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(C,{className:"text-base flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Próximos Compromissos"]}),e.jsx(o,{to:"/admin/agenda",children:e.jsxs(T,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todos ",e.jsx(z,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(r,{className:"space-y-3",children:P.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum compromisso próximo."}):P.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"text-center min-w-[3rem]",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:Z(s.date)}),s.time&&e.jsx("p",{className:"text-sm font-bold",children:s.time})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),s.client&&e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-0.5",children:[e.jsx(S,{className:"w-3 h-3"}),s.client]})]}),e.jsx(w,{variant:"secondary",className:`text-[10px] shrink-0 ${se[s.type]}`,children:ae[s.type]})]},s.id))})]}),e.jsxs(l,{children:[e.jsx(y,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(C,{className:"text-base flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4"}),"Tarefas Pendentes"]}),e.jsx(o,{to:"/admin/tarefas",children:e.jsxs(T,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todas ",e.jsx(z,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(r,{className:"space-y-3",children:R.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma tarefa pendente."}):R.map(s=>{const a=s.dueDate&&s.dueDate<f;return e.jsxs("div",{className:`p-3 rounded-lg border transition-colors hover:bg-muted/50 ${a?"border-red-300 bg-red-50/50":"border-border"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[s.client&&e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(S,{className:"w-3 h-3"}),s.client]}),s.dueDate&&e.jsxs("span",{className:`text-xs ${a?"text-red-600 font-medium":"text-muted-foreground"}`,children:[a?"⚠ ":"","Prazo: ",new Date(s.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]})]}),e.jsx(w,{variant:"secondary",className:`text-[10px] shrink-0 ${te[s.priority]}`,children:le[s.priority]})]}),s.subtasks.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] text-muted-foreground mb-1",children:[e.jsxs("span",{children:[s.subtasks.filter(t=>t.completed).length,"/",s.subtasks.length," subtarefas"]}),e.jsxs("span",{children:[Math.round(s.subtasks.filter(t=>t.completed).length/s.subtasks.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx("div",{className:"bg-primary rounded-full h-1.5 transition-all",style:{width:`${s.subtasks.filter(t=>t.completed).length/s.subtasks.length*100}%`}})})]})]},s.id)})})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsx(o,{to:"/admin/agenda",children:e.jsx(l,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(A,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"Agenda"})]})})}),e.jsx(o,{to:"/admin/tarefas",children:e.jsx(l,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(v,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"Tarefas"})]})})}),e.jsx(o,{to:"/admin/bosi",children:e.jsx(l,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(S,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"BOSI"})]})})}),e.jsx(o,{to:"/admin/posts/new",children:e.jsx(l,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(r,{className:"p-4 text-center",children:[e.jsx(O,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"Novo Post"})]})})})]})]})})}export{Ie as default};
