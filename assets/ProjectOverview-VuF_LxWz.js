import{c as A,r as u,j as e,m as g,e as m}from"./index-sVkT8duI.js";import{C as b,c as f,a as j,b as N}from"./card-CZp8FQyD.js";import{B as L}from"./badge-Cc4e8nUU.js";import{P as k}from"./TipTapEditor-CQ8HNnOe.js";import{T as R,c as P}from"./crmTypes-lczSRazm.js";import{T as O}from"./trending-up-Qs6yrNdh.js";import{C as _}from"./clock-4PBhOQuT.js";import{T as z}from"./triangle-alert-DB0IdVcL.js";import{L as I}from"./list-todo-CCeourwB.js";import{L as B}from"./AdminTarefas-BoyKeHx8.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=A("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=A("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),$={pendente:"bg-yellow-500/20 text-yellow-400",agendado:"bg-slate-500/20 text-slate-400",em_andamento:"bg-blue-500/20 text-blue-400",em_tramite:"bg-blue-500/20 text-blue-400",concluida:"bg-green-500/20 text-green-400",cancelada:"bg-red-500/20 text-red-400","A fazer":"bg-yellow-500/20 text-yellow-400","Em andamento":"bg-blue-500/20 text-blue-400",Concluído:"bg-green-500/20 text-green-400"};function Z({projectId:c,clientFilter:o,tasks:w,events:C}){const n=u.useMemo(()=>w.filter(s=>{var t,a;return o&&c?((t=s.client)==null?void 0:t.toLowerCase().includes(o.toLowerCase()))||s.projectId===c:o?(a=s.client)==null?void 0:a.toLowerCase().includes(o.toLowerCase()):s.projectId===c}),[w,c,o]),p=u.useMemo(()=>n.flatMap(s=>s.subtasks),[n]),y=u.useMemo(()=>C.filter(s=>{var t,a;return o&&c?((t=s.client)==null?void 0:t.toLowerCase().includes(o.toLowerCase()))||s.projectId===c:o?(a=s.client)==null?void 0:a.toLowerCase().includes(o.toLowerCase()):s.projectId===c}),[C,c,o]),r=u.useMemo(()=>{const s=n.length,t=n.filter(d=>d.status==="concluida").length,a=n.filter(d=>d.status==="em_andamento").length,i=n.filter(d=>d.status==="pendente").length,h=n.filter(d=>!d.dueDate||d.status==="concluida"||d.status==="cancelada"?!1:new Date(d.dueDate)<new Date).length,x=s>0?Math.round(t/s*100):0,l=p.length,T=p.filter(d=>d.status==="Concluído").length,E=l>0?Math.round(T/l*100):0;return{totalTarefas:s,concluidas:t,emAndamento:a,pendentes:i,atrasadas:h,progress:x,totalSub:l,subConcluidas:T,subProgress:E}},[n,p]),v=u.useMemo(()=>{const s=[];return n.forEach(t=>s.push({id:t.id,type:"tarefa",title:t.title,status:t.status,date:t.updatedAt||t.createdAt,priority:t.priority})),p.forEach(t=>s.push({id:t.id,type:"subtarefa",title:t.title,status:t.status,date:t.dueDate||""})),y.forEach(t=>s.push({id:t.id,type:"evento",title:t.title,status:t.status,date:t.date})),s.sort((t,a)=>new Date(a.date).getTime()-new Date(t.date).getTime()).slice(0,10)},[n,p,y]),D=u.useMemo(()=>{const s=new Date;s.setHours(0,0,0,0);const t=[];for(let a=0;a<14;a++){const i=new Date(s);i.setDate(i.getDate()+a);const h=i.toISOString().split("T")[0],x=[];y.forEach(l=>{l.date===h&&x.push({title:l.title,type:"evento"})}),n.forEach(l=>{l.dueDate===h&&x.push({title:l.title,type:"tarefa"})}),p.forEach(l=>{l.dueDate===h&&x.push({title:l.title,type:"subtarefa"})}),t.push({date:i,label:i.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric"}),isToday:a===0,events:x})}return t},[y,n,p]),M=[{title:"PROGRESSO GERAL",value:`${r.progress}%`,subtitle:`${r.concluidas}/${r.totalTarefas} tarefas`,icon:O,color:"text-green-400",bgColor:"bg-green-500/10"},{title:"EM ANDAMENTO",value:r.emAndamento,subtitle:"tarefas ativas",icon:S,color:"text-blue-400",bgColor:"bg-blue-500/10"},{title:"PENDENTES",value:r.pendentes,subtitle:"aguardando início",icon:_,color:"text-yellow-400",bgColor:"bg-yellow-500/10"},{title:"ATRASADAS",value:r.atrasadas,subtitle:"precisam de atenção",icon:z,color:r.atrasadas>0?"text-red-400":"text-muted-foreground",bgColor:r.atrasadas>0?"bg-red-500/10":"bg-muted/30"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:M.map((s,t)=>{const a=s.icon;return e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:t*.05},children:e.jsx(b,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[11px] font-medium text-muted-foreground uppercase tracking-wider",children:s.title}),e.jsx("p",{className:m("text-2xl font-bold",s.color),children:s.value}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:s.subtitle})]}),e.jsx("div",{className:m("rounded-lg p-2",s.bgColor),children:e.jsx(a,{className:m("h-4 w-4",s.color)})})]})})})},s.title)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(b,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-primary"}),"Tarefas"]})}),e.jsxs(f,{className:"px-4 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[r.concluidas," concluídas"]}),e.jsxs("span",{className:"font-semibold text-foreground",children:[r.progress,"%"]})]}),e.jsx(k,{value:r.progress,className:"h-2"}),e.jsxs("div",{className:"flex gap-3 text-[10px] text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-green-400"}),r.concluidas," concluídas"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-blue-400"}),r.emAndamento," andamento"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-400"}),r.pendentes," pendentes"]})]})]})]})}),e.jsx(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.25},children:e.jsxs(b,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-primary"}),"Subtarefas"]})}),e.jsxs(f,{className:"px-4 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[r.subConcluidas," concluídas"]}),e.jsxs("span",{className:"font-semibold text-foreground",children:[r.subProgress,"%"]})]}),e.jsx(k,{value:r.subProgress,className:"h-2"}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:[r.subConcluidas,"/",r.totalSub," subtarefas finalizadas"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-3",children:[e.jsx(g.div,{className:"lg:col-span-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(b,{className:"border-border/50 bg-card/80 backdrop-blur-sm h-full",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-primary"}),"Atividades Recentes"]})}),e.jsx(f,{className:"px-4 pb-4",children:v.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma atividade ainda."}):e.jsx("div",{className:"space-y-0",children:v.map((s,t)=>e.jsxs("div",{className:"flex items-start gap-3 py-2.5 border-b border-border/30 last:border-0",children:[e.jsxs("div",{className:"mt-1.5 flex flex-col items-center",children:[e.jsx("div",{className:m("h-2 w-2 rounded-full shrink-0",s.type==="evento"?"bg-purple-400":s.type==="subtarefa"?"bg-cyan-400":"bg-primary")}),t<v.length-1&&e.jsx("div",{className:"w-px h-full bg-border/40 mt-1"})]}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-foreground truncate",children:s.title}),e.jsx(L,{variant:"outline",className:m("text-[8px] px-1 py-0 shrink-0",$[s.status]||"bg-secondary text-secondary-foreground"),children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground",children:[e.jsx("span",{className:"capitalize",children:s.type==="tarefa"?"Tarefa":s.type==="subtarefa"?"Subtarefa":"Evento"}),s.priority&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:R[s.priority]||"",children:P[s.priority]||s.priority})]}),s.date&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(s.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})})]})]})]})]},s.id))})})]})}),e.jsx(g.div,{className:"lg:col-span-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.35},children:e.jsxs(b,{className:"border-border/50 bg-card/80 backdrop-blur-sm h-full",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-primary"}),"Próximos 14 dias"]})}),e.jsx(f,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-0.5",children:D.map(s=>{const t=s.events.length>0;return e.jsxs("div",{className:m("flex items-start gap-3 py-1.5 px-2 rounded-md transition-colors",s.isToday&&"bg-primary/5 border border-primary/20",t&&!s.isToday&&"bg-muted/20"),children:[e.jsx("span",{className:m("text-[11px] w-16 shrink-0 capitalize",s.isToday?"font-bold text-primary":t?"font-medium text-foreground":"text-muted-foreground"),children:s.isToday?"Hoje":s.label}),e.jsx("div",{className:"flex-1 min-w-0",children:t?e.jsx("div",{className:"space-y-0.5",children:s.events.map((a,i)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:m("h-1.5 w-1.5 rounded-full shrink-0",a.type==="evento"?"bg-purple-400":a.type==="subtarefa"?"bg-cyan-400":"bg-primary")}),e.jsx("span",{className:"text-[11px] text-foreground truncate",children:a.title})]},i))}):e.jsx("span",{className:"text-[10px] text-muted-foreground/50",children:"—"})})]},s.date.toISOString())})})})]})})]})]})}export{Z as P};
