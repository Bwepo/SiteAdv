import{c as X,ao as Y,$ as Z,r as a,l as I,j as e}from"./index-CC2g7BXp.js";import{A as ee,P as L,F as se,B as R}from"./AdminLayout-BIaoVi8D.js";import{C,c as N}from"./card-DrwXuBN8.js";import{B as r}from"./button-CKII4Ca3.js";import{I as b}from"./input-D4Ny5lXD.js";import{D as ae,a as te,c as oe,d as re,f as le}from"./dialog-DFSodkv1.js";import{A as ne,a as ie,b as ce,c as de,d as me,e as xe,f as he,g as ue}from"./alert-dialog-DdZMitm-.js";import{S as B,a as F,b as z,d as M,e as S}from"./select-D_4yNPEv.js";import{S as pe}from"./SyncToolbar-B3p40OLs.js";import{L as h}from"./label-Ag37qmII.js";import{S as je}from"./search-CRuXS0DY.js";import{C as ge}from"./circle-check-DCmJN5wl.js";import{P as ve}from"./pencil-Byygr_yM.js";import{T as fe}from"./trash-2-DI5JE9b3.js";import"./heart-Ckw0-9I9.js";import"./sparkles-C4v4JiNa.js";import"./calendar-C4LmLqyF.js";import"./house-ShKgI4ej.js";import"./menu-CSu1f_uB.js";import"./users-D3X7ED9-.js";import"./file-text-BlWUahmQ.js";import"./index-BF9YOj6b.js";import"./index-D_t__hLD.js";import"./index-BFsSXW-H.js";import"./chevron-up-06V4YNk2.js";import"./check-CRJ-IjN3.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=X("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),Ne={Ativo:"bg-green-100 text-green-800","Em Espera":"bg-yellow-100 text-yellow-800",Concluído:"bg-blue-100 text-blue-800",Cancelado:"bg-red-100 text-red-800"},be=["Ativo","Em Espera","Concluído","Cancelado"],Se=["Extra","CLT","Pessoal"];function We(){const{projects:u,loading:J,syncing:V,error:q,lastSync:H,sync:K,createProject:y,updateProject:w,deleteProject:k}=Y(),{tasks:A}=Z(),U=a.useMemo(()=>{const s={};for(const t of A)t.projectId&&(s[t.projectId]||(s[t.projectId]={total:0,done:0}),s[t.projectId].total++,t.status==="concluida"&&s[t.projectId].done++);return s},[A]),[l,$]=a.useState(""),[G,n]=a.useState(!1),[i,P]=a.useState(null),[o,p]=a.useState(""),[c,j]=a.useState("Ativo"),[d,g]=a.useState(""),[m,v]=a.useState(""),[E,D]=a.useState(!1),[x,f]=a.useState(null),T=a.useMemo(()=>{if(!l)return u;const s=l.toLowerCase();return u.filter(t=>t.name.toLowerCase().includes(s))},[u,l]),_=a.useCallback(()=>{P(null),p(""),j("Ativo"),g(""),v(""),n(!0)},[]),Q=a.useCallback(s=>{P(s),p(s.name),j(s.status||"Ativo"),g(s.tipo||""),v(s.observacoes||""),n(!0)},[]),O=a.useCallback(async()=>{if(o.trim()){D(!0);try{i?await w(i.id,{name:o.trim(),status:c,tipo:d||void 0,observacoes:m||void 0}):await y({name:o.trim(),status:c,tipo:d||void 0,observacoes:m||void 0}),n(!1)}catch(s){I.error("Erro ao salvar projeto: "+s.message)}finally{D(!1)}}},[o,c,d,m,i,y,w]),W=a.useCallback(async()=>{if(x)try{await k(x)}catch(s){I.error("Erro ao remover projeto: "+s.message)}finally{f(null)}},[x,k]);return e.jsxs(ee,{title:"Projetos",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(b,{placeholder:"Buscar projeto...",value:l,onChange:s=>$(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(pe,{syncing:V,lastSync:H,onSync:K,error:q}),e.jsxs(r,{size:"sm",onClick:_,className:"gap-1.5",children:[e.jsx(L,{className:"w-4 h-4"})," Novo Projeto"]})]})]}),J?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsx(C,{children:e.jsx(N,{className:"p-4 h-16 animate-pulse bg-muted/50"})},s))}):T.length===0?e.jsx(C,{children:e.jsxs(N,{className:"p-8 text-center text-muted-foreground",children:[l?"Nenhum projeto encontrado.":"Nenhum projeto cadastrado.",e.jsx("br",{}),e.jsxs(r,{variant:"outline",size:"sm",className:"mt-3 gap-1.5",onClick:_,children:[e.jsx(L,{className:"w-4 h-4"})," Criar projeto"]})]})}):e.jsx("div",{className:"space-y-2",children:T.map(s=>e.jsx(C,{className:"hover:border-primary/30 transition-colors",children:e.jsxs(N,{className:"p-4 flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx(se,{className:"w-4 h-4 text-muted-foreground shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium text-sm truncate",children:s.name}),e.jsx(R,{variant:"secondary",className:`text-xs ${Ne[s.status]||"bg-muted text-muted-foreground"}`,children:s.status}),s.tipo&&e.jsx(R,{variant:"outline",className:"text-xs",children:s.tipo}),(()=>{const t=U[s.id];return t?e.jsxs("span",{className:"flex items-center gap-1 text-xs text-muted-foreground ml-1",children:[e.jsx(Ce,{className:"w-3 h-3"}),t.total,t.done>0&&e.jsxs("span",{className:"flex items-center gap-0.5 text-green-600",children:[e.jsx(ge,{className:"w-3 h-3"}),t.done]})]}):null})()]}),s.observacoes&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 truncate",children:s.observacoes})]})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(r,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>Q(s),children:e.jsx(ve,{className:"w-3.5 h-3.5"})}),e.jsx(r,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>f(s.id),children:e.jsx(fe,{className:"w-3.5 h-3.5"})})]})]})},s.id))}),e.jsx(ae,{open:G,onOpenChange:n,children:e.jsxs(te,{className:"sm:max-w-md",children:[e.jsx(oe,{children:e.jsx(re,{children:i?"Editar Projeto":"Novo Projeto"})}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"project-name",children:"Nome do projeto"}),e.jsx(b,{id:"project-name",value:o,onChange:s=>p(s.target.value),placeholder:"Ex: EasyBR",onKeyDown:s=>s.key==="Enter"&&O(),autoFocus:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Status"}),e.jsxs(B,{value:c,onValueChange:j,children:[e.jsx(F,{children:e.jsx(z,{})}),e.jsx(M,{children:be.map(s=>e.jsx(S,{value:s,children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx(h,{children:"Tipo"}),e.jsxs(B,{value:d||"__none__",onValueChange:s=>g(s==="__none__"?"":s),children:[e.jsx(F,{children:e.jsx(z,{placeholder:"Nenhum"})}),e.jsxs(M,{children:[e.jsx(S,{value:"__none__",children:"Nenhum"}),Se.map(s=>e.jsx(S,{value:s,children:s},s))]})]})]})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"project-obs",children:"Observações"}),e.jsx(b,{id:"project-obs",value:m,onChange:s=>v(s.target.value),placeholder:"Notas sobre o projeto"})]})]}),e.jsxs(le,{children:[e.jsx(r,{variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),e.jsx(r,{onClick:O,disabled:E||!o.trim(),children:E?"Salvando...":i?"Salvar":"Criar"})]})]})}),e.jsx(ne,{open:!!x,onOpenChange:s=>!s&&f(null),children:e.jsxs(ie,{children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Remover projeto?"}),e.jsx(me,{children:"Esta ação não pode ser desfeita. O projeto será removido permanentemente do Airtable e do banco local."})]}),e.jsxs(xe,{children:[e.jsx(he,{children:"Cancelar"}),e.jsx(ue,{onClick:W,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})]})}export{We as default};
