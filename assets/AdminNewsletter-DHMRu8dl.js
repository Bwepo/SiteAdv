import{a as y,r as k,E as S,j as e,m as d}from"./index-CH2LE9ah.js";import{A as b}from"./AdminLayout-BsUoGkM7.js";import{B as N}from"./button-4Pi_8_m-.js";import{I as E}from"./input-OijHUgs-.js";import{C as m,a as p,b as u,d as x}from"./card-DQJQUXnA.js";import{T as L,a as I,b as h,c as l,d as B,e as a,A as H,m as M,f as R,g as U,h as O,i as q,j as z,k as P,l as V}from"./alert-dialog-DBKBM8GH.js";import{S as t}from"./skeleton-C622kORU.js";import{a as _,b as F,c as W,d as G}from"./useNewsletter-CACmSOpa.js";import{D as g}from"./download-bkLtuslj.js";import{L as J}from"./loader-circle-33sADBFt.js";import{S as K}from"./search-B1TMp_TH.js";import{M as Q}from"./mail-CTBv1P67.js";import{C as X}from"./calendar-B4K-ZpWz.js";import{T as Y}from"./trash-2-_QdVZ_fP.js";import"./chevron-left-0-nAhtCt.js";import"./index-Bu4aPwie.js";import"./Combination-DdrPTq02.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=y("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=y("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),fe=()=>{const[n,w]=k.useState(""),{toast:c}=S(),{data:i,isLoading:v}=_(),{data:r}=F(),C=W(),j=G(),o=i==null?void 0:i.filter(s=>s.email.toLowerCase().includes(n.toLowerCase())||s.name&&s.name.toLowerCase().includes(n.toLowerCase())),A=async s=>{try{await C.mutateAsync(s),c({title:"Inscrito removido",description:"O inscrito foi removido da lista."})}catch{c({title:"Erro",description:"Não foi possível remover o inscrito.",variant:"destructive"})}},D=async()=>{try{await j.mutateAsync(),c({title:"Exportação concluída",description:"O arquivo CSV foi baixado com sucesso."})}catch{c({title:"Erro",description:"Não foi possível exportar a lista.",variant:"destructive"})}},T=s=>new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(b,{title:"Newsletter",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3 mb-8",children:[e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(m,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Total de Inscritos"}),e.jsx($,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.total)??e.jsx(t,{className:"h-8 w-16"})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Inscritos ativos na newsletter"})]})]})}),e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(m,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Novos esta Semana"}),e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-2xl font-bold text-primary",children:["+",(r==null?void 0:r.newThisWeek)??e.jsx(t,{className:"h-8 w-12 inline-block"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Últimos 7 dias"})]})]})}),e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(m,{children:[e.jsxs(p,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:"Exportar Lista"}),e.jsx(g,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(x,{children:e.jsxs(N,{variant:"outline",size:"sm",onClick:D,disabled:j.isPending||!(i!=null&&i.length),children:[j.isPending?e.jsx(J,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(g,{className:"h-4 w-4 mr-2"}),"Baixar CSV"]})})]})})]}),e.jsx("div",{className:"flex items-center gap-4 mb-6",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(E,{placeholder:"Buscar por email ou nome...",value:n,onChange:s=>w(s.target.value),className:"pl-10"})]})}),e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:e.jsx(m,{children:e.jsx(x,{className:"p-0",children:e.jsxs(L,{children:[e.jsx(I,{children:e.jsxs(h,{children:[e.jsx(l,{children:"Email"}),e.jsx(l,{children:"Nome"}),e.jsx(l,{children:"Data de Inscrição"}),e.jsx(l,{children:"Origem"}),e.jsx(l,{className:"w-[80px]",children:"Ações"})]})}),e.jsx(B,{children:v?Array.from({length:5}).map((s,f)=>e.jsxs(h,{children:[e.jsx(a,{children:e.jsx(t,{className:"h-4 w-48"})}),e.jsx(a,{children:e.jsx(t,{className:"h-4 w-24"})}),e.jsx(a,{children:e.jsx(t,{className:"h-4 w-32"})}),e.jsx(a,{children:e.jsx(t,{className:"h-4 w-16"})}),e.jsx(a,{children:e.jsx(t,{className:"h-8 w-8"})})]},f)):(o==null?void 0:o.length)===0?e.jsx(h,{children:e.jsxs(a,{colSpan:5,className:"text-center py-8",children:[e.jsx(Q,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:n?"Nenhum inscrito encontrado com esse termo.":"Nenhum inscrito ainda."})]})}):o==null?void 0:o.map(s=>e.jsxs(h,{children:[e.jsx(a,{className:"font-medium",children:s.email}),e.jsx(a,{className:"text-muted-foreground",children:s.name||"—"}),e.jsx(a,{className:"text-muted-foreground",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"h-3 w-3"}),T(s.subscribed_at)]})}),e.jsx(a,{children:e.jsx("span",{className:"text-xs bg-muted px-2 py-1 rounded",children:s.source})}),e.jsx(a,{children:e.jsxs(H,{children:[e.jsx(M,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsxs(R,{children:[e.jsxs(U,{children:[e.jsx(O,{children:"Remover inscrito?"}),e.jsxs(q,{children:["Esta ação removerá ",s.email," da lista de newsletter. Esta ação não pode ser desfeita."]})]}),e.jsxs(z,{children:[e.jsx(P,{children:"Cancelar"}),e.jsx(V,{onClick:()=>A(s.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})]})})]},s.id))})]})})})})]})};export{fe as default};
