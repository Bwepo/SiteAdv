import{c as U,r as j,j as e,X as S,L as X,t as p}from"./index-C77yhLJt.js";import{A as G,M}from"./AdminLayout-C36LDLeJ.js";import{T as J,a as K,b as F,c as o,d as Q,e as d}from"./table-CcE-vIGE.js";import{B as g}from"./button-DqZUIAbJ.js";import{B as R}from"./badge-BXcUgfhf.js";import{A as W,a as Y,b as Z,c as ee,d as se,e as te,f as ae,g as re}from"./alert-dialog-Cix--tsv.js";import{f as le,h as ie,e as ne}from"./usePostInteractions-C3cSZDQC.js";import{g as C}from"./supabaseErrors-eYWJjREL.js";import{a as B,C as H}from"./chevron-up-CRxqKINg.js";import{C as L}from"./check-BN5nFh43.js";import{E as oe}from"./external-link-C5lyMZhn.js";import{f as P,p as O}from"./pt-BR-BnWYOt86.js";import{C as w,c as b}from"./card-DATr3Qr9.js";import{S as de}from"./skeleton-CIuzlHBH.js";import{T as ce,a as xe,b as y}from"./tabs-97eO-gg0.js";import{C as V}from"./clock-BKCOF9MU.js";import{C as z}from"./circle-check-big-Czya5Qe3.js";import"./dialog-CxTRq9Gb.js";import"./index-Cv7RYB-f.js";import"./heart-BtKJIzi0.js";import"./sparkles-CgZQl4le.js";import"./house-DEvfAAx3.js";import"./menu-BMCLmfsV.js";import"./calendar-CyItuC8S.js";import"./users-D0jUZ7WP.js";import"./file-text-Dt2-pumt.js";import"./useMutation-6bF1A1w3.js";import"./index-BKa80CN6.js";import"./index-CsCv3pTW.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=U("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function me({comments:m,filter:n}){const[a,c]=j.useState(!1),[x,h]=j.useState(null),[i,u]=j.useState(new Set),r=le(),v=ie(),N=m.filter(s=>n==="pending"?!s.reviewed_at:n==="approved"?!!s.reviewed_at:!0),A=s=>{const t=new Set(i);t.has(s)?t.delete(s):t.add(s),u(t)},D=(s,t)=>{var k,E;const l=((k=s.mladv_posts)==null?void 0:k.title)||"Post não encontrado",f=(E=s.mladv_posts)==null?void 0:E.slug,$=e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"line-clamp-2 text-sm",children:l}),f&&e.jsx(oe,{className:"w-3 h-3 flex-shrink-0"})]});return f?e.jsx(X,{to:`/blog/${f}`,target:"_blank",className:`text-foreground/90 hover:text-primary hover:underline flex items-center gap-1 ${t??""}`,children:$}):e.jsx("div",{className:`text-foreground/70 flex items-center gap-1 ${t??""}`,children:e.jsx("span",{className:"line-clamp-2 text-sm",children:l})})},T=async s=>{try{await r.mutateAsync({commentId:s}),p({title:"Comentário mantido",description:"O comentário foi marcado como revisado."})}catch(t){const l=C(t,"Não foi possível aprovar o comentário.");p({title:"Erro ao aprovar",description:l,variant:"destructive"})}},I=async()=>{if(x)try{await v.mutateAsync(x),p({title:"Comentário excluído",description:"O comentário foi removido permanentemente."})}catch(s){const t=C(s,"Não foi possível excluir o comentário.");p({title:"Erro ao excluir",description:t,variant:"destructive"})}finally{c(!1),h(null)}},_=s=>{h(s),c(!0)};return N.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:n==="pending"?"Nenhum comentário novo para revisar.":n==="approved"?"Nenhum comentário revisado ainda.":"Nenhum comentário encontrado."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block rounded-lg border border-border overflow-hidden",children:e.jsxs(J,{children:[e.jsx(K,{children:e.jsxs(F,{className:"bg-muted/50",children:[e.jsx(o,{className:"w-[200px]",children:"Post"}),e.jsx(o,{className:"w-[150px]",children:"Autor"}),e.jsx(o,{children:"Comentário"}),e.jsx(o,{className:"w-[120px]",children:"Data"}),e.jsx(o,{className:"w-[100px]",children:"Status"}),e.jsx(o,{className:"w-[100px] text-right",children:"Ações"})]})}),e.jsx(Q,{children:N.map(s=>{const t=i.has(s.id),l=s.content.length>100;return e.jsxs(F,{children:[e.jsx(d,{children:D(s)}),e.jsx(d,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.author_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.author_email})]})}),e.jsx(d,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:!t&&l?"line-clamp-2":"",children:s.content}),l&&e.jsx("button",{onClick:()=>A(s.id),className:"text-xs text-primary hover:underline mt-1 flex items-center gap-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-3 h-3"})," Ver menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-3 h-3"})," Ver mais"]})})]})}),e.jsx(d,{className:"text-sm text-muted-foreground",children:P(new Date(s.created_at),"dd/MM/yyyy HH:mm",{locale:O})}),e.jsx(d,{children:e.jsx(R,{variant:s.reviewed_at?"default":"secondary",className:s.reviewed_at?"bg-green-500/20 text-green-600 hover:bg-green-500/30":"bg-yellow-500/20 text-yellow-600 hover:bg-yellow-500/30",children:s.reviewed_at?"Revisado":"Novo"})}),e.jsx(d,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[!s.reviewed_at&&e.jsx(g,{size:"icon",variant:"ghost",className:"h-8 w-8 text-green-600 hover:text-green-700 hover:bg-green-500/10",onClick:()=>T(s.id),disabled:r.isPending,title:"Manter comentário",children:e.jsx(L,{className:"w-4 h-4"})}),e.jsx(g,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>_(s.id),disabled:v.isPending,title:"Excluir comentário",children:e.jsx(S,{className:"w-4 h-4"})})]})})]},s.id)})})]})}),e.jsx("div",{className:"md:hidden space-y-4",children:N.map(s=>{const t=i.has(s.id),l=s.content.length>100;return e.jsxs("div",{className:"bg-card rounded-lg border border-border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.author_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.author_email})]}),e.jsx(R,{variant:s.reviewed_at?"default":"secondary",className:s.reviewed_at?"bg-green-500/20 text-green-600":"bg-yellow-500/20 text-yellow-600",children:s.reviewed_at?"Revisado":"Novo"})]}),D(s,"text-xs"),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:!t&&l?"line-clamp-3":"",children:s.content}),l&&e.jsx("button",{onClick:()=>A(s.id),className:"text-xs text-primary hover:underline mt-1 flex items-center gap-1",children:t?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-3 h-3"})," Ver menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-3 h-3"})," Ver mais"]})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:P(new Date(s.created_at),"dd/MM/yyyy HH:mm",{locale:O})}),e.jsxs("div",{className:"flex items-center gap-1",children:[!s.reviewed_at&&e.jsxs(g,{size:"sm",variant:"ghost",className:"h-8 text-green-600 hover:text-green-700 hover:bg-green-500/10",onClick:()=>T(s.id),disabled:r.isPending,children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),"Manter"]}),e.jsxs(g,{size:"sm",variant:"ghost",className:"h-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>_(s.id),disabled:v.isPending,children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"Excluir"]})]})]})]},s.id)})}),e.jsx(W,{open:a,onOpenChange:c,children:e.jsxs(Y,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Excluir comentário?"}),e.jsx(se,{children:"Esta ação não pode ser desfeita. O comentário será removido permanentemente."})]}),e.jsxs(te,{children:[e.jsx(ae,{children:"Cancelar"}),e.jsx(re,{onClick:I,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}const qe=()=>{const[m,n]=j.useState("pending"),{data:a,isLoading:c,error:x}=ne(),h=(a==null?void 0:a.length)||0,i=(a==null?void 0:a.filter(r=>!r.reviewed_at).length)||0,u=(a==null?void 0:a.filter(r=>!!r.reviewed_at).length)||0;return e.jsxs(G,{title:"Moderação de Comentários",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3 mb-8",children:[e.jsx(w,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(M,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de comentários"})]})]})})}),e.jsx(w,{className:i>0?"ring-2 ring-yellow-500/50":"",children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-yellow-500/10",children:e.jsx(V,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Novos"})]}),i>0&&e.jsx(q,{className:"w-5 h-5 text-yellow-500 ml-auto"})]})})}),e.jsx(w,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-green-500/10",children:e.jsx(z,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:u}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Revisados"})]})]})})})]}),e.jsx("div",{className:"mb-6 -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsx(ce,{value:m,onValueChange:r=>n(r),children:e.jsxs(xe,{className:"w-full sm:w-auto flex",children:[e.jsxs(y,{value:"pending",className:"flex-1 sm:flex-none gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-4",children:[e.jsx(V,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Novos"}),e.jsx("span",{className:"xs:hidden",children:"Novos"}),i>0&&e.jsx("span",{className:"ml-0.5 sm:ml-1 px-1.5 sm:px-2 py-0.5 text-[10px] sm:text-xs rounded-full bg-yellow-500/20 text-yellow-600",children:i})]}),e.jsxs(y,{value:"approved",className:"flex-1 sm:flex-none gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-4",children:[e.jsx(z,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Revisados"}),e.jsx("span",{className:"xs:hidden",children:"Rev."})]}),e.jsxs(y,{value:"all",className:"flex-1 sm:flex-none gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-4",children:[e.jsx(M,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),"Todos"]})]})})}),c?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(r=>e.jsx(de,{className:"h-20 w-full"},r))}):x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:C(x,"Erro ao carregar comentários. Verifique se as tabelas foram criadas no banco de dados.")})]}):e.jsx(me,{comments:a||[],filter:m})]})};export{qe as default};
