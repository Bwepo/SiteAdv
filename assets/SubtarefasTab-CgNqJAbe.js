import{c as Ut,r as l,j as a,e as ae,h as Qn,a6 as L,f as Ze}from"./index-DecnLHKo.js";import{u as Zn,F as er,a as Be,b as $e,c as Ue,d as Ke,e as Xe,S as Te,f as Ae,g as Oe,h as Me,i as W,t as tr}from"./form-CMkr7sE5.js";import{S as nr,b as rr,c as sr,d as or,e as ar,f as ir}from"./sheet-5BOo_W2m.js";import{I as It}from"./input-b1PXoCdy.js";import{B as st}from"./button-blv5p1JR.js";import{T as lr}from"./textarea-DDCHxpxP.js";import{P as cr,a as ur,b as dr}from"./popover-BbKhP6JQ.js";import{f as mn,S as ot,g as kt,P as fr}from"./crmTypes-3TDjSWGp.js";import{S as vn}from"./search-BhDD_Kfz.js";import{C as hr}from"./check-C_sBm2Xx.js";import{U as gr}from"./separator-_Seup6FU.js";import{L as pr}from"./loader-circle-DBTixJ4M.js";import{o as mr,s as Qe,e as vr}from"./types-C9wiu8_K.js";import{C as Lt,c as Pt}from"./card-CiqP3Dhs.js";import{A as xr,a as br,b as yr,c as wr,d as Sr,e as Cr,f as Dr,g as jr}from"./alert-dialog-BUy4Fiut.js";import{B as et}from"./badge-D5OiQakQ.js";import{S as Nr}from"./switch-CCw1S2WL.js";import{P as Rr}from"./plus-DvZzPKn5.js";import{L as Er}from"./list-CffKj8ds.js";import{F as Tr}from"./folder-kanban-BwqRPhMg.js";import{U as Ar}from"./users-7BIpTiLP.js";import{C as Or}from"./calendar-CKfyerD0.js";import{T as Mr}from"./trash-2-DIp5utsS.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=Ut("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=Ut("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=Ut("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),Lr=mr({title:Qe().trim().min(1,"Título obrigatório").max(200),parentTaskId:Qe().min(1,"Tarefa-mãe obrigatória"),deadline:Qe().optional(),status:vr(["A fazer","Em andamento","Concluído"]),assignee:Qe().optional(),notes:Qe().max(2e3).optional()}),Pr=Object.entries(ot);function zr({open:e,onOpenChange:t,subtask:n,tasks:r,onSave:s}){const o=!n,[i,c]=l.useState(!1),[u,d]=l.useState(""),[f,h]=l.useState(!1),x=l.useMemo(()=>{if(!u.trim())return r;const m=u.toLowerCase();return r.filter(v=>v.title.toLowerCase().includes(m))},[r,u]),p=Zn({resolver:tr(Lr),defaultValues:{title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}});l.useEffect(()=>{e&&(n?p.reset({title:n.title,parentTaskId:n.parentTaskId,deadline:n.dueDate??"",status:n.status,assignee:n.assignee??"",notes:n.notes??""}):p.reset({title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}))},[e,n]);const y=async m=>{c(!0);try{await s(m,o,n==null?void 0:n.id),t(!1)}catch(v){Qn.error("Erro ao salvar subtarefa: "+v.message),console.error("Erro ao salvar subtarefa:",v)}finally{c(!1)}};return a.jsx(nr,{open:e,onOpenChange:t,children:a.jsxs(rr,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[a.jsxs(sr,{className:"mb-6",children:[a.jsx(or,{children:o?"Nova Subtarefa":"Editar Subtarefa"}),a.jsx(ar,{children:o?"Preencha os dados e selecione a tarefa-mãe relacionada.":"Altere os campos e salve."})]}),a.jsx(er,{...p,children:a.jsxs("form",{onSubmit:p.handleSubmit(y),className:"space-y-5",children:[a.jsx(Be,{control:p.control,name:"title",render:({field:m})=>a.jsxs($e,{children:[a.jsx(Ue,{children:"Título *"}),a.jsx(Ke,{children:a.jsx(It,{placeholder:"Ex: Enviar documento",...m})}),a.jsx(Xe,{})]})}),a.jsx(Be,{control:p.control,name:"parentTaskId",render:({field:m})=>{var v;return a.jsxs($e,{className:"flex flex-col",children:[a.jsx(Ue,{children:"Tarefa-mãe *"}),a.jsxs(cr,{open:f,onOpenChange:h,children:[a.jsx(ur,{asChild:!0,children:a.jsx(Ke,{children:a.jsxs(st,{variant:"outline",role:"combobox",className:ae("w-full justify-between font-normal",!m.value&&"text-muted-foreground"),children:[a.jsx("span",{className:"truncate",children:m.value?((v=r.find(b=>b.id===m.value))==null?void 0:v.title)??"Tarefa não encontrada":"Selecione a tarefa-mãe..."}),a.jsx(Ir,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),a.jsxs(dr,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:[a.jsxs("div",{className:"flex items-center border-b px-3",children:[a.jsx(vn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),a.jsx("input",{className:"flex h-10 w-full bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground",placeholder:"Buscar tarefa...",value:u,onChange:b=>d(b.target.value)})]}),a.jsx("div",{className:"max-h-[200px] overflow-y-auto p-1",children:x.length===0?a.jsx("p",{className:"py-4 text-center text-sm text-muted-foreground",children:"Nenhuma tarefa encontrada."}):x.map(b=>a.jsxs("button",{type:"button",className:ae("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",m.value===b.id&&"bg-accent"),onClick:()=>{m.onChange(b.id),h(!1),d("")},children:[a.jsx(hr,{className:ae("mr-2 h-4 w-4",m.value===b.id?"opacity-100":"opacity-0")}),a.jsx("span",{className:"truncate",children:b.title})]},b.id))})]})]}),a.jsx(Xe,{})]})}}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx(Be,{control:p.control,name:"deadline",render:({field:m})=>a.jsxs($e,{children:[a.jsx(Ue,{children:"Prazo"}),a.jsx(Ke,{children:a.jsx(It,{type:"date",...m})}),a.jsx(Xe,{})]})}),a.jsx(Be,{control:p.control,name:"status",render:({field:m})=>a.jsxs($e,{children:[a.jsx(Ue,{children:"Status"}),a.jsxs(Te,{onValueChange:m.onChange,value:m.value,children:[a.jsx(Ke,{children:a.jsx(Ae,{children:a.jsx(Oe,{})})}),a.jsx(Me,{children:Pr.map(([v,b])=>a.jsx(W,{value:v,children:b},v))})]}),a.jsx(Xe,{})]})})]}),a.jsx(Be,{control:p.control,name:"assignee",render:({field:m})=>a.jsxs($e,{children:[a.jsx(Ue,{children:"Responsável"}),a.jsxs(Te,{onValueChange:v=>m.onChange(v==="_none_"?"":v),value:m.value||"_none_",children:[a.jsx(Ke,{children:a.jsx(Ae,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gr,{className:"w-3.5 h-3.5 text-muted-foreground"}),a.jsx(Oe,{placeholder:"Responsável..."})]})})}),a.jsxs(Me,{children:[a.jsx(W,{value:"_none_",children:"— Sem responsável —"}),mn.map(v=>a.jsx(W,{value:v,children:v},v))]})]}),a.jsx(Xe,{})]})}),a.jsx(Be,{control:p.control,name:"notes",render:({field:m})=>a.jsxs($e,{children:[a.jsx(Ue,{children:"Observações"}),a.jsx(Ke,{children:a.jsx(lr,{placeholder:"Observações...",className:"resize-none min-h-[80px]",...m})}),a.jsx(Xe,{})]})}),a.jsx(ir,{children:a.jsxs(st,{type:"submit",disabled:i,className:"w-full",children:[i&&a.jsx(pr,{className:"w-4 h-4 mr-2 animate-spin"}),o?"Criar Subtarefa":"Salvar Alterações"]})})]})})]})})}function Fr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const St=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function _e(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Kt(e){return"nodeType"in e}function H(e){var t,n;return e?_e(e)?e:Kt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Xt(e){const{Document:t}=H(e);return e instanceof t}function lt(e){return _e(e)?!1:e instanceof H(e).HTMLElement}function xn(e){return e instanceof H(e).SVGElement}function Ve(e){return e?_e(e)?e.document:Kt(e)?Xt(e)?e:lt(e)||xn(e)?e.ownerDocument:document:document:document}const ce=St?l.useLayoutEffect:l.useEffect;function Ct(e){const t=l.useRef(e);return ce(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Br(){const e=l.useRef(null),t=l.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function at(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return ce(()=>{n.current!==e&&(n.current=e)},t),n}function ct(e,t){const n=l.useRef();return l.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function mt(e){const t=Ct(e),n=l.useRef(null),r=l.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function vt(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let Tt={};function ut(e,t){return l.useMemo(()=>{if(t)return t;const n=Tt[e]==null?0:Tt[e]+1;return Tt[e]=n,e+"-"+n},[e,t])}function bn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((o,i)=>{const c=Object.entries(i);for(const[u,d]of c){const f=o[u];f!=null&&(o[u]=f+e*d)}return o},{...t})}}const Ye=bn(1),xt=bn(-1);function $r(e){return"clientX"in e&&"clientY"in e}function Dt(e){if(!e)return!1;const{KeyboardEvent:t}=H(e.target);return t&&e instanceof t}function Ur(e){if(!e)return!1;const{TouchEvent:t}=H(e.target);return t&&e instanceof t}function bt(e){if(Ur(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return $r(e)?{x:e.clientX,y:e.clientY}:null}const je=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[je.Translate.toString(e),je.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),tn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Kr(e){return e.matches(tn)?e:e.querySelector(tn)}const Xr={display:"none"};function Yr(e){let{id:t,value:n}=e;return L.createElement("div",{id:t,style:Xr},n)}function _r(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return L.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function Vr(){const[e,t]=l.useState("");return{announce:l.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const yn=l.createContext(null);function Wr(e){const t=l.useContext(yn);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Hr(){const[e]=l.useState(()=>new Set),t=l.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[l.useCallback(r=>{let{type:s,event:o}=r;e.forEach(i=>{var c;return(c=i[s])==null?void 0:c.call(i,o)})},[e]),t]}const qr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Gr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Jr(e){let{announcements:t=Gr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=qr}=e;const{announce:o,announcement:i}=Vr(),c=ut("DndLiveRegion"),[u,d]=l.useState(!1);if(l.useEffect(()=>{d(!0)},[]),Wr(l.useMemo(()=>({onDragStart(h){let{active:x}=h;o(t.onDragStart({active:x}))},onDragMove(h){let{active:x,over:p}=h;t.onDragMove&&o(t.onDragMove({active:x,over:p}))},onDragOver(h){let{active:x,over:p}=h;o(t.onDragOver({active:x,over:p}))},onDragEnd(h){let{active:x,over:p}=h;o(t.onDragEnd({active:x,over:p}))},onDragCancel(h){let{active:x,over:p}=h;o(t.onDragCancel({active:x,over:p}))}}),[o,t])),!u)return null;const f=L.createElement(L.Fragment,null,L.createElement(Yr,{id:r,value:s.draggable}),L.createElement(_r,{id:c,announcement:i}));return n?Ze.createPortal(f,n):f}var F;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(F||(F={}));function yt(){}function Qr(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Zr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ue=Object.freeze({x:0,y:0});function es(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ts(e,t){const n=bt(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function ns(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function rs(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function nn(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function ss(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const os=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=nn(t),o=[];for(const i of r){const{id:c}=i,u=n.get(c);if(u){const d=nn(u),f=s.reduce((x,p,y)=>x+es(d[y],p),0),h=Number((f/4).toFixed(4));o.push({id:c,data:{droppableContainer:i,value:h}})}}return o.sort(ns)};function as(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=s-r,c=o-n;if(r<s&&n<o){const u=t.width*t.height,d=e.width*e.height,f=i*c,h=f/(u+d-f);return Number(h.toFixed(4))}return 0}const is=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const o of r){const{id:i}=o,c=n.get(i);if(c){const u=as(c,t);u>0&&s.push({id:i,data:{droppableContainer:o,value:u}})}}return s.sort(rs)};function ls(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function wn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ue}function cs(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return s.reduce((i,c)=>({...i,top:i.top+e*c.y,bottom:i.bottom+e*c.y,left:i.left+e*c.x,right:i.right+e*c.x}),{...n})}}const us=cs(1);function Sn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ds(e,t,n){const r=Sn(t);if(!r)return e;const{scaleX:s,scaleY:o,x:i,y:c}=r,u=e.left-i-(1-s)*parseFloat(n),d=e.top-c-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),f=s?e.width/s:e.width,h=o?e.height/o:e.height;return{width:f,height:h,top:d,right:u+f,bottom:d+h,left:u}}const fs={ignoreTransform:!1};function We(e,t){t===void 0&&(t=fs);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:f}=H(e).getComputedStyle(e);d&&(n=ds(n,d,f))}const{top:r,left:s,width:o,height:i,bottom:c,right:u}=n;return{top:r,left:s,width:o,height:i,bottom:c,right:u}}function rn(e){return We(e,{ignoreTransform:!0})}function hs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function gs(e,t){return t===void 0&&(t=H(e).getComputedStyle(e)),t.position==="fixed"}function ps(e,t){t===void 0&&(t=H(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?n.test(o):!1})}function Yt(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(Xt(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!lt(s)||xn(s)||n.includes(s))return n;const o=H(e).getComputedStyle(s);return s!==e&&ps(s,o)&&n.push(s),gs(s,o)?n:r(s.parentNode)}return e?r(e):n}function Cn(e){const[t]=Yt(e,1);return t??null}function At(e){return!St||!e?null:_e(e)?e:Kt(e)?Xt(e)||e===Ve(e).scrollingElement?window:lt(e)?e:null:null}function Dn(e){return _e(e)?e.scrollX:e.scrollLeft}function jn(e){return _e(e)?e.scrollY:e.scrollTop}function zt(e){return{x:Dn(e),y:jn(e)}}var U;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(U||(U={}));function Nn(e){return!St||!e?!1:e===document.scrollingElement}function Rn(e){const t={x:0,y:0},n=Nn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:s,isLeft:o,isBottom:i,isRight:c,maxScroll:r,minScroll:t}}const ms={x:.2,y:.2};function vs(e,t,n,r,s){let{top:o,left:i,right:c,bottom:u}=n;r===void 0&&(r=10),s===void 0&&(s=ms);const{isTop:d,isBottom:f,isLeft:h,isRight:x}=Rn(e),p={x:0,y:0},y={x:0,y:0},m={height:t.height*s.y,width:t.width*s.x};return!d&&o<=t.top+m.height?(p.y=U.Backward,y.y=r*Math.abs((t.top+m.height-o)/m.height)):!f&&u>=t.bottom-m.height&&(p.y=U.Forward,y.y=r*Math.abs((t.bottom-m.height-u)/m.height)),!x&&c>=t.right-m.width?(p.x=U.Forward,y.x=r*Math.abs((t.right-m.width-c)/m.width)):!h&&i<=t.left+m.width&&(p.x=U.Backward,y.x=r*Math.abs((t.left+m.width-i)/m.width)),{direction:p,speed:y}}function xs(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function En(e){return e.reduce((t,n)=>Ye(t,zt(n)),ue)}function bs(e){return e.reduce((t,n)=>t+Dn(n),0)}function ys(e){return e.reduce((t,n)=>t+jn(n),0)}function Tn(e,t){if(t===void 0&&(t=We),!e)return;const{top:n,left:r,bottom:s,right:o}=t(e);Cn(e)&&(s<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ws=[["x",["left","right"],bs],["y",["top","bottom"],ys]];class _t{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Yt(n),s=En(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,i,c]of ws)for(const u of i)Object.defineProperty(this,u,{get:()=>{const d=c(r),f=s[o]-d;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class tt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Ss(e){const{EventTarget:t}=H(e);return e instanceof t?e:Ve(e)}function Ot(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var oe;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(oe||(oe={}));function sn(e){e.preventDefault()}function Cs(e){e.stopPropagation()}var T;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(T||(T={}));const An={start:[T.Space,T.Enter],cancel:[T.Esc],end:[T.Space,T.Enter,T.Tab]},Ds=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case T.Right:return{...n,x:n.x+25};case T.Left:return{...n,x:n.x-25};case T.Down:return{...n,y:n.y+25};case T.Up:return{...n,y:n.y-25}}};class On{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new tt(Ve(n)),this.windowListeners=new tt(H(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(oe.Resize,this.handleCancel),this.windowListeners.add(oe.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(oe.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Tn(r),n(ue)}handleKeyDown(t){if(Dt(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:o=An,coordinateGetter:i=Ds,scrollBehavior:c="smooth"}=s,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:d}=r.current,f=d?{x:d.left,y:d.top}:ue;this.referenceCoordinates||(this.referenceCoordinates=f);const h=i(t,{active:n,context:r.current,currentCoordinates:f});if(h){const x=xt(h,f),p={x:0,y:0},{scrollableAncestors:y}=r.current;for(const m of y){const v=t.code,{isTop:b,isRight:w,isLeft:C,isBottom:j,maxScroll:R,minScroll:N}=Rn(m),D=xs(m),S={x:Math.min(v===T.Right?D.right-D.width/2:D.right,Math.max(v===T.Right?D.left:D.left+D.width/2,h.x)),y:Math.min(v===T.Down?D.bottom-D.height/2:D.bottom,Math.max(v===T.Down?D.top:D.top+D.height/2,h.y))},I=v===T.Right&&!w||v===T.Left&&!C,k=v===T.Down&&!j||v===T.Up&&!b;if(I&&S.x!==h.x){const M=m.scrollLeft+x.x,Y=v===T.Right&&M<=R.x||v===T.Left&&M>=N.x;if(Y&&!x.y){m.scrollTo({left:M,behavior:c});return}Y?p.x=m.scrollLeft-M:p.x=v===T.Right?m.scrollLeft-R.x:m.scrollLeft-N.x,p.x&&m.scrollBy({left:-p.x,behavior:c});break}else if(k&&S.y!==h.y){const M=m.scrollTop+x.y,Y=v===T.Down&&M<=R.y||v===T.Up&&M>=N.y;if(Y&&!x.x){m.scrollTo({top:M,behavior:c});return}Y?p.y=m.scrollTop-M:p.y=v===T.Down?m.scrollTop-R.y:m.scrollTop-N.y,p.y&&m.scrollBy({top:-p.y,behavior:c});break}}this.handleMove(t,Ye(xt(h,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}On.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=An,onActivation:s}=t,{active:o}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function on(e){return!!(e&&"distance"in e)}function an(e){return!!(e&&"delay"in e)}class Vt{constructor(t,n,r){var s;r===void 0&&(r=Ss(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:i}=o;this.props=t,this.events=n,this.document=Ve(i),this.documentListeners=new tt(this.document),this.listeners=new tt(r),this.windowListeners=new tt(H(i)),this.initialCoordinates=(s=bt(o))!=null?s:ue,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(oe.Resize,this.handleCancel),this.windowListeners.add(oe.DragStart,sn),this.windowListeners.add(oe.VisibilityChange,this.handleCancel),this.windowListeners.add(oe.ContextMenu,sn),this.documentListeners.add(oe.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(an(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(on(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(oe.Click,Cs,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(oe.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:o}=this,{onMove:i,options:{activationConstraint:c}}=o;if(!s)return;const u=(n=bt(t))!=null?n:ue,d=xt(s,u);if(!r&&c){if(on(c)){if(c.tolerance!=null&&Ot(d,c.tolerance))return this.handleCancel();if(Ot(d,c.distance))return this.handleStart()}if(an(c)&&Ot(d,c.tolerance))return this.handleCancel();this.handlePending(c,d);return}t.cancelable&&t.preventDefault(),i(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===T.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const js={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Wt extends Vt{constructor(t){const{event:n}=t,r=Ve(n.target);super(t,js,r)}}Wt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Ns={move:{name:"mousemove"},end:{name:"mouseup"}};var Ft;(function(e){e[e.RightClick=2]="RightClick"})(Ft||(Ft={}));class Rs extends Vt{constructor(t){super(t,Ns,Ve(t.event.target))}}Rs.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Ft.RightClick?!1:(r==null||r({event:n}),!0)}}];const Mt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Es extends Vt{constructor(t){super(t,Mt)}static setup(){return window.addEventListener(Mt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Mt.move.name,t)};function t(){}}}Es.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var nt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(nt||(nt={}));var wt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(wt||(wt={}));function Ts(e){let{acceleration:t,activator:n=nt.Pointer,canScroll:r,draggingRect:s,enabled:o,interval:i=5,order:c=wt.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:f,delta:h,threshold:x}=e;const p=Os({delta:h,disabled:!o}),[y,m]=Br(),v=l.useRef({x:0,y:0}),b=l.useRef({x:0,y:0}),w=l.useMemo(()=>{switch(n){case nt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case nt.DraggableRect:return s}},[n,s,u]),C=l.useRef(null),j=l.useCallback(()=>{const N=C.current;if(!N)return;const D=v.current.x*b.current.x,S=v.current.y*b.current.y;N.scrollBy(D,S)},[]),R=l.useMemo(()=>c===wt.TreeOrder?[...d].reverse():d,[c,d]);l.useEffect(()=>{if(!o||!d.length||!w){m();return}for(const N of R){if((r==null?void 0:r(N))===!1)continue;const D=d.indexOf(N),S=f[D];if(!S)continue;const{direction:I,speed:k}=vs(N,S,w,t,x);for(const M of["x","y"])p[M][I[M]]||(k[M]=0,I[M]=0);if(k.x>0||k.y>0){m(),C.current=N,y(j,i),v.current=k,b.current=I;return}}v.current={x:0,y:0},b.current={x:0,y:0},m()},[t,j,r,m,o,i,JSON.stringify(w),JSON.stringify(p),y,d,R,f,JSON.stringify(x)])}const As={x:{[U.Backward]:!1,[U.Forward]:!1},y:{[U.Backward]:!1,[U.Forward]:!1}};function Os(e){let{delta:t,disabled:n}=e;const r=vt(t);return ct(s=>{if(n||!r||!s)return As;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[U.Backward]:s.x[U.Backward]||o.x===-1,[U.Forward]:s.x[U.Forward]||o.x===1},y:{[U.Backward]:s.y[U.Backward]||o.y===-1,[U.Forward]:s.y[U.Forward]||o.y===1}}},[n,t,r])}function Ms(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return ct(s=>{var o;return t==null?null:(o=r??s)!=null?o:null},[r,t])}function Is(e,t){return l.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,o=s.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...o]},[]),[e,t])}var it;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(it||(it={}));var Bt;(function(e){e.Optimized="optimized"})(Bt||(Bt={}));const ln=new Map;function ks(e,t){let{dragging:n,dependencies:r,config:s}=t;const[o,i]=l.useState(null),{frequency:c,measure:u,strategy:d}=s,f=l.useRef(e),h=v(),x=at(h),p=l.useCallback(function(b){b===void 0&&(b=[]),!x.current&&i(w=>w===null?b:w.concat(b.filter(C=>!w.includes(C))))},[x]),y=l.useRef(null),m=ct(b=>{if(h&&!n)return ln;if(!b||b===ln||f.current!==e||o!=null){const w=new Map;for(let C of e){if(!C)continue;if(o&&o.length>0&&!o.includes(C.id)&&C.rect.current){w.set(C.id,C.rect.current);continue}const j=C.node.current,R=j?new _t(u(j),j):null;C.rect.current=R,R&&w.set(C.id,R)}return w}return b},[e,o,n,h,u]);return l.useEffect(()=>{f.current=e},[e]),l.useEffect(()=>{h||p()},[n,h]),l.useEffect(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),l.useEffect(()=>{h||typeof c!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},c))},[c,h,p,...r]),{droppableRects:m,measureDroppableContainers:p,measuringScheduled:o!=null};function v(){switch(d){case it.Always:return!1;case it.BeforeDragging:return n;default:return!n}}}function Ht(e,t){return ct(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ls(e,t){return Ht(e,t)}function Ps(e){let{callback:t,disabled:n}=e;const r=Ct(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function jt(e){let{callback:t,disabled:n}=e;const r=Ct(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function zs(e){return new _t(We(e),e)}function cn(e,t,n){t===void 0&&(t=zs);const[r,s]=l.useState(null);function o(){s(u=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=u??n)!=null?d:null}const f=t(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const i=Ps({callback(u){if(e)for(const d of u){const{type:f,target:h}=d;if(f==="childList"&&h instanceof HTMLElement&&h.contains(e)){o();break}}}}),c=jt({callback:o});return ce(()=>{o(),e?(c==null||c.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),i==null||i.disconnect())},[e]),r}function Fs(e){const t=Ht(e);return wn(e,t)}const un=[];function Bs(e){const t=l.useRef(e),n=ct(r=>e?r&&r!==un&&e&&t.current&&e.parentNode===t.current.parentNode?r:Yt(e):un,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function $s(e){const[t,n]=l.useState(null),r=l.useRef(e),s=l.useCallback(o=>{const i=At(o.target);i&&n(c=>c?(c.set(i,zt(i)),new Map(c)):null)},[]);return l.useEffect(()=>{const o=r.current;if(e!==o){i(o);const c=e.map(u=>{const d=At(u);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,zt(d)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),r.current=e}return()=>{i(e),i(o)};function i(c){c.forEach(u=>{const d=At(u);d==null||d.removeEventListener("scroll",s)})}},[s,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,i)=>Ye(o,i),ue):En(e):ue,[e,t])}function dn(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const r=e!==ue;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?xt(e,n.current):ue}function Us(e){l.useEffect(()=>{if(!St)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Ks(e,t){return l.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:o}=r;return n[s]=i=>{o(i,t)},n},{}),[e,t])}function Mn(e){return l.useMemo(()=>e?hs(e):null,[e])}const fn=[];function Xs(e,t){t===void 0&&(t=We);const[n]=e,r=Mn(n?H(n):null),[s,o]=l.useState(fn);function i(){o(()=>e.length?e.map(u=>Nn(u)?r:new _t(t(u),u)):fn)}const c=jt({callback:i});return ce(()=>{c==null||c.disconnect(),i(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),s}function In(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return lt(t)?t:e}function Ys(e){let{measure:t}=e;const[n,r]=l.useState(null),s=l.useCallback(d=>{for(const{target:f}of d)if(lt(f)){r(h=>{const x=t(f);return h?{...h,width:x.width,height:x.height}:x});break}},[t]),o=jt({callback:s}),i=l.useCallback(d=>{const f=In(d);o==null||o.disconnect(),f&&(o==null||o.observe(f)),r(f?t(f):null)},[t,o]),[c,u]=mt(i);return l.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const _s=[{sensor:Wt,options:{}},{sensor:On,options:{}}],Vs={current:{}},pt={draggable:{measure:rn},droppable:{measure:rn,strategy:it.WhileDragging,frequency:Bt.Optimized},dragOverlay:{measure:We}};class rt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Ws={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new rt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:yt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:pt,measureDroppableContainers:yt,windowRect:null,measuringScheduled:!1},kn={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:yt,draggableNodes:new Map,over:null,measureDroppableContainers:yt},dt=l.createContext(kn),Ln=l.createContext(Ws);function Hs(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new rt}}}function qs(e,t){switch(t.type){case F.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case F.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case F.DragEnd:case F.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case F.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new rt(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case F.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new rt(e.droppable.containers);return i.set(n,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:i}}}case F.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const o=new rt(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Gs(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=l.useContext(dt),o=vt(r),i=vt(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!r&&o&&i!=null){if(!Dt(o)||document.activeElement===o.target)return;const c=s.get(i);if(!c)return;const{activatorNode:u,node:d}=c;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const f of[u.current,d.current]){if(!f)continue;const h=Kr(f);if(h){h.focus();break}}})}},[r,t,s,i,o]),null}function Pn(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...r}),n):n}function Js(e){return l.useMemo(()=>({draggable:{...pt.draggable,...e==null?void 0:e.draggable},droppable:{...pt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...pt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Qs(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const o=l.useRef(!1),{x:i,y:c}=typeof s=="boolean"?{x:s,y:s}:s;ce(()=>{if(!i&&!c||!t){o.current=!1;return}if(o.current||!r)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const f=n(d),h=wn(f,r);if(i||(h.x=0),c||(h.y=0),o.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const x=Cn(d);x&&x.scrollBy({top:h.y,left:h.x})}},[t,i,c,r,n])}const Nt=l.createContext({...ue,scaleX:1,scaleY:1});var De;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(De||(De={}));const Zs=l.memo(function(t){var n,r,s,o;let{id:i,accessibility:c,autoScroll:u=!0,children:d,sensors:f=_s,collisionDetection:h=is,measuring:x,modifiers:p,...y}=t;const m=l.useReducer(qs,void 0,Hs),[v,b]=m,[w,C]=Hr(),[j,R]=l.useState(De.Uninitialized),N=j===De.Initialized,{draggable:{active:D,nodes:S,translate:I},droppable:{containers:k}}=v,M=D!=null?S.get(D):null,Y=l.useRef({initial:null,translated:null}),_=l.useMemo(()=>{var V;return D!=null?{id:D,data:(V=M==null?void 0:M.data)!=null?V:Vs,rect:Y}:null},[D,M]),G=l.useRef(null),[pe,Ie]=l.useState(null),[B,ke]=l.useState(null),re=at(y,Object.values(y)),$=ut("DndDescribedBy",i),me=l.useMemo(()=>k.getEnabled(),[k]),P=Js(x),{droppableRects:ie,measureDroppableContainers:de,measuringScheduled:Ne}=ks(me,{dragging:N,dependencies:[I.x,I.y],config:P.droppable}),q=Ms(S,D),Le=l.useMemo(()=>B?bt(B):null,[B]),fe=Jn(),le=Ls(q,P.draggable.measure);Qs({activeNode:D!=null?S.get(D):null,config:fe.layoutShiftCompensation,initialRect:le,measure:P.draggable.measure});const A=cn(q,P.draggable.measure,le),Re=cn(q?q.parentElement:null),J=l.useRef({activatorEvent:null,active:null,activeNode:q,collisionRect:null,collisions:null,droppableRects:ie,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:k,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ve=k.getNodeFor((n=J.current.over)==null?void 0:n.id),g=Ys({measure:P.dragOverlay.measure}),E=(r=g.nodeRef.current)!=null?r:q,O=N?(s=g.rect)!=null?s:A:null,Q=!!(g.nodeRef.current&&g.rect),Z=Fs(Q?null:A),z=Mn(E?H(E):null),K=Bs(N?ve??q:null),Ee=Xs(K),be=Pn(p,{transform:{x:I.x-Z.x,y:I.y-Z.y,scaleX:1,scaleY:1},activatorEvent:B,active:_,activeNodeRect:A,containerNodeRect:Re,draggingNodeRect:O,over:J.current.over,overlayNodeRect:g.rect,scrollableAncestors:K,scrollableAncestorRects:Ee,windowRect:z}),qt=Le?Ye(Le,I):null,Gt=$s(K),Yn=dn(Gt),_n=dn(Gt,[A]),Pe=Ye(be,Yn),ze=O?us(O,be):null,He=_&&ze?h({active:_,collisionRect:ze,droppableRects:ie,droppableContainers:me,pointerCoordinates:qt}):null,Jt=ss(He,"id"),[ye,Qt]=l.useState(null),Vn=Q?be:Ye(be,_n),Wn=ls(Vn,(o=ye==null?void 0:ye.rect)!=null?o:null,A),Rt=l.useRef(null),Zt=l.useCallback((V,ee)=>{let{sensor:te,options:we}=ee;if(G.current==null)return;const se=S.get(G.current);if(!se)return;const ne=V.nativeEvent,he=new te({active:G.current,activeNode:se,event:ne,options:we,context:J,onAbort(X){if(!S.get(X))return;const{onDragAbort:ge}=re.current,xe={id:X};ge==null||ge(xe),w({type:"onDragAbort",event:xe})},onPending(X,Se,ge,xe){if(!S.get(X))return;const{onDragPending:Ge}=re.current,Ce={id:X,constraint:Se,initialCoordinates:ge,offset:xe};Ge==null||Ge(Ce),w({type:"onDragPending",event:Ce})},onStart(X){const Se=G.current;if(Se==null)return;const ge=S.get(Se);if(!ge)return;const{onDragStart:xe}=re.current,qe={activatorEvent:ne,active:{id:Se,data:ge.data,rect:Y}};Ze.unstable_batchedUpdates(()=>{xe==null||xe(qe),R(De.Initializing),b({type:F.DragStart,initialCoordinates:X,active:Se}),w({type:"onDragStart",event:qe}),Ie(Rt.current),ke(ne)})},onMove(X){b({type:F.DragMove,coordinates:X})},onEnd:Fe(F.DragEnd),onCancel:Fe(F.DragCancel)});Rt.current=he;function Fe(X){return async function(){const{active:ge,collisions:xe,over:qe,scrollAdjustedTranslate:Ge}=J.current;let Ce=null;if(ge&&Ge){const{cancelDrop:Je}=re.current;Ce={activatorEvent:ne,active:ge,collisions:xe,delta:Ge,over:qe},X===F.DragEnd&&typeof Je=="function"&&await Promise.resolve(Je(Ce))&&(X=F.DragCancel)}G.current=null,Ze.unstable_batchedUpdates(()=>{b({type:X}),R(De.Uninitialized),Qt(null),Ie(null),ke(null),Rt.current=null;const Je=X===F.DragEnd?"onDragEnd":"onDragCancel";if(Ce){const Et=re.current[Je];Et==null||Et(Ce),w({type:Je,event:Ce})}})}}},[S]),Hn=l.useCallback((V,ee)=>(te,we)=>{const se=te.nativeEvent,ne=S.get(we);if(G.current!==null||!ne||se.dndKit||se.defaultPrevented)return;const he={active:ne};V(te,ee.options,he)===!0&&(se.dndKit={capturedBy:ee.sensor},G.current=we,Zt(te,ee))},[S,Zt]),en=Is(f,Hn);Us(f),ce(()=>{A&&j===De.Initializing&&R(De.Initialized)},[A,j]),l.useEffect(()=>{const{onDragMove:V}=re.current,{active:ee,activatorEvent:te,collisions:we,over:se}=J.current;if(!ee||!te)return;const ne={active:ee,activatorEvent:te,collisions:we,delta:{x:Pe.x,y:Pe.y},over:se};Ze.unstable_batchedUpdates(()=>{V==null||V(ne),w({type:"onDragMove",event:ne})})},[Pe.x,Pe.y]),l.useEffect(()=>{const{active:V,activatorEvent:ee,collisions:te,droppableContainers:we,scrollAdjustedTranslate:se}=J.current;if(!V||G.current==null||!ee||!se)return;const{onDragOver:ne}=re.current,he=we.get(Jt),Fe=he&&he.rect.current?{id:he.id,rect:he.rect.current,data:he.data,disabled:he.disabled}:null,X={active:V,activatorEvent:ee,collisions:te,delta:{x:se.x,y:se.y},over:Fe};Ze.unstable_batchedUpdates(()=>{Qt(Fe),ne==null||ne(X),w({type:"onDragOver",event:X})})},[Jt]),ce(()=>{J.current={activatorEvent:B,active:_,activeNode:q,collisionRect:ze,collisions:He,droppableRects:ie,draggableNodes:S,draggingNode:E,draggingNodeRect:O,droppableContainers:k,over:ye,scrollableAncestors:K,scrollAdjustedTranslate:Pe},Y.current={initial:O,translated:ze}},[_,q,He,ze,S,E,O,ie,k,ye,K,Pe]),Ts({...fe,delta:I,draggingRect:ze,pointerCoordinates:qt,scrollableAncestors:K,scrollableAncestorRects:Ee});const qn=l.useMemo(()=>({active:_,activeNode:q,activeNodeRect:A,activatorEvent:B,collisions:He,containerNodeRect:Re,dragOverlay:g,draggableNodes:S,droppableContainers:k,droppableRects:ie,over:ye,measureDroppableContainers:de,scrollableAncestors:K,scrollableAncestorRects:Ee,measuringConfiguration:P,measuringScheduled:Ne,windowRect:z}),[_,q,A,B,He,Re,g,S,k,ie,ye,de,K,Ee,P,Ne,z]),Gn=l.useMemo(()=>({activatorEvent:B,activators:en,active:_,activeNodeRect:A,ariaDescribedById:{draggable:$},dispatch:b,draggableNodes:S,over:ye,measureDroppableContainers:de}),[B,en,_,A,b,$,S,ye,de]);return L.createElement(yn.Provider,{value:C},L.createElement(dt.Provider,{value:Gn},L.createElement(Ln.Provider,{value:qn},L.createElement(Nt.Provider,{value:Wn},d)),L.createElement(Gs,{disabled:(c==null?void 0:c.restoreFocus)===!1})),L.createElement(Jr,{...c,hiddenTextDescribedById:$}));function Jn(){const V=(pe==null?void 0:pe.autoScrollEnabled)===!1,ee=typeof u=="object"?u.enabled===!1:u===!1,te=N&&!V&&!ee;return typeof u=="object"?{...u,enabled:te}:{enabled:te}}}),eo=l.createContext(null),hn="button",to="Draggable";function no(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const o=ut(to),{activators:i,activatorEvent:c,active:u,activeNodeRect:d,ariaDescribedById:f,draggableNodes:h,over:x}=l.useContext(dt),{role:p=hn,roleDescription:y="draggable",tabIndex:m=0}=s??{},v=(u==null?void 0:u.id)===t,b=l.useContext(v?Nt:eo),[w,C]=mt(),[j,R]=mt(),N=Ks(i,t),D=at(n);ce(()=>(h.set(t,{id:t,key:o,node:w,activatorNode:j,data:D}),()=>{const I=h.get(t);I&&I.key===o&&h.delete(t)}),[h,t]);const S=l.useMemo(()=>({role:p,tabIndex:m,"aria-disabled":r,"aria-pressed":v&&p===hn?!0:void 0,"aria-roledescription":y,"aria-describedby":f.draggable}),[r,p,m,v,y,f.draggable]);return{active:u,activatorEvent:c,activeNodeRect:d,attributes:S,isDragging:v,listeners:r?void 0:N,node:w,over:x,setNodeRef:C,setActivatorNodeRef:R,transform:b}}function zn(){return l.useContext(Ln)}const ro="Droppable",so={timeout:25};function Fn(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const o=ut(ro),{active:i,dispatch:c,over:u,measureDroppableContainers:d}=l.useContext(dt),f=l.useRef({disabled:n}),h=l.useRef(!1),x=l.useRef(null),p=l.useRef(null),{disabled:y,updateMeasurementsFor:m,timeout:v}={...so,...s},b=at(m??r),w=l.useCallback(()=>{if(!h.current){h.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),p.current=null},v)},[v]),C=jt({callback:w,disabled:y||!i}),j=l.useCallback((S,I)=>{C&&(I&&(C.unobserve(I),h.current=!1),S&&C.observe(S))},[C]),[R,N]=mt(j),D=at(t);return l.useEffect(()=>{!C||!R.current||(C.disconnect(),h.current=!1,C.observe(R.current))},[R,C]),l.useEffect(()=>(c({type:F.RegisterDroppable,element:{id:r,key:o,disabled:n,node:R,rect:x,data:D}}),()=>c({type:F.UnregisterDroppable,key:o,id:r})),[r]),l.useEffect(()=>{n!==f.current.disabled&&(c({type:F.SetDroppableDisabled,id:r,key:o,disabled:n}),f.current.disabled=n)},[r,o,n,c]),{active:i,rect:x,isOver:(u==null?void 0:u.id)===r,node:R,over:u,setNodeRef:N}}function oo(e){let{animation:t,children:n}=e;const[r,s]=l.useState(null),[o,i]=l.useState(null),c=vt(n);return!n&&!r&&c&&s(c),ce(()=>{if(!o)return;const u=r==null?void 0:r.key,d=r==null?void 0:r.props.id;if(u==null||d==null){s(null);return}Promise.resolve(t(d,o)).then(()=>{s(null)})},[t,r,o]),L.createElement(L.Fragment,null,n,r?l.cloneElement(r,{ref:i}):null)}const ao={x:0,y:0,scaleX:1,scaleY:1};function io(e){let{children:t}=e;return L.createElement(dt.Provider,{value:kn},L.createElement(Nt.Provider,{value:ao},t))}const lo={position:"fixed",touchAction:"none"},co=e=>Dt(e)?"transform 250ms ease":void 0,uo=l.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:s,children:o,className:i,rect:c,style:u,transform:d,transition:f=co}=e;if(!c)return null;const h=s?d:{...d,scaleX:1,scaleY:1},x={...lo,width:c.width,height:c.height,top:c.top,left:c.left,transform:je.Transform.toString(h),transformOrigin:s&&r?ts(r,c):void 0,transition:typeof f=="function"?f(r):f,...u};return L.createElement(n,{className:i,style:x,ref:t},o)}),fo=e=>t=>{let{active:n,dragOverlay:r}=t;const s={},{styles:o,className:i}=e;if(o!=null&&o.active)for(const[c,u]of Object.entries(o.active))u!==void 0&&(s[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,u));if(o!=null&&o.dragOverlay)for(const[c,u]of Object.entries(o.dragOverlay))u!==void 0&&r.node.style.setProperty(c,u);return i!=null&&i.active&&n.node.classList.add(i.active),i!=null&&i.dragOverlay&&r.node.classList.add(i.dragOverlay),function(){for(const[u,d]of Object.entries(s))n.node.style.setProperty(u,d);i!=null&&i.active&&n.node.classList.remove(i.active)}},ho=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:je.Transform.toString(t)},{transform:je.Transform.toString(n)}]},go={duration:250,easing:"ease",keyframes:ho,sideEffects:fo({styles:{active:{opacity:"0"}}})};function po(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:s}=e;return Ct((o,i)=>{if(t===null)return;const c=n.get(o);if(!c)return;const u=c.node.current;if(!u)return;const d=In(i);if(!d)return;const{transform:f}=H(i).getComputedStyle(i),h=Sn(f);if(!h)return;const x=typeof t=="function"?t:mo(t);return Tn(u,s.draggable.measure),x({active:{id:o,data:c.data,node:u,rect:s.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:i,rect:s.dragOverlay.measure(d)},droppableContainers:r,measuringConfiguration:s,transform:h})})}function mo(e){const{duration:t,easing:n,sideEffects:r,keyframes:s}={...go,...e};return o=>{let{active:i,dragOverlay:c,transform:u,...d}=o;if(!t)return;const f={x:c.rect.left-i.rect.left,y:c.rect.top-i.rect.top},h={scaleX:u.scaleX!==1?i.rect.width*u.scaleX/c.rect.width:1,scaleY:u.scaleY!==1?i.rect.height*u.scaleY/c.rect.height:1},x={x:u.x-f.x,y:u.y-f.y,...h},p=s({...d,active:i,dragOverlay:c,transform:{initial:u,final:x}}),[y]=p,m=p[p.length-1];if(JSON.stringify(y)===JSON.stringify(m))return;const v=r==null?void 0:r({active:i,dragOverlay:c,...d}),b=c.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{b.onfinish=()=>{v==null||v(),w()}})}}let gn=0;function vo(e){return l.useMemo(()=>{if(e!=null)return gn++,gn},[e])}const xo=L.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:s,transition:o,modifiers:i,wrapperElement:c="div",className:u,zIndex:d=999}=e;const{activatorEvent:f,active:h,activeNodeRect:x,containerNodeRect:p,draggableNodes:y,droppableContainers:m,dragOverlay:v,over:b,measuringConfiguration:w,scrollableAncestors:C,scrollableAncestorRects:j,windowRect:R}=zn(),N=l.useContext(Nt),D=vo(h==null?void 0:h.id),S=Pn(i,{activatorEvent:f,active:h,activeNodeRect:x,containerNodeRect:p,draggingNodeRect:v.rect,over:b,overlayNodeRect:v.rect,scrollableAncestors:C,scrollableAncestorRects:j,transform:N,windowRect:R}),I=Ht(x),k=po({config:r,draggableNodes:y,droppableContainers:m,measuringConfiguration:w}),M=I?v.setRef:void 0;return L.createElement(io,null,L.createElement(oo,{animation:k},h&&D?L.createElement(uo,{key:D,id:h.id,ref:M,as:c,activatorEvent:f,adjustScale:t,className:u,transition:o,rect:I,style:{zIndex:d,...s},transform:S},n):null))});function Bn(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function bo(e,t){return e.reduce((n,r,s)=>{const o=t.get(r);return o&&(n[s]=o),n},Array(e.length))}function ft(e){return e!==null&&e>=0}function yo(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function wo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const $n=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const o=Bn(t,r,n),i=t[s],c=o[s];return!c||!i?null:{x:c.left-i.left,y:c.top-i.top,scaleX:c.width/i.width,scaleY:c.height/i.height}},ht={scaleX:1,scaleY:1},So=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:o,overIndex:i}=e;const c=(t=o[n])!=null?t:r;if(!c)return null;if(s===n){const d=o[i];return d?{x:0,y:n<i?d.top+d.height-(c.top+c.height):d.top-c.top,...ht}:null}const u=Co(o,s,n);return s>n&&s<=i?{x:0,y:-c.height-u,...ht}:s<n&&s>=i?{x:0,y:c.height+u,...ht}:{x:0,y:0,...ht}};function Co(e,t,n){const r=e[t],s=e[t-1],o=e[t+1];return r?n<t?s?r.top-(s.top+s.height):o?o.top-(r.top+r.height):0:o?o.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Un="Sortable",Kn=L.createContext({activeIndex:-1,containerId:Un,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:$n,disabled:{draggable:!1,droppable:!1}});function Do(e){let{children:t,id:n,items:r,strategy:s=$n,disabled:o=!1}=e;const{active:i,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:f}=zn(),h=ut(Un,n),x=c.rect!==null,p=l.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),y=i!=null,m=i?p.indexOf(i.id):-1,v=d?p.indexOf(d.id):-1,b=l.useRef(p),w=!yo(p,b.current),C=v!==-1&&m===-1||w,j=wo(o);ce(()=>{w&&y&&f(p)},[w,p,y,f]),l.useEffect(()=>{b.current=p},[p]);const R=l.useMemo(()=>({activeIndex:m,containerId:h,disabled:j,disableTransforms:C,items:p,overIndex:v,useDragOverlay:x,sortedRects:bo(p,u),strategy:s}),[m,h,j.draggable,j.droppable,C,p,v,u,x,s]);return L.createElement(Kn.Provider,{value:R},t)}const jo=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Bn(n,r,s).indexOf(t)},No=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:o,newIndex:i,previousItems:c,previousContainerId:u,transition:d}=e;return!d||!r||c!==o&&s===i?!1:n?!0:i!==s&&t===u},Ro={duration:200,easing:"ease"},Xn="transform",Eo=je.Transition.toString({property:Xn,duration:0,easing:"linear"}),To={roleDescription:"sortable"};function Ao(e){let{disabled:t,index:n,node:r,rect:s}=e;const[o,i]=l.useState(null),c=l.useRef(n);return ce(()=>{if(!t&&n!==c.current&&r.current){const u=s.current;if(u){const d=We(r.current,{ignoreTransform:!0}),f={x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height};(f.x||f.y)&&i(f)}}n!==c.current&&(c.current=n)},[t,n,r,s]),l.useEffect(()=>{o&&i(null)},[o]),o}function Oo(e){let{animateLayoutChanges:t=No,attributes:n,disabled:r,data:s,getNewIndex:o=jo,id:i,strategy:c,resizeObserverConfig:u,transition:d=Ro}=e;const{items:f,containerId:h,activeIndex:x,disabled:p,disableTransforms:y,sortedRects:m,overIndex:v,useDragOverlay:b,strategy:w}=l.useContext(Kn),C=Mo(r,p),j=f.indexOf(i),R=l.useMemo(()=>({sortable:{containerId:h,index:j,items:f},...s}),[h,s,j,f]),N=l.useMemo(()=>f.slice(f.indexOf(i)),[f,i]),{rect:D,node:S,isOver:I,setNodeRef:k}=Fn({id:i,data:R,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...u}}),{active:M,activatorEvent:Y,activeNodeRect:_,attributes:G,setNodeRef:pe,listeners:Ie,isDragging:B,over:ke,setActivatorNodeRef:re,transform:$}=no({id:i,data:R,attributes:{...To,...n},disabled:C.draggable}),me=Fr(k,pe),P=!!M,ie=P&&!y&&ft(x)&&ft(v),de=!b&&B,Ne=de&&ie?$:null,Le=ie?Ne??(c??w)({rects:m,activeNodeRect:_,activeIndex:x,overIndex:v,index:j}):null,fe=ft(x)&&ft(v)?o({id:i,items:f,activeIndex:x,overIndex:v}):j,le=M==null?void 0:M.id,A=l.useRef({activeId:le,items:f,newIndex:fe,containerId:h}),Re=f!==A.current.items,J=t({active:M,containerId:h,isDragging:B,isSorting:P,id:i,index:j,items:f,newIndex:A.current.newIndex,previousItems:A.current.items,previousContainerId:A.current.containerId,transition:d,wasDragging:A.current.activeId!=null}),ve=Ao({disabled:!J,index:j,node:S,rect:D});return l.useEffect(()=>{P&&A.current.newIndex!==fe&&(A.current.newIndex=fe),h!==A.current.containerId&&(A.current.containerId=h),f!==A.current.items&&(A.current.items=f)},[P,fe,h,f]),l.useEffect(()=>{if(le===A.current.activeId)return;if(le!=null&&A.current.activeId==null){A.current.activeId=le;return}const E=setTimeout(()=>{A.current.activeId=le},50);return()=>clearTimeout(E)},[le]),{active:M,activeIndex:x,attributes:G,data:R,rect:D,index:j,newIndex:fe,items:f,isOver:I,isSorting:P,isDragging:B,listeners:Ie,node:S,overIndex:v,over:ke,setNodeRef:me,setActivatorNodeRef:re,setDroppableNodeRef:k,setDraggableNodeRef:pe,transform:ve??Le,transition:g()};function g(){if(ve||Re&&A.current.newIndex===j)return Eo;if(!(de&&!Dt(Y)||!d)&&(P||J))return je.Transition.toString({...d,property:Xn})}}function Mo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}T.Down,T.Right,T.Up,T.Left;const Io=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"title",label:"Título (A → Z)"},{value:"status",label:"Status"}],pn={"A fazer":0,"Em andamento":1,Concluído:2},gt=["A fazer","Em andamento","Concluído"],ko={"A fazer":"border-t-red-500/60","Em andamento":"border-t-yellow-500/60",Concluído:"border-t-green-500/60"};function Lo(e,t){return[...e].sort((n,r)=>{switch(t){case"deadline":return!n.dueDate&&!r.dueDate?0:n.dueDate?r.dueDate?n.dueDate.localeCompare(r.dueDate):-1:1;case"title":return n.title.localeCompare(r.title,"pt-BR");case"status":return(pn[n.status]??0)-(pn[r.status]??0);default:return 0}})}function Po({id:e,children:t}){const{attributes:n,listeners:r,setNodeRef:s,transform:o,transition:i,isDragging:c}=Oo({id:e}),u={transform:je.Transform.toString(o),transition:i};return a.jsx("div",{ref:s,style:u,...n,...r,className:ae("touch-none",c&&"opacity-30"),children:t})}function zo({status:e,isOver:t,items:n,itemIds:r,today:s,onEdit:o,onDelete:i}){const{setNodeRef:c}=Fn({id:e});return a.jsxs("div",{className:ae("flex flex-col rounded-xl border border-border border-t-4 bg-card/40 min-h-[400px] transition-colors",ko[e]||"border-t-muted/60",t&&"bg-card/80 ring-2 ring-primary/20"),children:[a.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border shadow-sm bg-background/50 backdrop-blur-md rounded-t-xl",children:[a.jsx(et,{variant:"secondary",className:kt[e],children:ot[e]}),a.jsx(et,{variant:"secondary",className:"ml-auto text-xs bg-secondary/50",children:n.length})]}),a.jsxs("div",{ref:c,"data-column-status":e,className:"flex-1 p-3 space-y-3",children:[a.jsx(Do,{items:r,strategy:So,children:n.map(u=>a.jsx(Po,{id:u.id,children:a.jsx($t,{sub:u,today:s,onEdit:()=>o(u),onDelete:()=>i(u.id)})},u.id))}),n.length===0&&a.jsxs("div",{className:"sticky top-[40vh] flex flex-col items-center justify-center text-xs text-muted-foreground/50 border-2 border-dashed border-border/50 rounded-xl p-4 text-center gap-1",children:[a.jsx(et,{variant:"secondary",className:ae("font-medium mb-1",kt[e]),children:ot[e]}),a.jsx("span",{children:"Arraste subtarefas para cá"})]})]})]})}const $t=l.memo(function({sub:t,today:n,showStatus:r,onEdit:s,onDelete:o}){const i=t.dueDate&&t.dueDate<n&&t.status!=="Concluído";return a.jsx(Lt,{className:ae("transition-shadow duration-150",i&&"border-destructive/50"),children:a.jsx(Pt,{className:"p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[r&&a.jsx(et,{variant:"secondary",className:ae("text-[10px]",kt[t.status]),children:ot[t.status]}),i&&a.jsx(et,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),a.jsx("p",{className:ae("font-medium text-sm",t.completed&&"line-through text-muted-foreground"),children:t.title}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[a.jsx("span",{className:"font-medium",children:"Tarefa:"})," ",t.parentTaskTitle]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[t.projectName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Tr,{className:"w-3 h-3"}),t.projectName]}),t.assignee&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ar,{className:"w-3 h-3"}),t.assignee]}),t.dueDate&&a.jsxs("span",{className:ae("flex items-center gap-1",i&&"text-destructive font-medium"),children:[a.jsx(Or,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]}),t.notes&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.notes})]}),a.jsxs("div",{className:"flex gap-1 shrink-0",children:[a.jsx(st,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:s,children:a.jsx(fr,{className:"w-3.5 h-3.5"})}),a.jsx(st,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:o,children:a.jsx(Mr,{className:"w-3.5 h-3.5"})})]})]})})})});function la({tasks:e,projects:t,loading:n,onCreateSubtask:r,onUpdateSubtask:s,onDeleteSubtask:o}){const[i,c]=l.useState(!1),[u,d]=l.useState(null),[f,h]=l.useState("kanban"),[x,p]=l.useState(""),[y,m]=l.useState("all"),[v,b]=l.useState("all"),[w,C]=l.useState("all"),[j,R]=l.useState("all"),[N,D]=l.useState("all"),[S,I]=l.useState("deadline"),[k,M]=l.useState(!1),[Y,_]=l.useState(null),[G,pe]=l.useState(null),[Ie,B]=l.useState(null),ke=Zr(Qr(Wt,{activationConstraint:{distance:8}})),re=l.useMemo(()=>{const g={};return t.forEach(E=>{g[E.id]=E.name}),g},[t]),$=l.useMemo(()=>e.flatMap(g=>g.subtasks.map(E=>({...E,parentTaskTitle:g.title,projectId:g.projectId,projectName:g.projectId?re[g.projectId]:void 0}))),[e,re]),me=l.useMemo(()=>{const g=new Date,E=new Date(g.getFullYear(),g.getMonth(),g.getDate()),O=new Date(E);O.setDate(E.getDate()+(7-E.getDay()));const Q=new Date(g.getFullYear(),g.getMonth()+1,0),Z=$.filter(z=>{if(x&&!z.title.toLowerCase().includes(x.toLowerCase())||y!=="all"&&z.status!==y||v!=="all"&&z.assignee!==v||w!=="all"&&z.projectId!==w||j!=="all"&&z.parentTaskId!==j)return!1;if(N!=="all"){if(!z.dueDate)return N==="sem_prazo";const K=new Date(z.dueDate+"T23:59:59");switch(N){case"atrasadas":return K<E&&z.status!=="Concluído";case"hoje":return z.dueDate===P;case"esta_semana":return K>=E&&K<=O;case"este_mes":return K>=E&&K<=Q;case"sem_prazo":return!1}}return!0});return Lo(Z,S)},[$,x,y,v,w,j,S]),P=l.useMemo(()=>{const g=new Date;return`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}`},[]);l.useMemo(()=>{const g={"A fazer":0,"Em andamento":0,Concluído:0},E=$.filter(O=>O.dueDate&&O.dueDate<P&&O.status!=="Concluído").length;return $.forEach(O=>{g[O.status]!==void 0&&g[O.status]++}),{...g,overdue:E,total:$.length}},[$,P]);const ie=l.useCallback(()=>{d(null),c(!0)},[]),de=l.useCallback(g=>{d(g),c(!0)},[]),Ne=l.useCallback(async(g,E,O)=>{E?await r(g.parentTaskId,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0}):O&&await s(O,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0})},[r,s]),q=l.useCallback(async()=>{Y&&(await o(Y),_(null))},[Y,o]),Le=l.useMemo(()=>{const g={"A fazer":[],"Em andamento":[],Concluído:[]};return me.forEach(E=>{g[E.status]&&g[E.status].push(E)}),g},[me]),fe=l.useCallback(g=>{pe(String(g.active.id))},[]),le=l.useCallback(g=>{const{over:E}=g;if(!E){B(null);return}const O=String(E.id),Q=$.find(z=>z.id===O),Z=Q?Q.status:gt.includes(O)?O:null;B(Z)},[$]),A=l.useCallback(async g=>{const{active:E,over:O}=g;if(pe(null),B(null),!O)return;const Q=String(E.id),Z=String(O.id);if(Q===Z)return;const z=$.find(be=>be.id===Q);if(!z)return;const K=$.find(be=>be.id===Z),Ee=K?K.status:gt.includes(Z)?Z:z.status;z.status!==Ee&&await s(Q,{status:Ee})},[$,s]),Re=l.useCallback(()=>{pe(null),B(null)},[]),J=G?$.find(g=>g.id===G):null,ve=l.useMemo(()=>gt.filter(g=>!k||g!=="Concluído"),[k]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-3 glass p-4 rounded-xl border border-border shadow-sm mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[a.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[a.jsx(vn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),a.jsx(It,{placeholder:"Buscar subtarefa...",value:x,onChange:g=>p(g.target.value),className:"pl-9 w-full text-sm"})]}),a.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[a.jsxs(st,{onClick:ie,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity h-9",children:[a.jsx(Rr,{className:"mr-1.5 h-4 w-4"})," Nova Subtarefa"]}),a.jsxs("div",{className:"flex border border-border rounded-lg overflow-hidden bg-muted/40",children:[a.jsxs("button",{onClick:()=>h("kanban"),className:ae("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",f==="kanban"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[a.jsx(kr,{className:"w-4 h-4"})," Kanban"]}),a.jsxs("button",{onClick:()=>h("list"),className:ae("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",f==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[a.jsx(Er,{className:"w-4 h-4"})," Lista"]})]})]})]}),a.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap flex-1",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Status"}),a.jsxs(Te,{value:y,onValueChange:m,children:[a.jsx(Ae,{className:"w-[130px] h-8 text-xs",children:a.jsx(Oe,{placeholder:"Todos Status"})}),a.jsxs(Me,{children:[a.jsx(W,{value:"all",children:"Todos Status"}),gt.map(g=>a.jsx(W,{value:g,children:ot[g]},g))]})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prazo"}),a.jsxs(Te,{value:N,onValueChange:D,children:[a.jsx(Ae,{className:"w-[120px] h-8 text-xs",children:a.jsx(Oe,{placeholder:"Todos"})}),a.jsxs(Me,{children:[a.jsx(W,{value:"all",children:"Todos"}),a.jsx(W,{value:"atrasadas",children:"Atrasadas"}),a.jsx(W,{value:"hoje",children:"Vence hoje"}),a.jsx(W,{value:"esta_semana",children:"Esta semana"}),a.jsx(W,{value:"este_mes",children:"Este mês"}),a.jsx(W,{value:"sem_prazo",children:"Sem prazo"})]})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Responsável"}),a.jsxs(Te,{value:v,onValueChange:b,children:[a.jsx(Ae,{className:"w-[120px] h-8 text-xs",children:a.jsx(Oe,{placeholder:"Todos"})}),a.jsxs(Me,{children:[a.jsx(W,{value:"all",children:"Todos"}),mn.map(g=>a.jsx(W,{value:g,children:g},g))]})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Tarefa-mãe"}),a.jsxs(Te,{value:j,onValueChange:R,children:[a.jsx(Ae,{className:"w-[160px] h-8 text-xs",children:a.jsx(Oe,{placeholder:"Todas"})}),a.jsxs(Me,{children:[a.jsx(W,{value:"all",children:"Todas"}),e.map(g=>a.jsx(W,{value:g.id,children:g.title},g.id))]})]})]}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Ordenar por"}),a.jsxs(Te,{value:S,onValueChange:g=>I(g),children:[a.jsx(Ae,{className:"w-[160px] h-8 text-xs",children:a.jsx(Oe,{})}),a.jsx(Me,{children:Io.map(g=>a.jsx(W,{value:g.value,children:g.label},g.value))})]})]})]}),a.jsx("div",{className:"flex flex-col gap-1.5 ml-auto shrink-0",children:a.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar concluídas",a.jsx(Nr,{checked:k,onCheckedChange:M,className:"scale-75"})]})})]})]}),a.jsx(zr,{open:i,onOpenChange:c,subtask:u,tasks:e,onSave:Ne}),a.jsx(xr,{open:!!Y,onOpenChange:g=>!g&&_(null),children:a.jsxs(br,{children:[a.jsxs(yr,{children:[a.jsx(wr,{children:"Remover subtarefa?"}),a.jsx(Sr,{children:"Esta ação não pode ser desfeita. A subtarefa será removida permanentemente."})]}),a.jsxs(Cr,{children:[a.jsx(Dr,{children:"Cancelar"}),a.jsx(jr,{onClick:q,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?a.jsx("div",{className:"space-y-3",children:[1,2,3].map(g=>a.jsx(Lt,{children:a.jsx(Pt,{className:"p-4",children:a.jsx("div",{className:"h-16 bg-muted animate-pulse rounded"})})},g))}):f==="list"?a.jsx("div",{className:"space-y-3",children:me.length===0?a.jsx(Lt,{children:a.jsx(Pt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma subtarefa encontrada."})}):me.map(g=>a.jsx($t,{sub:g,today:P,showStatus:!0,onEdit:()=>de(g),onDelete:()=>_(g.id)},g.id))}):a.jsxs(Zs,{sensors:ke,collisionDetection:os,onDragStart:fe,onDragOver:le,onDragEnd:A,onDragCancel:Re,children:[a.jsx("div",{className:"overflow-x-auto -mx-2 px-2 pb-4",children:a.jsx("div",{className:"flex gap-4",style:{minWidth:`${ve.length*300}px`},children:ve.map(g=>{const E=Ie===g,O=Le[g],Q=O.map(Z=>Z.id);return a.jsx("div",{className:"flex-1 min-w-[260px]",children:a.jsx(zo,{status:g,isOver:E,items:O,itemIds:Q,today:P,onEdit:de,onDelete:_})},g)})})}),a.jsx(xo,{children:J&&a.jsx("div",{className:"shadow-xl ring-2 ring-primary/30 rotate-[2deg] scale-105",children:a.jsx($t,{sub:J,today:P,showStatus:!0,onEdit:()=>{},onDelete:()=>{}})})})]})]})}export{kr as C,Zs as D,Wt as P,ia as S,Qr as a,xo as b,os as c,la as d,Fn as e,Do as f,Oo as g,je as h,Zr as u,So as v};
