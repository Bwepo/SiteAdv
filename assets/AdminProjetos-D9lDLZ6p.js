import{c as Ee,r as t,s as w,a0 as Re,U as Be,h as N,j as e,m as L,e as x,X as Ve}from"./index-Bi6fXPkN.js";import{b as ze,a as Ge,u as He}from"./crmTypes-DMcrRG2c.js";import{B as O,P as qe}from"./badge-DIQK51KO.js";import{U as be,P as ye}from"./TipTapEditor-B6Vc8VEa.js";import{S as $e}from"./skeleton-DpeCQ-rV.js";import{B as E}from"./button-CIMEXK4J.js";import{S as ie,a as ne,b as le,c as ce,d as M}from"./select-BVxP8cnt.js";import{D as Je,a as Xe,c as Ke,d as We,f as Qe}from"./dialog-CGV7qW4F.js";import{A as Ye,a as Ze,b as ea,c as aa,d as sa,e as ra,f as ta,g as oa}from"./alert-dialog-_Xo6vaI3.js";import{I as we}from"./input-fxnufI8S.js";import{L as D}from"./label-B5iS1324.js";import{P as ia}from"./ProjectOverview-C-Nj_Blq.js";import{C as na}from"./ClientSelect-CRJkz0RE.js";import la from"./AdminAgenda-BQPmOvfI.js";import{A as Ne,L as ca}from"./AdminTarefas-bRiPojqw.js";import{F as Ce}from"./folder-kanban-CtZ9e8X7.js";import{L as da}from"./list-QsmtIyPC.js";import{C as ma}from"./chevron-left-BkuJjm-M.js";import{L as de}from"./loader-circle-BcDjfpal.js";import{L as ke}from"./list-todo-BN8OJjmY.js";import{C as pe}from"./calendar-B6Y8_SJ0.js";import{C as pa}from"./circle-check-BlYflz_y.js";import{C as ua}from"./clipboard-list-D6p2FHKY.js";import"./useQuery-BnhfeGZd.js";import"./index-CEE0JnHj.js";import"./dropdown-menu-BFWPqSJJ.js";import"./index-CL8ZcC2a.js";import"./index-keeIb-8m.js";import"./index-CQk61hWp.js";import"./chevron-right-BP2gIf5g.js";import"./check-BcR7RGjd.js";import"./tabs-BfnChziO.js";import"./link-DRKIMcSW.js";import"./quote-BpFM9iur.js";import"./trash-2-BEL-FTn4.js";import"./index-Dd1vnD_E.js";import"./chevron-up-Md0gtQ3y.js";import"./index-Cl2EFUDv.js";import"./card--IkLb4h4.js";import"./trending-up-DUtoNI7W.js";import"./clock-29kLRTcr.js";import"./triangle-alert-D2FprzBk.js";import"./popover-DLpJMYg7.js";import"./search-BI7EHze9.js";import"./CrmSkeletons-BV1_34Aj.js";import"./checkbox-CZxNLWpk.js";import"./pencil-BshQjtuw.js";import"./arrow-up-down-C60z95Jt.js";import"./scroll-area-NMxFWeyC.js";import"./AgendaEventSheet-Bpti36BX.js";import"./form-Bzh_WqSv.js";import"./DatePickerInput-BDckuqB3.js";import"./pt-BR-ZY5I46FX.js";import"./sheet-Cte1iECS.js";import"./textarea-DmkJNqaS.js";import"./useCrmFieldOptions-Dw7aB_VX.js";import"./useMutation-D2C76tz9.js";import"./types-Ba-nZvwf.js";import"./users-Q5GnH0XQ.js";import"./map-pin-mQmSd8_o.js";import"./formatters-CjApKTaw.js";import"./download-Bs8_q2LC.js";import"./file-text-DeWhd_4q.js";import"./purify.es-D9RiKzGB.js";import"./TarefaSheet-BPKk6r8o.js";import"./separator-ByI1QcPJ.js";import"./ProcessosList-pkth_dnR.js";import"./scale-B3sEnIz8.js";import"./user-cK0CbHAb.js";import"./switch-DVnn8U_s.js";import"./sortable.esm-D9g1FOcr.js";import"./filter-DlV_o9o1.js";import"./circle-x-B4dxxQ3G.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=Ee("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=Ee("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),me="mladv-project-covers",_e=800,Se=600,ga=.8,ha=5*1024*1024;async function fa(i){return new Promise((h,C)=>{const p=new Image,k=URL.createObjectURL(i);p.onload=()=>{URL.revokeObjectURL(k);let{width:f,height:l}=p;if(f>_e||l>Se){const m=Math.min(_e/f,Se/l);f=Math.round(f*m),l=Math.round(l*m)}const o=document.createElement("canvas");o.width=f,o.height=l;const v=o.getContext("2d");if(!v){C(new Error("Canvas não suportado"));return}v.drawImage(p,0,0,f,l),o.toBlob(m=>{if(!m){C(new Error("Falha ao comprimir imagem"));return}h(m)},"image/jpeg",ga)},p.onerror=()=>{URL.revokeObjectURL(k),C(new Error("Falha ao carregar imagem para compressão"))},p.src=k})}async function va(i){try{return{blob:await fa(i),contentType:"image/jpeg"}}catch(h){return console.warn("[CoverUpload] Compressão falhou, enviando original:",h),{blob:i,contentType:i.type}}}function ja(){const[i,h]=t.useState(!1),[C,p]=t.useState(0);return{uploadCover:async(l,o)=>{h(!0),p(0);try{if(!["image/jpeg","image/png","image/webp","image/gif"].includes(o.type))throw new Error("Tipo não permitido. Use JPEG, PNG, WebP ou GIF.");if(o.size>ha)throw new Error("Arquivo muito grande. Máximo de 5MB.");p(10);const{blob:m,contentType:y}=await va(o);p(40);const G=y==="image/jpeg"?"jpg":o.name.split(".").pop()||"jpg",_=`covers/${`${l}-${Date.now()}.${G}`}`,{error:j}=await w.storage.from(me).upload(_,m,{contentType:y,cacheControl:"3600",upsert:!1});if(j)throw new Error(j.message);p(70);const{data:F}=w.storage.from(me).getPublicUrl(_),{data:g}=await w.from("mladv_crm_projetos").select("raw_fields").eq("airtable_id",l).single(),T=(g==null?void 0:g.raw_fields)||{},{error:A}=await w.from("mladv_crm_projetos").update({raw_fields:{...T,cover_url:F.publicUrl}}).eq("airtable_id",l);if(A)throw new Error(A.message);return p(100),{url:F.publicUrl,path:_}}finally{h(!1)}},removeCover:async(l,o)=>{try{const y=o.match(/\/object\/public\/mladv-project-covers\/(.+)$/);y&&await w.storage.from(me).remove([y[1]])}catch{}const{data:v}=await w.from("mladv_crm_projetos").select("raw_fields").eq("airtable_id",l).single(),m=(v==null?void 0:v.raw_fields)||{};delete m.cover_url,await w.from("mladv_crm_projetos").update({raw_fields:m}).eq("airtable_id",l)},isUploading:i,progress:C}}const z={Ativo:"bg-green-600/90 text-white border-green-600/50","Em Espera":"bg-yellow-600/90 text-white border-yellow-600/50",Concluído:"bg-blue-600/90 text-white border-blue-600/50",Cancelado:"bg-red-600/90 text-white border-red-600/50"},ba=[{id:"visao_geral",label:"Visão Geral",icon:pa},{id:"agenda",label:"Agenda",icon:pe},{id:"tarefas",label:"Tarefas",icon:ua},{id:"subtarefas",label:"Subtarefas",icon:ca}],ya=["Ativo","Em Espera","Concluído","Cancelado"],wa=["Extra","CLT","Pessoal"];function zs(){const{projects:i,loading:h,error:C,createProject:p,updateProject:k,deleteProject:f}=ze(),l=()=>{},{tasks:o,loading:v}=Ge(),{events:m}=He(),{uploadCover:y,removeCover:G,isUploading:P}=ja(),_=t.useRef(null),[j,F]=t.useState(null),[g,T]=t.useState(null),[A,R]=Re(),u=A.get("projeto")||null,S=A.get("tab")||"visao_geral",B=t.useCallback(a=>{R(r=>(a?(r.set("projeto",a),r.has("tab")||r.set("tab","visao_geral")):(r.delete("projeto"),r.delete("tab")),r),{replace:!0})},[R]),De=t.useCallback(a=>{R(r=>(r.set("tab",a),r),{replace:!0})},[R]),{prefs:Pe,updatePref:Te}=Be(),H=Pe.project_view_mode,ue=a=>Te("project_view_mode",a),[Ae,I]=t.useState(!1),[n,xe]=t.useState(null),[U,q]=t.useState(""),[$,J]=t.useState("Ativo"),[X,K]=t.useState(""),[W,Q]=t.useState(""),[Y,Z]=t.useState(""),[ge,he]=t.useState(!1),[ee,fe]=t.useState(null),ae=async(a,r)=>{try{await y(a,r),N.success("Capa atualizada!"),l()}catch(s){N.error("Erro ao enviar capa: "+s.message)}},Ie=async(a,r)=>{try{await G(a,r),N.success("Capa removida"),l()}catch(s){N.error("Erro ao remover capa: "+s.message)}},se=(a,r)=>{var s;r.stopPropagation(),F(a),(s=_.current)==null||s.click()},Ue=a=>{var s;const r=(s=a.target.files)==null?void 0:s[0];r&&j&&ae(j,r),a.target.value=""},re=t.useCallback((a,r)=>{a.preventDefault(),a.stopPropagation(),T(r)},[]),te=t.useCallback(a=>{a.preventDefault(),a.stopPropagation(),T(null)},[]),oe=t.useCallback((a,r)=>{var c;a.preventDefault(),a.stopPropagation(),T(null);const s=(c=a.dataTransfer.files)==null?void 0:c[0];s&&s.type.startsWith("image/")?ae(r,s):s&&N.error("Apenas imagens são permitidas.")},[ae]),b=t.useMemo(()=>i.find(a=>a.id===u)||null,[i,u]),ve=t.useMemo(()=>{if(!i.length||!o.length)return new Map;const a=new Map;return i.forEach(r=>{const s=o.filter(d=>d.projectId===r.id&&d.status!=="cancelada"),c=s.filter(d=>d.status==="concluida").length;a.set(r.id,{total:s.length,concluidas:c})}),a},[i,o]),Le=t.useMemo(()=>{if(!u)return{visao_geral:0,agenda:0,tarefas:0,subtarefas:0};const a=o.filter(c=>c.projectId===u),r=a.flatMap(c=>c.subtasks);return{visao_geral:0,agenda:m.filter(c=>c.projectId===u).length,tarefas:a.length,subtarefas:r.length}},[u,o,m]),Oe=()=>{xe(null),q(""),J("Ativo"),K(""),Q(""),Z(""),I(!0)},Me=a=>{xe(a),q(a.name),J(a.status||"Ativo"),K(a.tipo||""),Q(a.observacoes||""),Z(a.cliente||""),I(!0)},je=async()=>{if(U.trim()){he(!0);try{n?await k(n.id,{name:U.trim(),status:$,tipo:X||void 0,observacoes:W||void 0,cliente:Y||void 0}):await p({name:U.trim(),status:$,tipo:X||void 0,observacoes:W||void 0,cliente:Y||void 0}),I(!1)}catch(a){N.error("Erro ao salvar projeto: "+a.message)}finally{he(!1)}}},Fe=async()=>{if(ee)try{await f(ee)}catch(a){N.error("Erro ao remover projeto: "+a.message)}finally{fe(null)}};return h||v?e.jsxs("div",{className:"space-y-6 pb-20 md:pb-0",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Projetos"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[1,2,3,4].map(a=>e.jsx($e,{className:"h-40 w-full rounded-xl"},a))})]}):e.jsxs(L.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6 pb-20 md:pb-0",children:[e.jsx("input",{ref:_,type:"file",accept:"image/jpeg,image/png,image/webp,image/gif",onChange:Ue,className:"hidden"}),u?e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsxs(E,{variant:"ghost",size:"sm",className:"gap-1.5 text-muted-foreground hover:text-foreground shrink-0",onClick:()=>B(null),children:[e.jsx(ma,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Voltar"})]}),e.jsx("span",{className:"text-base sm:text-lg font-semibold text-foreground truncate",children:b==null?void 0:b.name}),b&&e.jsx(O,{variant:"outline",className:x("text-[10px] px-1.5 py-0 shrink-0",z[b.status]||"bg-secondary text-secondary-foreground"),children:b.status})]}),e.jsx(E,{variant:"outline",size:"sm",className:"text-xs h-8 shrink-0 w-full sm:w-auto",onClick:()=>b&&Me(b),children:"Editar projeto"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Projetos"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(O,{variant:"secondary",className:"text-xs",children:[i.length," projetos"]}),e.jsxs(E,{onClick:Oe,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity",children:[e.jsx(qe,{className:"mr-2 h-4 w-4"})," Novo Projeto"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 max-w-md",children:[e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsxs(ie,{value:"none",onValueChange:a=>a!=="none"&&B(a),children:[e.jsx(ne,{className:"bg-background/50",children:e.jsx(le,{placeholder:"Selecionar projeto..."})}),e.jsxs(ce,{children:[e.jsx(M,{value:"none",children:"Selecionar projeto..."}),i.map(a=>e.jsx(M,{value:a.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:a.name}),e.jsx(O,{variant:"outline",className:x("text-[9px] px-1 py-0 ml-1",z[a.status]||"bg-secondary text-secondary-foreground"),children:a.status})]})},a.id))]})]})]}),e.jsxs("div",{className:"flex items-center gap-0.5 rounded-lg border border-border bg-muted/40 p-0.5",children:[e.jsx("button",{onClick:()=>ue("list"),className:x("rounded-md p-1.5 transition-colors",H==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:e.jsx(da,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ue("cards"),className:x("rounded-md p-1.5 transition-colors",H==="cards"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:e.jsx(xa,{className:"h-4 w-4"})})]})]})]}),u?e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 scrollbar-none",children:e.jsx("div",{className:"flex items-center gap-1 rounded-2xl border border-border bg-muted/40 p-1 w-fit backdrop-blur-sm",children:ba.map(a=>{const r=S===a.id,s=a.icon;return e.jsxs("button",{onClick:()=>De(a.id),className:x("relative flex items-center gap-1.5 sm:gap-2 rounded-xl px-3 sm:px-5 py-2 sm:py-2.5 text-xs sm:text-sm font-medium transition-all duration-200 whitespace-nowrap",r?"text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-background/50"),children:[r&&e.jsx(L.div,{layoutId:"project-tab-bg",className:"absolute inset-0 rounded-xl gold-gradient shadow-sm",transition:{type:"spring",bounce:.15,duration:.5}}),e.jsxs("span",{className:"relative z-10 flex items-center gap-1.5 sm:gap-2",children:[e.jsx(s,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:a.label}),e.jsx("span",{className:"sm:hidden",children:a.id==="visao_geral"?"Geral":a.label}),a.id!=="visao_geral"&&e.jsx("span",{className:x("inline-flex items-center justify-center rounded-full px-1.5 sm:px-2 py-0.5 text-[10px] font-semibold tabular-nums min-w-[20px] transition-colors",r?"bg-primary-foreground/20 text-primary-foreground":"bg-secondary text-muted-foreground"),children:Le[a.id]})]})]},a.id)})})}),e.jsxs(L.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.2},children:[S==="visao_geral"&&e.jsx(ia,{projectId:u,tasks:o,events:m}),S==="agenda"&&e.jsx(la,{projectId:u,hideHeader:!0}),S==="tarefas"&&e.jsx(Ne,{projectId:u,hideHeader:!0,forceTab:"tarefas"}),S==="subtarefas"&&e.jsx(Ne,{projectId:u,hideHeader:!0,forceTab:"subtarefas"})]},`${u}-${S}`)]}):H==="list"?e.jsx("div",{className:"space-y-2",children:i.map((a,r)=>{const s=ve.get(a.id),c=s&&s.total>0?Math.round(s.concluidas/s.total*100):0;return e.jsxs(L.div,{initial:{opacity:0,x:-8},animate:{opacity:1,x:0},transition:{delay:r*.03},onClick:()=>B(a.id),className:"group flex items-center gap-4 rounded-lg border border-border bg-card p-3 cursor-pointer hover:border-primary/40 hover:bg-card/90 transition-all duration-200",children:[e.jsxs("div",{className:x("shrink-0 w-24 aspect-[4/3] rounded-md overflow-hidden border-2 bg-muted/20 flex items-center justify-center relative group/thumb transition-all",g===a.id?"border-primary border-dashed ring-2 ring-primary/30":"border-border/50"),onDragOver:d=>re(d,a.id),onDragLeave:te,onDrop:d=>oe(d,a.id),children:[a.coverUrl?e.jsx("img",{src:a.coverUrl,alt:a.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-accent/10 via-muted/30 to-muted/10 flex items-center justify-center",children:g===a.id?e.jsx(be,{className:"h-5 w-5 text-primary animate-pulse"}):e.jsx(Ce,{className:"h-5 w-5 text-accent/40"})}),e.jsx("button",{onClick:d=>se(a.id,d),className:"absolute inset-0 bg-black/50 opacity-0 group-hover/thumb:opacity-100 transition-opacity flex items-center justify-center",children:P&&j===a.id?e.jsx(de,{className:"h-4 w-4 text-white animate-spin"}):e.jsx(V,{className:"h-4 w-4 text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground truncate",children:a.name}),e.jsx(O,{variant:"outline",className:x("text-[9px] px-1.5 py-0 shrink-0",z[a.status]||"bg-secondary text-secondary-foreground"),children:a.status})]}),e.jsxs("div",{className:"flex items-center gap-3 text-[11px] text-muted-foreground",children:[a.tipo&&e.jsx("span",{children:a.tipo}),a.observacoes&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-border",children:"•"}),e.jsx("span",{className:"truncate",children:a.observacoes})]})]})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-5 shrink-0",children:[e.jsxs("div",{className:"w-32 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ke,{className:"h-3 w-3"}),(s==null?void 0:s.concluidas)||0,"/",(s==null?void 0:s.total)||0]}),e.jsxs("span",{className:"font-medium",children:[c,"%"]})]}),e.jsx(ye,{value:c,className:"h-1.5"})]}),a.dataInicio&&e.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-muted-foreground whitespace-nowrap",children:[e.jsx(pe,{className:"h-3 w-3"}),new Date(a.dataInicio+"T12:00:00").toLocaleDateString("pt-BR")]})]})]},a.id)})}):e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:i.map((a,r)=>{const s=ve.get(a.id),c=s&&s.total>0?Math.round(s.concluidas/s.total*100):0;return e.jsxs(L.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{delay:r*.03},onClick:()=>B(a.id),className:x("group relative rounded-lg border-2 overflow-hidden cursor-pointer hover:border-primary/40 transition-all duration-200 aspect-[4/3] flex flex-col justify-end",g===a.id?"border-primary border-dashed ring-2 ring-primary/30":"border-border"),onDragOver:d=>re(d,a.id),onDragLeave:te,onDrop:d=>oe(d,a.id),children:[a.coverUrl?e.jsx("img",{src:a.coverUrl,alt:a.name,className:"absolute inset-0 w-full h-full object-cover"}):e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-accent/8 via-card to-card"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-card via-card/60 to-transparent"}),e.jsx("button",{onClick:d=>se(a.id,d),className:"absolute top-2.5 left-2.5 z-20 rounded-full bg-black/50 p-1.5 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-black/70",children:P&&j===a.id?e.jsx(de,{className:"h-3.5 w-3.5 text-white animate-spin"}):e.jsx(V,{className:"h-3.5 w-3.5 text-white"})}),e.jsx(O,{variant:"outline",className:x("absolute top-2.5 right-2.5 text-[11px] px-2 py-0.5 font-semibold backdrop-blur-sm shadow-sm",z[a.status]||"bg-secondary text-secondary-foreground"),children:a.status}),e.jsxs("div",{className:"relative z-10 p-3.5 space-y-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground truncate",children:a.name}),a.tipo&&e.jsx("span",{className:"text-[11px] text-muted-foreground",children:a.tipo})]}),a.observacoes&&e.jsx("p",{className:"text-[11px] text-muted-foreground line-clamp-1",children:a.observacoes}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ke,{className:"h-3 w-3"}),(s==null?void 0:s.concluidas)||0,"/",(s==null?void 0:s.total)||0," tarefas"]}),e.jsxs("span",{className:"font-medium",children:[c,"%"]})]}),e.jsx(ye,{value:c,className:"h-1.5"})]}),a.dataInicio&&e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:[e.jsx(pe,{className:"h-2.5 w-2.5"}),"Início: ",new Date(a.dataInicio+"T12:00:00").toLocaleDateString("pt-BR")]})]})]},a.id)})}),e.jsx(Je,{open:Ae,onOpenChange:I,children:e.jsxs(Xe,{className:"sm:max-w-md",children:[e.jsx(Ke,{children:e.jsx(We,{children:n?"Editar Projeto":"Novo Projeto"})}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{children:[e.jsx(D,{htmlFor:"project-name",children:"Nome do projeto"}),e.jsx(we,{id:"project-name",value:U,onChange:a=>q(a.target.value),placeholder:"Ex: EasyBR",onKeyDown:a=>a.key==="Enter"&&je(),autoFocus:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(D,{children:"Status"}),e.jsxs(ie,{value:$,onValueChange:J,children:[e.jsx(ne,{children:e.jsx(le,{})}),e.jsx(ce,{children:ya.map(a=>e.jsx(M,{value:a,children:a},a))})]})]}),e.jsxs("div",{children:[e.jsx(D,{children:"Tipo"}),e.jsxs(ie,{value:X||"__none__",onValueChange:a=>K(a==="__none__"?"":a),children:[e.jsx(ne,{children:e.jsx(le,{placeholder:"Nenhum"})}),e.jsxs(ce,{children:[e.jsx(M,{value:"__none__",children:"Nenhum"}),wa.map(a=>e.jsx(M,{value:a,children:a},a))]})]})]})]}),e.jsxs("div",{children:[e.jsx(D,{children:"Cliente"}),e.jsx(na,{value:Y,onValueChange:a=>Z(a)})]}),e.jsxs("div",{children:[e.jsx(D,{htmlFor:"project-obs",children:"Observações"}),e.jsx(we,{id:"project-obs",value:W,onChange:a=>Q(a.target.value),placeholder:"Notas sobre o projeto"})]}),n&&e.jsxs("div",{children:[e.jsx(D,{children:"Capa do projeto"}),e.jsxs("div",{className:x("mt-1.5 flex items-center gap-3 p-3 rounded-lg border-2 border-dashed transition-all",g===n.id?"border-primary bg-primary/5":"border-transparent"),onDragOver:a=>re(a,n.id),onDragLeave:te,onDrop:a=>oe(a,n.id),children:[n.coverUrl?e.jsxs("div",{className:"relative w-24 aspect-[4/3] rounded-md overflow-hidden border border-border",children:[e.jsx("img",{src:n.coverUrl,alt:"Capa",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>Ie(n.id,n.coverUrl),className:"absolute top-0.5 right-0.5 rounded-full bg-destructive p-0.5",children:e.jsx(Ve,{className:"h-3 w-3 text-destructive-foreground"})})]}):e.jsxs("div",{className:x("w-24 aspect-[4/3] rounded-md border-2 border-dashed flex flex-col items-center justify-center bg-muted/20 gap-1 transition-colors",g===n.id?"border-primary":"border-border"),children:[g===n.id?e.jsx(be,{className:"h-5 w-5 text-primary animate-pulse"}):e.jsx(V,{className:"h-5 w-5 text-muted-foreground/40"}),e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"Arraste aqui"})]}),e.jsx(E,{type:"button",variant:"outline",size:"sm",onClick:a=>se(n.id,a),disabled:P,children:P&&j===n.id?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"})," Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-3.5 w-3.5 mr-1.5"})," ",n.coverUrl?"Trocar":"Adicionar"]})})]})]})]}),e.jsxs(Qe,{children:[e.jsx(E,{variant:"outline",onClick:()=>I(!1),children:"Cancelar"}),e.jsx(E,{onClick:je,disabled:ge||!U.trim(),className:"gold-gradient text-primary-foreground hover:opacity-90",children:ge?"Salvando...":n?"Salvar":"Criar"})]})]})}),e.jsx(Ye,{open:!!ee,onOpenChange:a=>!a&&fe(null),children:e.jsxs(Ze,{children:[e.jsxs(ea,{children:[e.jsx(aa,{children:"Remover projeto?"}),e.jsx(sa,{children:"Esta ação não pode ser desfeita. O projeto será removido permanentemente."})]}),e.jsxs(ra,{children:[e.jsx(ta,{children:"Cancelar"}),e.jsx(oa,{onClick:Fe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})]})}export{zs as default};
