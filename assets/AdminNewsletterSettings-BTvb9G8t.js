import{n as x,r as c,j as e}from"./index-CXIpuz_-.js";import{A as _,e as u}from"./AdminLayout-D1SuZYWo.js";import{B as f}from"./button-DsftJtE4.js";import{I as m}from"./input--GVCOrrz.js";import{L as l}from"./label-BPy4k5e7.js";import{C as g,a as y,b as j,d as v,c as N}from"./card-DBAmFPwO.js";import{S as o}from"./skeleton-CFbITS2I.js";import{l as b,m as C}from"./useNewsletter-Dn94IiX9.js";import{g as w}from"./supabaseErrors-eYWJjREL.js";import{L as S}from"./loader-circle-D9jQtkTq.js";import{S as L}from"./save-CyZZEAMg.js";import"./index-gWbUSHUY.js";import"./index-BpCwBHQg.js";import"./house-BdN2o6Mm.js";import"./menu-CUUPlfG5.js";import"./calendar-C3zWe-GW.js";import"./users-CilgE17M.js";import"./file-text-DN8kTDfl.js";import"./useMutation-DEr_qGEM.js";const K=()=>{const{toast:n}=x(),{data:i,isLoading:p}=b(),d=C(),[a,r]=c.useState({from_name:"",from_email:"",reply_to:"",batch_size:100,daily_send_limit:100,monthly_send_limit:3e3});c.useEffect(()=>{i&&r({from_name:i.from_name||"",from_email:i.from_email||"",reply_to:i.reply_to||"",batch_size:i.batch_size||100,daily_send_limit:i.daily_send_limit||100,monthly_send_limit:i.monthly_send_limit||3e3})},[i]);const h=async s=>{if(s.preventDefault(),!a.from_email.trim()){n({title:"E-mail obrigatório",description:"Informe o e-mail remetente.",variant:"destructive"});return}try{await d.mutateAsync({from_name:a.from_name.trim(),from_email:a.from_email.trim(),reply_to:a.reply_to.trim()||null,batch_size:Math.max(1,Math.min(500,a.batch_size)),daily_send_limit:Math.max(1,Math.min(1e4,a.daily_send_limit)),monthly_send_limit:Math.max(1,Math.min(1e5,a.monthly_send_limit))}),n({title:"Configurações salvas",description:"As configurações de newsletter foram atualizadas."})}catch(t){n({title:"Erro ao salvar",description:w(t,"Não foi possível salvar."),variant:"destructive"})}};return e.jsx(_,{title:"Configurações de Newsletter",children:e.jsxs(g,{className:"max-w-2xl",children:[e.jsxs(y,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"Configurações de envio"]}),e.jsx(v,{children:"Configure os dados do remetente e parâmetros de envio das campanhas de newsletter."})]}),e.jsx(N,{children:p?e.jsxs("div",{className:"space-y-4",children:[e.jsx(o,{className:"h-10 w-full"}),e.jsx(o,{className:"h-10 w-full"}),e.jsx(o,{className:"h-10 w-full"}),e.jsx(o,{className:"h-10 w-1/2"})]}):e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"from_name",children:"Nome do remetente"}),e.jsx(m,{id:"from_name",value:a.from_name,onChange:s=>r(t=>({...t,from_name:s.target.value})),placeholder:"Mariana Lima",maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"from_email",children:"E-mail remetente *"}),e.jsx(m,{id:"from_email",type:"email",value:a.from_email,onChange:s=>r(t=>({...t,from_email:s.target.value})),placeholder:"no-reply@marianalima.adv.br",required:!0,maxLength:255}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Deve ser um domínio verificado no Resend."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"reply_to",children:"Responder para (opcional)"}),e.jsx(m,{id:"reply_to",type:"email",value:a.reply_to,onChange:s=>r(t=>({...t,reply_to:s.target.value})),placeholder:"contato@marianalima.adv.br",maxLength:255}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Quando o leitor clicar em "Responder", o e-mail será enviado para este endereço.'})]}),e.jsxs("div",{className:"space-y-2 max-w-[200px]",children:[e.jsx(l,{htmlFor:"batch_size",children:"Tamanho do lote"}),e.jsx(m,{id:"batch_size",type:"number",min:1,max:500,value:a.batch_size,onChange:s=>r(t=>({...t,batch_size:parseInt(s.target.value,10)||100}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Quantos e-mails enviar por execução da função (1–500). O cron automático executa a cada 2 minutos."})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"daily_send_limit",children:"Limite diário"}),e.jsx(m,{id:"daily_send_limit",type:"number",min:1,max:1e4,value:a.daily_send_limit,onChange:s=>r(t=>({...t,daily_send_limit:parseInt(s.target.value,10)||100}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Máximo de e-mails por dia. Padrão: 100 (plano gratuito do Resend)."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"monthly_send_limit",children:"Limite mensal"}),e.jsx(m,{id:"monthly_send_limit",type:"number",min:1,max:1e5,value:a.monthly_send_limit,onChange:s=>r(t=>({...t,monthly_send_limit:parseInt(s.target.value,10)||3e3}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Máximo de e-mails por mês. Padrão: 3.000 (plano gratuito do Resend)."})]})]}),e.jsxs(f,{type:"submit",disabled:d.isPending,children:[d.isPending?e.jsx(S,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(L,{className:"w-4 h-4 mr-2"}),"Salvar configurações"]})]})})]})})};export{K as default};
