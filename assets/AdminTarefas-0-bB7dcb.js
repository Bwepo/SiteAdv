import{c as Je,r as o,j as r,e as Z,h as Pr,a5 as V,f as it,m as xn}from"./index-DRlkAaou.js";import{E as Fr,m as Pn,T as zr}from"./TarefaSheet-NlX0_N1H.js";import{u as _r,F as Br,a as Ve,b as Xe,c as He,d as We,e as qe,t as $r}from"./form-C2Ws4Von.js";import{S as Kr,b as Ur,c as Yr,d as Vr,e as Xr,f as Hr}from"./sheet-C2hoj6sE.js";import{I as Ot}from"./input-_XQ-klIu.js";import{B as Ye}from"./button-DLMKOCBr.js";import{P as Fn,a as zn,b as _n,S as me,c as ge,d as pe,e as xe,f as z}from"./popover-BVRC4BIT.js";import{d as Bn,S as ft,e as tn,f as It,a as nn,T as Wr,g as qr}from"./crmTypes-Cf4doRlX.js";import{S as cn}from"./search-Ci7U5frY.js";import{C as Gr}from"./check-sQ4Pipq2.js";import{U as Jr}from"./user-D2kJ7ZpK.js";import{L as Zr}from"./loader-circle-BmKbPMDk.js";import{o as Qr,s as ot,e as es}from"./types-C9wiu8_K.js";import{C as ht,c as mt}from"./card-DrFFkqNF.js";import{A as $n,a as Kn,b as Un,c as Yn,d as Vn,e as Xn,f as Hn,g as Wn}from"./alert-dialog-DkT_OwZe.js";import{P as qn,B as Ae}from"./badge-CNu_xf_F.js";import{S as lt}from"./switch-BsufxqI2.js";import{L as Gn}from"./list-DrPGPzoO.js";import{F as Jn}from"./folder-kanban-Bw5gs8ZT.js";import{U as Zn}from"./users-PcxS2OWG.js";import{C as Qn}from"./calendar-C3WkqwC4.js";import{P as ts}from"./pencil-B-huywX_.js";import{T as ns}from"./trash-2-COS8KViw.js";import{L as rs}from"./label-12wqLIL_.js";import{a as ss,b as as}from"./useAirtable-D1dj7Ls_.js";import{T as os,K as is}from"./CrmSkeletons-ONTezS2n.js";import{C as ls}from"./clipboard-list-kAJHLPFY.js";import{C as er,a as cs}from"./circle-x-IGnLsYbV.js";import{C as ds}from"./clock-DtdpRlkM.js";import{C as us}from"./circle-check-K-BUcD2F.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=Je("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=Je("CircleDot",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=Je("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Je("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=Je("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=Je("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),gs=Qr({title:ot().trim().min(1,"Título obrigatório").max(200),parentTaskId:ot().min(1,"Tarefa-mãe obrigatória"),deadline:ot().optional(),status:es(["A fazer","Em andamento","Concluído"]),assignee:ot().optional(),notes:ot().max(2e3).optional()}),ps=Object.entries(ft);function xs({open:e,onOpenChange:t,subtask:n,tasks:s,onSave:a}){const i=!n,[c,l]=o.useState(!1),[u,f]=o.useState(""),[h,m]=o.useState(!1),b=o.useMemo(()=>{if(!u.trim())return s;const p=u.toLowerCase();return s.filter(v=>v.title.toLowerCase().includes(p))},[s,u]),x=_r({resolver:$r(gs),defaultValues:{title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}});o.useEffect(()=>{e&&(n?x.reset({title:n.title,parentTaskId:n.parentTaskId,deadline:n.dueDate??"",status:n.status,assignee:n.assignee??"",notes:n.notes??""}):x.reset({title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}))},[e,n]);const S=async p=>{l(!0);try{await a(p,i,n==null?void 0:n.id),t(!1)}catch(v){Pr.error("Erro ao salvar subtarefa: "+v.message),console.error("Erro ao salvar subtarefa:",v)}finally{l(!1)}};return r.jsx(Kr,{open:e,onOpenChange:t,children:r.jsxs(Ur,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[r.jsxs(Yr,{className:"mb-6",children:[r.jsx(Vr,{children:i?"Nova Subtarefa":"Editar Subtarefa"}),r.jsx(Xr,{children:i?"Preencha os dados e selecione a tarefa-mãe relacionada.":"Altere os campos e salve."})]}),r.jsx(Br,{...x,children:r.jsxs("form",{onSubmit:x.handleSubmit(S),className:"space-y-5",children:[r.jsx(Ve,{control:x.control,name:"title",render:({field:p})=>r.jsxs(Xe,{children:[r.jsx(He,{children:"Título *"}),r.jsx(We,{children:r.jsx(Ot,{placeholder:"Ex: Enviar documento",...p})}),r.jsx(qe,{})]})}),r.jsx(Ve,{control:x.control,name:"parentTaskId",render:({field:p})=>{var v;return r.jsxs(Xe,{className:"flex flex-col",children:[r.jsx(He,{children:"Tarefa-mãe *"}),r.jsxs(Fn,{open:h,onOpenChange:m,children:[r.jsx(zn,{asChild:!0,children:r.jsx(We,{children:r.jsxs(Ye,{variant:"outline",role:"combobox",className:Z("w-full justify-between font-normal",!p.value&&"text-muted-foreground"),children:[r.jsx("span",{className:"truncate",children:p.value?((v=s.find(j=>j.id===p.value))==null?void 0:v.title)??"Tarefa não encontrada":"Selecione a tarefa-mãe..."}),r.jsx(fs,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),r.jsxs(_n,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:[r.jsxs("div",{className:"flex items-center border-b px-3",children:[r.jsx(cn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),r.jsx("input",{className:"flex h-10 w-full bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground",placeholder:"Buscar tarefa...",value:u,onChange:j=>f(j.target.value)})]}),r.jsx("div",{className:"max-h-[200px] overflow-y-auto p-1",children:b.length===0?r.jsx("p",{className:"py-4 text-center text-sm text-muted-foreground",children:"Nenhuma tarefa encontrada."}):b.map(j=>r.jsxs("button",{type:"button",className:Z("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",p.value===j.id&&"bg-accent"),onClick:()=>{p.onChange(j.id),m(!1),f("")},children:[r.jsx(Gr,{className:Z("mr-2 h-4 w-4",p.value===j.id?"opacity-100":"opacity-0")}),r.jsx("span",{className:"truncate",children:j.title})]},j.id))})]})]}),r.jsx(qe,{})]})}}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ve,{control:x.control,name:"deadline",render:({field:p})=>r.jsxs(Xe,{children:[r.jsx(He,{children:"Prazo"}),r.jsx(We,{children:r.jsx(Ot,{type:"date",...p})}),r.jsx(qe,{})]})}),r.jsx(Ve,{control:x.control,name:"status",render:({field:p})=>r.jsxs(Xe,{children:[r.jsx(He,{children:"Status"}),r.jsxs(me,{onValueChange:p.onChange,value:p.value,children:[r.jsx(We,{children:r.jsx(ge,{children:r.jsx(pe,{})})}),r.jsx(xe,{children:ps.map(([v,j])=>r.jsx(z,{value:v,children:j},v))})]}),r.jsx(qe,{})]})})]}),r.jsx(Ve,{control:x.control,name:"assignee",render:({field:p})=>r.jsxs(Xe,{children:[r.jsx(He,{children:"Responsável"}),r.jsxs(me,{onValueChange:v=>p.onChange(v==="_none_"?"":v),value:p.value||"_none_",children:[r.jsx(We,{children:r.jsx(ge,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Jr,{className:"w-3.5 h-3.5 text-muted-foreground"}),r.jsx(pe,{placeholder:"Responsável..."})]})})}),r.jsxs(xe,{children:[r.jsx(z,{value:"_none_",children:"— Sem responsável —"}),Bn.map(v=>r.jsx(z,{value:v,children:v},v))]})]}),r.jsx(qe,{})]})}),r.jsx(Ve,{control:x.control,name:"notes",render:({field:p})=>r.jsxs(Xe,{children:[r.jsx(He,{children:"Observações"}),r.jsx(We,{children:r.jsx(Fr,{value:p.value??"",onChange:p.onChange,placeholder:"Observações...",modalTitle:"Editar Observações da Subtarefa"})}),r.jsx(qe,{})]})}),r.jsx(Hr,{children:r.jsxs(Ye,{type:"submit",disabled:c,className:"w-full",children:[c&&r.jsx(Zr,{className:"w-4 h-4 mr-2 animate-spin"}),i?"Criar Subtarefa":"Salvar Alterações"]})})]})})]})})}function vs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const Bt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ze(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function dn(e){return"nodeType"in e}function ue(e){var t,n;return e?Ze(e)?e:dn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function un(e){const{Document:t}=ue(e);return e instanceof t}function xt(e){return Ze(e)?!1:e instanceof ue(e).HTMLElement}function rr(e){return e instanceof ue(e).SVGElement}function Qe(e){return e?Ze(e)?e.document:dn(e)?un(e)?e:xt(e)||rr(e)?e.ownerDocument:document:document:document}const Te=Bt?o.useLayoutEffect:o.useEffect;function $t(e){const t=o.useRef(e);return Te(()=>{t.current=e}),o.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function bs(){const e=o.useRef(null),t=o.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function gt(e,t){t===void 0&&(t=[e]);const n=o.useRef(e);return Te(()=>{n.current!==e&&(n.current=e)},t),n}function vt(e,t){const n=o.useRef();return o.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Mt(e){const t=$t(e),n=o.useRef(null),s=o.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function Lt(e){const t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}let Jt={};function bt(e,t){return o.useMemo(()=>{if(t)return t;const n=Jt[e]==null?0:Jt[e]+1;return Jt[e]=n,e+"-"+n},[e,t])}function sr(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((i,c)=>{const l=Object.entries(c);for(const[u,f]of l){const h=i[u];h!=null&&(i[u]=h+e*f)}return i},{...t})}}const Ge=sr(1),Pt=sr(-1);function ys(e){return"clientX"in e&&"clientY"in e}function Kt(e){if(!e)return!1;const{KeyboardEvent:t}=ue(e.target);return t&&e instanceof t}function ws(e){if(!e)return!1;const{TouchEvent:t}=ue(e.target);return t&&e instanceof t}function Ft(e){if(ws(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return ys(e)?{x:e.clientX,y:e.clientY}:null}const Pe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Pe.Translate.toString(e),Pe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),bn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function js(e){return e.matches(bn)?e:e.querySelector(bn)}const Ss={display:"none"};function Cs(e){let{id:t,value:n}=e;return V.createElement("div",{id:t,style:Ss},n)}function Ns(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return V.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function Ds(){const[e,t]=o.useState("");return{announce:o.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const ar=o.createContext(null);function Ts(e){const t=o.useContext(ar);o.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Es(){const[e]=o.useState(()=>new Set),t=o.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[o.useCallback(s=>{let{type:a,event:i}=s;e.forEach(c=>{var l;return(l=c[a])==null?void 0:l.call(c,i)})},[e]),t]}const Rs={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},As={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function ks(e){let{announcements:t=As,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=Rs}=e;const{announce:i,announcement:c}=Ds(),l=bt("DndLiveRegion"),[u,f]=o.useState(!1);if(o.useEffect(()=>{f(!0)},[]),Ts(o.useMemo(()=>({onDragStart(m){let{active:b}=m;i(t.onDragStart({active:b}))},onDragMove(m){let{active:b,over:x}=m;t.onDragMove&&i(t.onDragMove({active:b,over:x}))},onDragOver(m){let{active:b,over:x}=m;i(t.onDragOver({active:b,over:x}))},onDragEnd(m){let{active:b,over:x}=m;i(t.onDragEnd({active:b,over:x}))},onDragCancel(m){let{active:b,over:x}=m;i(t.onDragCancel({active:b,over:x}))}}),[i,t])),!u)return null;const h=V.createElement(V.Fragment,null,V.createElement(Cs,{id:s,value:a.draggable}),V.createElement(Ns,{id:l,announcement:c}));return n?it.createPortal(h,n):h}var ee;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ee||(ee={}));function zt(){}function or(e,t){return o.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ir(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Ee=Object.freeze({x:0,y:0});function Os(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Is(e,t){const n=Ft(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function Ms(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Ls(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function yn(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function Ps(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const lr=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=yn(t),i=[];for(const c of s){const{id:l}=c,u=n.get(l);if(u){const f=yn(u),h=a.reduce((b,x,S)=>b+Os(f[S],x),0),m=Number((h/4).toFixed(4));i.push({id:l,data:{droppableContainer:c,value:m}})}}return i.sort(Ms)};function Fs(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),c=a-s,l=i-n;if(s<a&&n<i){const u=t.width*t.height,f=e.width*e.height,h=c*l,m=h/(u+f-h);return Number(m.toFixed(4))}return 0}const zs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const i of s){const{id:c}=i,l=n.get(c);if(l){const u=Fs(l,t);u>0&&a.push({id:c,data:{droppableContainer:i,value:u}})}}return a.sort(Ls)};function _s(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function cr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ee}function Bs(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),i=1;i<s;i++)a[i-1]=arguments[i];return a.reduce((c,l)=>({...c,top:c.top+e*l.y,bottom:c.bottom+e*l.y,left:c.left+e*l.x,right:c.right+e*l.x}),{...n})}}const $s=Bs(1);function dr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Ks(e,t,n){const s=dr(t);if(!s)return e;const{scaleX:a,scaleY:i,x:c,y:l}=s,u=e.left-c-(1-a)*parseFloat(n),f=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),h=a?e.width/a:e.width,m=i?e.height/i:e.height;return{width:h,height:m,top:f,right:u+h,bottom:f+m,left:u}}const Us={ignoreTransform:!1};function et(e,t){t===void 0&&(t=Us);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:h}=ue(e).getComputedStyle(e);f&&(n=Ks(n,f,h))}const{top:s,left:a,width:i,height:c,bottom:l,right:u}=n;return{top:s,left:a,width:i,height:c,bottom:l,right:u}}function wn(e){return et(e,{ignoreTransform:!0})}function Ys(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Vs(e,t){return t===void 0&&(t=ue(e).getComputedStyle(e)),t.position==="fixed"}function Xs(e,t){t===void 0&&(t=ue(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?n.test(i):!1})}function fn(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(un(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!xt(a)||rr(a)||n.includes(a))return n;const i=ue(e).getComputedStyle(a);return a!==e&&Xs(a,i)&&n.push(a),Vs(a,i)?n:s(a.parentNode)}return e?s(e):n}function ur(e){const[t]=fn(e,1);return t??null}function Zt(e){return!Bt||!e?null:Ze(e)?e:dn(e)?un(e)||e===Qe(e).scrollingElement?window:xt(e)?e:null:null}function fr(e){return Ze(e)?e.scrollX:e.scrollLeft}function hr(e){return Ze(e)?e.scrollY:e.scrollTop}function rn(e){return{x:fr(e),y:hr(e)}}var re;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(re||(re={}));function mr(e){return!Bt||!e?!1:e===document.scrollingElement}function gr(e){const t={x:0,y:0},n=mr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,c=e.scrollTop>=s.y,l=e.scrollLeft>=s.x;return{isTop:a,isLeft:i,isBottom:c,isRight:l,maxScroll:s,minScroll:t}}const Hs={x:.2,y:.2};function Ws(e,t,n,s,a){let{top:i,left:c,right:l,bottom:u}=n;s===void 0&&(s=10),a===void 0&&(a=Hs);const{isTop:f,isBottom:h,isLeft:m,isRight:b}=gr(e),x={x:0,y:0},S={x:0,y:0},p={height:t.height*a.y,width:t.width*a.x};return!f&&i<=t.top+p.height?(x.y=re.Backward,S.y=s*Math.abs((t.top+p.height-i)/p.height)):!h&&u>=t.bottom-p.height&&(x.y=re.Forward,S.y=s*Math.abs((t.bottom-p.height-u)/p.height)),!b&&l>=t.right-p.width?(x.x=re.Forward,S.x=s*Math.abs((t.right-p.width-l)/p.width)):!m&&c<=t.left+p.width&&(x.x=re.Backward,S.x=s*Math.abs((t.left+p.width-c)/p.width)),{direction:x,speed:S}}function qs(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:c}=window;return{top:0,left:0,right:i,bottom:c,width:i,height:c}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function pr(e){return e.reduce((t,n)=>Ge(t,rn(n)),Ee)}function Gs(e){return e.reduce((t,n)=>t+fr(n),0)}function Js(e){return e.reduce((t,n)=>t+hr(n),0)}function xr(e,t){if(t===void 0&&(t=et),!e)return;const{top:n,left:s,bottom:a,right:i}=t(e);ur(e)&&(a<=0||i<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Zs=[["x",["left","right"],Gs],["y",["top","bottom"],Js]];class hn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=fn(n),a=pr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,c,l]of Zs)for(const u of c)Object.defineProperty(this,u,{get:()=>{const f=l(s),h=a[i]-f;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ct{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function Qs(e){const{EventTarget:t}=ue(e);return e instanceof t?e:Qe(e)}function Qt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var je;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(je||(je={}));function jn(e){e.preventDefault()}function ea(e){e.stopPropagation()}var L;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(L||(L={}));const vr={start:[L.Space,L.Enter],cancel:[L.Esc],end:[L.Space,L.Enter,L.Tab]},ta=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case L.Right:return{...n,x:n.x+25};case L.Left:return{...n,x:n.x-25};case L.Down:return{...n,y:n.y+25};case L.Up:return{...n,y:n.y-25}}};class br{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new ct(Qe(n)),this.windowListeners=new ct(ue(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(je.Resize,this.handleCancel),this.windowListeners.add(je.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(je.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&xr(s),n(Ee)}handleKeyDown(t){if(Kt(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:i=vr,coordinateGetter:c=ta,scrollBehavior:l="smooth"}=a,{code:u}=t;if(i.end.includes(u)){this.handleEnd(t);return}if(i.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:f}=s.current,h=f?{x:f.left,y:f.top}:Ee;this.referenceCoordinates||(this.referenceCoordinates=h);const m=c(t,{active:n,context:s.current,currentCoordinates:h});if(m){const b=Pt(m,h),x={x:0,y:0},{scrollableAncestors:S}=s.current;for(const p of S){const v=t.code,{isTop:j,isRight:N,isLeft:D,isBottom:y,maxScroll:R,minScroll:T}=gr(p),E=qs(p),C={x:Math.min(v===L.Right?E.right-E.width/2:E.right,Math.max(v===L.Right?E.left:E.left+E.width/2,m.x)),y:Math.min(v===L.Down?E.bottom-E.height/2:E.bottom,Math.max(v===L.Down?E.top:E.top+E.height/2,m.y))},_=v===L.Right&&!N||v===L.Left&&!D,F=v===L.Down&&!y||v===L.Up&&!j;if(_&&C.x!==m.x){const P=p.scrollLeft+b.x,X=v===L.Right&&P<=R.x||v===L.Left&&P>=T.x;if(X&&!b.y){p.scrollTo({left:P,behavior:l});return}X?x.x=p.scrollLeft-P:x.x=v===L.Right?p.scrollLeft-R.x:p.scrollLeft-T.x,x.x&&p.scrollBy({left:-x.x,behavior:l});break}else if(F&&C.y!==m.y){const P=p.scrollTop+b.y,X=v===L.Down&&P<=R.y||v===L.Up&&P>=T.y;if(X&&!b.x){p.scrollTo({top:P,behavior:l});return}X?x.y=p.scrollTop-P:x.y=v===L.Down?p.scrollTop-R.y:p.scrollTop-T.y,x.y&&p.scrollBy({top:-x.y,behavior:l});break}}this.handleMove(t,Ge(Pt(m,this.referenceCoordinates),x))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}br.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=vr,onActivation:a}=t,{active:i}=n;const{code:c}=e.nativeEvent;if(s.start.includes(c)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Sn(e){return!!(e&&"distance"in e)}function Cn(e){return!!(e&&"delay"in e)}class mn{constructor(t,n,s){var a;s===void 0&&(s=Qs(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:c}=i;this.props=t,this.events=n,this.document=Qe(c),this.documentListeners=new ct(this.document),this.listeners=new ct(s),this.windowListeners=new ct(ue(c)),this.initialCoordinates=(a=Ft(i))!=null?a:Ee,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(je.Resize,this.handleCancel),this.windowListeners.add(je.DragStart,jn),this.windowListeners.add(je.VisibilityChange,this.handleCancel),this.windowListeners.add(je.ContextMenu,jn),this.documentListeners.add(je.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Cn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Sn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(je.Click,ea,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(je.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:i}=this,{onMove:c,options:{activationConstraint:l}}=i;if(!a)return;const u=(n=Ft(t))!=null?n:Ee,f=Pt(a,u);if(!s&&l){if(Sn(l)){if(l.tolerance!=null&&Qt(f,l.tolerance))return this.handleCancel();if(Qt(f,l.distance))return this.handleStart()}if(Cn(l)&&Qt(f,l.tolerance))return this.handleCancel();this.handlePending(l,f);return}t.cancelable&&t.preventDefault(),c(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===L.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const na={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ut extends mn{constructor(t){const{event:n}=t,s=Qe(n.target);super(t,na,s)}}Ut.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const ra={move:{name:"mousemove"},end:{name:"mouseup"}};var sn;(function(e){e[e.RightClick=2]="RightClick"})(sn||(sn={}));class sa extends mn{constructor(t){super(t,ra,Qe(t.event.target))}}sa.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===sn.RightClick?!1:(s==null||s({event:n}),!0)}}];const en={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class aa extends mn{constructor(t){super(t,en)}static setup(){return window.addEventListener(en.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(en.move.name,t)};function t(){}}}aa.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var dt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(dt||(dt={}));var _t;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(_t||(_t={}));function oa(e){let{acceleration:t,activator:n=dt.Pointer,canScroll:s,draggingRect:a,enabled:i,interval:c=5,order:l=_t.TreeOrder,pointerCoordinates:u,scrollableAncestors:f,scrollableAncestorRects:h,delta:m,threshold:b}=e;const x=la({delta:m,disabled:!i}),[S,p]=bs(),v=o.useRef({x:0,y:0}),j=o.useRef({x:0,y:0}),N=o.useMemo(()=>{switch(n){case dt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case dt.DraggableRect:return a}},[n,a,u]),D=o.useRef(null),y=o.useCallback(()=>{const T=D.current;if(!T)return;const E=v.current.x*j.current.x,C=v.current.y*j.current.y;T.scrollBy(E,C)},[]),R=o.useMemo(()=>l===_t.TreeOrder?[...f].reverse():f,[l,f]);o.useEffect(()=>{if(!i||!f.length||!N){p();return}for(const T of R){if((s==null?void 0:s(T))===!1)continue;const E=f.indexOf(T),C=h[E];if(!C)continue;const{direction:_,speed:F}=Ws(T,C,N,t,b);for(const P of["x","y"])x[P][_[P]]||(F[P]=0,_[P]=0);if(F.x>0||F.y>0){p(),D.current=T,S(y,c),v.current=F,j.current=_;return}}v.current={x:0,y:0},j.current={x:0,y:0},p()},[t,y,s,p,i,c,JSON.stringify(N),JSON.stringify(x),S,f,R,h,JSON.stringify(b)])}const ia={x:{[re.Backward]:!1,[re.Forward]:!1},y:{[re.Backward]:!1,[re.Forward]:!1}};function la(e){let{delta:t,disabled:n}=e;const s=Lt(t);return vt(a=>{if(n||!s||!a)return ia;const i={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[re.Backward]:a.x[re.Backward]||i.x===-1,[re.Forward]:a.x[re.Forward]||i.x===1},y:{[re.Backward]:a.y[re.Backward]||i.y===-1,[re.Forward]:a.y[re.Forward]||i.y===1}}},[n,t,s])}function ca(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return vt(a=>{var i;return t==null?null:(i=s??a)!=null?i:null},[s,t])}function da(e,t){return o.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,i=a.activators.map(c=>({eventName:c.eventName,handler:t(c.handler,s)}));return[...n,...i]},[]),[e,t])}var pt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(pt||(pt={}));var an;(function(e){e.Optimized="optimized"})(an||(an={}));const Nn=new Map;function ua(e,t){let{dragging:n,dependencies:s,config:a}=t;const[i,c]=o.useState(null),{frequency:l,measure:u,strategy:f}=a,h=o.useRef(e),m=v(),b=gt(m),x=o.useCallback(function(j){j===void 0&&(j=[]),!b.current&&c(N=>N===null?j:N.concat(j.filter(D=>!N.includes(D))))},[b]),S=o.useRef(null),p=vt(j=>{if(m&&!n)return Nn;if(!j||j===Nn||h.current!==e||i!=null){const N=new Map;for(let D of e){if(!D)continue;if(i&&i.length>0&&!i.includes(D.id)&&D.rect.current){N.set(D.id,D.rect.current);continue}const y=D.node.current,R=y?new hn(u(y),y):null;D.rect.current=R,R&&N.set(D.id,R)}return N}return j},[e,i,n,m,u]);return o.useEffect(()=>{h.current=e},[e]),o.useEffect(()=>{m||x()},[n,m]),o.useEffect(()=>{i&&i.length>0&&c(null)},[JSON.stringify(i)]),o.useEffect(()=>{m||typeof l!="number"||S.current!==null||(S.current=setTimeout(()=>{x(),S.current=null},l))},[l,m,x,...s]),{droppableRects:p,measureDroppableContainers:x,measuringScheduled:i!=null};function v(){switch(f){case pt.Always:return!1;case pt.BeforeDragging:return n;default:return!n}}}function gn(e,t){return vt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function fa(e,t){return gn(e,t)}function ha(e){let{callback:t,disabled:n}=e;const s=$t(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(s)},[s,n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Yt(e){let{callback:t,disabled:n}=e;const s=$t(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(s)},[n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function ma(e){return new hn(et(e),e)}function Dn(e,t,n){t===void 0&&(t=ma);const[s,a]=o.useState(null);function i(){a(u=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=u??n)!=null?f:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const c=ha({callback(u){if(e)for(const f of u){const{type:h,target:m}=f;if(h==="childList"&&m instanceof HTMLElement&&m.contains(e)){i();break}}}}),l=Yt({callback:i});return Te(()=>{i(),e?(l==null||l.observe(e),c==null||c.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),c==null||c.disconnect())},[e]),s}function ga(e){const t=gn(e);return cr(e,t)}const Tn=[];function pa(e){const t=o.useRef(e),n=vt(s=>e?s&&s!==Tn&&e&&t.current&&e.parentNode===t.current.parentNode?s:fn(e):Tn,[e]);return o.useEffect(()=>{t.current=e},[e]),n}function xa(e){const[t,n]=o.useState(null),s=o.useRef(e),a=o.useCallback(i=>{const c=Zt(i.target);c&&n(l=>l?(l.set(c,rn(c)),new Map(l)):null)},[]);return o.useEffect(()=>{const i=s.current;if(e!==i){c(i);const l=e.map(u=>{const f=Zt(u);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,rn(f)]):null}).filter(u=>u!=null);n(l.length?new Map(l):null),s.current=e}return()=>{c(e),c(i)};function c(l){l.forEach(u=>{const f=Zt(u);f==null||f.removeEventListener("scroll",a)})}},[a,e]),o.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,c)=>Ge(i,c),Ee):pr(e):Ee,[e,t])}function En(e,t){t===void 0&&(t=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},t),o.useEffect(()=>{const s=e!==Ee;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Pt(e,n.current):Ee}function va(e){o.useEffect(()=>{if(!Bt)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function ba(e,t){return o.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:i}=s;return n[a]=c=>{i(c,t)},n},{}),[e,t])}function yr(e){return o.useMemo(()=>e?Ys(e):null,[e])}const Rn=[];function ya(e,t){t===void 0&&(t=et);const[n]=e,s=yr(n?ue(n):null),[a,i]=o.useState(Rn);function c(){i(()=>e.length?e.map(u=>mr(u)?s:new hn(t(u),u)):Rn)}const l=Yt({callback:c});return Te(()=>{l==null||l.disconnect(),c(),e.forEach(u=>l==null?void 0:l.observe(u))},[e]),a}function wr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return xt(t)?t:e}function wa(e){let{measure:t}=e;const[n,s]=o.useState(null),a=o.useCallback(f=>{for(const{target:h}of f)if(xt(h)){s(m=>{const b=t(h);return m?{...m,width:b.width,height:b.height}:b});break}},[t]),i=Yt({callback:a}),c=o.useCallback(f=>{const h=wr(f);i==null||i.disconnect(),h&&(i==null||i.observe(h)),s(h?t(h):null)},[t,i]),[l,u]=Mt(c);return o.useMemo(()=>({nodeRef:l,rect:n,setRef:u}),[n,l,u])}const ja=[{sensor:Ut,options:{}},{sensor:br,options:{}}],Sa={current:{}},kt={draggable:{measure:wn},droppable:{measure:wn,strategy:pt.WhileDragging,frequency:an.Optimized},dragOverlay:{measure:et}};class ut extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Ca={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ut,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:zt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:kt,measureDroppableContainers:zt,windowRect:null,measuringScheduled:!1},jr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:zt,draggableNodes:new Map,over:null,measureDroppableContainers:zt},yt=o.createContext(jr),Sr=o.createContext(Ca);function Na(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ut}}}function Da(e,t){switch(t.type){case ee.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ee.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ee.DragEnd:case ee.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ee.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new ut(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case ee.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const c=new ut(e.droppable.containers);return c.set(n,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:c}}}case ee.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const i=new ut(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function Ta(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=o.useContext(yt),i=Lt(s),c=Lt(n==null?void 0:n.id);return o.useEffect(()=>{if(!t&&!s&&i&&c!=null){if(!Kt(i)||document.activeElement===i.target)return;const l=a.get(c);if(!l)return;const{activatorNode:u,node:f}=l;if(!u.current&&!f.current)return;requestAnimationFrame(()=>{for(const h of[u.current,f.current]){if(!h)continue;const m=js(h);if(m){m.focus();break}}})}},[s,t,a,c,i]),null}function Cr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...s}),n):n}function Ea(e){return o.useMemo(()=>({draggable:{...kt.draggable,...e==null?void 0:e.draggable},droppable:{...kt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...kt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Ra(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const i=o.useRef(!1),{x:c,y:l}=typeof a=="boolean"?{x:a,y:a}:a;Te(()=>{if(!c&&!l||!t){i.current=!1;return}if(i.current||!s)return;const f=t==null?void 0:t.node.current;if(!f||f.isConnected===!1)return;const h=n(f),m=cr(h,s);if(c||(m.x=0),l||(m.y=0),i.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const b=ur(f);b&&b.scrollBy({top:m.y,left:m.x})}},[t,c,l,s,n])}const Vt=o.createContext({...Ee,scaleX:1,scaleY:1});var Be;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Be||(Be={}));const Nr=o.memo(function(t){var n,s,a,i;let{id:c,accessibility:l,autoScroll:u=!0,children:f,sensors:h=ja,collisionDetection:m=zs,measuring:b,modifiers:x,...S}=t;const p=o.useReducer(Da,void 0,Na),[v,j]=p,[N,D]=Es(),[y,R]=o.useState(Be.Uninitialized),T=y===Be.Initialized,{draggable:{active:E,nodes:C,translate:_},droppable:{containers:F}}=v,P=E!=null?C.get(E):null,X=o.useRef({initial:null,translated:null}),ce=o.useMemo(()=>{var d;return E!=null?{id:E,data:(d=P==null?void 0:P.data)!=null?d:Sa,rect:X}:null},[E,P]),G=o.useRef(null),[be,Se]=o.useState(null),[Q,ke]=o.useState(null),ie=gt(S,Object.values(S)),ye=bt("DndDescribedBy",c),Oe=o.useMemo(()=>F.getEnabled(),[F]),O=Ea(b),{droppableRects:te,measureDroppableContainers:le,measuringScheduled:we}=ua(Oe,{dragging:T,dependencies:[_.x,_.y],config:O.droppable}),H=ca(C,E),Fe=o.useMemo(()=>Q?Ft(Q):null,[Q]),fe=qt(),ve=fa(H,O.draggable.measure);Ra({activeNode:E!=null?C.get(E):null,config:fe.layoutShiftCompensation,initialRect:ve,measure:O.draggable.measure});const k=Dn(H,O.draggable.measure,ve),Ie=Dn(H?H.parentElement:null),se=o.useRef({activatorEvent:null,active:null,activeNode:H,collisionRect:null,collisions:null,droppableRects:te,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:F,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Re=F.getNodeFor((n=se.current.over)==null?void 0:n.id),ae=wa({measure:O.dragOverlay.measure}),Ce=(s=ae.nodeRef.current)!=null?s:H,g=T?(a=ae.rect)!=null?a:k:null,I=!!(ae.nodeRef.current&&ae.rect),M=ga(I?null:k),ne=yr(Ce?ue(Ce):null),U=pa(T?Re??H:null),Y=ya(U),oe=Cr(x,{transform:{x:_.x-M.x,y:_.y-M.y,scaleX:1,scaleY:1},activatorEvent:Q,active:ce,activeNodeRect:k,containerNodeRect:Ie,draggingNodeRect:g,over:se.current.over,overlayNodeRect:ae.rect,scrollableAncestors:U,scrollableAncestorRects:Y,windowRect:ne}),$e=Fe?Ge(Fe,_):null,Me=xa(U),wt=En(Me),Ke=En(Me,[k]),Ne=Ge(oe,wt),ze=g?$s(g,oe):null,Ue=ce&&ze?m({active:ce,collisionRect:ze,droppableRects:te,droppableContainers:Oe,pointerCoordinates:$e}):null,jt=Ps(Ue,"id"),[De,St]=o.useState(null),Xt=I?oe:Ge(oe,Ke),Ht=_s(Xt,(i=De==null?void 0:De.rect)!=null?i:null,k),tt=o.useRef(null),Ct=o.useCallback((d,w)=>{let{sensor:A,options:K}=w;if(G.current==null)return;const B=C.get(G.current);if(!B)return;const W=d.nativeEvent,de=new A({active:G.current,activeNode:B,event:W,options:K,context:se,onAbort($){if(!C.get($))return;const{onDragAbort:he}=ie.current,Le={id:$};he==null||he(Le),N({type:"onDragAbort",event:Le})},onPending($,q,he,Le){if(!C.get($))return;const{onDragPending:st}=ie.current,_e={id:$,constraint:q,initialCoordinates:he,offset:Le};st==null||st(_e),N({type:"onDragPending",event:_e})},onStart($){const q=G.current;if(q==null)return;const he=C.get(q);if(!he)return;const{onDragStart:Le}=ie.current,rt={activatorEvent:W,active:{id:q,data:he.data,rect:X}};it.unstable_batchedUpdates(()=>{Le==null||Le(rt),R(Be.Initializing),j({type:ee.DragStart,initialCoordinates:$,active:q}),N({type:"onDragStart",event:rt}),Se(tt.current),ke(W)})},onMove($){j({type:ee.DragMove,coordinates:$})},onEnd:J(ee.DragEnd),onCancel:J(ee.DragCancel)});tt.current=de;function J($){return async function(){const{active:he,collisions:Le,over:rt,scrollAdjustedTranslate:st}=se.current;let _e=null;if(he&&st){const{cancelDrop:at}=ie.current;_e={activatorEvent:W,active:he,collisions:Le,delta:st,over:rt},$===ee.DragEnd&&typeof at=="function"&&await Promise.resolve(at(_e))&&($=ee.DragCancel)}G.current=null,it.unstable_batchedUpdates(()=>{j({type:$}),R(Be.Uninitialized),St(null),Se(null),ke(null),tt.current=null;const at=$===ee.DragEnd?"onDragEnd":"onDragCancel";if(_e){const Gt=ie.current[at];Gt==null||Gt(_e),N({type:at,event:_e})}})}}},[C]),Wt=o.useCallback((d,w)=>(A,K)=>{const B=A.nativeEvent,W=C.get(K);if(G.current!==null||!W||B.dndKit||B.defaultPrevented)return;const de={active:W};d(A,w.options,de)===!0&&(B.dndKit={capturedBy:w.sensor},G.current=K,Ct(A,w))},[C,Ct]),Nt=da(h,Wt);va(h),Te(()=>{k&&y===Be.Initializing&&R(Be.Initialized)},[k,y]),o.useEffect(()=>{const{onDragMove:d}=ie.current,{active:w,activatorEvent:A,collisions:K,over:B}=se.current;if(!w||!A)return;const W={active:w,activatorEvent:A,collisions:K,delta:{x:Ne.x,y:Ne.y},over:B};it.unstable_batchedUpdates(()=>{d==null||d(W),N({type:"onDragMove",event:W})})},[Ne.x,Ne.y]),o.useEffect(()=>{const{active:d,activatorEvent:w,collisions:A,droppableContainers:K,scrollAdjustedTranslate:B}=se.current;if(!d||G.current==null||!w||!B)return;const{onDragOver:W}=ie.current,de=K.get(jt),J=de&&de.rect.current?{id:de.id,rect:de.rect.current,data:de.data,disabled:de.disabled}:null,$={active:d,activatorEvent:w,collisions:A,delta:{x:B.x,y:B.y},over:J};it.unstable_batchedUpdates(()=>{St(J),W==null||W($),N({type:"onDragOver",event:$})})},[jt]),Te(()=>{se.current={activatorEvent:Q,active:ce,activeNode:H,collisionRect:ze,collisions:Ue,droppableRects:te,draggableNodes:C,draggingNode:Ce,draggingNodeRect:g,droppableContainers:F,over:De,scrollableAncestors:U,scrollAdjustedTranslate:Ne},X.current={initial:g,translated:ze}},[ce,H,Ue,ze,C,Ce,g,te,F,De,U,Ne]),oa({...fe,delta:_,draggingRect:ze,pointerCoordinates:$e,scrollableAncestors:U,scrollableAncestorRects:Y});const Dt=o.useMemo(()=>({active:ce,activeNode:H,activeNodeRect:k,activatorEvent:Q,collisions:Ue,containerNodeRect:Ie,dragOverlay:ae,draggableNodes:C,droppableContainers:F,droppableRects:te,over:De,measureDroppableContainers:le,scrollableAncestors:U,scrollableAncestorRects:Y,measuringConfiguration:O,measuringScheduled:we,windowRect:ne}),[ce,H,k,Q,Ue,Ie,ae,C,F,te,De,le,U,Y,O,we,ne]),nt=o.useMemo(()=>({activatorEvent:Q,activators:Nt,active:ce,activeNodeRect:k,ariaDescribedById:{draggable:ye},dispatch:j,draggableNodes:C,over:De,measureDroppableContainers:le}),[Q,Nt,ce,k,j,ye,C,De,le]);return V.createElement(ar.Provider,{value:D},V.createElement(yt.Provider,{value:nt},V.createElement(Sr.Provider,{value:Dt},V.createElement(Vt.Provider,{value:Ht},f)),V.createElement(Ta,{disabled:(l==null?void 0:l.restoreFocus)===!1})),V.createElement(ks,{...l,hiddenTextDescribedById:ye}));function qt(){const d=(be==null?void 0:be.autoScrollEnabled)===!1,w=typeof u=="object"?u.enabled===!1:u===!1,A=T&&!d&&!w;return typeof u=="object"?{...u,enabled:A}:{enabled:A}}}),Aa=o.createContext(null),An="button",ka="Draggable";function Oa(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const i=bt(ka),{activators:c,activatorEvent:l,active:u,activeNodeRect:f,ariaDescribedById:h,draggableNodes:m,over:b}=o.useContext(yt),{role:x=An,roleDescription:S="draggable",tabIndex:p=0}=a??{},v=(u==null?void 0:u.id)===t,j=o.useContext(v?Vt:Aa),[N,D]=Mt(),[y,R]=Mt(),T=ba(c,t),E=gt(n);Te(()=>(m.set(t,{id:t,key:i,node:N,activatorNode:y,data:E}),()=>{const _=m.get(t);_&&_.key===i&&m.delete(t)}),[m,t]);const C=o.useMemo(()=>({role:x,tabIndex:p,"aria-disabled":s,"aria-pressed":v&&x===An?!0:void 0,"aria-roledescription":S,"aria-describedby":h.draggable}),[s,x,p,v,S,h.draggable]);return{active:u,activatorEvent:l,activeNodeRect:f,attributes:C,isDragging:v,listeners:s?void 0:T,node:N,over:b,setNodeRef:D,setActivatorNodeRef:R,transform:j}}function Dr(){return o.useContext(Sr)}const Ia="Droppable",Ma={timeout:25};function pn(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const i=bt(Ia),{active:c,dispatch:l,over:u,measureDroppableContainers:f}=o.useContext(yt),h=o.useRef({disabled:n}),m=o.useRef(!1),b=o.useRef(null),x=o.useRef(null),{disabled:S,updateMeasurementsFor:p,timeout:v}={...Ma,...a},j=gt(p??s),N=o.useCallback(()=>{if(!m.current){m.current=!0;return}x.current!=null&&clearTimeout(x.current),x.current=setTimeout(()=>{f(Array.isArray(j.current)?j.current:[j.current]),x.current=null},v)},[v]),D=Yt({callback:N,disabled:S||!c}),y=o.useCallback((C,_)=>{D&&(_&&(D.unobserve(_),m.current=!1),C&&D.observe(C))},[D]),[R,T]=Mt(y),E=gt(t);return o.useEffect(()=>{!D||!R.current||(D.disconnect(),m.current=!1,D.observe(R.current))},[R,D]),o.useEffect(()=>(l({type:ee.RegisterDroppable,element:{id:s,key:i,disabled:n,node:R,rect:b,data:E}}),()=>l({type:ee.UnregisterDroppable,key:i,id:s})),[s]),o.useEffect(()=>{n!==h.current.disabled&&(l({type:ee.SetDroppableDisabled,id:s,key:i,disabled:n}),h.current.disabled=n)},[s,i,n,l]),{active:c,rect:b,isOver:(u==null?void 0:u.id)===s,node:R,over:u,setNodeRef:T}}function La(e){let{animation:t,children:n}=e;const[s,a]=o.useState(null),[i,c]=o.useState(null),l=Lt(n);return!n&&!s&&l&&a(l),Te(()=>{if(!i)return;const u=s==null?void 0:s.key,f=s==null?void 0:s.props.id;if(u==null||f==null){a(null);return}Promise.resolve(t(f,i)).then(()=>{a(null)})},[t,s,i]),V.createElement(V.Fragment,null,n,s?o.cloneElement(s,{ref:c}):null)}const Pa={x:0,y:0,scaleX:1,scaleY:1};function Fa(e){let{children:t}=e;return V.createElement(yt.Provider,{value:jr},V.createElement(Vt.Provider,{value:Pa},t))}const za={position:"fixed",touchAction:"none"},_a=e=>Kt(e)?"transform 250ms ease":void 0,Ba=o.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:i,className:c,rect:l,style:u,transform:f,transition:h=_a}=e;if(!l)return null;const m=a?f:{...f,scaleX:1,scaleY:1},b={...za,width:l.width,height:l.height,top:l.top,left:l.left,transform:Pe.Transform.toString(m),transformOrigin:a&&s?Is(s,l):void 0,transition:typeof h=="function"?h(s):h,...u};return V.createElement(n,{className:c,style:b,ref:t},i)}),$a=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:i,className:c}=e;if(i!=null&&i.active)for(const[l,u]of Object.entries(i.active))u!==void 0&&(a[l]=n.node.style.getPropertyValue(l),n.node.style.setProperty(l,u));if(i!=null&&i.dragOverlay)for(const[l,u]of Object.entries(i.dragOverlay))u!==void 0&&s.node.style.setProperty(l,u);return c!=null&&c.active&&n.node.classList.add(c.active),c!=null&&c.dragOverlay&&s.node.classList.add(c.dragOverlay),function(){for(const[u,f]of Object.entries(a))n.node.style.setProperty(u,f);c!=null&&c.active&&n.node.classList.remove(c.active)}},Ka=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Pe.Transform.toString(t)},{transform:Pe.Transform.toString(n)}]},Ua={duration:250,easing:"ease",keyframes:Ka,sideEffects:$a({styles:{active:{opacity:"0"}}})};function Ya(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return $t((i,c)=>{if(t===null)return;const l=n.get(i);if(!l)return;const u=l.node.current;if(!u)return;const f=wr(c);if(!f)return;const{transform:h}=ue(c).getComputedStyle(c),m=dr(h);if(!m)return;const b=typeof t=="function"?t:Va(t);return xr(u,a.draggable.measure),b({active:{id:i,data:l.data,node:u,rect:a.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:c,rect:a.dragOverlay.measure(f)},droppableContainers:s,measuringConfiguration:a,transform:m})})}function Va(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...Ua,...e};return i=>{let{active:c,dragOverlay:l,transform:u,...f}=i;if(!t)return;const h={x:l.rect.left-c.rect.left,y:l.rect.top-c.rect.top},m={scaleX:u.scaleX!==1?c.rect.width*u.scaleX/l.rect.width:1,scaleY:u.scaleY!==1?c.rect.height*u.scaleY/l.rect.height:1},b={x:u.x-h.x,y:u.y-h.y,...m},x=a({...f,active:c,dragOverlay:l,transform:{initial:u,final:b}}),[S]=x,p=x[x.length-1];if(JSON.stringify(S)===JSON.stringify(p))return;const v=s==null?void 0:s({active:c,dragOverlay:l,...f}),j=l.node.animate(x,{duration:t,easing:n,fill:"forwards"});return new Promise(N=>{j.onfinish=()=>{v==null||v(),N()}})}}let kn=0;function Xa(e){return o.useMemo(()=>{if(e!=null)return kn++,kn},[e])}const Tr=V.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:i,modifiers:c,wrapperElement:l="div",className:u,zIndex:f=999}=e;const{activatorEvent:h,active:m,activeNodeRect:b,containerNodeRect:x,draggableNodes:S,droppableContainers:p,dragOverlay:v,over:j,measuringConfiguration:N,scrollableAncestors:D,scrollableAncestorRects:y,windowRect:R}=Dr(),T=o.useContext(Vt),E=Xa(m==null?void 0:m.id),C=Cr(c,{activatorEvent:h,active:m,activeNodeRect:b,containerNodeRect:x,draggingNodeRect:v.rect,over:j,overlayNodeRect:v.rect,scrollableAncestors:D,scrollableAncestorRects:y,transform:T,windowRect:R}),_=gn(b),F=Ya({config:s,draggableNodes:S,droppableContainers:p,measuringConfiguration:N}),P=_?v.setRef:void 0;return V.createElement(Fa,null,V.createElement(La,{animation:F},m&&E?V.createElement(Ba,{key:E,id:m.id,ref:P,as:l,activatorEvent:h,adjustScale:t,className:u,transition:i,rect:_,style:{zIndex:f,...a},transform:C},n):null))});function Er(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Ha(e,t){return e.reduce((n,s,a)=>{const i=t.get(s);return i&&(n[a]=i),n},Array(e.length))}function Tt(e){return e!==null&&e>=0}function Wa(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function qa(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Rr=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const i=Er(t,s,n),c=t[a],l=i[a];return!l||!c?null:{x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height}},Et={scaleX:1,scaleY:1},Ar=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:i,overIndex:c}=e;const l=(t=i[n])!=null?t:s;if(!l)return null;if(a===n){const f=i[c];return f?{x:0,y:n<c?f.top+f.height-(l.top+l.height):f.top-l.top,...Et}:null}const u=Ga(i,a,n);return a>n&&a<=c?{x:0,y:-l.height-u,...Et}:a<n&&a>=c?{x:0,y:l.height+u,...Et}:{x:0,y:0,...Et}};function Ga(e,t,n){const s=e[t],a=e[t-1],i=e[t+1];return s?n<t?a?s.top-(a.top+a.height):i?i.top-(s.top+s.height):0:i?i.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const kr="Sortable",Or=V.createContext({activeIndex:-1,containerId:kr,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Rr,disabled:{draggable:!1,droppable:!1}});function Ir(e){let{children:t,id:n,items:s,strategy:a=Rr,disabled:i=!1}=e;const{active:c,dragOverlay:l,droppableRects:u,over:f,measureDroppableContainers:h}=Dr(),m=bt(kr,n),b=l.rect!==null,x=o.useMemo(()=>s.map(T=>typeof T=="object"&&"id"in T?T.id:T),[s]),S=c!=null,p=c?x.indexOf(c.id):-1,v=f?x.indexOf(f.id):-1,j=o.useRef(x),N=!Wa(x,j.current),D=v!==-1&&p===-1||N,y=qa(i);Te(()=>{N&&S&&h(x)},[N,x,S,h]),o.useEffect(()=>{j.current=x},[x]);const R=o.useMemo(()=>({activeIndex:p,containerId:m,disabled:y,disableTransforms:D,items:x,overIndex:v,useDragOverlay:b,sortedRects:Ha(x,u),strategy:a}),[p,m,y.draggable,y.droppable,D,x,v,u,b,a]);return V.createElement(Or.Provider,{value:R},t)}const Ja=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return Er(n,s,a).indexOf(t)},Za=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:i,newIndex:c,previousItems:l,previousContainerId:u,transition:f}=e;return!f||!s||l!==i&&a===c?!1:n?!0:c!==a&&t===u},Qa={duration:200,easing:"ease"},Mr="transform",eo=Pe.Transition.toString({property:Mr,duration:0,easing:"linear"}),to={roleDescription:"sortable"};function no(e){let{disabled:t,index:n,node:s,rect:a}=e;const[i,c]=o.useState(null),l=o.useRef(n);return Te(()=>{if(!t&&n!==l.current&&s.current){const u=a.current;if(u){const f=et(s.current,{ignoreTransform:!0}),h={x:u.left-f.left,y:u.top-f.top,scaleX:u.width/f.width,scaleY:u.height/f.height};(h.x||h.y)&&c(h)}}n!==l.current&&(l.current=n)},[t,n,s,a]),o.useEffect(()=>{i&&c(null)},[i]),i}function Lr(e){let{animateLayoutChanges:t=Za,attributes:n,disabled:s,data:a,getNewIndex:i=Ja,id:c,strategy:l,resizeObserverConfig:u,transition:f=Qa}=e;const{items:h,containerId:m,activeIndex:b,disabled:x,disableTransforms:S,sortedRects:p,overIndex:v,useDragOverlay:j,strategy:N}=o.useContext(Or),D=ro(s,x),y=h.indexOf(c),R=o.useMemo(()=>({sortable:{containerId:m,index:y,items:h},...a}),[m,a,y,h]),T=o.useMemo(()=>h.slice(h.indexOf(c)),[h,c]),{rect:E,node:C,isOver:_,setNodeRef:F}=pn({id:c,data:R,disabled:D.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...u}}),{active:P,activatorEvent:X,activeNodeRect:ce,attributes:G,setNodeRef:be,listeners:Se,isDragging:Q,over:ke,setActivatorNodeRef:ie,transform:ye}=Oa({id:c,data:R,attributes:{...to,...n},disabled:D.draggable}),Oe=vs(F,be),O=!!P,te=O&&!S&&Tt(b)&&Tt(v),le=!j&&Q,we=le&&te?ye:null,Fe=te?we??(l??N)({rects:p,activeNodeRect:ce,activeIndex:b,overIndex:v,index:y}):null,fe=Tt(b)&&Tt(v)?i({id:c,items:h,activeIndex:b,overIndex:v}):y,ve=P==null?void 0:P.id,k=o.useRef({activeId:ve,items:h,newIndex:fe,containerId:m}),Ie=h!==k.current.items,se=t({active:P,containerId:m,isDragging:Q,isSorting:O,id:c,index:y,items:h,newIndex:k.current.newIndex,previousItems:k.current.items,previousContainerId:k.current.containerId,transition:f,wasDragging:k.current.activeId!=null}),Re=no({disabled:!se,index:y,node:C,rect:E});return o.useEffect(()=>{O&&k.current.newIndex!==fe&&(k.current.newIndex=fe),m!==k.current.containerId&&(k.current.containerId=m),h!==k.current.items&&(k.current.items=h)},[O,fe,m,h]),o.useEffect(()=>{if(ve===k.current.activeId)return;if(ve!=null&&k.current.activeId==null){k.current.activeId=ve;return}const Ce=setTimeout(()=>{k.current.activeId=ve},50);return()=>clearTimeout(Ce)},[ve]),{active:P,activeIndex:b,attributes:G,data:R,rect:E,index:y,newIndex:fe,items:h,isOver:_,isSorting:O,isDragging:Q,listeners:Se,node:C,overIndex:v,over:ke,setNodeRef:Oe,setActivatorNodeRef:ie,setDroppableNodeRef:F,setDraggableNodeRef:be,transform:Re??Fe,transition:ae()};function ae(){if(Re||Ie&&k.current.newIndex===y)return eo;if(!(le&&!Kt(X)||!f)&&(O||se))return Pe.Transition.toString({...f,property:Mr})}}function ro(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}L.Down,L.Right,L.Up,L.Left;const so=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"title",label:"Título (A → Z)"},{value:"status",label:"Status"}],On={"A fazer":0,"Em andamento":1,Concluído:2},Rt=["A fazer","Em andamento","Concluído"],ao={"A fazer":"border-t-red-500/60","Em andamento":"border-t-yellow-500/60",Concluído:"border-t-green-500/60"};function oo(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"title":return n.title.localeCompare(s.title,"pt-BR");case"status":return(On[n.status]??0)-(On[s.status]??0);default:return 0}})}function io({id:e,children:t}){const{attributes:n,listeners:s,setNodeRef:a,transform:i,transition:c,isDragging:l}=Lr({id:e}),u={transform:Pe.Transform.toString(i),transition:c};return r.jsx("div",{ref:a,style:u,...n,...s,className:Z("touch-none",l&&"opacity-30"),children:t})}function lo({status:e,isOver:t,items:n,itemIds:s,today:a,onEdit:i,onDelete:c,showRichNotes:l}){const{setNodeRef:u}=pn({id:e});return r.jsxs("div",{className:Z("flex flex-col rounded-xl border border-border border-t-4 bg-card/40 min-h-[400px] transition-colors",ao[e]||"border-t-muted/60",t&&"bg-card/80 ring-2 ring-primary/20"),children:[r.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border shadow-sm bg-background/50 backdrop-blur-md rounded-t-xl",children:[r.jsx(Ae,{variant:"secondary",className:tn[e],children:ft[e]}),r.jsx(Ae,{variant:"secondary",className:"ml-auto text-xs bg-secondary/50",children:n.length})]}),r.jsxs("div",{ref:u,"data-column-status":e,className:"flex-1 p-3 space-y-3",children:[r.jsx(Ir,{items:s,strategy:Ar,children:n.map(f=>r.jsx(io,{id:f.id,children:r.jsx(on,{sub:f,today:a,onEdit:()=>i(f),onDelete:()=>c(f.id),showRichNotes:l})},f.id))}),n.length===0&&r.jsxs("div",{className:"sticky top-[40vh] flex flex-col items-center justify-center text-xs text-muted-foreground/50 border-2 border-dashed border-border/50 rounded-xl p-4 text-center gap-1",children:[r.jsx(Ae,{variant:"secondary",className:Z("font-medium mb-1",tn[e]),children:ft[e]}),r.jsx("span",{children:"Arraste subtarefas para cá"})]})]})]})}const on=o.memo(function({sub:t,today:n,showStatus:s,onEdit:a,onDelete:i,showRichNotes:c}){const l=t.dueDate&&t.dueDate<n&&t.status!=="Concluído";return r.jsx(ht,{className:Z("transition-shadow duration-150",l&&"border-destructive/50"),children:r.jsx(mt,{className:"p-3",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[s&&r.jsx(Ae,{variant:"secondary",className:Z("text-[10px]",tn[t.status]),children:ft[t.status]}),l&&r.jsx(Ae,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),r.jsx("p",{className:Z("font-medium text-sm",t.completed&&"line-through text-muted-foreground"),children:t.title}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[r.jsx("span",{className:"font-medium",children:"Tarefa:"})," ",t.parentTaskTitle]}),r.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[t.projectName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Jn,{className:"w-3 h-3"}),t.projectName]}),t.assignee&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Zn,{className:"w-3 h-3"}),t.assignee]}),t.dueDate&&r.jsxs("span",{className:Z("flex items-center gap-1",l&&"text-destructive font-medium"),children:[r.jsx(Qn,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]}),t.notes&&c&&r.jsx("div",{className:"text-xs text-muted-foreground mt-1 prose prose-xs max-w-none [&>*]:m-0 [&>*]:text-xs line-clamp-4",dangerouslySetInnerHTML:{__html:Pn(t.notes)||t.notes}}),t.notes&&!c&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.notes.replace(/<[^>]*>/g,"")})]}),r.jsxs("div",{className:"flex gap-1 shrink-0",children:[r.jsx(Ye,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:a,children:r.jsx(ts,{className:"w-3.5 h-3.5"})}),r.jsx(Ye,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:i,children:r.jsx(ns,{className:"w-3.5 h-3.5"})})]})]})})})});function co({tasks:e,projects:t,loading:n,onCreateSubtask:s,onUpdateSubtask:a,onDeleteSubtask:i}){const[c,l]=o.useState(!1),[u,f]=o.useState(null),[h,m]=o.useState("kanban"),[b,x]=o.useState(""),[S,p]=o.useState("all"),[v,j]=o.useState("all"),[N,D]=o.useState("all"),[y,R]=o.useState("all"),[T,E]=o.useState("all"),[C,_]=o.useState("deadline"),[F,P]=o.useState(!1),[X,ce]=o.useState(!1),[G,be]=o.useState(null),[Se,Q]=o.useState(null),[ke,ie]=o.useState(null),ye=ir(or(Ut,{activationConstraint:{distance:8}})),Oe=o.useMemo(()=>{const g={};return t.forEach(I=>{g[I.id]=I.name}),g},[t]),O=o.useMemo(()=>e.flatMap(g=>g.subtasks.map(I=>({...I,parentTaskTitle:g.title,projectId:g.projectId,projectName:g.projectId?Oe[g.projectId]:void 0}))),[e,Oe]),te=o.useMemo(()=>{const g=new Date,I=new Date(g.getFullYear(),g.getMonth(),g.getDate()),M=new Date(I);M.setDate(I.getDate()+(7-I.getDay()));const ne=new Date(g.getFullYear(),g.getMonth()+1,0),U=O.filter(Y=>{if(b&&!Y.title.toLowerCase().includes(b.toLowerCase())||S!=="all"&&Y.status!==S||v!=="all"&&Y.assignee!==v||N!=="all"&&Y.projectId!==N||y!=="all"&&Y.parentTaskId!==y)return!1;if(T!=="all"){if(!Y.dueDate)return T==="sem_prazo";const oe=new Date(Y.dueDate+"T23:59:59");switch(T){case"atrasadas":return oe<I&&Y.status!=="Concluído";case"hoje":return Y.dueDate===le;case"esta_semana":return oe>=I&&oe<=M;case"este_mes":return oe>=I&&oe<=ne;case"sem_prazo":return!1}}return!0});return oo(U,C)},[O,b,S,v,N,y,C]),le=o.useMemo(()=>{const g=new Date;return`${g.getFullYear()}-${String(g.getMonth()+1).padStart(2,"0")}-${String(g.getDate()).padStart(2,"0")}`},[]);o.useMemo(()=>{const g={"A fazer":0,"Em andamento":0,Concluído:0},I=O.filter(M=>M.dueDate&&M.dueDate<le&&M.status!=="Concluído").length;return O.forEach(M=>{g[M.status]!==void 0&&g[M.status]++}),{...g,overdue:I,total:O.length}},[O,le]);const we=o.useCallback(()=>{f(null),l(!0)},[]),H=o.useCallback(g=>{f(g),l(!0)},[]),Fe=o.useCallback(async(g,I,M)=>{I?await s(g.parentTaskId,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0}):M&&await a(M,{title:g.title,deadline:g.deadline||void 0,status:g.status,assignee:g.assignee||void 0,notes:g.notes||void 0})},[s,a]),fe=o.useCallback(async()=>{G&&(await i(G),be(null))},[G,i]),ve=o.useMemo(()=>{const g={"A fazer":[],"Em andamento":[],Concluído:[]};return te.forEach(I=>{g[I.status]&&g[I.status].push(I)}),g},[te]),k=o.useCallback(g=>{Q(String(g.active.id))},[]),Ie=o.useCallback(g=>{const{over:I}=g;if(!I){ie(null);return}const M=String(I.id),ne=O.find(Y=>Y.id===M),U=ne?ne.status:Rt.includes(M)?M:null;ie(U)},[O]),se=o.useCallback(async g=>{const{active:I,over:M}=g;if(Q(null),ie(null),!M)return;const ne=String(I.id),U=String(M.id);if(ne===U)return;const Y=O.find(Me=>Me.id===ne);if(!Y)return;const oe=O.find(Me=>Me.id===U),$e=oe?oe.status:Rt.includes(U)?U:Y.status;Y.status!==$e&&await a(ne,{status:$e})},[O,a]),Re=o.useCallback(()=>{Q(null),ie(null)},[]),ae=Se?O.find(g=>g.id===Se):null,Ce=o.useMemo(()=>Rt.filter(g=>!F||g!=="Concluído"),[F]);return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3 glass p-4 rounded-xl border border-border shadow-sm mb-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(cn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(Ot,{placeholder:"Buscar subtarefa...",value:b,onChange:g=>x(g.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[r.jsxs(Ye,{onClick:we,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity h-9",children:[r.jsx(qn,{className:"mr-1.5 h-4 w-4"})," Nova Subtarefa"]}),r.jsxs("div",{className:"flex border border-border rounded-lg overflow-hidden bg-muted/40",children:[r.jsxs("button",{onClick:()=>m("kanban"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",h==="kanban"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(tr,{className:"w-4 h-4"})," Kanban"]}),r.jsxs("button",{onClick:()=>m("list"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",h==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(Gn,{className:"w-4 h-4"})," Lista"]})]})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap flex-1",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Status"}),r.jsxs(me,{value:S,onValueChange:p,children:[r.jsx(ge,{className:"w-[130px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos Status"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todos Status"}),Rt.map(g=>r.jsx(z,{value:g,children:ft[g]},g))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prazo"}),r.jsxs(me,{value:T,onValueChange:E,children:[r.jsx(ge,{className:"w-[120px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todos"}),r.jsx(z,{value:"atrasadas",children:"Atrasadas"}),r.jsx(z,{value:"hoje",children:"Vence hoje"}),r.jsx(z,{value:"esta_semana",children:"Esta semana"}),r.jsx(z,{value:"este_mes",children:"Este mês"}),r.jsx(z,{value:"sem_prazo",children:"Sem prazo"})]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Responsável"}),r.jsxs(me,{value:v,onValueChange:j,children:[r.jsx(ge,{className:"w-[120px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todos"}),Bn.map(g=>r.jsx(z,{value:g,children:g},g))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Tarefa-mãe"}),r.jsxs(me,{value:y,onValueChange:R,children:[r.jsx(ge,{className:"w-[160px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todas"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todas"}),e.map(g=>r.jsx(z,{value:g.id,children:g.title},g.id))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Ordenar por"}),r.jsxs(me,{value:C,onValueChange:g=>_(g),children:[r.jsx(ge,{className:"w-[160px] h-8 text-xs",children:r.jsx(pe,{})}),r.jsx(xe,{children:so.map(g=>r.jsx(z,{value:g.value,children:g.label},g.value))})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1.5 ml-auto shrink-0",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar concluídas",r.jsx(lt,{checked:F,onCheckedChange:P,className:"scale-75"})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Observações formatadas",r.jsx(lt,{checked:X,onCheckedChange:ce,className:"scale-75"})]})]})]})]}),r.jsx(xs,{open:c,onOpenChange:l,subtask:u,tasks:e,onSave:Fe}),r.jsx($n,{open:!!G,onOpenChange:g=>!g&&be(null),children:r.jsxs(Kn,{children:[r.jsxs(Un,{children:[r.jsx(Yn,{children:"Remover subtarefa?"}),r.jsx(Vn,{children:"Esta ação não pode ser desfeita. A subtarefa será removida permanentemente."})]}),r.jsxs(Xn,{children:[r.jsx(Hn,{children:"Cancelar"}),r.jsx(Wn,{onClick:fe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?r.jsx("div",{className:"space-y-3",children:[1,2,3].map(g=>r.jsx(ht,{children:r.jsx(mt,{className:"p-4",children:r.jsx("div",{className:"h-16 bg-muted animate-pulse rounded"})})},g))}):h==="list"?r.jsx("div",{className:"space-y-3",children:te.length===0?r.jsx(ht,{children:r.jsx(mt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma subtarefa encontrada."})}):te.map(g=>r.jsx(on,{sub:g,today:le,showStatus:!0,onEdit:()=>H(g),onDelete:()=>be(g.id),showRichNotes:X},g.id))}):r.jsxs(Nr,{sensors:ye,collisionDetection:lr,onDragStart:k,onDragOver:Ie,onDragEnd:se,onDragCancel:Re,children:[r.jsx("div",{className:"overflow-x-auto -mx-2 px-2 pb-4",children:r.jsx("div",{className:"flex gap-4",style:{minWidth:`${Ce.length*300}px`},children:Ce.map(g=>{const I=ke===g,M=ve[g],ne=M.map(U=>U.id);return r.jsx("div",{className:"flex-1 min-w-[260px]",children:r.jsx(lo,{status:g,isOver:I,items:M,itemIds:ne,today:le,onEdit:H,onDelete:be,showRichNotes:X})},g)})})}),r.jsx(Tr,{children:ae&&r.jsx("div",{className:"shadow-xl ring-2 ring-primary/30 rotate-[2deg] scale-105",children:r.jsx(on,{sub:ae,today:le,showStatus:!0,onEdit:()=>{},onDelete:()=>{},showRichNotes:X})})})]})]})}const uo=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"priority",label:"Prioridade (Alta → Baixa)"},{value:"title",label:"Título (A → Z)"},{value:"client",label:"Cliente (A → Z)"}],In={alta:0,media:1,baixa:2};function Mn(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"priority":return(In[n.priority]??1)-(In[s.priority]??1);case"title":return n.title.localeCompare(s.title,"pt-BR");case"client":return(n.client??"").localeCompare(s.client??"","pt-BR");default:return 0}})}const fo={client:!0,dueDate:!0,priority:!0,subtasks:!0,tags:!0,description:!0,richDescription:!1},Ln={client:"Cliente",dueDate:"Data de entrega",priority:"Prioridade",subtasks:"Subtarefas",tags:"Tags",description:"Descrição",richDescription:"Observação formatada"},At=["pendente","agendado","em_andamento","em_tramite","concluida","cancelada"],ho={pendente:"border-t-red-500/60",agendado:"border-t-blue-500/60",em_andamento:"border-t-yellow-500/60",em_tramite:"border-t-orange-500/60",concluida:"border-t-green-500/60",cancelada:"border-t-muted/60"},mo={pendente:er,agendado:ds,em_andamento:vn,em_tramite:vn,concluida:us,cancelada:cs},go=[{value:"all",label:"Todos"},{value:"today",label:"Hoje"},{value:"this_week",label:"Esta semana"},{value:"this_month",label:"Este mês"},{value:"overdue",label:"Atrasadas"},{value:"no_deadline",label:"Sem prazo"}],ln=o.memo(function({task:t,cardFields:n,today:s,isExpanded:a,onToggleExpand:i,onToggleSubtask:c,onEdit:l,onDelete:u,showStatus:f,isDragging:h,isOverlay:m,projectName:b}){const x=t.subtasks.filter(v=>v.completed).length,S=t.subtasks.length,p=t.dueDate&&t.dueDate<s&&t.status!=="concluida"&&t.status!=="cancelada";return r.jsx(ht,{className:Z("relative group transition-all duration-200 hover:shadow-md cursor-pointer",h?"opacity-40 scale-95":"",m&&"shadow-2xl ring-2 ring-primary/40 rotate-[2deg] scale-105 cursor-grabbing","border-border/50 bg-card"),onClick:()=>l==null?void 0:l(t),children:r.jsxs(mt,{className:"p-3.5",children:[b&&r.jsx("div",{className:"mb-2",children:r.jsxs(Ae,{variant:"outline",className:"text-[10px] px-1.5 py-0 gap-1 font-normal",children:[r.jsx(Jn,{className:"w-3 h-3"}),b]})}),r.jsx("p",{className:"font-medium text-sm mb-1",children:t.title}),n.description&&t.description&&!n.richDescription&&r.jsx("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-2",children:t.description.replace(/<[^>]*>/g,"")}),n.richDescription&&t.description&&r.jsx("div",{className:"text-xs text-muted-foreground mb-2 prose prose-xs max-w-none [&>*]:m-0 [&>*]:text-xs line-clamp-4",dangerouslySetInnerHTML:{__html:Pn(t.description)||t.description}}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[n.priority&&r.jsx(Ae,{variant:"secondary",className:`text-[10px] ${Wr[t.priority]}`,children:nn[t.priority]}),f&&r.jsx(Ae,{variant:"secondary",className:`text-[10px] ${qr[t.status]}`,children:It[t.status]}),n.dueDate&&t.dueDate&&r.jsxs("span",{className:Z("flex items-center gap-1",p&&"text-destructive font-medium"),children:[p?r.jsx(er,{className:"w-3 h-3"}):r.jsx(Qn,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]}),p&&r.jsx("span",{className:"text-destructive font-medium",children:"Atrasada"}),t.assignee&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Zn,{className:"w-3 h-3"}),t.assignee]})]}),n.subtasks&&S>0&&!m&&r.jsx("div",{className:"flex justify-end mt-2",children:r.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:[r.jsx(nr,{className:"w-3 h-3"}),x,"/",S]})}),n.tags&&t.tags&&t.tags.length>0&&!m&&r.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.map(v=>r.jsx(Ae,{variant:"outline",className:"text-[10px]",children:v},v))})]})})});function po(e){const{attributes:t,listeners:n,setNodeRef:s,transform:a,transition:i,isDragging:c}=Lr({id:e.task.id}),l={transform:Pe.Transform.toString(a),transition:i};return r.jsx("div",{ref:s,style:l,...t,...n,children:r.jsx(ln,{...e,isDragging:c})})}function xo({status:e,tasks:t,isOver:n,cardFields:s,today:a,expandedTasks:i,onToggleExpand:c,onToggleSubtask:l,onEdit:u,onDelete:f,projectMap:h}){const m=o.useMemo(()=>t.map(S=>S.id),[t]),{setNodeRef:b}=pn({id:e}),x=mo[e];return r.jsxs("div",{className:Z("flex flex-col rounded-xl border border-border border-t-4 bg-card/40 min-h-[400px] transition-colors",ho[e]||"border-t-muted/60",n&&"bg-card/80 ring-2 ring-primary/20"),children:[r.jsxs("div",{className:"flex items-center gap-2 p-3 px-4",children:[r.jsx(x,{className:Z("w-4 h-4",{"text-red-500":e==="pendente","text-blue-500":e==="agendado","text-yellow-500":e==="em_andamento","text-orange-500":e==="em_tramite","text-green-500":e==="concluida","text-muted-foreground":e==="cancelada"})}),r.jsx("span",{className:"text-sm font-medium",children:It[e]}),r.jsx(Ae,{variant:"secondary",className:"ml-auto text-xs bg-secondary/50 tabular-nums",children:t.length})]}),r.jsxs("div",{ref:b,"data-column-status":e,className:"flex-1 p-3 pt-0 space-y-3",children:[r.jsx(Ir,{items:m,strategy:Ar,children:t.map(S=>r.jsx(po,{task:S,cardFields:s,today:a,isExpanded:i.has(S.id),onToggleExpand:c,onToggleSubtask:l,onEdit:u,onDelete:f,projectName:h.get(S.projectId||"")},S.id))}),t.length===0&&r.jsx("div",{className:"flex flex-col items-center justify-center text-xs text-muted-foreground/50 border-2 border-dashed border-border/50 rounded-xl p-4 text-center gap-1 min-h-[100px]",children:r.jsx("span",{children:"Arraste tarefas para cá"})})]})]})}function vo({projectId:e,clientNameFilter:t,hideHeader:n,forceTab:s}={}){const{tasks:a,setTasks:i,loading:c,error:l,updateTaskStatus:u,deleteTask:f,createTask:h,updateTask:m,createSubtask:b,updateSubtask:x,deleteSubtask:S}=ss(),{projects:p}=as(),[v,j]=o.useState(!1),[N,D]=o.useState(null),[y,R]=o.useState([]),[T,E]=o.useState("kanban"),[C,_]=o.useState(""),[F,P]=o.useState("all"),[X,ce]=o.useState("all"),[G,be]=o.useState("all"),[Se,Q]=o.useState(e||"all"),[ke,ie]=o.useState(new Set),[ye,Oe]=o.useState(fo),[O,te]=o.useState(null),[le,we]=o.useState(null),[H,Fe]=o.useState("deadline"),[fe,ve]=o.useState(!1),[k,Ie]=o.useState(!1),[se,Re]=o.useState("all"),[ae,Ce]=o.useState("all");o.useEffect(()=>{a.length>0&&R(t?a.filter(d=>{var w;return(w=d.client)==null?void 0:w.toLowerCase().includes(t.toLowerCase())}):a)},[a,t]);const g=o.useMemo(()=>{const d=new Date;return`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`},[]),I=o.useMemo(()=>[...new Set(y.map(d=>d.assignee).filter(Boolean))],[y]),M=o.useMemo(()=>{const d=e||Se,w=new Date,A=new Date(w);A.setDate(w.getDate()+7);const K=new Date(w.getFullYear(),w.getMonth()+1,0),B=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}-${String(A.getDate()).padStart(2,"0")}`,W=`${K.getFullYear()}-${String(K.getMonth()+1).padStart(2,"0")}-${String(K.getDate()).padStart(2,"0")}`,de=y.filter(J=>{var $;if(C&&!J.title.toLowerCase().includes(C.toLowerCase())||F!=="all"&&J.status!==F||X!=="all"&&J.priority!==X||G!=="all"&&J.client!==G||ae!=="all"&&J.assignee!==ae||d!=="all"&&J.projectId!==d)return!1;if(se!=="all"){const q=($=J.dueDate)==null?void 0:$.split("T")[0];switch(se){case"today":if(q!==g)return!1;break;case"this_week":if(!q||q<g||q>B)return!1;break;case"this_month":if(!q||q<g||q>W)return!1;break;case"overdue":if(!q||q>=g||J.status==="concluida"||J.status==="cancelada")return!1;break;case"no_deadline":if(q)return!1;break}}return!0});return Mn(de,H)},[y,C,F,X,G,ae,Se,H,se,g]),ne=g,U=o.useMemo(()=>O?y.find(d=>d.id===O):null,[O,y]),Y=o.useMemo(()=>[...new Set(y.map(d=>d.client).filter(Boolean))],[y]),oe=o.useMemo(()=>{const d=new Map;return p.forEach(w=>d.set(w.id,w.name)),d},[p]),$e=o.useMemo(()=>y.reduce((d,w)=>d+w.subtasks.length,0),[y]),Me=o.useCallback(d=>{ie(w=>{const A=new Set(w);return A.has(d)?A.delete(d):A.add(d),A})},[]),wt=o.useCallback((d,w)=>{R(A=>A.map(K=>K.id===d?{...K,subtasks:K.subtasks.map(B=>B.id===w?{...B,completed:!B.completed}:B)}:K))},[]),[Ke,Ne]=o.useState(null),ze=o.useCallback(async()=>{Ke&&(f(Ke),R(d=>d.filter(w=>w.id!==Ke)),Ne(null))},[Ke,f]),Ue=o.useCallback(d=>{Oe(w=>({...w,[d]:!w[d]}))},[]),jt=o.useCallback(()=>{D(null),j(!0)},[]),De=o.useCallback(d=>{D(d),j(!0)},[]),St=o.useCallback(async(d,w,A)=>{w?await h({title:d.title,deadline:d.deadline,priority:d.priority,status:d.status,clientName:d.clientName,projectId:d.projectId,assignee:d.assignee,description:d.description}):A&&await m(A,{title:d.title,deadline:d.deadline,priority:d.priority,status:d.status,clientName:d.clientName,projectId:d.projectId,assignee:d.assignee,description:d.description})},[h,m]),Xt=ir(or(Ut,{activationConstraint:{distance:8}}));o.useCallback(d=>{const w=y.find(A=>A.id===d);return w==null?void 0:w.status},[y]);const Ht=o.useCallback(d=>{te(d.active.id)},[]),tt=o.useCallback(d=>{const{over:w}=d;if(!w){we(null);return}const A=w.id,K=y.find(W=>W.id===A),B=K?K.status:At.includes(A)?A:null;we(B)},[y]),Ct=o.useCallback(d=>{const{active:w,over:A}=d;if(te(null),we(null),!A)return;const K=w.id,B=A.id;if(K===B)return;const W=y.find($=>$.id===K);if(!W)return;const de=y.find($=>$.id===B),J=de?de.status:At.includes(B)?B:W.status;W.status!==J&&(R($=>{const q=$.map(he=>he.id===K?{...he,status:J}:he);return Mn(q,H)}),u(K,J))},[y,u,H]),Wt=o.useCallback(()=>{te(null),we(null)},[]),Nt=o.useMemo(()=>{const d={};return At.forEach(w=>{d[w]=[]}),M.forEach(w=>{d[w.status]&&d[w.status].push(w)}),d},[M]),Dt=o.useMemo(()=>At.filter(d=>!(fe&&d==="concluida"||k&&d==="cancelada")),[fe,k]),[nt,qt]=o.useState(s||"tarefas");return r.jsxs(xn.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[!s&&r.jsx("div",{className:"flex items-center gap-1 rounded-2xl border border-border bg-muted/40 p-1 w-fit backdrop-blur-sm mb-5",children:[{id:"tarefas",label:"Tarefas",icon:ls,count:M.length},{id:"subtarefas",label:"Subtarefas",icon:nr,count:$e}].map(d=>{const w=nt===d.id,A=d.icon;return r.jsxs("button",{onClick:()=>qt(d.id),className:Z("relative flex items-center gap-2 rounded-xl px-5 py-2.5 text-sm font-medium transition-all duration-200",w?"text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-background/50"),children:[w&&r.jsx(xn.div,{layoutId:"tarefas-tab-bg",className:"absolute inset-0 rounded-xl gold-gradient shadow-sm",transition:{type:"spring",bounce:.15,duration:.5}}),r.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[r.jsx(A,{className:"h-4 w-4"}),d.label,r.jsx("span",{className:Z("inline-flex items-center justify-center rounded-full px-2 py-0.5 text-[10px] font-semibold tabular-nums min-w-[22px] transition-colors",w?"bg-primary-foreground/20 text-primary-foreground":"bg-secondary text-muted-foreground"),children:d.count})]})]},d.id)})}),nt==="tarefas"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex flex-col gap-3 glass p-4 rounded-xl border border-border shadow-sm mb-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(cn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(Ot,{placeholder:"Buscar tarefas...",value:C,onChange:d=>_(d.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[r.jsxs(Ye,{onClick:jt,className:"gold-gradient text-primary-foreground shadow-md hover:opacity-90 transition-opacity h-9",children:[r.jsx(qn,{className:"mr-1.5 h-4 w-4"})," Nova Tarefa"]}),r.jsxs("div",{className:"flex border border-border rounded-lg overflow-hidden bg-muted/40",children:[r.jsxs("button",{onClick:()=>E("kanban"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",T==="kanban"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(tr,{className:"w-4 h-4"})," Kanban"]}),r.jsxs("button",{onClick:()=>E("list"),className:Z("flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium transition-colors",T==="list"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[r.jsx(Gn,{className:"w-4 h-4"})," Lista"]})]}),l&&r.jsx("span",{className:"text-xs text-destructive",children:"Erro ao carregar"}),r.jsxs(Fn,{children:[r.jsx(zn,{asChild:!0,children:r.jsx(Ye,{variant:"outline",size:"icon",className:"h-9 w-9",children:r.jsx(ms,{className:"w-4 h-4"})})}),r.jsx(_n,{className:"w-56",align:"end",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm font-medium mb-2",children:"Mostrar nos cards"}),Object.keys(Ln).map(d=>r.jsxs("div",{className:"flex items-center justify-between py-1",children:[r.jsx(rs,{htmlFor:`field-${d}`,className:"text-sm cursor-pointer",children:Ln[d]}),r.jsx(lt,{id:`field-${d}`,checked:ye[d],onCheckedChange:()=>Ue(d)})]},d))]})})]})]})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-end",children:[r.jsx(hs,{className:"w-4 h-4 text-muted-foreground shrink-0 mb-2"}),r.jsxs("div",{className:"flex items-end gap-2 flex-wrap flex-1",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Status"}),r.jsxs(me,{value:F,onValueChange:P,children:[r.jsx(ge,{className:"w-[130px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos Status"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todos Status"}),Object.keys(It).map(d=>r.jsx(z,{value:d,children:It[d]},d))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prioridade"}),r.jsxs(me,{value:X,onValueChange:ce,children:[r.jsx(ge,{className:"w-[110px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todas"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todas"}),Object.keys(nn).map(d=>r.jsx(z,{value:d,children:nn[d]},d))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Prazo"}),r.jsxs(me,{value:se,onValueChange:d=>Re(d),children:[r.jsx(ge,{className:"w-[110px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos"})}),r.jsx(xe,{children:go.map(d=>r.jsx(z,{value:d.value,children:d.label},d.value))})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Responsável"}),r.jsxs(me,{value:ae,onValueChange:Ce,children:[r.jsx(ge,{className:"w-[120px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todos"}),I.map(d=>r.jsx(z,{value:d,children:d},d))]})]})]}),!e&&r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Projeto"}),r.jsxs(me,{value:Se,onValueChange:Q,children:[r.jsx(ge,{className:"w-[150px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todos Projetos"}),p.map(d=>r.jsx(z,{value:d.id,children:d.name},d.id))]})]})]}),Y.length>0&&r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Cliente"}),r.jsxs(me,{value:G,onValueChange:be,children:[r.jsx(ge,{className:"w-[130px] h-8 text-xs",children:r.jsx(pe,{placeholder:"Todos"})}),r.jsxs(xe,{children:[r.jsx(z,{value:"all",children:"Todos Clientes"}),Y.map(d=>r.jsx(z,{value:d,children:d},d))]})]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] text-muted-foreground mb-0.5",children:"Ordenar por"}),r.jsxs(me,{value:H,onValueChange:d=>Fe(d),children:[r.jsx(ge,{className:"w-[160px] h-8 text-xs",children:r.jsx(pe,{})}),r.jsxs(xe,{children:[r.jsx(z,{value:"deadline",children:"Sem ordenação"}),uo.map(d=>r.jsx(z,{value:d.value,children:d.label},d.value))]})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-1.5 ml-auto shrink-0",children:[r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar canceladas",r.jsx(lt,{checked:k,onCheckedChange:Ie,className:"scale-75"})]}),r.jsxs("label",{className:"flex items-center gap-2 text-xs text-muted-foreground cursor-pointer select-none justify-end",children:["Ocultar concluídas",r.jsx(lt,{checked:fe,onCheckedChange:ve,className:"scale-75"})]})]})]})]}),r.jsx(zr,{open:v,onOpenChange:j,task:N,onSave:St,onCreateSubtask:b,onUpdateSubtask:x,onDeleteSubtask:S}),r.jsx($n,{open:!!Ke,onOpenChange:d=>!d&&Ne(null),children:r.jsxs(Kn,{children:[r.jsxs(Un,{children:[r.jsx(Yn,{children:"Remover tarefa?"}),r.jsx(Vn,{children:"Esta ação não pode ser desfeita. A tarefa será removida permanentemente."})]}),r.jsxs(Xn,{children:[r.jsx(Hn,{children:"Cancelar"}),r.jsx(Wn,{onClick:ze,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),c?T==="list"?r.jsx(os,{}):r.jsx(is,{}):T==="list"?r.jsx("div",{className:"space-y-3",children:M.length===0?r.jsx(ht,{children:r.jsx(mt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma tarefa encontrada."})}):M.map(d=>r.jsx(ln,{task:d,cardFields:ye,today:ne,isExpanded:ke.has(d.id),onToggleExpand:Me,onToggleSubtask:wt,onEdit:De,onDelete:Ne,showStatus:!0,projectName:oe.get(d.projectId||"")},d.id))}):r.jsxs(Nr,{sensors:Xt,collisionDetection:lr,onDragStart:Ht,onDragOver:tt,onDragEnd:Ct,onDragCancel:Wt,children:[r.jsx("div",{className:"overflow-x-auto -mx-2 px-2 pb-4",children:r.jsx("div",{className:"flex gap-4",style:{minWidth:`${Dt.length*280}px`},children:Dt.map(d=>r.jsx("div",{className:"flex-1 min-w-[260px]",children:r.jsx(xo,{status:d,tasks:Nt[d],isOver:le===d&&O!==null,cardFields:ye,today:ne,expandedTasks:ke,onToggleExpand:Me,onToggleSubtask:wt,onEdit:De,onDelete:Ne,projectMap:oe})},d))})}),r.jsx(Tr,{dropAnimation:{duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)"},children:U?r.jsx("div",{className:"w-[260px]",children:r.jsx(ln,{task:U,cardFields:ye,today:ne,isExpanded:!1,onToggleExpand:()=>{},onToggleSubtask:()=>{},onDelete:()=>{},isOverlay:!0,projectName:oe.get(U.projectId||"")})}):null})]})]}),nt==="subtarefas"&&r.jsx(co,{tasks:e?y.filter(d=>d.projectId===e):y,projects:p,loading:c,onCreateSubtask:b,onUpdateSubtask:x,onDeleteSubtask:S})]})}const qo=Object.freeze(Object.defineProperty({__proto__:null,default:vo},Symbol.toStringTag,{value:"Module"}));export{vo as A,nr as L,qo as a};
