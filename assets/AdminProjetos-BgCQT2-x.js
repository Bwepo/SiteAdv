import{c as Z,an as $,_ as ee,r as s,l as I,j as e,e as re}from"./index-BMDTlWzG.js";import{A as se,P as L,F as R,B}from"./AdminLayout-DZwxHSBJ.js";import{C as f,c as N}from"./card-6gda0clM.js";import{B as o}from"./button-CgbmT4aX.js";import{I as C}from"./input-CKcuu7Jp.js";import{D as ae,a as te,c as oe,d as le,f as ne}from"./dialog-CxpHdbU5.js";import{A as ie,a as de,b as ce,c as me,d as ue,e as xe,f as pe,g as he}from"./alert-dialog-P2xgdHLE.js";import{S as F,a as z,b as M,d as J,e as y}from"./select-CgFeC9EE.js";import{S as be}from"./SyncToolbar-B7iNLi7W.js";import{L as x}from"./label-WV5YjFg1.js";import{S as ge}from"./search-DECeClkP.js";import{C as je}from"./circle-check-CjtbMqbS.js";import{P as ve}from"./pencil-B5sIECDn.js";import{T as fe}from"./trash-2-DuqO7YMt.js";import"./heart-CZo_sTVX.js";import"./sparkles-BD8n7rJK.js";import"./ThemeToggle-Cw0uMEj6.js";import"./calendar-BhdFccp0.js";import"./house-CTjidkC1.js";import"./users-C35XAPJ3.js";import"./file-text-BiWSHexe.js";import"./index-D8Vs1H0p.js";import"./index-LCcQ49ni.js";import"./index-i9GKX4V-.js";import"./chevron-up-yUozLexO.js";import"./check-D6uv4zKf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=Z("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),Ce={Ativo:"bg-emerald-50 text-emerald-700 dark:bg-emerald-950/30 dark:text-emerald-400 border border-emerald-200/50 dark:border-emerald-800/50","Em Espera":"bg-amber-50 text-amber-700 dark:bg-amber-950/30 dark:text-amber-400 border border-amber-200/50 dark:border-amber-800/50",Concluído:"bg-blue-50 text-blue-700 dark:bg-blue-950/30 dark:text-blue-400 border border-blue-200/50 dark:border-blue-800/50",Cancelado:"bg-destructive/5 text-destructive dark:bg-destructive/20 border border-destructive/20"},ye=["Ativo","Em Espera","Concluído","Cancelado"],ke=["Extra","CLT","Pessoal"];function Ye(){const{projects:p,loading:V,syncing:q,error:H,lastSync:K,sync:U,createProject:k,updateProject:S,deleteProject:w}=$(),{tasks:A}=ee(),G=s.useMemo(()=>{const r={};for(const a of A)a.projectId&&(r[a.projectId]||(r[a.projectId]={total:0,done:0}),r[a.projectId].total++,a.status==="concluida"&&r[a.projectId].done++);return r},[A]),[l,Q]=s.useState(""),[W,n]=s.useState(!1),[i,P]=s.useState(null),[t,h]=s.useState(""),[d,b]=s.useState("Ativo"),[c,g]=s.useState(""),[m,j]=s.useState(""),[E,D]=s.useState(!1),[u,v]=s.useState(null),T=s.useMemo(()=>{if(!l)return p;const r=l.toLowerCase();return p.filter(a=>a.name.toLowerCase().includes(r))},[p,l]),_=s.useCallback(()=>{P(null),h(""),b("Ativo"),g(""),j(""),n(!0)},[]),X=s.useCallback(r=>{P(r),h(r.name),b(r.status||"Ativo"),g(r.tipo||""),j(r.observacoes||""),n(!0)},[]),O=s.useCallback(async()=>{if(t.trim()){D(!0);try{i?await S(i.id,{name:t.trim(),status:d,tipo:c||void 0,observacoes:m||void 0}):await k({name:t.trim(),status:d,tipo:c||void 0,observacoes:m||void 0}),n(!1)}catch(r){I.error("Erro ao salvar projeto: "+r.message)}finally{D(!1)}}},[t,d,c,m,i,k,S]),Y=s.useCallback(async()=>{if(u)try{await w(u)}catch(r){I.error("Erro ao remover projeto: "+r.message)}finally{v(null)}},[u,w]);return e.jsxs(se,{title:"Projetos",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(C,{placeholder:"Buscar projeto...",value:l,onChange:r=>Q(r.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(be,{syncing:q,lastSync:K,onSync:U,error:H}),e.jsxs(o,{size:"sm",onClick:_,className:"gap-1.5",children:[e.jsx(L,{className:"w-4 h-4"})," Novo Projeto"]})]})]}),V?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>e.jsx(f,{className:"rounded-xl border-border/40",children:e.jsx(N,{className:"p-4 h-16 animate-pulse bg-muted/30"})},r))}):T.length===0?e.jsx(f,{className:"rounded-xl border-dashed border-2 bg-muted/10",children:e.jsxs(N,{className:"p-12 flex flex-col items-center text-center",children:[e.jsx(R,{className:"w-12 h-12 text-muted-foreground/30 mb-4"}),e.jsx("p",{className:"text-muted-foreground font-medium",children:l?"Nenhum projeto encontrado.":"Nenhum projeto cadastrado."}),e.jsxs(o,{variant:"outline",size:"sm",className:"mt-4 gap-1.5 shadow-sm",onClick:_,children:[e.jsx(L,{className:"w-4 h-4"})," Criar projeto"]})]})}):e.jsx("div",{className:"space-y-3",children:T.map(r=>e.jsx(f,{className:"rounded-xl border-border/50 hover:border-primary/30 hover:shadow-md transition-all group bg-background/95 backdrop-blur-sm",children:e.jsxs(N,{className:"p-3.5 sm:p-4 flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3.5 min-w-0 flex-1",children:[e.jsx("div",{className:"p-2 rounded-lg bg-muted/50 border border-border/50 group-hover:bg-primary/5 group-hover:border-primary/20 transition-colors mt-0.5",children:e.jsx(R,{className:"w-4 h-4 text-muted-foreground group-hover:text-primary transition-colors"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2.5 flex-wrap",children:[e.jsx("span",{className:"font-semibold text-[15px] truncate group-hover:text-primary transition-colors",children:r.name}),e.jsx(B,{variant:"secondary",className:re("text-[10px] uppercase font-semibold tracking-wider px-2 py-0.5 shadow-sm",Ce[r.status]||"bg-muted text-muted-foreground"),children:r.status}),r.tipo&&e.jsx(B,{variant:"outline",className:"text-[10px] uppercase tracking-wider bg-background/50 text-muted-foreground border-border/50 px-2 py-0.5",children:r.tipo}),(()=>{const a=G[r.id];return a?e.jsxs("span",{className:"flex items-center gap-1 text-xs font-medium text-muted-foreground ml-2 bg-muted/40 px-2 py-0.5 rounded-md border border-border/40",children:[e.jsx(Ne,{className:"w-3.5 h-3.5 opacity-70"}),a.total,a.done>0&&e.jsxs("span",{className:"flex items-center gap-0.5 text-emerald-600 dark:text-emerald-500 ml-1.5",children:[e.jsx(je,{className:"w-3.5 h-3.5"}),a.done]})]}):null})()]}),r.observacoes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1.5 line-clamp-2 pr-4",children:r.observacoes})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity bg-background/80 backdrop-blur-md rounded-md shadow-sm border border-border/50 p-0.5 relative md:-right-2 md:-top-2",children:[e.jsx(o,{variant:"ghost",size:"icon",className:"h-7 w-7 hover:bg-primary/20 hover:text-primary transition-colors",onClick:()=>X(r),children:e.jsx(ve,{className:"w-3.5 h-3.5"})}),e.jsx(o,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:bg-destructive/20 hover:text-destructive transition-colors",onClick:()=>v(r.id),children:e.jsx(fe,{className:"w-3.5 h-3.5"})})]})]})},r.id))}),e.jsx(ae,{open:W,onOpenChange:n,children:e.jsxs(te,{className:"sm:max-w-md",children:[e.jsx(oe,{children:e.jsx(le,{children:i?"Editar Projeto":"Novo Projeto"})}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"project-name",children:"Nome do projeto"}),e.jsx(C,{id:"project-name",value:t,onChange:r=>h(r.target.value),placeholder:"Ex: EasyBR",onKeyDown:r=>r.key==="Enter"&&O(),autoFocus:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(x,{children:"Status"}),e.jsxs(F,{value:d,onValueChange:b,children:[e.jsx(z,{children:e.jsx(M,{})}),e.jsx(J,{children:ye.map(r=>e.jsx(y,{value:r,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx(x,{children:"Tipo"}),e.jsxs(F,{value:c||"__none__",onValueChange:r=>g(r==="__none__"?"":r),children:[e.jsx(z,{children:e.jsx(M,{placeholder:"Nenhum"})}),e.jsxs(J,{children:[e.jsx(y,{value:"__none__",children:"Nenhum"}),ke.map(r=>e.jsx(y,{value:r,children:r},r))]})]})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"project-obs",children:"Observações"}),e.jsx(C,{id:"project-obs",value:m,onChange:r=>j(r.target.value),placeholder:"Notas sobre o projeto"})]})]}),e.jsxs(ne,{children:[e.jsx(o,{variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),e.jsx(o,{onClick:O,disabled:E||!t.trim(),children:E?"Salvando...":i?"Salvar":"Criar"})]})]})}),e.jsx(ie,{open:!!u,onOpenChange:r=>!r&&v(null),children:e.jsxs(de,{children:[e.jsxs(ce,{children:[e.jsx(me,{children:"Remover projeto?"}),e.jsx(ue,{children:"Esta ação não pode ser desfeita. O projeto será removido permanentemente do Airtable e do banco local."})]}),e.jsxs(xe,{children:[e.jsx(pe,{children:"Cancelar"}),e.jsx(he,{onClick:Y,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})]})}export{Ye as default};
