import{c as Xs,r as l,$ as Dt,j as e,e as g,s as Et,Z as At,_ as Lt,an as Mt,l as ns}from"./index-BZM7W3UK.js";import{A as Bt,L as Ot,B as $,P as ze,F as As}from"./AdminLayout-DAsiaDkq.js";import{C as k,c as C,a as pe,b as ge}from"./card-j73cSHib.js";import{B as p}from"./button-Cmf_uUyj.js";import{I as Ls}from"./input-B8SjqRY5.js";import{S as Ms,C as Pt}from"./checkbox-Dsqm7FvK.js";import{L as It}from"./label-D8PSUn72.js";import{T as Rt,a as $t,b as je,c as fe}from"./tabs-Bm5UlDBO.js";import{P as zt}from"./progress-CoXKg7wq.js";import{S as Y,a as H,b as G,d as q,e as A}from"./select-BF0udTWD.js";import{P as Ft,a as _t,b as Vt}from"./popover-CagwFnLq.js";import{A as Bs,a as Os,b as Ps,c as Is,d as Rs,e as $s,f as zs,g as Fs}from"./alert-dialog-Dbh53oLk.js";import{T as ye,E as be,a as Ne,c as os,e as ls,b as Kt,d as us}from"./crmTypes-C2SECzd8.js";import{S as Yt}from"./SyncToolbar-BNYnXQ6J.js";import{B as Ht,a as _s}from"./CrmSkeletons-IOav0FHp.js";import{T as qt}from"./TarefaSheet-Co3etC_f.js";import{A as Ut}from"./AgendaEventSheet-DrpXtBzX.js";import{u as Gt,a as Wt,C as Zt,A as Qt,S as Jt,D as Xt,c as ea,b as sa,d as ta,G as aa,e as ra,f as na,v as la,P as ia,g as oa,h as ca}from"./SubtarefasTab-Hl6hMyQz.js";import{S as is}from"./skeleton-C7TMJCWW.js";import{C as cs}from"./dialog-CN7r4cOB.js";import{C as He}from"./chevron-right-CKa2SwPA.js";import{E as da}from"./eye-BR2DWBko.js";import{B as ma}from"./building-2-DIPeHJME.js";import{C as Ye}from"./calendar-B1bfMcsq.js";import{C as Fe}from"./clock-Dvu1DFGs.js";import{T as Vs}from"./triangle-alert-CrMU5TgJ.js";import{C as Ks}from"./circle-check-D3EJag0Z.js";import{T as xa}from"./trending-up-5I886G_T.js";import{C as ua}from"./chart-column-kqSvAq8y.js";import{F as ha}from"./file-text-CbgGzXEw.js";import{S as Ys}from"./search-hleOy17D.js";import{L as Hs}from"./list-CMAynRZs.js";import{U as et}from"./users-D0pOPhHA.js";import{M as pa}from"./map-pin-CBRYUx0Q.js";import{P as st}from"./pencil-JfM5Y40M.js";import{T as tt}from"./trash-2-ppiEIdbR.js";import{C as ga}from"./chevron-up-C-SbE5lx.js";import"./heart-BxQHTcMA.js";import"./sparkles-DzLxI3yR.js";import"./ThemeToggle-zTGoJKm2.js";import"./house-BrmQyQUo.js";import"./index-DMRtMsfK.js";import"./check-B_GfEZKp.js";import"./index-4-iAn504.js";import"./index-DKT_o_o_.js";import"./index-Cv53anFD.js";import"./form-xX6r7mA8.js";import"./textarea-66APvHeC.js";import"./separator-DJ1-t0GD.js";import"./loader-circle-DWfjbY7L.js";import"./circle-59-XQULk.js";import"./types-C9wiu8_K.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=Xs("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=Xs("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),ba=i=>Et.from(i),ve=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];function ds(i){if(!i)return"";const a=String(i).slice(0,10);return/^\d{4}-\d{2}-\d{2}$/.test(a)?a:""}function qs(i){const a=ds(i);return a?`${a.slice(8,10)}/${a.slice(5,7)}/${a.slice(0,4)}`:String(i||"")}function Us(i){if(typeof i=="boolean")return i;if(typeof i=="number")return i!==0;const a=String(i??"").trim().toLowerCase();return["true","yes","sim","1","checked","on","x"].includes(a)}function Gs(i){const a=Number(i.slice(0,4));let m=Number(i.slice(5,7))-1+1,h=a;return m>11&&(m=0,h=a+1),{anoRef:h,mesRef:m}}function Na(i){const a=String(i||"").trim().toLowerCase();return a.includes("conclu")||a.includes("finaliz")||a.includes("encerrad")?{label:"Concluído",kind:"done",order:0}:a.includes("andamento")||a.includes("trâmite")||a.includes("tramite")||a.includes("process")?{label:a.includes("trâmite")||a.includes("tramite")?"Em trâmite":"Em andamento",kind:"wip",order:1}:a.includes("agend")?{label:"Agendado",kind:"sched",order:2}:{label:i||"—",kind:"other",order:3}}function va(i){const a=i.match(/\s*\(([^)]+)\)\s*$/);return a?{titulo:i.replace(/\s*\(([^)]+)\)\s*$/,"").trim(),projeto:a[1].trim()}:{titulo:i,projeto:""}}function ya(i){if(!i)return"";const a=String(i).split(/\r?\n/).map(c=>c.trim()).filter(Boolean);for(let c of a){c=c.replace(/^#{1,6}\s+/,"").replace(/^\d+\)\s+/,"").replace(/^(-|•|o)\s+/i,"");const m=c.replace(/\*\*(.+?)\*\*/g,"$1").replace(/[_`]+/g,"").replace(/\s+/g," ").trim();if(m)return m.length>140?m.slice(0,137).trim()+"...":m}return""}function wa(i){if(!i)return e.jsx("span",{className:"text-muted-foreground text-xs italic",children:"Sem observações registradas."});const a=String(i).split(/\r?\n/).map(j=>j.trim()).filter(Boolean),c=[];let m=[],h=0;const b=j=>j.split(/\*\*(.+?)\*\*/g).map((S,M)=>M%2===1?e.jsx("strong",{children:S},M):S),v=()=>{m.length&&(c.push(e.jsx("ul",{className:"list-disc list-inside space-y-0.5 text-xs leading-relaxed ml-2",children:m.map((j,L)=>e.jsx("li",{children:b(j)},L))},h++)),m=[])};for(const j of a){const L=j.match(/^#{1,6}\s+(.+)$/);if(L){v(),c.push(e.jsx("p",{className:"text-xs font-bold mt-2 mb-1",children:b(L[1])},h++));continue}const S=j.match(/^(\d+)\)\s+(.+)$/);if(S){v(),c.push(e.jsxs("p",{className:"text-xs font-bold mt-2 mb-1",children:[S[1],") ",b(S[2])]},h++));continue}const M=j.match(/^\*\*(.+?)\*\*:?$/);if(M){v(),c.push(e.jsx("p",{className:"text-xs font-bold mt-2 mb-1",children:b(M[1])},h++));continue}if(/^(-|•|o)\s+/i.test(j)){m.push(j.replace(/^(-|•|o)\s+/i,""));continue}v(),c.push(e.jsx("p",{className:"text-xs leading-relaxed",children:b(j)},h++))}return v(),e.jsx(e.Fragment,{children:c})}const at={done:"bg-green-100 text-green-800 border-green-200",wip:"bg-amber-100 text-amber-800 border-amber-200",sched:"bg-orange-100 text-orange-700 border-orange-200",other:"bg-muted text-muted-foreground border-border"};async function Sa(){const{data:i,error:a}=await ba("mladv_crm_tarefas").select("titulo, status, deadline, descricao, raw_fields").ilike("cliente","%bosi%");if(a)throw a;return i||[]}function ka(){const i=l.useRef(null),a=new Date,[c,m]=l.useState(a.getFullYear()),[h,b]=l.useState(a.getMonth()),{data:v,isLoading:j}=Dt({queryKey:["crm","bosi-report"],queryFn:Sa}),L=l.useMemo(()=>{if(!v)return[];const n=new Set;return v.forEach(N=>{const D=N.raw_fields||{};if(!Us(D.Bosi))return;const f=ds(D.Date);if(!f)return;const E=Gs(f);n.add(`${E.anoRef}-${String(E.mesRef).padStart(2,"0")}`)}),Array.from(n).sort().reverse()},[v]),S=()=>{h===0?(b(11),m(n=>n-1)):b(n=>n-1)},M=()=>{h===11?(b(0),m(n=>n+1)):b(n=>n+1)},B=c===a.getFullYear()&&h===a.getMonth(),d=l.useMemo(()=>{if(!v)return null;const n=c,N=h,D=v.filter(u=>{const O=u.raw_fields||{};if(!Us(O.Bosi))return!1;const z=ds(O.Date);if(!z)return!1;const W=Gs(z);return W.anoRef===n&&W.mesRef===N});if(D.length===0)return null;const f=D.filter(u=>u.titulo&&u.titulo.toLowerCase()!=="tarefa sem nome").map(u=>{var ne;const O=Na(u.status),z=((ne=u.raw_fields)==null?void 0:ne.Observações)||u.descricao||null,{titulo:W,projeto:Z}=va(u.titulo);return{titulo:u.titulo,observacoes:z,deadline:u.deadline,statusLabel:O.label,statusKind:O.kind,statusOrder:O.order,projeto:Z,tituloClean:W}}).sort((u,O)=>u.statusOrder!==O.statusOrder?u.statusOrder-O.statusOrder:u.tituloClean.localeCompare(O.tituloClean,"pt-BR"));let E=N-1,te=n;E<0&&(E=11,te=n-1);const R=new Date(te,E+1,0).getDate(),Ue=f.length,ae=f.filter(u=>u.statusKind==="done").length,Ge=f.filter(u=>u.statusKind==="wip").length,De=f.filter(u=>u.statusKind==="sched").length,Ee=f.filter(u=>u.observacoes).slice(0,3).map(u=>({titulo:u.tituloClean,projeto:u.projeto,impacto:ya(u.observacoes),statusLabel:u.statusLabel,statusKind:u.statusKind})),re=new Date;return{tasks:f,periodoTxt:`01 a ${String(R).padStart(2,"0")} de ${ve[E]} de ${te}`,mesAno:`${ve[N]} de ${n}`,geradoEm:qs(`${re.getFullYear()}-${String(re.getMonth()+1).padStart(2,"0")}-${String(re.getDate()).padStart(2,"0")}`),reportId:`${n}-${String(N+1).padStart(2,"0")}`,total:Ue,concluidas:ae,emAndamento:Ge,agendado:De,destaques:Ee}},[v,c,h]),P=l.useCallback(()=>{if(!i.current)return;const n=window.open("","_blank");if(!n)return;const N=i.current.innerHTML,f=Array.from(document.querySelectorAll('style, link[rel="stylesheet"]')).map(E=>E.outerHTML).join(`
`);n.document.write(`
      <!DOCTYPE html>
      <html lang="pt-br">
      <head>
        <meta charset="UTF-8">
        <title>Relatório Executivo – ${(d==null?void 0:d.mesAno)||""}</title>
        ${f}
        <style>
          @page { size: A4; margin: 12mm; }
          * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
          body { margin: 0; padding: 0; background: white; }
          .page-break { page-break-before: always; break-before: page; }
          @media print { body { padding: 0; } }
        </style>
      </head>
      <body>
        <div class="bg-white text-slate-900 p-6 sm:p-8 max-w-[680px] mx-auto">${N}</div>
      </body>
      </html>
    `),n.document.close(),setTimeout(()=>{n.print()},500)},[d]);if(j)return e.jsxs("div",{className:"space-y-4",children:[e.jsx(is,{className:"h-8 w-48"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:[1,2,3,4].map(n=>e.jsx(is,{className:"h-20"},n))}),e.jsx(is,{className:"h-64"})]});const U=!d||d.total===0,I=(d==null?void 0:d.tasks)??[],T=(d==null?void 0:d.periodoTxt)??"",ee=(d==null?void 0:d.mesAno)??"",we=(d==null?void 0:d.geradoEm)??"",Se=(d==null?void 0:d.reportId)??"",ke=(d==null?void 0:d.total)??0,Ce=(d==null?void 0:d.concluidas)??0,se=(d==null?void 0:d.emAndamento)??0,qe=(d==null?void 0:d.agendado)??0,Te=(d==null?void 0:d.destaques)??[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:S,children:e.jsx(cs,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Y,{value:String(h),onValueChange:n=>b(Number(n)),children:[e.jsx(H,{className:"w-[130px] h-8 text-xs capitalize",children:e.jsx(G,{})}),e.jsx(q,{children:ve.map((n,N)=>e.jsx(A,{value:String(N),className:"capitalize",children:n},N))})]}),e.jsxs(Y,{value:String(c),onValueChange:n=>m(Number(n)),children:[e.jsx(H,{className:"w-[80px] h-8 text-xs",children:e.jsx(G,{})}),e.jsx(q,{children:Array.from({length:5},(n,N)=>a.getFullYear()-N).map(n=>e.jsx(A,{value:String(n),children:n},n))})]})]}),e.jsx(p,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:M,disabled:B,children:e.jsx(He,{className:"w-4 h-4"})}),!B&&e.jsx(p,{variant:"outline",size:"sm",className:"text-xs h-8",onClick:()=>{m(a.getFullYear()),b(a.getMonth())},children:"Mês atual"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:P,className:"gap-1.5",disabled:U,children:[e.jsx(ja,{className:"w-3.5 h-3.5"}),"Exportar PDF"]}),e.jsxs(p,{variant:"outline",size:"sm",disabled:U,onClick:P,className:"gap-1.5",children:[e.jsx(fa,{className:"w-3.5 h-3.5"}),"Imprimir"]})]})]}),U?e.jsx(k,{children:e.jsxs(C,{className:"p-8 text-center text-muted-foreground",children:[e.jsx(da,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsxs("p",{className:"text-sm font-medium",children:["Nenhuma tarefa BOSI encontrada para ",ve[h]," de ",c,"."]}),e.jsx("p",{className:"text-xs mt-1",children:'Verifique se as tarefas possuem o campo "Bosi" marcado e "Date" preenchido no Airtable.'}),L.length>0&&e.jsxs("p",{className:"text-xs mt-2 text-muted-foreground",children:["Meses com dados: ",L.slice(0,6).map(n=>{const[N,D]=n.split("-");return`${ve[Number(D)]}/${N}`}).join(", ")]})]})}):e.jsx(e.Fragment,{children:e.jsx(k,{className:"overflow-hidden",children:e.jsx(C,{className:"p-0",children:e.jsxs("div",{ref:i,className:"bg-white text-slate-900 p-6 sm:p-8 max-w-[680px] mx-auto",children:[e.jsxs("div",{className:"report-header pb-3 mb-4 border-b-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/logo-horizontal_transparent.png",alt:"Mariana Lima Advocacia",style:{maxHeight:70}}),e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/bosi_logo.png",alt:"BOSI",style:{maxHeight:34}})]}),e.jsxs("h1",{className:"text-lg font-extrabold text-slate-900",children:["Atuação jurídica do período – ",ee]}),e.jsxs("p",{className:"subtitle text-xs text-slate-500 mt-1",children:["Período: ",T]})]}),e.jsxs("div",{className:"kpi-grid grid grid-cols-2 sm:grid-cols-4 gap-2.5 mb-5",children:[e.jsx(_e,{label:"Total",value:ke,kind:"other"}),e.jsx(_e,{label:"Concluídas",value:Ce,kind:"done"}),e.jsx(_e,{label:"Em andamento",value:se,kind:"wip"}),e.jsx(_e,{label:"Agendadas",value:qe,kind:"sched"})]}),Te.length>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("h2",{className:"section-title text-sm font-extrabold text-slate-900 mb-2 pb-1 border-b border-slate-200",children:"Destaques estratégicos"}),e.jsx("div",{className:"space-y-2",children:Te.map((n,N)=>e.jsxs("div",{className:"flex items-start justify-between gap-3 py-2 border-b border-slate-100 last:border-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-xs font-extrabold text-slate-900",children:[n.titulo,n.projeto&&e.jsxs("span",{className:"text-slate-500 font-bold",children:[" · ",n.projeto]})]}),e.jsx("p",{className:"text-xs text-slate-600 font-semibold mt-0.5 leading-snug",children:n.impacto||"Atualização registrada no período."})]}),e.jsx(ms,{label:n.statusLabel,kind:n.statusKind})]},N))})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("h2",{className:"section-title text-sm font-extrabold text-slate-900 mb-2 pb-1 border-b border-slate-200",children:"Frentes acompanhadas"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-4",children:[e.jsx(Ve,{title:"Concluídas",kind:"done",tasks:I.filter(n=>n.statusKind==="done")}),e.jsx(Ve,{title:"Em andamento / Em trâmite",kind:"wip",tasks:I.filter(n=>n.statusKind==="wip")}),e.jsx(Ve,{title:"Agendadas",kind:"sched",tasks:I.filter(n=>n.statusKind==="sched")}),e.jsx(Ve,{title:"Outras",kind:"other",tasks:I.filter(n=>n.statusKind==="other")})]})]}),e.jsx("div",{className:"page-break"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-center py-4 mb-4 bg-slate-50 rounded-lg",children:[e.jsx("h2",{className:"text-base font-extrabold text-slate-900",children:"Detalhamento das Tarefas"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Resumo técnico e jurídico de cada frente acompanhada em ",e.jsx("strong",{children:ee}),"."]})]}),e.jsx("div",{className:"space-y-0",children:I.map((n,N)=>e.jsxs("div",{className:"task-detail py-3 border-b border-slate-100 last:border-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("p",{className:"task-title text-xs font-extrabold text-slate-900",children:[N+1,". ",n.tituloClean,n.projeto&&e.jsxs("span",{className:"task-projeto text-slate-500 font-bold",children:[" · ",n.projeto]})]}),e.jsx(ms,{label:n.statusLabel,kind:n.statusKind})]}),n.deadline&&e.jsxs("p",{className:"text-[11px] text-slate-600 font-semibold mt-1",children:["Prazo: ",qs(n.deadline)]}),e.jsx("div",{className:"task-obs mt-2",children:wa(n.observacoes)})]},N))})]}),e.jsxs("div",{className:"footer mt-6 pt-3 border-t-2 border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-extrabold text-slate-700",children:"Mariana Lima Advocacia"}),e.jsxs("p",{className:"text-[11px] text-slate-500 mt-1",children:["Telefone: (31) 99404-8797",e.jsx("br",{}),"E-mail: contato@marianalima.adv.br",e.jsx("br",{}),"Rua Hugo Santos Silva, nº 100 – Centro, Sete Lagoas – MG"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/logo-horizontal_transparent.png",alt:"Mariana Lima Advocacia",style:{maxHeight:70,marginLeft:"auto"},className:"mb-2"}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:["Gerado em: ",we]}),e.jsxs("p",{className:"text-[10px] text-slate-400",children:["Relatório #",Se]})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-2 border-t border-slate-100",children:[e.jsx("p",{className:"text-[10px] text-slate-400 italic",children:"Este relatório é confidencial e destinado exclusivamente ao destinatário."}),e.jsx("img",{src:"https://vps2-public-videos.m7brnq.easypanel.host/bosi_logo.png",alt:"BOSI",style:{maxHeight:28}})]})]})]})})})})]})}function _e({label:i,value:a,kind:c}){const m={done:"bg-green-50 border-green-200 text-green-900",wip:"bg-amber-50 border-amber-200 text-amber-900",sched:"bg-orange-50 border-orange-200 text-orange-900",other:"bg-slate-50 border-slate-200 text-slate-900"};return e.jsxs("div",{className:g("kpi-card rounded-lg border p-3",m[c]),children:[e.jsx("p",{className:"value text-2xl font-black leading-none",children:a}),e.jsx("p",{className:"label text-[10px] font-bold uppercase tracking-wide mt-1.5",children:i})]})}function ms({label:i,kind:a}){return e.jsx("span",{className:g("badge inline-block px-2 py-0.5 rounded-full text-[10px] font-bold border shrink-0 whitespace-nowrap",at[a]),children:i})}function Ve({title:i,kind:a,tasks:c}){return c.length===0?null:e.jsxs("div",{className:"mb-3 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 pb-1",children:[e.jsx("p",{className:"text-xs font-extrabold text-slate-900",children:i}),e.jsx("span",{className:g("badge inline-block px-1.5 py-0 rounded-full text-[10px] font-black border",at[a]),children:c.length})]}),e.jsx("div",{className:"border-t border-slate-100",children:c.map((m,h)=>e.jsxs("div",{className:"flex items-center justify-between gap-2 py-1 border-b border-slate-50 last:border-0",children:[e.jsxs("p",{className:"text-[11px] font-bold text-slate-900 leading-tight flex-1 min-w-0",children:[m.tituloClean,m.projeto&&e.jsxs("span",{className:"text-slate-500 font-bold",children:[" · ",m.projeto]})]}),e.jsx(ms,{label:m.statusLabel,kind:m.statusKind})]},h))})]})}const Ca=["pendente","agendado","em_andamento","em_tramite"],Ke=["pendente","agendado","em_andamento","em_tramite","concluida","cancelada"],Ws=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"priority",label:"Prioridade (Alta → Baixa)"},{value:"title",label:"Título (A → Z)"},{value:"client",label:"Cliente (A → Z)"}],Zs={alta:0,media:1,baixa:2};function Qs(i,a){return[...i].sort((c,m)=>{switch(a){case"deadline":return!c.dueDate&&!m.dueDate?0:c.dueDate?m.dueDate?c.dueDate.localeCompare(m.dueDate):-1:1;case"priority":return(Zs[c.priority]??1)-(Zs[m.priority]??1);case"title":return c.title.localeCompare(m.title,"pt-BR");case"client":return(c.client??"").localeCompare(m.client??"","pt-BR");default:return 0}})}const Ta={client:!0,dueDate:!0,priority:!0,subtasks:!0,tags:!0,description:!1},Js={client:"Cliente",dueDate:"Data de entrega",priority:"Prioridade",subtasks:"Subtarefas",tags:"Tags",description:"Descrição"},xs=l.memo(function({task:a,cardFields:c,today:m,isExpanded:h,onToggleExpand:b,onToggleSubtask:v,onEdit:j,onDelete:L,showStatus:S,isDragging:M,isOverlay:B}){const d=a.subtasks.filter(T=>T.completed).length,P=a.subtasks.length,U=P>0?Math.round(d/P*100):0,I=a.dueDate&&a.dueDate<m&&a.status!=="concluida"&&a.status!=="cancelada";return e.jsx(k,{className:g("transition-shadow duration-150",M&&"opacity-40",B&&"shadow-xl ring-2 ring-primary/30 rotate-[2deg]",I&&"border-destructive/50"),children:e.jsxs(C,{className:"p-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[!B&&e.jsx(aa,{className:"w-4 h-4 text-muted-foreground mt-0.5 shrink-0 cursor-grab active:cursor-grabbing"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[c.priority&&e.jsx($,{variant:"secondary",className:g("text-[10px]",Kt[a.priority]),children:os[a.priority]}),S&&e.jsx($,{variant:"secondary",className:g("text-[10px]",us[a.status]),children:ye[a.status]}),I&&e.jsx($,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),e.jsx("p",{className:"font-medium text-sm",children:a.title}),c.description&&a.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[c.client&&a.client&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(et,{className:"w-3 h-3"}),a.client]}),c.dueDate&&a.dueDate&&e.jsxs("span",{className:g("flex items-center gap-1",I&&"text-destructive font-medium"),children:[e.jsx(Ye,{className:"w-3 h-3"}),new Date(a.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]})]}),!B&&e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(p,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>j==null?void 0:j(a),children:e.jsx(st,{className:"w-3.5 h-3.5"})}),e.jsx(p,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>L(a.id),children:e.jsx(tt,{className:"w-3.5 h-3.5"})})]})]}),c.subtasks&&P>0&&!B&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{className:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full",onClick:()=>b(a.id),children:[h?e.jsx(ga,{className:"w-3 h-3"}):e.jsx(He,{className:"w-3 h-3"}),e.jsxs("span",{children:[d,"/",P," subtarefas"]}),e.jsx("div",{className:"flex-1 mx-2 bg-muted rounded-full h-1.5",children:e.jsx("div",{className:"bg-primary rounded-full h-1.5 transition-all",style:{width:`${U}%`}})}),e.jsxs("span",{className:"text-[10px]",children:[U,"%"]})]}),h&&e.jsx("div",{className:"mt-2 space-y-1 pl-4",children:a.subtasks.map(T=>e.jsxs("label",{className:"flex items-center gap-2 text-xs cursor-pointer hover:bg-muted/50 rounded p-1 -ml-1",children:[e.jsx(Pt,{checked:T.completed,onCheckedChange:()=>v(a.id,T.id)}),e.jsx("span",{className:g(T.completed&&"line-through text-muted-foreground"),children:T.title})]},T.id))})]}),c.tags&&a.tags&&a.tags.length>0&&!B&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:a.tags.map(T=>e.jsx($,{variant:"outline",className:"text-[10px]",children:T},T))})]})})});function Da(i){const{attributes:a,listeners:c,setNodeRef:m,transform:h,transition:b,isDragging:v}=oa({id:i.task.id}),j={transform:ca.Transform.toString(h),transition:b};return e.jsx("div",{ref:m,style:j,...a,...c,children:e.jsx(xs,{...i,isDragging:v})})}function Ea({status:i,tasks:a,isOver:c,cardFields:m,today:h,expandedTasks:b,onToggleExpand:v,onToggleSubtask:j,onEdit:L,onDelete:S}){const M=l.useMemo(()=>a.map(d=>d.id),[a]),{setNodeRef:B}=ra({id:i});return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($,{variant:"secondary",className:us[i],children:ye[i]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a.length,")"]})]}),e.jsx("div",{ref:B,"data-column-status":i,className:g("space-y-3 min-h-[400px] p-2 rounded-lg transition-colors duration-150",c?"bg-primary/10 border-2 border-dashed border-primary/40":"bg-muted/30 border-2 border-transparent"),children:e.jsx(na,{items:M,strategy:la,children:a.length===0?e.jsx("p",{className:g("text-xs text-center py-8 transition-colors",c?"text-primary font-medium":"text-muted-foreground"),children:c?"↓ Soltar aqui":"Vazio"}):a.map(d=>e.jsx(Da,{task:d,cardFields:m,today:h,isExpanded:b.has(d.id),onToggleExpand:v,onToggleSubtask:j,onEdit:L,onDelete:S},d.id))})})]})}function Dr(){var Es;const i=new Date,a=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,{events:c,loading:m,syncing:h,lastSync:b,sync:v,deleteEvent:j,createEvent:L,updateEvent:S}=At(),{tasks:M,loading:B,syncing:d,lastSync:P,sync:U,updateTaskStatus:I,deleteTask:T,createTask:ee,updateTask:we,createSubtask:Se,updateSubtask:ke,deleteSubtask:Ce}=Lt(),{projects:se}=Mt(),qe=()=>{v(),U()},Te=h||d,n=b&&P?b>P?P:b:b||P,N=m||B,D=l.useMemo(()=>c.filter(s=>{var t;return(t=s.client)==null?void 0:t.toLowerCase().includes("bosi")}).sort((s,t)=>s.date.localeCompare(t.date)),[c]),f=l.useMemo(()=>M.filter(s=>{var t;return(t=s.client)==null?void 0:t.toLowerCase().includes("bosi")}),[M]),E=l.useMemo(()=>D.filter(s=>s.date>=a&&s.status!=="cancelado"),[D,a]),te=f.filter(s=>Ca.includes(s.status)),R=f.filter(s=>s.dueDate&&s.dueDate<a&&s.status!=="concluida"&&s.status!=="cancelada"),Ue=f.filter(s=>s.status==="concluida"),ae=l.useMemo(()=>f.flatMap(s=>s.subtasks),[f]),Ge=ae.filter(s=>s.completed),De=ae.length>0?Math.round(Ge.length/ae.length*100):0,Ee=l.useMemo(()=>{const s={};return f.forEach(t=>{s[t.status]=(s[t.status]||0)+1}),s},[f]),re=s=>{const t=new Date(s+"T12:00:00"),r=new Date;return r.setHours(12,0,0,0),Math.round((t.getTime()-r.getTime())/(1e3*60*60*24))},[u,O]=l.useState("kanban"),[z,W]=l.useState(""),[Z,ne]=l.useState("all"),[le,hs]=l.useState("all"),[ie,ps]=l.useState("all"),[Q,rt]=l.useState("deadline"),[We,nt]=l.useState(!1),[gs,lt]=l.useState(new Set),[Ae,it]=l.useState(Ta),ot=l.useCallback(s=>{it(t=>({...t,[s]:!t[s]}))},[]),[Le,Ze]=l.useState(null),[ct,Me]=l.useState(null),[dt,Be]=l.useState(!1),[mt,Qe]=l.useState(null),[oe,Oe]=l.useState(null),[V,Pe]=l.useState([]);l.useEffect(()=>{Pe(f)},[f]);const Ie=l.useMemo(()=>{const s=V.filter(t=>!(z&&!t.title.toLowerCase().includes(z.toLowerCase())||Z!=="all"&&t.status!==Z||le!=="all"&&t.priority!==le||ie!=="all"&&t.projectId!==ie));return Qs(s,Q)},[V,z,Z,le,ie,Q]),xt=l.useMemo(()=>{const s={};return Ke.forEach(t=>{s[t]=[]}),Ie.forEach(t=>{s[t.status]&&s[t.status].push(t)}),s},[Ie]),js=l.useMemo(()=>Le?V.find(s=>s.id===Le):null,[Le,V]),ut=Gt(Wt(ia,{activationConstraint:{distance:8}})),fs=l.useCallback(s=>{lt(t=>{const r=new Set(t);return r.has(s)?r.delete(s):r.add(s),r})},[]),bs=l.useCallback((s,t)=>{Pe(r=>r.map(x=>x.id===s?{...x,subtasks:x.subtasks.map(o=>o.id===t?{...o,completed:!o.completed}:o)}:x))},[]),ht=l.useCallback(s=>{Ze(s.active.id)},[]),pt=l.useCallback(s=>{const{over:t}=s;if(!t){Me(null);return}const r=t.id,x=V.find(o=>o.id===r);Me(x?x.status:Ke.includes(r)?r:null)},[V]),gt=l.useCallback(s=>{const{active:t,over:r}=s;if(Ze(null),Me(null),!r)return;const x=t.id,o=r.id;if(x===o)return;const y=V.find(_=>_.id===x);if(!y)return;const X=V.find(_=>_.id===o),w=X?X.status:Ke.includes(o)?o:y.status;y.status!==w&&(Pe(_=>Qs(_.map(rs=>rs.id===x?{...rs,status:w}:rs),Q)),I(x,w))},[V,I,Q]),jt=l.useCallback(()=>{Ze(null),Me(null)},[]),ft=l.useCallback(async(s,t,r)=>{t?await ee({title:s.title,deadline:s.deadline,priority:s.priority,status:s.status,clientName:s.clientName||"BOSI Empreendimentos",projectId:s.projectId,assignee:s.assignee,description:s.description}):r&&await we(r,{title:s.title,deadline:s.deadline,priority:s.priority,status:s.status,clientName:s.clientName,projectId:s.projectId,assignee:s.assignee,description:s.description})},[ee,we]),bt=l.useCallback(async()=>{oe&&(T(oe),Pe(s=>s.filter(t=>t.id!==oe)),Oe(null))},[oe,T]),[ce,Je]=l.useState("calendar"),[J,Ns]=l.useState(""),[de,vs]=l.useState("all"),[me,ys]=l.useState("all"),[xe,ws]=l.useState("all"),[Re,Ss]=l.useState(()=>({year:i.getFullYear(),month:i.getMonth()})),[Nt,F]=l.useState(!1),[Xe,K]=l.useState(null),[es,ss]=l.useState(null),[ks,ue]=l.useState(null),[ts,as]=l.useState(0),$e=l.useMemo(()=>D.filter(s=>{var t;return!(J&&!s.title.toLowerCase().includes(J.toLowerCase())&&!((t=s.client)!=null&&t.toLowerCase().includes(J.toLowerCase()))||de!=="all"&&s.type!==de||me!=="all"&&s.status!==me||xe!=="all"&&s.projectId!==xe)}),[D,J,de,me,xe]),Cs=l.useMemo(()=>{const s=new Map;return $e.forEach(t=>{s.has(t.date)||s.set(t.date,[]),s.get(t.date).push(t)}),s},[$e]),vt=l.useMemo(()=>{const{year:s,month:t}=Re,r=new Date(s,t,1),x=new Date(s,t+1,0),o=r.getDay(),y=[],X=w=>`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}-${String(w.getDate()).padStart(2,"0")}`;for(let w=o-1;w>=0;w--){const _=new Date(s,t,-w);y.push({date:X(_),day:_.getDate(),isCurrentMonth:!1})}for(let w=1;w<=x.getDate();w++){const _=new Date(s,t,w);y.push({date:X(_),day:w,isCurrentMonth:!0})}for(;y.length<42;){const w=new Date(s,t+1,y.length-o-x.getDate()+1);y.push({date:X(w),day:w.getDate(),isCurrentMonth:!1})}return y},[Re]),yt=new Date(Re.year,Re.month).toLocaleDateString("pt-BR",{month:"long",year:"numeric"}),wt=()=>Ss(s=>s.month===0?{year:s.year-1,month:11}:{...s,month:s.month-1}),St=()=>Ss(s=>s.month===11?{year:s.year+1,month:0}:{...s,month:s.month+1}),he=l.useMemo(()=>{const s=new Date,t=new Date(s);t.setDate(s.getDate()-s.getDay()+ts*7);const r=[];for(let x=0;x<7;x++){const o=new Date(t);o.setDate(t.getDate()+x),r.push(`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`)}return r},[ts]),kt=l.useMemo(()=>{if(he.length===0)return"";const s=new Date(he[0]+"T12:00:00"),t=new Date(he[6]+"T12:00:00");return`${s.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})} — ${t.toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"})}`},[he]),Ct=async(s,t)=>{const r={...s,clientName:s.clientName||"BOSI Empreendimentos"};t?await L(r):Xe&&await S(Xe.id,r)},Tt=async()=>{if(es)try{await j(es)}catch{ns.error("Erro ao remover.")}finally{ss(null)}},Ts=l.useMemo(()=>{const s=new Map;return $e.forEach(t=>{s.has(t.date)||s.set(t.date,[]),s.get(t.date).push(t)}),Array.from(s.entries())},[$e]),Ds=l.useCallback(async(s,t)=>{s.preventDefault(),ue(null);const r=s.dataTransfer.getData("eventId");if(!r)return;const x=D.find(o=>o.id===r);if(!(!x||x.date===t))try{await S(r,{title:x.title,date:t,time:x.time,endTime:x.endTime,type:x.type,status:x.status,clientName:x.client,location:x.location,description:x.description,projectAirtableId:x.projectId}),ns.success(`"${x.title}" reagendado`)}catch{ns.error("Erro ao reagendar")}},[D,S]);return e.jsxs(Bt,{title:"",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-primary/10 border border-primary/20",children:e.jsx(ma,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"BOSI Empreendimentos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Painel exclusivo do cliente"})]})]}),e.jsx(Yt,{syncing:Te,lastSync:n,onSync:qe})]}),N?e.jsxs(e.Fragment,{children:[e.jsx(Ht,{}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsx(_s,{}),e.jsx(_s,{})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3 mb-6",children:[e.jsx(k,{className:"border-l-4 border-l-blue-500",children:e.jsx(C,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:E.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Compromissos"})]}),e.jsx(Ye,{className:"w-5 h-5 text-blue-500"})]})})}),e.jsx(k,{className:"border-l-4 border-l-amber-500",children:e.jsx(C,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:te.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Em andamento"})]}),e.jsx(Fe,{className:"w-5 h-5 text-amber-500"})]})})}),e.jsx(k,{className:g("border-l-4",R.length>0?"border-l-destructive":"border-l-muted"),children:e.jsx(C,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:R.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Atrasadas"})]}),e.jsx(Vs,{className:g("w-5 h-5",R.length>0?"text-destructive":"text-muted-foreground")})]})})}),e.jsx(k,{className:"border-l-4 border-l-green-500",children:e.jsx(C,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:Ue.length}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Concluídas"})]}),e.jsx(Ks,{className:"w-5 h-5 text-green-500"})]})})}),e.jsx(k,{className:"border-l-4 border-l-primary",children:e.jsxs(C,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold",children:[De,"%"]}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Progresso geral"})]}),e.jsx(xa,{className:"w-5 h-5 text-primary"})]}),e.jsx(zt,{value:De,className:"h-1.5 mt-2"})]})})]}),R.length>0&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-6 rounded-lg bg-destructive/10 border border-destructive/20",children:[e.jsx(Vs,{className:"w-4 h-4 text-destructive shrink-0"}),e.jsxs("p",{className:"text-xs font-medium text-destructive",children:[R.length," tarefa",R.length>1?"s":""," atrasada",R.length>1?"s":"",":"," ",R.slice(0,3).map(s=>s.title).join(", "),R.length>3&&` e mais ${R.length-3}`]})]}),e.jsxs(Rt,{defaultValue:"overview",className:"w-full",children:[e.jsxs($t,{className:"mb-4",children:[e.jsxs(je,{value:"overview",className:"gap-1.5",children:[e.jsx(ua,{className:"w-3.5 h-3.5"}),"Visão Geral"]}),e.jsxs(je,{value:"agenda",className:"gap-1.5",children:[e.jsx(Ye,{className:"w-3.5 h-3.5"}),"Agenda"]}),e.jsxs(je,{value:"tarefas",className:"gap-1.5",children:[e.jsx(Ot,{className:"w-3.5 h-3.5"}),"Tarefas"]}),e.jsxs(je,{value:"subtarefas",className:"gap-1.5",children:[e.jsx(Ks,{className:"w-3.5 h-3.5"}),"Subtarefas"]}),e.jsxs(je,{value:"relatorio",className:"gap-1.5",children:[e.jsx(ha,{className:"w-3.5 h-3.5"}),"Relatório"]})]}),e.jsx(fe,{value:"overview",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(k,{children:[e.jsx(pe,{className:"pb-3",children:e.jsx(ge,{className:"text-sm",children:"Distribuição de Tarefas"})}),e.jsxs(C,{className:"space-y-2.5",children:[Object.entries(Ee).map(([s,t])=>{const r=f.length>0?Math.round(t/f.length*100):0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{variant:"secondary",className:g("text-[10px] w-24 justify-center",us[s]),children:ye[s]}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:g("h-2 rounded-full transition-all",s==="concluida"?"bg-green-500":s==="cancelada"?"bg-muted-foreground/30":"bg-primary"),style:{width:`${r}%`}})})}),e.jsxs("span",{className:"text-xs text-muted-foreground w-12 text-right",children:[t," (",r,"%)"]})]},s)}),Object.keys(Ee).length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Sem tarefas"})]})]}),e.jsxs(k,{children:[e.jsx(pe,{className:"pb-3",children:e.jsx(ge,{className:"text-sm",children:"Próximos Compromissos"})}),e.jsx(C,{children:E.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum compromisso futuro"}):e.jsx("div",{className:"space-y-3",children:E.slice(0,6).map(s=>{const t=re(s.date),r=t===0?"Hoje":t===1?"Amanhã":`Em ${t}d`;return e.jsxs("div",{className:"flex items-center gap-3 p-2.5 rounded-lg border border-border/60 hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center min-w-[40px] rounded bg-muted px-1.5 py-1",children:[e.jsx("span",{className:"text-[9px] uppercase text-muted-foreground leading-none",children:new Date(s.date+"T12:00:00").toLocaleDateString("pt-BR",{month:"short"})}),e.jsx("span",{className:"text-base font-bold leading-tight",children:new Date(s.date+"T12:00:00").getDate()})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx($,{variant:"outline",className:g("text-[10px] px-1.5 py-0",be[s.type]),children:Ne[s.type]}),s.time&&e.jsx("span",{className:"text-[10px] text-muted-foreground",children:s.time})]})]}),e.jsx("span",{className:g("text-[10px] font-medium shrink-0 px-2 py-0.5 rounded-full",t<=1?"bg-destructive/10 text-destructive":t<=3?"bg-amber-100 text-amber-700":"bg-muted text-muted-foreground"),children:r})]},s.id)})})})]})]})}),e.jsxs(fe,{value:"tarefas",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[e.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[e.jsx(Ys,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),e.jsx(Ls,{placeholder:"Buscar tarefa...",value:z,onChange:s=>W(s.target.value),className:"pl-9 w-full text-sm"})]}),e.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[e.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[e.jsx(p,{variant:u==="list"?"default":"ghost",size:"sm",onClick:()=>O("list"),className:"rounded-none",children:e.jsx(Hs,{className:"w-4 h-4"})}),e.jsx(p,{variant:u==="kanban"?"default":"ghost",size:"sm",onClick:()=>O("kanban"),className:"rounded-none",children:e.jsx(Zt,{className:"w-4 h-4"})})]}),u==="kanban"&&e.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-muted-foreground cursor-pointer select-none",children:[e.jsx(Ms,{checked:We,onCheckedChange:nt,className:"scale-75"}),"Ocultar concluídas"]}),e.jsxs(p,{size:"sm",onClick:()=>{Qe(null),Be(!0)},className:"gap-1.5",children:[e.jsx(ze,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Nova"})]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsxs(Y,{value:Z,onValueChange:ne,children:[e.jsx(H,{className:"w-[130px] h-8 text-xs",children:e.jsx(G,{placeholder:"Status"})}),e.jsxs(q,{children:[e.jsx(A,{value:"all",children:"Todos"}),Object.keys(ye).map(s=>e.jsx(A,{value:s,children:ye[s]},s))]})]}),e.jsxs(Y,{value:le,onValueChange:hs,children:[e.jsx(H,{className:"w-[110px] h-8 text-xs",children:e.jsx(G,{placeholder:"Prioridade"})}),e.jsxs(q,{children:[e.jsx(A,{value:"all",children:"Todas"}),Object.keys(os).map(s=>e.jsx(A,{value:s,children:os[s]},s))]})]}),e.jsxs(Y,{value:ie,onValueChange:ps,children:[e.jsxs(H,{className:"w-[150px] h-8 text-xs",children:[e.jsx(As,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),e.jsx(G,{placeholder:"Projeto"})]}),e.jsxs(q,{children:[e.jsx(A,{value:"all",children:"Todos"}),se.map(s=>e.jsx(A,{value:s.id,children:s.name},s.id))]})]}),e.jsxs(Y,{value:Q,onValueChange:s=>rt(s),children:[e.jsxs(H,{className:"w-[44px] sm:w-[170px] h-8 text-xs gap-1.5",children:[e.jsx(Qt,{className:"w-3.5 h-3.5 shrink-0 text-muted-foreground"}),e.jsx("span",{className:"hidden sm:inline truncate",children:(Es=Ws.find(s=>s.value===Q))==null?void 0:Es.label})]}),e.jsx(q,{children:Ws.map(s=>e.jsx(A,{value:s.value,children:s.label},s.value))})]}),e.jsxs(Ft,{children:[e.jsx(_t,{asChild:!0,children:e.jsxs(p,{variant:"outline",size:"sm",className:"gap-1.5 h-8 text-xs",children:[e.jsx(Jt,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Campos"})]})}),e.jsx(Vt,{className:"w-56",align:"end",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Mostrar nos cards"}),Object.keys(Js).map(s=>e.jsxs("div",{className:"flex items-center justify-between py-1",children:[e.jsx(It,{htmlFor:`bosi-field-${s}`,className:"text-sm cursor-pointer",children:Js[s]}),e.jsx(Ms,{id:`bosi-field-${s}`,checked:Ae[s],onCheckedChange:()=>ot(s)})]},s))]})})]}),(Z!=="all"||le!=="all"||ie!=="all"||z)&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>{ne("all"),hs("all"),ps("all"),W("")},className:"text-xs gap-1 h-8",children:"✕ Limpar"})]})]}),e.jsx(qt,{open:dt,onOpenChange:Be,task:mt,onSave:ft,onCreateSubtask:Se,onUpdateSubtask:ke,onDeleteSubtask:Ce}),e.jsx(Bs,{open:!!oe,onOpenChange:s=>!s&&Oe(null),children:e.jsxs(Os,{children:[e.jsxs(Ps,{children:[e.jsx(Is,{children:"Remover tarefa?"}),e.jsx(Rs,{children:"Esta ação não pode ser desfeita."})]}),e.jsxs($s,{children:[e.jsx(zs,{children:"Cancelar"}),e.jsx(Fs,{onClick:bt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),u==="list"?e.jsx("div",{className:"space-y-3",children:Ie.length===0?e.jsx(k,{children:e.jsx(C,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma tarefa encontrada."})}):Ie.map(s=>e.jsx(xs,{task:s,cardFields:Ae,today:a,isExpanded:gs.has(s.id),onToggleExpand:fs,onToggleSubtask:bs,onEdit:t=>{Qe(t),Be(!0)},onDelete:Oe,showStatus:!0},s.id))}):e.jsxs(Xt,{sensors:ut,collisionDetection:ea,onDragStart:ht,onDragOver:pt,onDragEnd:gt,onDragCancel:jt,children:[e.jsx("div",{className:g("grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",We?"xl:grid-cols-4":"xl:grid-cols-6"),children:Ke.filter(s=>!We||s!=="concluida"&&s!=="cancelada").map(s=>e.jsx(Ea,{status:s,tasks:xt[s],isOver:ct===s&&Le!==null,cardFields:Ae,today:a,expandedTasks:gs,onToggleExpand:fs,onToggleSubtask:bs,onEdit:t=>{Qe(t),Be(!0)},onDelete:Oe},s))}),e.jsx(sa,{dropAnimation:{duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)"},children:js?e.jsx("div",{className:"w-[260px]",children:e.jsx(xs,{task:js,cardFields:Ae,today:a,isExpanded:!1,onToggleExpand:()=>{},onToggleSubtask:()=>{},onDelete:()=>{},isOverlay:!0})}):null})]})]}),e.jsx(fe,{value:"subtarefas",children:e.jsx(ta,{tasks:f,projects:se,loading:B,onCreateSubtask:Se,onUpdateSubtask:ke,onDeleteSubtask:Ce})}),e.jsxs(fe,{value:"agenda",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[e.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[e.jsx(Ys,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),e.jsx(Ls,{placeholder:"Buscar compromisso ou cliente...",value:J,onChange:s=>Ns(s.target.value),className:"pl-9 w-full text-sm"})]}),e.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[e.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[e.jsx(p,{variant:ce==="list"?"default":"ghost",size:"sm",onClick:()=>Je("list"),className:"rounded-none",children:e.jsx(Hs,{className:"w-4 h-4"})}),e.jsx(p,{variant:ce==="week"?"default":"ghost",size:"sm",onClick:()=>Je("week"),className:"rounded-none text-xs px-2",children:"Sem"}),e.jsx(p,{variant:ce==="calendar"?"default":"ghost",size:"sm",onClick:()=>Je("calendar"),className:"rounded-none",children:e.jsx(Ye,{className:"w-4 h-4"})})]}),e.jsxs(p,{size:"sm",onClick:()=>{K(null),F(!0)},className:"gap-1.5",children:[e.jsx(ze,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Novo"})]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsxs(Y,{value:de,onValueChange:vs,children:[e.jsx(H,{className:"w-[130px] h-8 text-xs",children:e.jsx(G,{placeholder:"Tipo"})}),e.jsxs(q,{children:[e.jsx(A,{value:"all",children:"Todos"}),Object.keys(Ne).map(s=>e.jsx(A,{value:s,children:Ne[s]},s))]})]}),e.jsxs(Y,{value:me,onValueChange:ys,children:[e.jsx(H,{className:"w-[130px] h-8 text-xs",children:e.jsx(G,{placeholder:"Status"})}),e.jsxs(q,{children:[e.jsx(A,{value:"all",children:"Todos"}),Object.keys(ls).map(s=>e.jsx(A,{value:s,children:ls[s]},s))]})]}),e.jsxs(Y,{value:xe,onValueChange:ws,children:[e.jsxs(H,{className:"w-[150px] h-8 text-xs",children:[e.jsx(As,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),e.jsx(G,{placeholder:"Projeto"})]}),e.jsxs(q,{children:[e.jsx(A,{value:"all",children:"Todos"}),se.map(s=>e.jsx(A,{value:s.id,children:s.name},s.id))]})]}),(de!=="all"||me!=="all"||xe!=="all"||J)&&e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>{vs("all"),ys("all"),ws("all"),Ns("")},className:"text-xs gap-1 h-8",children:"✕ Limpar"})]})]}),e.jsx(Ut,{open:Nt,onOpenChange:F,event:Xe,onSave:Ct}),e.jsx(Bs,{open:!!es,onOpenChange:s=>!s&&ss(null),children:e.jsxs(Os,{children:[e.jsxs(Ps,{children:[e.jsx(Is,{children:"Remover compromisso?"}),e.jsx(Rs,{children:"Esta ação não pode ser desfeita."})]}),e.jsxs($s,{children:[e.jsx(zs,{children:"Cancelar"}),e.jsx(Fs,{onClick:Tt,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),ce==="list"?e.jsx("div",{className:"space-y-6",children:Ts.length===0?e.jsx(k,{children:e.jsxs(C,{className:"p-8 text-center text-muted-foreground",children:["Nenhum compromisso encontrado.",e.jsx("br",{}),e.jsxs(p,{variant:"outline",size:"sm",className:"mt-3 gap-1.5",onClick:()=>{K(null),F(!0)},children:[e.jsx(ze,{className:"w-4 h-4"})," Criar compromisso"]})]})}):Ts.map(([s,t])=>e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-muted-foreground mb-2 capitalize",children:[new Date(s+"T12:00:00").toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"long"}),s===a&&e.jsx($,{variant:"secondary",className:"ml-2 text-[10px]",children:"Hoje"})]}),e.jsx("div",{className:"space-y-2",children:t.map(r=>e.jsx(k,{className:"hover:border-primary/30 transition-colors",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx($,{variant:"secondary",className:g("text-[10px]",be[r.type]),children:Ne[r.type]}),e.jsx($,{variant:"outline",className:"text-[10px]",children:ls[r.status]})]}),e.jsx("p",{className:"font-medium text-sm",children:r.title}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-1.5 text-xs text-muted-foreground",children:[r.time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Fe,{className:"w-3 h-3"}),r.time,r.endTime&&` — ${r.endTime}`]}),r.client&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(et,{className:"w-3 h-3"}),r.client]}),r.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pa,{className:"w-3 h-3"}),r.location]})]}),r.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.description})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx(p,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{K(r),F(!0)},children:e.jsx(st,{className:"w-3.5 h-3.5"})}),e.jsx(p,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>ss(r.id),children:e.jsx(tt,{className:"w-3.5 h-3.5"})})]})]})})},r.id))})]},s))}):ce==="week"?e.jsxs(k,{children:[e.jsx(pe,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>as(s=>s-1),children:e.jsx(cs,{className:"w-4 h-4"})}),e.jsx(ge,{className:"text-base",children:kt}),e.jsxs("div",{className:"flex items-center gap-1",children:[ts!==0&&e.jsx(p,{variant:"ghost",size:"sm",className:"text-xs h-7",onClick:()=>as(0),children:"Hoje"}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>as(s=>s+1),children:e.jsx(He,{className:"w-4 h-4"})})]})]})}),e.jsx(C,{children:e.jsx("div",{className:"grid grid-cols-7 gap-2",children:he.map(s=>{const t=new Date(s+"T12:00:00"),r=s===a,x=Cs.get(s)||[];return e.jsxs("div",{className:g("min-h-[140px] p-2 rounded-lg border transition-colors cursor-pointer hover:bg-muted/30",r?"bg-primary/5 border-primary/30":"border-border/50",ks===s&&"bg-primary/10 border-primary/40"),onClick:()=>{x.length===0&&(K(null),F(!0))},onDragOver:o=>{o.preventDefault(),ue(s)},onDragLeave:()=>ue(null),onDrop:o=>Ds(o,s),children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground capitalize",children:t.toLocaleDateString("pt-BR",{weekday:"short"})}),e.jsx("p",{className:g("text-lg font-bold",r&&"text-primary"),children:t.getDate()})]}),e.jsx("div",{className:"space-y-1",children:x.map(o=>e.jsxs("div",{className:g("text-[10px] px-1.5 py-1 rounded cursor-grab hover:opacity-80",be[o.type]),draggable:!0,onDragStart:y=>y.dataTransfer.setData("eventId",o.id),onClick:y=>{y.stopPropagation(),K(o),F(!0)},children:[o.time&&e.jsxs("span",{className:"font-semibold",children:[o.time," "]}),e.jsx("span",{className:"truncate",children:o.title})]},o.id))})]},s)})})})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-6",children:[e.jsxs(k,{children:[e.jsx(pe,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:wt,children:e.jsx(cs,{className:"w-4 h-4"})}),e.jsx(ge,{className:"text-base capitalize",children:yt}),e.jsx(p,{variant:"ghost",size:"icon",onClick:St,children:e.jsx(He,{className:"w-4 h-4"})})]})}),e.jsx(C,{children:e.jsxs("div",{className:"grid grid-cols-7 gap-px",children:[["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map(s=>e.jsx("div",{className:"text-center text-xs font-medium text-muted-foreground py-2",children:s},s)),vt.map((s,t)=>{const r=Cs.get(s.date)||[],x=s.date===a;return e.jsxs("div",{className:g("min-h-[80px] p-1 border border-border/50 rounded-sm cursor-pointer hover:bg-muted/30 transition-colors",!s.isCurrentMonth&&"opacity-40",x&&"bg-primary/5 border-primary/30",ks===s.date&&"bg-primary/10 border-primary/40 ring-1 ring-primary/30"),onDragOver:o=>{o.preventDefault(),ue(s.date)},onDragLeave:()=>ue(null),onDrop:o=>Ds(o,s.date),onClick:()=>{r.length===0&&(K(null),F(!0))},children:[e.jsx("p",{className:g("text-xs font-medium mb-0.5",x&&"text-primary font-bold"),children:s.day}),e.jsxs("div",{className:"space-y-0.5",children:[r.slice(0,2).map(o=>e.jsxs("div",{draggable:!0,onDragStart:y=>{y.dataTransfer.setData("eventId",o.id)},className:g("text-[9px] px-1 py-0.5 rounded truncate cursor-grab active:cursor-grabbing hover:opacity-80",be[o.type]),title:`${o.title} — arraste para reagendar`,onClick:y=>{y.stopPropagation(),K(o),F(!0)},children:[o.time&&e.jsxs("span",{className:"font-medium",children:[o.time," "]}),o.title]},o.id)),r.length>2&&e.jsxs("p",{className:"text-[9px] text-muted-foreground pl-1",children:["+",r.length-2," mais"]})]})]},t)})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs(k,{className:"h-fit lg:sticky lg:top-4",children:[e.jsx(pe,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ge,{className:"text-sm flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-primary"}),"Próximos"]}),e.jsx(p,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{K(null),F(!0)},children:e.jsx(ze,{className:"w-4 h-4"})})]})}),e.jsx(C,{className:"space-y-3",children:E.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum compromisso futuro"}):E.slice(0,8).map(s=>{const t=new Date(s.date+"T12:00:00"),r=new Date;r.setHours(0,0,0,0);const x=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o=Math.round((x.getTime()-r.getTime())/(1e3*60*60*24)),y=o===0?"Hoje":o===1?"Amanhã":`Em ${o} dias`;return e.jsxs("div",{className:"flex gap-3 p-2 rounded-md border border-border/60 hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>{K(s),F(!0)},children:[e.jsxs("div",{className:"flex flex-col items-center justify-center min-w-[44px] rounded bg-muted px-1 py-1",children:[e.jsx("span",{className:"text-[10px] uppercase text-muted-foreground leading-none",children:t.toLocaleDateString("pt-BR",{month:"short"})}),e.jsx("span",{className:"text-lg font-bold leading-tight",children:t.getDate()}),e.jsx("span",{className:"text-[10px] capitalize text-muted-foreground leading-none",children:t.toLocaleDateString("pt-BR",{weekday:"short"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5 flex-wrap",children:[e.jsx($,{variant:"outline",className:g("text-[10px] px-1.5 py-0",be[s.type]),children:Ne[s.type]}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:y})]}),s.time&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[e.jsx(Fe,{className:"w-3 h-3 inline mr-1"}),s.time,s.endTime?` – ${s.endTime}`:""]})]})]},s.id)})})]})})]})]}),e.jsx(fe,{value:"relatorio",children:e.jsx(ka,{})})]})]})]})}export{Dr as default};
