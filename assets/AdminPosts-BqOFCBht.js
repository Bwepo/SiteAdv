import{c as R,r as g,n as $,j as e,L as N,e as E}from"./index--VkK_6xW.js";import{A as q,P as G}from"./AdminLayout-BBlkaNDR.js";import{c as U,d as J,b as K}from"./usePosts-CztFNCJC.js";import{b as Q}from"./usePostViews-CqSNquAa.js";import{B as c}from"./button-BNnjEdlp.js";import{B as T}from"./badge-Dt7x2lqa.js";import{T as W,a as X,b as A,c as u,d as Y,e as p}from"./table-gEfiBt_9.js";import{D as k,a as S,b as M,c as j,d as Z}from"./dropdown-menu-Dd04UcwM.js";import{A as ee,a as se,b as re,c as ae,d as te,e as le,f as ie,g as ne}from"./alert-dialog-DdJCDIQ2.js";import{g as L}from"./supabaseErrors-eYWJjREL.js";import{C as ce}from"./chart-column-CuGYe-Xy.js";import{E as z}from"./external-link-C-azHpw7.js";import{E as F,a as _}from"./eye-DLVwjBcp.js";import{T as I}from"./trash-2-CTyzDFyk.js";import{I as de}from"./input-XXLJvWnV.js";import{S as oe}from"./skeleton-BEXVZZmk.js";import{T as me,a as xe,b as y}from"./tabs-BRLoCYgP.js";import{S as he}from"./search-7JmT5a0I.js";import"./dialog-BGwx2yHr.js";import"./index-ftCiKN76.js";import"./heart-c2aXVGpz.js";import"./sparkles-ABMq_5Qg.js";import"./house-DmKTZdQW.js";import"./menu-DPTdwRDk.js";import"./calendar-BhjfDFmQ.js";import"./users-l5ClWeL2.js";import"./file-text-pDZcbHxd.js";import"./useMutation-Cn7_PTXz.js";import"./usePostInteractions-BY1plIZc.js";import"./index-wqxuX6B3.js";import"./index-CkvygLlU.js";import"./chevron-right-8Qug1pP7.js";import"./check-DII1-jKf.js";import"./circle-DpjQhG_t.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=R("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=R("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);function f(a){return a?new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}function ue({posts:a,isLoading:b}){const[t,d]=g.useState(null),o=U(),v=J(),{toast:m}=$(),{data:l}=Q(),i=async s=>{const n=!s.published;try{await o.mutateAsync({id:s.id,published:n,published_at:n?new Date().toISOString():s.published_at}),m({title:n?"Post publicado!":"Post despublicado",description:n?"O artigo agora está visível no blog.":"O artigo foi movido para rascunhos."})}catch(w){const P=L(w,"Não foi possível atualizar o post.");m({title:"Erro",description:P,variant:"destructive"})}},x=async()=>{if(t)try{await v.mutateAsync(t),m({title:"Post excluído",description:"O artigo foi removido permanentemente."})}catch(s){const n=L(s,"Não foi possível excluir o post.");m({title:"Erro",description:n,variant:"destructive"})}finally{d(null)}};return a.length===0&&!b?e.jsxs("div",{className:"text-center py-12 border border-dashed border-border rounded-lg",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Nenhum post encontrado."}),e.jsx(N,{to:"/admin/posts/new",children:e.jsx(c,{children:"Criar primeiro post"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block border border-border rounded-lg overflow-hidden",children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(A,{children:[e.jsx(u,{className:"w-[35%]",children:"Título"}),e.jsx(u,{children:"Status"}),e.jsx(u,{children:"Views"}),e.jsx(u,{children:"Publicado em"}),e.jsx(u,{children:"Criado em"}),e.jsx(u,{className:"w-[100px]",children:"Ações"})]})}),e.jsx(Y,{children:a.map(s=>e.jsxs(A,{children:[e.jsx(p,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground line-clamp-1",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-1",children:["/",s.slug]})]})}),e.jsx(p,{children:e.jsx(T,{variant:s.published?"default":"secondary",className:E(s.published?"bg-green-500/10 text-green-600 border-green-500/30":""),children:s.published?"Publicado":"Rascunho"})}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{children:(l==null?void 0:l[s.id])||0})]})}),e.jsx(p,{className:"text-muted-foreground",children:f(s.published_at)}),e.jsx(p,{className:"text-muted-foreground",children:f(s.created_at)}),e.jsx(p,{children:e.jsxs(k,{children:[e.jsx(S,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",children:e.jsx(B,{className:"w-4 h-4"})})}),e.jsxs(M,{align:"end",className:"bg-popover",children:[e.jsx(j,{asChild:!0,children:e.jsxs(N,{to:`/admin/posts/${s.id}/edit`,children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Editar"]})}),s.published&&e.jsx(j,{asChild:!0,children:e.jsxs("a",{href:`/blog/${s.slug}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Ver no blog"]})}),e.jsx(j,{onClick:()=>i(s),children:s.published?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Despublicar"]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Publicar"]})}),e.jsx(Z,{}),e.jsxs(j,{onClick:()=>d(s.id),className:"text-destructive focus:text-destructive",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})})]},s.id))})]})}),e.jsx("div",{className:"lg:hidden space-y-3",children:a.map(s=>e.jsxs("div",{className:"bg-card rounded-lg border border-border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground line-clamp-2 text-sm sm:text-base",children:s.title}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",children:["/",s.slug]})]}),e.jsx(T,{variant:s.published?"default":"secondary",className:E("shrink-0 text-xs",s.published?"bg-green-500/10 text-green-600 border-green-500/30":""),children:s.published?"Publicado":"Rascunho"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Publicado: ",f(s.published_at)]}),e.jsxs("span",{children:["Criado: ",f(s.created_at)]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-border",children:[e.jsx(N,{to:`/admin/posts/${s.id}/edit`,children:e.jsxs(c,{variant:"outline",size:"sm",className:"h-8 text-xs",children:[e.jsx(O,{className:"w-3.5 h-3.5 mr-1.5"}),"Editar"]})}),e.jsx(c,{variant:"outline",size:"sm",className:"h-8 text-xs",onClick:()=>i(s),children:s.published?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-3.5 h-3.5 mr-1.5"}),"Despublicar"]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"w-3.5 h-3.5 mr-1.5"}),"Publicar"]})}),e.jsxs(k,{children:[e.jsx(S,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(B,{className:"w-4 h-4"})})}),e.jsxs(M,{align:"end",className:"bg-popover",children:[s.published&&e.jsx(j,{asChild:!0,children:e.jsxs("a",{href:`/blog/${s.slug}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Ver no blog"]})}),e.jsxs(j,{onClick:()=>d(s.id),className:"text-destructive focus:text-destructive",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})]})]},s.id))}),e.jsx(ee,{open:!!t,onOpenChange:()=>d(null),children:e.jsxs(se,{children:[e.jsxs(re,{children:[e.jsx(ae,{children:"Excluir post?"}),e.jsx(te,{children:"Esta ação não pode ser desfeita. O post será removido permanentemente."})]}),e.jsxs(le,{children:[e.jsx(ie,{children:"Cancelar"}),e.jsx(ne,{onClick:x,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}const C=15,Qe=()=>{const{data:a,isLoading:b}=K(),[t,d]=g.useState(""),[o,v]=g.useState("all"),[m,l]=g.useState(1),i=g.useMemo(()=>{let r=a||[];if(o==="published"?r=r.filter(h=>h.published):o==="draft"&&(r=r.filter(h=>!h.published)),t.trim()){const h=t.toLowerCase();r=r.filter(D=>D.title.toLowerCase().includes(h)||D.slug.toLowerCase().includes(h))}return r},[a,o,t]),x=Math.max(1,Math.ceil(i.length/C)),s=Math.min(m,x),n=i.slice((s-1)*C,s*C),w=r=>{v(r),l(1)},P=r=>{d(r),l(1)},V=(a==null?void 0:a.filter(r=>r.published).length)||0,H=(a==null?void 0:a.filter(r=>!r.published).length)||0;return e.jsxs(q,{title:"Posts",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 flex-1",children:[e.jsxs("div",{className:"relative w-full sm:max-w-xs",children:[e.jsx(he,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(de,{placeholder:"Buscar por título...",value:t,onChange:r=>P(r.target.value),className:"pl-9 h-9"})]}),e.jsx(me,{value:o,onValueChange:w,children:e.jsxs(xe,{className:"h-9",children:[e.jsxs(y,{value:"all",className:"text-xs px-3",children:["Todos (",(a==null?void 0:a.length)||0,")"]}),e.jsxs(y,{value:"published",className:"text-xs px-3",children:["Publicados (",V,")"]}),e.jsxs(y,{value:"draft",className:"text-xs px-3",children:["Rascunhos (",H,")"]})]})})]}),e.jsx(N,{to:"/admin/posts/new",children:e.jsxs(c,{size:"sm",children:[e.jsx(G,{className:"w-4 h-4 mr-1.5"}),"Novo Post"]})})]}),b?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>e.jsx(oe,{className:"h-16 w-full"},r))}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{posts:n}),x>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 text-sm",children:[e.jsxs("p",{className:"text-muted-foreground text-xs",children:[i.length," post",i.length!==1?"s":""," encontrado",i.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{variant:"outline",size:"sm",className:"h-8 px-3 text-xs",disabled:s<=1,onClick:()=>l(s-1),children:"Anterior"}),e.jsxs("span",{className:"px-3 text-xs text-muted-foreground",children:[s," / ",x]}),e.jsx(c,{variant:"outline",size:"sm",className:"h-8 px-3 text-xs",disabled:s>=x,onClick:()=>l(s+1),children:"Próxima"})]})]})]})]})};export{Qe as default};
