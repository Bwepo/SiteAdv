import{c as U,r as j,j as e,X as S,L as X,t as p}from"./index-C5rdV3ki.js";import{T as G,a as J,b as F,c as d,d as K,e as o}from"./table-DpX92v9g.js";import{B as g}from"./button-V3BEsbEG.js";import{B as M}from"./badge-BMLAq-mz.js";import{A as Q,a as W,b as Y,c as Z,d as ee,e as se,f as ae,g as te}from"./alert-dialog-fZtWGPG7.js";import{f as re,h as le,e as ne}from"./usePostInteractions-CgHV8EvV.js";import{g as C}from"./supabaseErrors-eYWJjREL.js";import{a as R,C as B}from"./chevron-up-CgXdGGql.js";import{C as H}from"./check-CsZJdN-T.js";import{E as ie}from"./external-link-BcA1Fq5E.js";import{f as P,p as L}from"./pt-BR-BnWYOt86.js";import{C as w,c as b}from"./card-DeLiqJaA.js";import{S as de}from"./skeleton-v7DQooK3.js";import{T as oe,a as ce,b as y}from"./tabs-CDYNvNKh.js";import{M as O}from"./message-square-CIph5uxV.js";import{C as V}from"./clock-DLn3XL0K.js";import{C as z}from"./circle-check-big-DWVB9sDy.js";import"./index-DhX7exH0.js";import"./index-YIY_kSu2.js";import"./useMutation-D3gHoRll.js";import"./index-Dr-H1w6C.js";import"./index-FK3-Dmxm.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=U("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function xe({comments:m,filter:i}){const[t,c]=j.useState(!1),[x,h]=j.useState(null),[n,u]=j.useState(new Set),r=re(),v=le(),N=m.filter(s=>i==="pending"?!s.reviewed_at:i==="approved"?!!s.reviewed_at:!0),D=s=>{const a=new Set(n);a.has(s)?a.delete(s):a.add(s),u(a)},T=(s,a)=>{var A,E;const l=((A=s.mladv_posts)==null?void 0:A.title)||"Post não encontrado",f=(E=s.mladv_posts)==null?void 0:E.slug,$=e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"line-clamp-2 text-sm",children:l}),f&&e.jsx(ie,{className:"w-3 h-3 flex-shrink-0"})]});return f?e.jsx(X,{to:`/blog/${f}`,target:"_blank",className:`text-foreground/90 hover:text-primary hover:underline flex items-center gap-1 ${a??""}`,children:$}):e.jsx("div",{className:`text-foreground/70 flex items-center gap-1 ${a??""}`,children:e.jsx("span",{className:"line-clamp-2 text-sm",children:l})})},_=async s=>{try{await r.mutateAsync({commentId:s}),p({title:"Comentário mantido",description:"O comentário foi marcado como revisado."})}catch(a){const l=C(a,"Não foi possível aprovar o comentário.");p({title:"Erro ao aprovar",description:l,variant:"destructive"})}},I=async()=>{if(x)try{await v.mutateAsync(x),p({title:"Comentário excluído",description:"O comentário foi removido permanentemente."})}catch(s){const a=C(s,"Não foi possível excluir o comentário.");p({title:"Erro ao excluir",description:a,variant:"destructive"})}finally{c(!1),h(null)}},k=s=>{h(s),c(!0)};return N.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:i==="pending"?"Nenhum comentário novo para revisar.":i==="approved"?"Nenhum comentário revisado ainda.":"Nenhum comentário encontrado."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block rounded-lg border border-border overflow-hidden",children:e.jsxs(G,{children:[e.jsx(J,{children:e.jsxs(F,{className:"bg-muted/50",children:[e.jsx(d,{className:"w-[200px]",children:"Post"}),e.jsx(d,{className:"w-[150px]",children:"Autor"}),e.jsx(d,{children:"Comentário"}),e.jsx(d,{className:"w-[120px]",children:"Data"}),e.jsx(d,{className:"w-[100px]",children:"Status"}),e.jsx(d,{className:"w-[100px] text-right",children:"Ações"})]})}),e.jsx(K,{children:N.map(s=>{const a=n.has(s.id),l=s.content.length>100;return e.jsxs(F,{children:[e.jsx(o,{children:T(s)}),e.jsx(o,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.author_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.author_email})]})}),e.jsx(o,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:!a&&l?"line-clamp-2":"",children:s.content}),l&&e.jsx("button",{onClick:()=>D(s.id),className:"text-xs text-primary hover:underline mt-1 flex items-center gap-1",children:a?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-3 h-3"})," Ver menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-3 h-3"})," Ver mais"]})})]})}),e.jsx(o,{className:"text-sm text-muted-foreground",children:P(new Date(s.created_at),"dd/MM/yyyy HH:mm",{locale:L})}),e.jsx(o,{children:e.jsx(M,{variant:s.reviewed_at?"default":"secondary",className:s.reviewed_at?"bg-green-500/20 text-green-600 hover:bg-green-500/30":"bg-yellow-500/20 text-yellow-600 hover:bg-yellow-500/30",children:s.reviewed_at?"Revisado":"Novo"})}),e.jsx(o,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[!s.reviewed_at&&e.jsx(g,{size:"icon",variant:"ghost",className:"h-8 w-8 text-green-600 hover:text-green-700 hover:bg-green-500/10",onClick:()=>_(s.id),disabled:r.isPending,title:"Manter comentário",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx(g,{size:"icon",variant:"ghost",className:"h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>k(s.id),disabled:v.isPending,title:"Excluir comentário",children:e.jsx(S,{className:"w-4 h-4"})})]})})]},s.id)})})]})}),e.jsx("div",{className:"md:hidden space-y-4",children:N.map(s=>{const a=n.has(s.id),l=s.content.length>100;return e.jsxs("div",{className:"bg-card rounded-lg border border-border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.author_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.author_email})]}),e.jsx(M,{variant:s.reviewed_at?"default":"secondary",className:s.reviewed_at?"bg-green-500/20 text-green-600":"bg-yellow-500/20 text-yellow-600",children:s.reviewed_at?"Revisado":"Novo"})]}),T(s,"text-xs"),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:!a&&l?"line-clamp-3":"",children:s.content}),l&&e.jsx("button",{onClick:()=>D(s.id),className:"text-xs text-primary hover:underline mt-1 flex items-center gap-1",children:a?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-3 h-3"})," Ver menos"]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-3 h-3"})," Ver mais"]})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-border",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:P(new Date(s.created_at),"dd/MM/yyyy HH:mm",{locale:L})}),e.jsxs("div",{className:"flex items-center gap-1",children:[!s.reviewed_at&&e.jsxs(g,{size:"sm",variant:"ghost",className:"h-8 text-green-600 hover:text-green-700 hover:bg-green-500/10",onClick:()=>_(s.id),disabled:r.isPending,children:[e.jsx(H,{className:"w-4 h-4 mr-1"}),"Manter"]}),e.jsxs(g,{size:"sm",variant:"ghost",className:"h-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>k(s.id),disabled:v.isPending,children:[e.jsx(S,{className:"w-4 h-4 mr-1"}),"Excluir"]})]})]})]},s.id)})}),e.jsx(Q,{open:t,onOpenChange:c,children:e.jsxs(W,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Excluir comentário?"}),e.jsx(ee,{children:"Esta ação não pode ser desfeita. O comentário será removido permanentemente."})]}),e.jsxs(se,{children:[e.jsx(ae,{children:"Cancelar"}),e.jsx(te,{onClick:I,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}const Re=()=>{const[m,i]=j.useState("pending"),{data:t,isLoading:c,error:x}=ne(),h=(t==null?void 0:t.length)||0,n=(t==null?void 0:t.filter(r=>!r.reviewed_at).length)||0,u=(t==null?void 0:t.filter(r=>!!r.reviewed_at).length)||0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3 mb-8",children:[e.jsx(w,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(O,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total de comentários"})]})]})})}),e.jsx(w,{className:n>0?"ring-2 ring-yellow-500/50":"",children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-yellow-500/10",children:e.jsx(V,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:n}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Novos"})]}),n>0&&e.jsx(q,{className:"w-5 h-5 text-yellow-500 ml-auto"})]})})}),e.jsx(w,{children:e.jsx(b,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-green-500/10",children:e.jsx(z,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:u}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Revisados"})]})]})})})]}),e.jsx("div",{className:"mb-6 -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsx(oe,{value:m,onValueChange:r=>i(r),children:e.jsxs(ce,{className:"w-full sm:w-auto flex",children:[e.jsxs(y,{value:"pending",className:"flex-1 sm:flex-none gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-4",children:[e.jsx(V,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Novos"}),e.jsx("span",{className:"xs:hidden",children:"Novos"}),n>0&&e.jsx("span",{className:"ml-0.5 sm:ml-1 px-1.5 sm:px-2 py-0.5 text-[10px] sm:text-xs rounded-full bg-yellow-500/20 text-yellow-600",children:n})]}),e.jsxs(y,{value:"approved",className:"flex-1 sm:flex-none gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-4",children:[e.jsx(z,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden xs:inline",children:"Revisados"}),e.jsx("span",{className:"xs:hidden",children:"Rev."})]}),e.jsxs(y,{value:"all",className:"flex-1 sm:flex-none gap-1 sm:gap-2 text-xs sm:text-sm px-2 sm:px-4",children:[e.jsx(O,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),"Todos"]})]})})}),c?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(r=>e.jsx(de,{className:"h-20 w-full"},r))}):x?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"w-12 h-12 text-destructive mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:C(x,"Erro ao carregar comentários. Verifique se as tabelas foram criadas no banco de dados.")})]}):e.jsx(xe,{comments:t||[],filter:m})]})};export{Re as default};
