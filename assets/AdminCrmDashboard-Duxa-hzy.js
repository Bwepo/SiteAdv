import{r as g,j as e,m as l,e as d,L as T}from"./index-BhzdYSzI.js";import{C as o,c,a as S,b as k}from"./card-CG5tzdnu.js";import{B as A}from"./badge-DAR0pp9x.js";import{B as D}from"./button-BCA6LSQI.js";import{S as f}from"./skeleton-oY5iPKrI.js";import{S as $,a as z,b as M,c as H,d as w}from"./select-DwnyfgoJ.js";import{u as ee,a as se,f as ae,b as re,E as te,d as le,T as ie,c as ne}from"./crmTypes-DXfMBV5U.js";import{F as de}from"./filter-CqO-9pvF.js";import{F as oe}from"./folder-kanban-Ci74sovk.js";import{C as y}from"./calendar-CYmNMj4f.js";import{L as E}from"./list-todo-B-YV8_OI.js";import{C as ce}from"./clock-CW1j7_3E.js";import{T as Y}from"./triangle-alert-e3brHdMs.js";import{a as K,C as me}from"./circle-check-CnJ4znfa.js";import{A as U}from"./arrow-right-DTn0sW5M.js";import{U as F}from"./users-CnkMEnCD.js";import"./index-CF90hve9.js";import"./index-DF8BQtXL.js";import"./index-DQjPI_6X.js";import"./chevron-up-B-Ufv85n.js";import"./check-DOyymFu-.js";import"./useQuery-FdrG3W7_.js";function xe(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[1,2,3,4].map(i=>e.jsx(o,{className:"glass-card",children:e.jsxs(c,{className:"p-4 flex items-center gap-3",children:[e.jsx(f,{className:"h-10 w-10 rounded-lg"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{className:"h-7 w-8"}),e.jsx(f,{className:"h-3 w-20"})]})]})},i))}),e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:[1,2].map(i=>e.jsx(o,{className:"glass-card",children:e.jsxs(c,{className:"p-6 space-y-3",children:[e.jsx(f,{className:"h-5 w-40 mb-2"}),[1,2,3].map(C=>e.jsx(f,{className:"h-16 w-full rounded-lg"},C))]})},i))})]})}function ue(){return new Intl.DateTimeFormat("sv-SE",{timeZone:"America/Sao_Paulo"}).format(new Date)}const B={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.06}}},j={hidden:{opacity:0,y:12},show:{opacity:1,y:0,transition:{duration:.35,ease:[0,0,.2,1]}}};function Ve(){const{events:i,loading:C}=ee(),{tasks:b,loading:Z}=se(),{clients:he,loading:q}=ae(),{projects:x,loading:G}=re(),[t,L]=g.useState("all"),[n,P]=g.useState("all"),J=C||Z||q||G,N=ue(),Q=g.useMemo(()=>{const s=new Set;return b.forEach(a=>{a.client&&s.add(a.client)}),i.forEach(a=>{a.client&&s.add(a.client)}),[...s].sort()},[b,i]),m=g.useMemo(()=>{let s=b;if(t!=="all"&&(s=s.filter(a=>a.client===t)),n!=="all"){const a=x.find(r=>r.id===n);a&&(s=s.filter(r=>r.client===a.name))}return s},[b,t,n,x]),R=g.useMemo(()=>{let s=i;if(t!=="all"&&(s=s.filter(a=>a.client===t)),n!=="all"){const a=x.find(r=>r.id===n);a&&(s=s.filter(r=>r.client===a.name))}return s},[i,t,n,x]),W=R.filter(s=>s.date===N).length,v=m.filter(s=>s.status!=="cancelada").length,_=m.filter(s=>s.dueDate&&s.dueDate<N&&s.status!=="concluida"&&s.status!=="cancelada").length,u=m.filter(s=>s.status==="em_andamento").length,h=m.filter(s=>s.status==="concluida").length,p=m.filter(s=>s.status==="pendente"||s.status==="agendado").length,V=R.filter(s=>s.date>=N&&s.status!=="cancelado").sort((s,a)=>s.date.localeCompare(a.date)||(s.time||"").localeCompare(a.time||"")).slice(0,6),O=m.filter(s=>s.status!=="concluida"&&s.status!=="cancelada").sort((s,a)=>{const r={alta:0,media:1,baixa:2};return r[s.priority]-r[a.priority]||(s.dueDate||"").localeCompare(a.dueDate||"")}).slice(0,6),X=s=>{const a=new Date(s+"T12:00:00"),r=new Date;r.setHours(12,0,0,0);const I=Math.round((a.getTime()-r.getTime())/864e5);return I===0?"Hoje":I===1?"Amanhã":a.toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"short"})};return e.jsx(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:J?e.jsx(xe,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 flex-wrap",children:[e.jsx(de,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs($,{value:t,onValueChange:L,children:[e.jsx(z,{className:"w-[220px] glass-card border-border/40",children:e.jsx(M,{placeholder:"Filtrar por cliente"})}),e.jsxs(H,{children:[e.jsx(w,{value:"all",children:"Todos os clientes"}),Q.map(s=>e.jsx(w,{value:s,children:s},s))]})]}),e.jsxs($,{value:n,onValueChange:P,children:[e.jsxs(z,{className:"w-[220px] glass-card border-border/40",children:[e.jsx(oe,{className:"w-4 h-4 mr-1.5 text-muted-foreground"}),e.jsx(M,{placeholder:"Filtrar por projeto"})]}),e.jsxs(H,{children:[e.jsx(w,{value:"all",children:"Todos os projetos"}),x.map(s=>e.jsx(w,{value:s.id,children:s.name},s.id))]})]}),(t!=="all"||n!=="all")&&e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>{L("all"),P("all")},className:"text-xs",children:"Limpar filtros"})]}),e.jsx(l.div,{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-8",variants:B,initial:"hidden",animate:"show",children:[{icon:y,value:W,label:"Hoje",gradient:"from-background to-primary/5",iconBg:"bg-primary/10 text-primary ring-primary/20"},{icon:E,value:p,label:"A Fazer",gradient:"from-background to-muted/30",iconBg:"bg-muted text-muted-foreground ring-muted-foreground/10"},{icon:ce,value:u,label:"Em andamento",gradient:"from-background to-accent/5",iconBg:"bg-accent/10 text-accent ring-accent/20"},{icon:Y,value:_,label:"Atrasadas",gradient:"from-background to-destructive/5",iconBg:"bg-destructive/10 text-destructive ring-destructive/20",valueColor:"text-destructive/90"},{icon:K,value:h,label:"Concluídas",gradient:"from-background to-emerald-500/5",iconBg:"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 ring-emerald-500/20"}].map((s,a)=>e.jsx(l.div,{variants:j,children:e.jsx(o,{className:d("glass-card bg-gradient-to-br hover:shadow-md transition-all",s.gradient),children:e.jsxs(c,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:d("p-2.5 rounded-xl ring-1 ring-inset",s.iconBg),children:e.jsx(s.icon,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:d("text-2xl font-bold font-serif tracking-tight",s.valueColor||"text-foreground/90"),children:s.value}),e.jsx("p",{className:"text-[11px] font-medium uppercase tracking-wider text-muted-foreground",children:s.label})]})]})})},s.label))}),e.jsx(l.div,{variants:j,initial:"hidden",animate:"show",children:e.jsxs(o,{className:"mb-6 glass-card",children:[e.jsx(S,{className:"pb-3 border-b border-border/40",children:e.jsxs(k,{className:"text-[15px] font-semibold flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-primary"}),"Distribuição de Tarefas",t!=="all"&&e.jsx(A,{variant:"secondary",className:"text-[10px] ml-2 font-medium bg-primary/10 text-primary",children:t})]})}),e.jsxs(c,{className:"pt-4",children:[e.jsx("div",{className:"flex gap-1.5 h-3.5 rounded-full overflow-hidden bg-muted/50 p-0.5 border border-border/50",children:v>0&&e.jsxs(e.Fragment,{children:[p>0&&e.jsx("div",{className:"bg-muted-foreground/40 transition-all rounded-full",style:{width:`${p/v*100}%`},title:`A Fazer: ${p}`}),u>0&&e.jsx("div",{className:"bg-accent transition-all rounded-full",style:{width:`${u/v*100}%`},title:`Em Andamento: ${u}`}),h>0&&e.jsx("div",{className:"bg-emerald-500 transition-all rounded-full",style:{width:`${h/v*100}%`},title:`Concluídas: ${h}`})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-muted-foreground/40 shadow-sm"})," A Fazer (",p,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-accent shadow-sm"})," Andamento (",u,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500 shadow-sm"})," Concluídas (",h,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-destructive/80 shadow-sm"})," Atrasadas (",_,")"]})]})]})]})}),e.jsxs(l.div,{className:"grid lg:grid-cols-2 gap-6",variants:B,initial:"hidden",animate:"show",children:[e.jsx(l.div,{variants:j,children:e.jsxs(o,{className:"glass-card h-full",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"text-base flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4 text-primary"}),"Próximos Compromissos"]}),e.jsx(T,{to:"/admin/agenda",children:e.jsxs(D,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todos ",e.jsx(U,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(c,{className:"space-y-3",children:V.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum compromisso próximo."}):V.map(s=>e.jsxs("div",{className:"flex items-start gap-3.5 p-3 rounded-xl border border-border/40 hover:bg-muted/40 hover:border-border/80 transition-all group",children:[e.jsxs("div",{className:"text-center min-w-[3.5rem] p-1.5 rounded-lg bg-background shadow-sm border border-border/30 group-hover:border-primary/20 transition-colors",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:X(s.date).split(" ")[0]}),s.time&&e.jsx("p",{className:"text-sm font-bold text-foreground/90",children:s.time})]}),e.jsxs("div",{className:"flex-1 min-w-0 py-0.5",children:[e.jsx("p",{className:"text-sm font-semibold truncate group-hover:text-primary transition-colors",children:s.title}),s.client&&e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1.5 mt-1",children:[e.jsx(F,{className:"w-3 h-3 opacity-70"}),s.client]})]}),e.jsx(A,{variant:"secondary",className:d("text-[9px] uppercase tracking-widest shrink-0 py-0.5 font-semibold",te[s.type]),children:le[s.type]})]},s.id))})]})}),e.jsx(l.div,{variants:j,children:e.jsxs(o,{className:"glass-card h-full",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"text-base flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-primary"}),"Tarefas Pendentes"]}),e.jsx(T,{to:"/admin/tarefas",children:e.jsxs(D,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todas ",e.jsx(U,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(c,{className:"space-y-3",children:O.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma tarefa pendente."}):O.map(s=>{const a=s.dueDate&&s.dueDate<N;return e.jsxs("div",{className:d("p-3.5 rounded-xl border transition-all duration-200 group",a?"border-destructive/30 bg-destructive/5 hover:border-destructive/50":"border-border/40 hover:bg-muted/40 hover:border-border/80"),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[13px] font-semibold truncate group-hover:text-primary transition-colors",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1.5 flex-wrap",children:[s.client&&e.jsxs("span",{className:"text-[11px] text-muted-foreground bg-background px-1.5 py-0.5 rounded shadow-sm border border-border/30 flex items-center gap-1.5",children:[e.jsx(F,{className:"w-3 h-3 opacity-70"}),s.client]}),s.dueDate&&e.jsxs("span",{className:d("text-[11px] font-medium flex items-center gap-1",a?"text-destructive":"text-muted-foreground"),children:[a?e.jsx(Y,{className:"w-3 h-3"}):e.jsx(y,{className:"w-3 h-3"}),new Date(s.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]})]}),e.jsx(A,{variant:"secondary",className:d("text-[9px] uppercase font-semibold tracking-wider shrink-0",ie[s.priority]),children:ne[s.priority]})]}),s.subtasks.length>0&&e.jsxs("div",{className:"mt-3 bg-background/50 rounded-lg p-2 border border-border/20",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] text-muted-foreground mb-1.5 font-medium",children:[e.jsxs("span",{children:["Subtarefas (",s.subtasks.filter(r=>r.status==="Concluído").length,"/",s.subtasks.length,")"]}),e.jsxs("span",{children:[Math.round(s.subtasks.filter(r=>r.status==="Concluído").length/s.subtasks.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-muted/50 rounded-full h-1.5 p-[1px] border border-border/30",children:e.jsx("div",{className:"bg-primary/90 rounded-full h-full transition-all duration-500 ease-out",style:{width:`${s.subtasks.filter(r=>r.status==="Concluído").length/s.subtasks.length*100}%`}})})]})]},s.id)})})]})})]}),e.jsx(l.div,{className:"mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3",variants:B,initial:"hidden",animate:"show",children:[{href:"/admin/agenda",icon:y,label:"Agenda"},{href:"/admin/tarefas",icon:E,label:"Tarefas"},{href:"/admin/bosi",icon:F,label:"BOSI"},{href:"/admin/posts/new",icon:K,label:"Novo Post"}].map(s=>e.jsx(l.div,{variants:j,children:e.jsx(T,{to:s.href,children:e.jsx(o,{className:"glass-card hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(c,{className:"p-4 text-center",children:[e.jsx(s.icon,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:s.label})]})})})},s.href))})]})})}export{Ve as default};
