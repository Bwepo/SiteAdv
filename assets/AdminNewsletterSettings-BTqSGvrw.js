import{y as x,r as c,j as e}from"./index-BMi_G2aQ.js";import{A as f,S as u}from"./AdminLayout-Crf21vjA.js";import{B as g}from"./button-CLTjtWEi.js";import{I as o}from"./input-B9MJYkaX.js";import{L as m}from"./label-Cj1Kh4bO.js";import{C as _,a as j,b as v,d as y,c as N}from"./card-FvmdAdt7.js";import{S as l}from"./skeleton-DlXhQc5K.js";import{k as b,l as w}from"./useNewsletter-9H7jxTAF.js";import{g as C}from"./supabaseErrors-eYWJjREL.js";import{L as S}from"./loader-circle-DnF7ebpD.js";import{S as z}from"./save-CD3kT5Do.js";import"./chevron-left-B6XPOTh1.js";import"./house-HIG3P3VO.js";import"./file-text-BMME2LbX.js";import"./mail-DmCJRpfO.js";import"./useMutation-a59Q_35T.js";const G=()=>{const{toast:n}=x(),{data:t,isLoading:p}=b(),d=w(),[a,i]=c.useState({from_name:"",from_email:"",reply_to:"",batch_size:100});c.useEffect(()=>{t&&i({from_name:t.from_name||"",from_email:t.from_email||"",reply_to:t.reply_to||"",batch_size:t.batch_size||100})},[t]);const h=async s=>{if(s.preventDefault(),!a.from_email.trim()){n({title:"E-mail obrigatório",description:"Informe o e-mail remetente.",variant:"destructive"});return}try{await d.mutateAsync({from_name:a.from_name.trim(),from_email:a.from_email.trim(),reply_to:a.reply_to.trim()||null,batch_size:Math.max(1,Math.min(500,a.batch_size))}),n({title:"Configurações salvas",description:"As configurações de newsletter foram atualizadas."})}catch(r){n({title:"Erro ao salvar",description:C(r,"Não foi possível salvar."),variant:"destructive"})}};return e.jsx(f,{title:"Configurações de Newsletter",children:e.jsxs(_,{className:"max-w-2xl",children:[e.jsxs(j,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"Configurações de envio"]}),e.jsx(y,{children:"Configure os dados do remetente e parâmetros de envio das campanhas de newsletter."})]}),e.jsx(N,{children:p?e.jsxs("div",{className:"space-y-4",children:[e.jsx(l,{className:"h-10 w-full"}),e.jsx(l,{className:"h-10 w-full"}),e.jsx(l,{className:"h-10 w-full"}),e.jsx(l,{className:"h-10 w-1/2"})]}):e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"from_name",children:"Nome do remetente"}),e.jsx(o,{id:"from_name",value:a.from_name,onChange:s=>i(r=>({...r,from_name:s.target.value})),placeholder:"Mariana Lima",maxLength:100})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"from_email",children:"E-mail remetente *"}),e.jsx(o,{id:"from_email",type:"email",value:a.from_email,onChange:s=>i(r=>({...r,from_email:s.target.value})),placeholder:"no-reply@marianalima.adv.br",required:!0,maxLength:255}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Deve ser um domínio verificado no Resend."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"reply_to",children:"Responder para (opcional)"}),e.jsx(o,{id:"reply_to",type:"email",value:a.reply_to,onChange:s=>i(r=>({...r,reply_to:s.target.value})),placeholder:"contato@marianalima.adv.br",maxLength:255}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Quando o leitor clicar em "Responder", o e-mail será enviado para este endereço.'})]}),e.jsxs("div",{className:"space-y-2 max-w-[200px]",children:[e.jsx(m,{htmlFor:"batch_size",children:"Tamanho do lote"}),e.jsx(o,{id:"batch_size",type:"number",min:1,max:500,value:a.batch_size,onChange:s=>i(r=>({...r,batch_size:parseInt(s.target.value,10)||100}))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Quantos e-mails enviar por execução (1–500)."})]}),e.jsxs(g,{type:"submit",disabled:d.isPending,children:[d.isPending?e.jsx(S,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(z,{className:"w-4 h-4 mr-2"}),"Salvar configurações"]})]})})]})})};export{G as default};
