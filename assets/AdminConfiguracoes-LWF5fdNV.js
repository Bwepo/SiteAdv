import{c as L,j as e,r as l,e as A,X as Me,U as Ve,m as Fe,h as p,V as be,s as X}from"./index-DQ4BcdQP.js";import{C as P,a as _,c as I,b as U,d as Q}from"./card-B9Ql-6Yu.js";import{B as g}from"./button-DH8xpC-k.js";import{P as $e,a as qe,b as Ue}from"./popover-DPSVvMWA.js";import{I as R}from"./input-C6F89SOL.js";import{L as se}from"./label-mOsQqGGT.js";import{T as Ge,a as He,b as W,c as Y,E as ve,U as Ke}from"./tabs-DGyYuTHF.js";import{u as Je}from"./useCrmFieldOptions-C5TANtui.js";import{P as Xe,B as q}from"./badge-OivbyGqf.js";import{S as Qe}from"./separator-BXJb2Lx9.js";import{A as ae,a as re,b as te,c as le,d as oe,e as ne,f as ce,g as ie,h as Ne}from"./alert-dialog-D9IQb3L1.js";import{S as de,a as me,c as he,d as ue,b as We}from"./select-DAXKJtub.js";import{S as ee}from"./skeleton-aLnbU5aI.js";import{u as Ye,a as ye,s as Ze,K as es,P as ss,D as as,f as rs,S as ts,v as ls,e as os,C as ns,g as cs}from"./sortable.esm-D8bG9Qqw.js";import{L as F}from"./loader-circle-C0_UrFHt.js";import{C as xe}from"./check-Cq8YYEDK.js";import{P as is}from"./pencil-DhzgQOHl.js";import{T as ke}from"./trash-2-BJ5LbWD2.js";import{S as ds}from"./settings-IwkR2Q5B.js";import{L as Se}from"./lock-Bz_JLC3v.js";import{E as we}from"./eye-off-BcmOXWhM.js";import{D as ms}from"./download-DDa0nS9m.js";import"./index-BbAhL-mP.js";import"./index-B8TJVCQv.js";import"./index-CJ_y7zwL.js";import"./useQuery-CY_b4SRx.js";import"./useMutation-DMzEC-9V.js";import"./index-DlOXUKP_.js";import"./index-AkQFuhpZ.js";import"./chevron-up-BWaheX2M.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=L("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=L("FolderArchive",[["circle",{cx:"15",cy:"19",r:"2",key:"u2pros"}],["path",{d:"M20.9 19.8A2 2 0 0 0 22 18V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2h5.1",key:"1jj40k"}],["path",{d:"M15 11v-1",key:"cntcp"}],["path",{d:"M15 17v-2",key:"1279jj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=L("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=L("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=L("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=L("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=L("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=L("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),$=[{label:"Vermelho",value:"bg-red-100 text-red-800"},{label:"Amarelo",value:"bg-yellow-100 text-yellow-800"},{label:"Verde",value:"bg-green-100 text-green-800"},{label:"Azul",value:"bg-blue-100 text-blue-800"},{label:"Roxo",value:"bg-purple-100 text-purple-800"},{label:"Cinza",value:"bg-gray-100 text-gray-800"},{label:"Slate",value:"bg-slate-100 text-slate-800"},{label:"Laranja",value:"bg-orange-100 text-orange-800"},{label:"Rosa",value:"bg-pink-100 text-pink-800"},{label:"Teal",value:"bg-teal-100 text-teal-800"}],js=[{fieldName:"tarefa_status",title:"Status da Tarefa",description:"OpÃ§Ãµes de status para tarefas do CRM."},{fieldName:"tarefa_prioridade",title:"Prioridade da Tarefa",description:"NÃ­veis de prioridade para tarefas."},{fieldName:"agenda_tipo",title:"Tipo de Evento",description:"Tipos de compromissos na agenda."},{fieldName:"agenda_status",title:"Status do Evento",description:"Status dos compromissos da agenda."},{fieldName:"subtarefa_status",title:"Status da Subtarefa",description:"Status das subtarefas."}];function fs({opt:o,editingId:j,editLabel:u,editColor:c,editValue:f,setEditLabel:b,setEditColor:x,setEditValue:r,onStartEdit:n,onSaveEdit:v,onCancelEdit:d,onDelete:m}){var s;const{attributes:N,listeners:y,setNodeRef:O,transform:T,transition:B,isDragging:S}=os({id:o.id}),E={transform:ns.Transform.toString(T),transition:B,zIndex:S?10:void 0,opacity:S?.8:1};return e.jsxs("div",{ref:O,style:E,className:"flex items-center gap-2 px-3 py-2 rounded-lg border border-border/50 bg-muted/30 group",children:[e.jsx("button",{type:"button",...N,...y,className:"cursor-grab active:cursor-grabbing touch-none p-1 -m-1 rounded hover:bg-muted/60",children:e.jsx(us,{className:"h-4 w-4 text-muted-foreground shrink-0"})}),j===o.id?e.jsxs(e.Fragment,{children:[e.jsx(R,{value:u,onChange:t=>b(t.target.value),placeholder:"Label",className:"h-7 text-sm flex-1",autoFocus:!0}),e.jsx(R,{value:f,onChange:t=>r(t.target.value.toLowerCase().replace(/\s+/g,"_")),placeholder:"Valor",className:"h-7 text-sm w-28 font-mono"}),e.jsxs(de,{value:c,onValueChange:x,children:[e.jsx(me,{className:"h-7 w-28",children:e.jsx(q,{className:A("text-[10px]",c),children:((s=$.find(t=>t.value===c))==null?void 0:s.label)??"Cor"})}),e.jsx(he,{children:$.map(t=>e.jsx(ue,{value:t.value,children:e.jsx(q,{className:A("text-[10px]",t.value),children:t.label})},t.value))})]}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:v,children:e.jsx(xe,{className:"h-3.5 w-3.5 text-primary"})}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:d,children:e.jsx(Me,{className:"h-3.5 w-3.5"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:A("text-[10px]",o.color),children:o.label}),e.jsx("span",{className:"text-[10px] text-muted-foreground font-mono",children:o.value}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>n(o),children:e.jsx(is,{className:"h-3 w-3"})}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",onClick:()=>m(o.id),children:e.jsx(ke,{className:"h-3 w-3"})})]})]})]})}function bs({fieldName:o,title:j,description:u,options:c,onAdd:f,onUpdate:b,onDelete:x,onReorder:r,onCountRecords:n}){var fe;const[v,d]=l.useState(!1),[m,N]=l.useState(""),[y,O]=l.useState(""),[T,B]=l.useState($[5].value),[S,E]=l.useState(null),[s,t]=l.useState(""),[h,i]=l.useState(""),[w,G]=l.useState(""),[k,H]=l.useState(null),[D,M]=l.useState(""),[C,Z]=l.useState(null),[pe,ge]=l.useState(!1),V=k?c.find(a=>a.id===k):null,je=V?c.filter(a=>a.id!==k):[];l.useEffect(()=>{var a;V?(ge(!0),M(((a=je[0])==null?void 0:a.value)??""),n(o,V.value).then(Z).catch(()=>Z(0)).finally(()=>ge(!1))):Z(null)},[k]);const Te=Ye(ye(ss,{activationConstraint:{distance:5}}),ye(es,{coordinateGetter:Ze})),De=()=>{!m.trim()||!y.trim()||(f({field_name:o,value:m.trim().toLowerCase().replace(/\s+/g,"_"),label:y.trim(),color:T}),N(""),O(""),B($[5].value),d(!1))},Le=a=>{E(a.id),t(a.label),i(a.color),G(a.value)},ze=()=>{if(!S||!s.trim())return;const a=c.find(K=>K.id===S),z={id:S,label:s.trim(),color:h};a&&w.trim()&&w.trim()!==a.value&&(z.value=w.trim()),b(z),E(null)},Pe=()=>{k&&(x({id:k,migrateToValue:C&&C>0?D:void 0}),H(null))},_e=a=>{const{active:z,over:K}=a;if(!K||z.id===K.id)return;const Ie=c.findIndex(J=>J.id===z.id),Re=c.findIndex(J=>J.id===K.id),Oe=cs(c,Ie,Re);r(Oe.map((J,Be)=>({id:J.id,sort_order:Be})))};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:j}),e.jsx("p",{className:"text-xs text-muted-foreground",children:u})]}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>d(!0),className:"gap-1",children:[e.jsx(Xe,{className:"h-3.5 w-3.5"})," Adicionar"]})]}),e.jsx(as,{sensors:Te,collisionDetection:rs,onDragEnd:_e,children:e.jsx(ts,{items:c.map(a=>a.id),strategy:ls,children:e.jsx("div",{className:"space-y-1.5",children:c.map(a=>e.jsx(fs,{opt:a,editingId:S,editLabel:s,editColor:h,editValue:w,setEditLabel:t,setEditColor:i,setEditValue:G,onStartEdit:Le,onSaveEdit:ze,onCancelEdit:()=>E(null),onDelete:z=>H(z)},a.id))})})}),v&&e.jsxs("div",{className:"p-3 rounded-lg border border-border bg-muted/50 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(R,{value:y,onChange:a=>{O(a.target.value),(!m||m===y.trim().toLowerCase().replace(/\s+/g,"_"))&&N(a.target.value.trim().toLowerCase().replace(/\s+/g,"_"))},placeholder:"Nome (ex: Ultra)",className:"h-8 text-sm",autoFocus:!0}),e.jsx(R,{value:m,onChange:a=>N(a.target.value),placeholder:"Valor (ex: ultra)",className:"h-8 text-sm font-mono"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(de,{value:T,onValueChange:B,children:[e.jsx(me,{className:"h-8 w-36",children:e.jsx(q,{className:A("text-[10px]",T),children:((fe=$.find(a=>a.value===T))==null?void 0:fe.label)??"Cor"})}),e.jsx(he,{children:$.map(a=>e.jsx(ue,{value:a.value,children:e.jsx(q,{className:A("text-[10px]",a.value),children:a.label})},a.value))})]}),e.jsx("div",{className:"flex-1"}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>d(!1),children:"Cancelar"}),e.jsx(g,{size:"sm",onClick:De,disabled:!y.trim()||!m.trim(),children:"Adicionar"})]})]}),e.jsx(ae,{open:!!k,onOpenChange:a=>!a&&H(null),children:e.jsxs(re,{children:[e.jsxs(te,{children:[e.jsxs(le,{children:['Remover opÃ§Ã£o "',V==null?void 0:V.label,'"?']}),e.jsx(oe,{asChild:!0,children:e.jsx("div",{className:"space-y-3",children:pe?e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(F,{className:"h-4 w-4 animate-spin"}),"Verificando registros afetados..."]}):C&&C>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-destructive font-medium",children:[C," registro",C>1?"s":""," usa",C>1?"m":""," este valor."]}),e.jsx("p",{children:"Migrar para:"}),e.jsxs(de,{value:D,onValueChange:M,children:[e.jsx(me,{className:"w-full",children:e.jsx(We,{})}),e.jsx(he,{children:je.map(a=>e.jsxs(ue,{value:a.value,children:[e.jsx(q,{className:A("text-[10px] mr-2",a.color),children:a.label}),e.jsx("span",{className:"text-muted-foreground font-mono text-xs",children:a.value})]},a.value))})]})]}):e.jsx("p",{children:"Nenhum registro utiliza este valor. A opÃ§Ã£o serÃ¡ removida dos seletores."})})})]}),e.jsxs(ne,{children:[e.jsx(ce,{children:"Cancelar"}),e.jsx(ie,{onClick:Pe,disabled:pe||!!C&&C>0&&!D,children:C&&C>0?"Migrar e Remover":"Remover"})]})]})})]})}function vs(){const{allOptions:o,isLoading:j,getOptions:u,countRecords:c,addOption:f,updateOption:b,deleteOption:x,reorderOptions:r}=Je();return j?e.jsxs(P,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsxs(_,{className:"pb-4",children:[e.jsx(ee,{className:"h-5 w-48"}),e.jsx(ee,{className:"h-4 w-72"})]}),e.jsx(I,{className:"space-y-4",children:[1,2,3].map(n=>e.jsx(ee,{className:"h-20 w-full"},n))})]}):e.jsxs(P,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsxs(_,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5 text-primary"}),e.jsx(U,{className:"text-base",children:"Campos do CRM"})]}),e.jsx(Q,{children:"Gerencie as opÃ§Ãµes de status, prioridade e tipo de evento."})]}),e.jsx(I,{className:"space-y-6",children:js.map((n,v)=>e.jsxs("div",{children:[v>0&&e.jsx(Qe,{className:"mb-6"}),e.jsx(bs,{fieldName:n.fieldName,title:n.title,description:n.description,options:u(n.fieldName),onAdd:d=>f.mutate(d),onUpdate:d=>b.mutate(d),onDelete:d=>x.mutate(d),onReorder:d=>r.mutate(d),onCountRecords:c})]},n.fieldName))})]})}function Ns(){const[o,j]=l.useState(""),[u,c]=l.useState(""),[f,b]=l.useState(!1),[x,r]=l.useState(!1),[n,v]=l.useState(!1),d=async m=>{if(m.preventDefault(),o.length<6){p.error("A nova senha deve ter no mÃ­nimo 6 caracteres.");return}if(o!==u){p.error("As senhas nÃ£o coincidem.");return}b(!0);try{const{error:N}=await X.auth.updateUser({password:o});N?p.error(N.message):(p.success("Senha alterada com sucesso!"),j(""),c(""))}catch{p.error("Erro ao alterar a senha.")}finally{b(!1)}};return e.jsxs(P,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsxs(_,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-5 w-5 text-primary"}),e.jsx(U,{className:"text-base",children:"Alterar Senha"})]}),e.jsx(Q,{children:"Atualize sua senha de acesso."})]}),e.jsx(I,{children:e.jsxs("form",{onSubmit:d,className:"space-y-4 max-w-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{type:x?"text":"password",value:o,onChange:m=>j(m.target.value),placeholder:"MÃ­nimo 6 caracteres",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>r(!x),className:"absolute right-2.5 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:x?e.jsx(we,{className:"h-4 w-4"}):e.jsx(ve,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{type:n?"text":"password",value:u,onChange:m=>c(m.target.value),placeholder:"Repita a nova senha",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>v(!n),className:"absolute right-2.5 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:n?e.jsx(we,{className:"h-4 w-4"}):e.jsx(ve,{className:"h-4 w-4"})})]})]}),e.jsx(g,{type:"submit",disabled:f,className:"gold-gradient text-primary-foreground hover:opacity-90",children:f?"Alterando...":"Alterar Senha"})]})})]})}function ys(){const[o,j]=l.useState([]),[u,c]=l.useState(!1),[f,b]=l.useState(!1),[x,r]=l.useState(null),[n,v]=l.useState(!1),[d,m]=l.useState(null),N=async()=>{var t;const{data:s}=await X.auth.getSession();return(t=s.session)==null?void 0:t.access_token},y=async()=>{c(!0);try{const{data:s,error:t}=await X.storage.from("backups").list("",{limit:100,sortBy:{column:"name",order:"desc"}});if(t)throw t;const h=(s||[]).filter(i=>i.id&&!i.name.includes("."));j(h.map(i=>({name:i.name,created_at:i.created_at||i.name})))}catch(s){console.error("Error loading backups:",s),p.error("Erro ao carregar backups: "+s.message)}finally{c(!1)}};l.useEffect(()=>{y()},[]);const O=async()=>{b(!0);try{const s=await N(),h=await fetch("https://xlumfscnfnqldlvpbpil.supabase.co/functions/v1/backup-data",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({})}),i=await h.json();if(!h.ok)throw new Error(i.error||"Erro no backup");p.success(`Backup criado! ${i.total_rows} registros em ${i.timestamp}`),y()}catch(s){p.error("Erro no backup: "+s.message)}finally{b(!1)}},T=async s=>{r(s);try{const t=await N(),i=await fetch("https://xlumfscnfnqldlvpbpil.supabase.co/functions/v1/restore-data",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({storage_path:s})}),w=await i.json();if(!i.ok)throw new Error(w.error||"Erro na restauraÃ§Ã£o");p.success("Backup restaurado com sucesso!")}catch(t){p.error("Erro na restauraÃ§Ã£o: "+t.message)}finally{r(null)}},B=async s=>{m(s);try{const{data:t}=await X.storage.from("backups").list(s);if(t&&t.length>0){const h=t.map(i=>`${s}/${i.name}`);await X.storage.from("backups").remove(h)}p.success("Backup excluÃ­do!"),y()}catch(t){p.error("Erro ao excluir: "+t.message)}finally{m(null)}},S=async s=>{const t=s.target.files;if(!(!t||t.length===0)){v(!0);try{const h=await N(),i="xlumfscnfnqldlvpbpil",w=new FormData;w.append("mode","upsert");for(const D of Array.from(t)){const M=D.name.replace(/\.csv$/i,"");w.append(M,D)}const G=await fetch(`https://${i}.supabase.co/functions/v1/restore-data`,{method:"POST",headers:{Authorization:`Bearer ${h}`},body:w}),k=await G.json();if(!G.ok)throw new Error(k.error||"Erro na importaÃ§Ã£o");const H=Object.entries(k.results||{}).map(([D,M])=>`${D}: ${M.inserted||0}`).join(", ");p.success(`ImportaÃ§Ã£o concluÃ­da! ${H}`)}catch(h){p.error("Erro na importaÃ§Ã£o: "+h.message)}finally{v(!1),s.target.value=""}}},E=s=>{try{const t=s.replace(/T/," ").replace(/-/g,(i,w)=>w<10?"-":":").slice(0,16),h=new Date(s.replace(/T/,"T").replace(/-(\d{2})-(\d{2})$/,":$1:$2"));return isNaN(h.getTime())?s:h.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(P,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsxs(_,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5 text-primary"}),e.jsx(U,{className:"text-base",children:"AÃ§Ãµes de Backup"})]}),e.jsx(Q,{children:"Backup automÃ¡tico diÃ¡rio Ã s 3h. Use os botÃµes abaixo para operaÃ§Ãµes manuais."})]}),e.jsxs(I,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(g,{onClick:O,disabled:f,className:"gold-gradient text-primary-foreground hover:opacity-90 gap-2",children:[f?e.jsx(F,{className:"h-4 w-4 animate-spin"}):e.jsx(ms,{className:"h-4 w-4"}),f?"Fazendo backup...":"Fazer Backup Agora"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:".csv",multiple:!0,onChange:S,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:n}),e.jsxs(g,{variant:"outline",disabled:n,className:"gap-2 pointer-events-none w-full sm:w-auto",children:[n?e.jsx(F,{className:"h-4 w-4 animate-spin"}):e.jsx(Ke,{className:"h-4 w-4"}),n?"Importando...":"Importar CSVs (Upsert)"]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-3",children:["Os arquivos CSV devem ser nomeados com o nome da tabela (ex: ",e.jsx("code",{children:"mladv_crm_tarefas.csv"}),"). O sistema farÃ¡ upsert por ID."]})]})]}),e.jsxs(P,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsx(_,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-5 w-5 text-primary"}),e.jsx(U,{className:"text-base",children:"Backups Salvos"})]}),e.jsxs(g,{variant:"ghost",size:"sm",onClick:y,disabled:u,className:"gap-1.5",children:[e.jsx(ps,{className:A("h-3.5 w-3.5",u&&"animate-spin")}),"Atualizar"]})]})}),e.jsx(I,{children:u&&o.length===0?e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground py-8 justify-center",children:[e.jsx(F,{className:"h-4 w-4 animate-spin"}),"Carregando..."]}):o.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:'Nenhum backup encontrado. Clique em "Fazer Backup Agora" para criar o primeiro.'}):e.jsx("div",{className:"space-y-2",children:o.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-border/50 bg-background/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:E(s.name)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ae,{children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(g,{variant:"outline",size:"sm",disabled:x===s.name,className:"gap-1.5",children:[x===s.name?e.jsx(F,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx(gs,{className:"h-3.5 w-3.5"}),"Restaurar"]})}),e.jsxs(re,{children:[e.jsxs(te,{children:[e.jsx(le,{children:"Restaurar Backup"}),e.jsxs(oe,{children:["Isso irÃ¡ ",e.jsx("strong",{children:"substituir todos os dados atuais"})," pelos dados deste backup (",E(s.name),"). Esta aÃ§Ã£o nÃ£o pode ser desfeita. Tem certeza?"]})]}),e.jsxs(ne,{children:[e.jsx(ce,{children:"Cancelar"}),e.jsx(ie,{onClick:()=>T(s.name),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sim, Restaurar"})]})]})]}),e.jsxs(ae,{children:[e.jsx(Ne,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"sm",disabled:d===s.name,className:"text-destructive hover:text-destructive",children:d===s.name?e.jsx(F,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx(ke,{className:"h-3.5 w-3.5"})})}),e.jsxs(re,{children:[e.jsxs(te,{children:[e.jsx(le,{children:"Excluir Backup"}),e.jsxs(oe,{children:["Excluir o backup de ",E(s.name),"? Esta aÃ§Ã£o nÃ£o pode ser desfeita."]})]}),e.jsxs(ne,{children:[e.jsx(ce,{children:"Cancelar"}),e.jsx(ie,{onClick:()=>B(s.name),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})]})]})]},s.name))})})]})]})}const Zs=()=>{const{prefs:o,updatePref:j}=Ve(),[u,c]=l.useState(""),[f,b]=l.useState(!1);l.useEffect(()=>{c(o.panel_name||"Painel Admin")},[o.panel_name]);const x=[{id:"forest",name:"Forest",desc:"Verde & Dourado",colors:["hsl(165 14% 9%)","hsl(40 58% 54%)","hsl(162 11% 13%)","hsl(160 7% 20%)"]},{id:"ocean",name:"Ocean",desc:"Azul & Teal",colors:["hsl(220 18% 10%)","hsl(210 65% 60%)","hsl(218 16% 14%)","hsl(185 55% 48%)"]},{id:"slate",name:"Slate",desc:"Cinza & Indigo",colors:["hsl(240 10% 10%)","hsl(250 45% 65%)","hsl(240 8% 14%)","hsl(240 6% 22%)"]},{id:"midnight",name:"Midnight",desc:"Navy & ElÃ©trico",colors:["hsl(228 25% 7%)","hsl(217 90% 61%)","hsl(226 22% 11%)","hsl(225 15% 18%)"]},{id:"copper",name:"Copper",desc:"Bronze & Rose Gold",colors:["hsl(20 18% 8%)","hsl(25 65% 58%)","hsl(18 15% 12%)","hsl(15 55% 52%)"]},{id:"arctic",name:"Arctic",desc:"Gelo & Ciano",colors:["hsl(200 25% 97%)","hsl(195 80% 42%)","hsl(200 20% 94%)","hsl(200 12% 88%)"]}];return e.jsxs(Fe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-6 pb-20 md:pb-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ds,{className:"h-6 w-6 text-primary"}),e.jsx("h1",{className:"text-2xl font-bold text-foreground font-serif",children:"ConfiguraÃ§Ãµes"})]}),e.jsxs(Ge,{defaultValue:"geral",className:"space-y-6",children:[e.jsxs(He,{className:"bg-muted/40 border border-border",children:[e.jsxs(W,{value:"geral",className:"gap-1.5 data-[state=active]:bg-background",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Geral"]}),e.jsxs(W,{value:"senha",className:"gap-1.5 data-[state=active]:bg-background",children:[e.jsx(Se,{className:"h-4 w-4"}),"Senha"]}),e.jsxs(W,{value:"campos",className:"gap-1.5 data-[state=active]:bg-background",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Campos CRM"]}),e.jsxs(W,{value:"backup",className:"gap-1.5 data-[state=active]:bg-background",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Backup"]})]}),e.jsxs(Y,{value:"geral",className:"space-y-6",children:[e.jsxs(P,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsxs(_,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5 text-primary"}),e.jsx(U,{className:"text-base",children:"Painel"})]}),e.jsx(Q,{children:"Personalize o nome exibido no menu lateral."})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-3 max-w-md",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{children:"Nome do Painel"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{value:u,onChange:r=>c(r.target.value),placeholder:"Painel Admin",maxLength:30,className:"flex-1"}),e.jsxs($e,{open:f,onOpenChange:b,children:[e.jsx(qe,{asChild:!0,children:e.jsx(g,{variant:"outline",size:"icon",className:"shrink-0 h-10 w-10",type:"button",children:e.jsx("span",{className:"text-lg",children:"ðŸ˜Š"})})}),e.jsx(Ue,{className:"w-64 p-2",align:"end",children:e.jsx("div",{className:"grid grid-cols-8 gap-1",children:["ðŸ“Š","ðŸ“ˆ","ðŸ“‹","ðŸ“","ðŸ—‚ï¸","ðŸ’¼","ðŸ¢","ðŸš€","âš¡","ðŸ”¥","ðŸ’¡","ðŸŽ¯","âœ…","â­","ðŸ†","ðŸ’Ž","ðŸ“Œ","ðŸ””","ðŸ“…","ðŸ—“ï¸","ðŸ‘¥","ðŸ¤","ðŸ’¬","ðŸ“§","ðŸ› ï¸","âš™ï¸","ðŸ”§","ðŸ”‘","ðŸŒ¿","ðŸŒŠ","ðŸª¨","ðŸŽ¨","â¤ï¸","ðŸ’™","ðŸ’š","ðŸ’›","ðŸ§ ","ðŸŽ‰","âœ¨","ðŸŒŸ"].map(r=>e.jsx("button",{type:"button",className:"h-8 w-8 flex items-center justify-center rounded hover:bg-muted text-lg transition-colors",onClick:()=>{c(n=>n+r),b(!1)},children:r},r))})})]})]})]}),e.jsx(g,{onClick:()=>{j("panel_name",u),p.success("Nome do painel atualizado!")},className:"gold-gradient text-primary-foreground hover:opacity-90",children:"Salvar"})]})})]}),e.jsxs(P,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsxs(_,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"h-5 w-5 text-primary"}),e.jsx(U,{className:"text-base",children:"Tema de Cores"})]}),e.jsx(Q,{children:"Escolha o estilo visual do painel."})]}),e.jsxs(I,{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Com modo claro/escuro"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:x.filter(r=>!be.includes(r.id)).map(r=>e.jsxs("button",{onClick:()=>j("color_theme",r.id),className:A("relative rounded-xl border-2 p-3 text-left transition-all",o.color_theme===r.id?"border-accent shadow-card-hover":"border-border/50 hover:border-border"),children:[o.color_theme===r.id&&e.jsx("div",{className:"absolute top-2 right-2 h-5 w-5 rounded-full gold-gradient flex items-center justify-center",children:e.jsx(xe,{className:"h-3 w-3 text-primary-foreground"})}),e.jsx("div",{className:"flex gap-1.5 mb-2",children:r.colors.map((n,v)=>e.jsx("div",{className:"h-6 w-6 rounded-full border border-border/30",style:{background:n}},v))}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:r.desc})]},r.id))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-6 mb-3",children:"Temas fixos (aparÃªncia Ãºnica)"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:x.filter(r=>be.includes(r.id)).map(r=>e.jsxs("button",{onClick:()=>j("color_theme",r.id),className:A("relative rounded-xl border-2 p-3 text-left transition-all",o.color_theme===r.id?"border-accent shadow-card-hover":"border-border/50 hover:border-border"),children:[o.color_theme===r.id&&e.jsx("div",{className:"absolute top-2 right-2 h-5 w-5 rounded-full gold-gradient flex items-center justify-center",children:e.jsx(xe,{className:"h-3 w-3 text-primary-foreground"})}),e.jsx("div",{className:"flex gap-1.5 mb-2",children:r.colors.map((n,v)=>e.jsx("div",{className:"h-6 w-6 rounded-full border border-border/30",style:{background:n}},v))}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:r.name}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:r.desc})]},r.id))})]})]})]}),e.jsx(Y,{value:"senha",children:e.jsx(Ns,{})}),e.jsx(Y,{value:"campos",children:e.jsx(vs,{})}),e.jsx(Y,{value:"backup",children:e.jsx(ys,{})})]})]})};export{Zs as default};
