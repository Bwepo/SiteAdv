import{a as j,e as V,r as i,u as B,p as H,j as e,P as k,i as M,ai as he,c as S,l as me,w as pe,a9 as ve,ac as xe,E as ge}from"./index-rGXuuAVG.js";import{E as fe,a as be,A}from"./AdminLayout-CfPMja3u.js";import{e as ye,b as je,f as Ne,S as E}from"./skeleton-BxEJsNAC.js";import{B as f}from"./button-BlI5sIj8.js";import{I as T}from"./input-D8rojG0v.js";import{L as N}from"./label-IOOySrWm.js";import{u as we,T as F,S as ke}from"./index-cdvYziHI.js";import{c as D,R as Ce,I as _e}from"./index-C3Yfc3Hi.js";import{u as Se}from"./index-5Eqt3AO6.js";import{P as Te,L as Me}from"./PostContent-u6C75SEB.js";import"./house-Dp1DU4jy.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=j("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=j("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=j("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=j("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=j("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=j("ListOrdered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=j("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=j("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var P="Switch",[Ve,it]=V(P),[Be,He]=Ve(P),$=i.forwardRef((t,n)=>{const{__scopeSwitch:o,name:r,checked:c,defaultChecked:d,required:a,disabled:u,value:m="on",onCheckedChange:b,form:l,...h}=t,[p,w]=i.useState(null),y=B(n,g=>w(g)),v=i.useRef(!1),C=p?l||!!p.closest("form"):!0,[s,x]=H({prop:c,defaultProp:d??!1,onChange:b,caller:P});return e.jsxs(Be,{scope:o,checked:s,disabled:u,children:[e.jsx(k.button,{type:"button",role:"switch","aria-checked":s,"aria-required":a,"data-state":U(s),"data-disabled":u?"":void 0,disabled:u,value:m,...h,ref:y,onClick:M(t.onClick,g=>{x(_=>!_),C&&(v.current=g.isPropagationStopped(),v.current||g.stopPropagation())})}),C&&e.jsx(G,{control:p,bubbles:!v.current,name:r,value:m,checked:s,required:a,disabled:u,form:l,style:{transform:"translateX(-100%)"}})]})});$.displayName=P;var q="SwitchThumb",O=i.forwardRef((t,n)=>{const{__scopeSwitch:o,...r}=t,c=He(q,o);return e.jsx(k.span,{"data-state":U(c.checked),"data-disabled":c.disabled?"":void 0,...r,ref:n})});O.displayName=q;var De="SwitchBubbleInput",G=i.forwardRef(({__scopeSwitch:t,control:n,checked:o,bubbles:r=!0,...c},d)=>{const a=i.useRef(null),u=B(a,d),m=we(o),b=he(n);return i.useEffect(()=>{const l=a.current;if(!l)return;const h=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(h,"checked").set;if(m!==o&&w){const y=new Event("click",{bubbles:r});w.call(l,o),l.dispatchEvent(y)}},[m,o,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:o,...c,tabIndex:-1,ref:u,style:{...c.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});G.displayName=De;function U(t){return t?"checked":"unchecked"}var K=$,$e=O;const W=i.forwardRef(({className:t,...n},o)=>e.jsx(K,{className:S("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...n,ref:o,children:e.jsx($e,{className:S("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));W.displayName=K.displayName;var I="Tabs",[qe,ct]=V(I,[D]),X=D(),[Oe,L]=qe(I),J=i.forwardRef((t,n)=>{const{__scopeTabs:o,value:r,onValueChange:c,defaultValue:d,orientation:a="horizontal",dir:u,activationMode:m="automatic",...b}=t,l=Se(u),[h,p]=H({prop:r,onChange:c,defaultProp:d??"",caller:I});return e.jsx(Oe,{scope:o,baseId:me(),value:h,onValueChange:p,orientation:a,dir:l,activationMode:m,children:e.jsx(k.div,{dir:l,"data-orientation":a,...b,ref:n})})});J.displayName=I;var Q="TabsList",Y=i.forwardRef((t,n)=>{const{__scopeTabs:o,loop:r=!0,...c}=t,d=L(Q,o),a=X(o);return e.jsx(Ce,{asChild:!0,...a,orientation:d.orientation,dir:d.dir,loop:r,children:e.jsx(k.div,{role:"tablist","aria-orientation":d.orientation,...c,ref:n})})});Y.displayName=Q;var Z="TabsTrigger",ee=i.forwardRef((t,n)=>{const{__scopeTabs:o,value:r,disabled:c=!1,...d}=t,a=L(Z,o),u=X(o),m=se(a.baseId,r),b=ne(a.baseId,r),l=r===a.value;return e.jsx(_e,{asChild:!0,...u,focusable:!c,active:l,children:e.jsx(k.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":b,"data-state":l?"active":"inactive","data-disabled":c?"":void 0,disabled:c,id:m,...d,ref:n,onMouseDown:M(t.onMouseDown,h=>{!c&&h.button===0&&h.ctrlKey===!1?a.onValueChange(r):h.preventDefault()}),onKeyDown:M(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&a.onValueChange(r)}),onFocus:M(t.onFocus,()=>{const h=a.activationMode!=="manual";!l&&!c&&h&&a.onValueChange(r)})})})});ee.displayName=Z;var te="TabsContent",ae=i.forwardRef((t,n)=>{const{__scopeTabs:o,value:r,forceMount:c,children:d,...a}=t,u=L(te,o),m=se(u.baseId,r),b=ne(u.baseId,r),l=r===u.value,h=i.useRef(l);return i.useEffect(()=>{const p=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(p)},[]),e.jsx(pe,{present:c||l,children:({present:p})=>e.jsx(k.div,{"data-state":l?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!p,id:b,tabIndex:0,...a,ref:n,style:{...t.style,animationDuration:h.current?"0s":void 0},children:p&&d})})});ae.displayName=te;function se(t,n){return`${t}-trigger-${n}`}function ne(t,n){return`${t}-content-${n}`}var Ge=J,oe=Y,re=ee,ie=ae;const Ue=Ge,ce=i.forwardRef(({className:t,...n},o)=>e.jsx(oe,{ref:o,className:S("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...n}));ce.displayName=oe.displayName;const z=i.forwardRef(({className:t,...n},o)=>e.jsx(re,{ref:o,className:S("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...n}));z.displayName=re.displayName;const Ke=i.forwardRef(({className:t,...n},o)=>e.jsx(ie,{ref:o,className:S("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n}));Ke.displayName=ie.displayName;function We(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"").slice(0,100)}function Xe({post:t,isEditing:n}){const o=ve(),r=ye(),c=je(),{toast:d}=xe(),[a,u]=i.useState({title:(t==null?void 0:t.title)||"",slug:(t==null?void 0:t.slug)||"",excerpt:(t==null?void 0:t.excerpt)||"",content_html:(t==null?void 0:t.content_html)||"",cover_image_url:(t==null?void 0:t.cover_image_url)||"",author_name:(t==null?void 0:t.author_name)||"Mariana Lima",published:(t==null?void 0:t.published)||!1,published_at:(t==null?void 0:t.published_at)||null}),[m,b]=i.useState(!1),[l,h]=i.useState(!1),[p,w]=i.useState("html");i.useEffect(()=>{!n&&a.title&&u(s=>({...s,slug:We(a.title)}))},[a.title,n]);const y=(s,x)=>{u(g=>({...g,[s]:x}))},v=(s,x="")=>{const g=document.getElementById("content_html");if(!g)return;const _=g.selectionStart,R=g.selectionEnd,le=a.content_html.substring(_,R),de=a.content_html.substring(0,_)+s+le+x+a.content_html.substring(R);u(ue=>({...ue,content_html:de})),setTimeout(()=>{g.focus(),g.setSelectionRange(_+s.length,R+s.length)},0)},C=async(s=!1)=>{if(!a.title.trim()){d({title:"Título obrigatório",description:"Por favor, insira um título para o post.",variant:"destructive"});return}if(!a.content_html.trim()){d({title:"Conteúdo obrigatório",description:"Por favor, insira o conteúdo do post.",variant:"destructive"});return}h(!0);try{const x={...a,published:s||a.published,published_at:s&&!a.published_at?new Date().toISOString():a.published_at};n&&t?(await c.mutateAsync({id:t.id,...x}),d({title:"Post atualizado!",description:s?"O artigo foi publicado.":"Alterações salvas."})):(await r.mutateAsync(x),d({title:s?"Post publicado!":"Rascunho salvo!",description:s?"O artigo está disponível no blog.":"Você pode continuar editando depois."})),o("/admin")}catch(x){d({title:"Erro ao salvar",description:(x==null?void 0:x.message)||"Não foi possível salvar o post.",variant:"destructive"})}finally{h(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"title",children:"Título *"}),e.jsx(T,{id:"title",value:a.title,onChange:s=>y("title",s.target.value),placeholder:"Título do artigo",className:"text-lg"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"slug",children:"Slug (URL)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"/blog/"}),e.jsx(T,{id:"slug",value:a.slug,onChange:s=>y("slug",s.target.value),placeholder:"url-do-artigo"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"excerpt",children:"Resumo (opcional)"}),e.jsx(F,{id:"excerpt",value:a.excerpt,onChange:s=>y("excerpt",s.target.value),placeholder:"Breve descrição do artigo...",rows:3,maxLength:300}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.excerpt.length,"/300 caracteres"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"cover_image_url",children:"URL da Imagem de Capa (opcional)"}),e.jsx(T,{id:"cover_image_url",value:a.cover_image_url,onChange:s=>y("cover_image_url",s.target.value),placeholder:"https://exemplo.com/imagem.jpg"}),a.cover_image_url&&e.jsx("div",{className:"aspect-video rounded-lg overflow-hidden border border-border mt-2",children:e.jsx("img",{src:a.cover_image_url,alt:"Preview da capa",className:"w-full h-full object-cover",onError:s=>{s.target.style.display="none"}})})]})]}),e.jsxs("div",{className:"max-w-xs",children:[e.jsx(N,{htmlFor:"author_name",children:"Autor"}),e.jsx(T,{id:"author_name",value:a.author_name,onChange:s=>y("author_name",s.target.value),placeholder:"Nome do autor"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{children:"Conteúdo *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{value:p,onValueChange:s=>w(s),children:e.jsxs(ce,{className:"h-8",children:[e.jsx(z,{value:"html",className:"text-xs px-3",children:"HTML"}),e.jsx(z,{value:"visual",className:"text-xs px-3",children:"Visual"})]})}),e.jsxs(f,{type:"button",variant:"outline",size:"sm",onClick:()=>b(!m),children:[m?e.jsx(fe,{className:"w-4 h-4 mr-1"}):e.jsx(be,{className:"w-4 h-4 mr-1"}),m?"Editar":"Preview"]})]})]}),m?e.jsx("div",{className:"border border-border rounded-lg p-6 min-h-[400px] bg-card",children:e.jsx(Te,{html:a.content_html})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap gap-1 p-2 border border-border rounded-t-lg bg-muted/30",children:[e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v("<strong>","</strong>"),title:"Negrito",children:e.jsx(Pe,{className:"w-4 h-4"})}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v("<em>","</em>"),title:"Itálico",children:e.jsx(ze,{className:"w-4 h-4"})}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v('<a href="">',"</a>"),title:"Link",children:e.jsx(Me,{className:"w-4 h-4"})}),e.jsx("div",{className:"w-px h-6 bg-border mx-1 self-center"}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v("<h2>","</h2>"),title:"Título H2",children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v("<h3>","</h3>"),title:"Título H3",children:e.jsx(Ee,{className:"w-4 h-4"})}),e.jsx("div",{className:"w-px h-6 bg-border mx-1 self-center"}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v(`<ul>
  <li>`,`</li>
</ul>`),title:"Lista",children:e.jsx(Ae,{className:"w-4 h-4"})}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v(`<ol>
  <li>`,`</li>
</ol>`),title:"Lista numerada",children:e.jsx(Le,{className:"w-4 h-4"})}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>v("<code>","</code>"),title:"Código",children:e.jsx(Ie,{className:"w-4 h-4"})})]}),e.jsx(F,{id:"content_html",value:a.content_html,onChange:s=>y("content_html",s.target.value),placeholder:"<p>Conteúdo do artigo em HTML...</p>",className:"min-h-[400px] font-mono text-sm rounded-t-none border-t-0"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{id:"published",checked:a.published,onCheckedChange:s=>y("published",s)}),e.jsx(N,{htmlFor:"published",className:"cursor-pointer",children:a.published?"Publicado":"Rascunho"})]}),e.jsxs("div",{className:"flex gap-3 sm:ml-auto",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>o("/admin"),children:"Cancelar"}),e.jsxs(f,{type:"button",variant:"secondary",onClick:()=>C(!1),disabled:l,children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Salvar rascunho"]}),e.jsxs(f,{type:"button",onClick:()=>C(!0),disabled:l,children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),n?"Atualizar":"Publicar"]})]})]})]})}const lt=()=>{const{id:t}=ge(),n=!!t,{data:o,isLoading:r}=Ne(t||"");return n&&r?e.jsx(A,{title:"Carregando...",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(E,{className:"h-10 w-full"}),e.jsx(E,{className:"h-10 w-full"}),e.jsx(E,{className:"h-40 w-full"})]})}):e.jsx(A,{title:n?"Editar Post":"Novo Post",children:e.jsx(Xe,{post:o||void 0,isEditing:n})})};export{lt as default};
