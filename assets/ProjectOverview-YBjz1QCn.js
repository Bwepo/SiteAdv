import{c as A,r as x,j as e,m as h,e as o}from"./index-BYSmSza6.js";import{C as g,c as b,a as j,b as N}from"./card-D4tD-R2t.js";import{B as L}from"./badge-DbLWEFBC.js";import{P as k}from"./TipTapEditor-CbGBz5R8.js";import{T as R,a as P}from"./crmTypes-DIKVQqcx.js";import{T as O}from"./trending-up-c0SblFgU.js";import{C as I}from"./clock-DK-ztRz0.js";import{T as _}from"./triangle-alert-B3wsmQ_V.js";import{L as z}from"./list-todo-Da2zWk8K.js";import{L as B}from"./AdminTarefas-DzgT9vF2.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=A("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=A("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),$={pendente:"bg-yellow-500/20 text-yellow-400",agendado:"bg-slate-500/20 text-slate-400",em_andamento:"bg-blue-500/20 text-blue-400",em_tramite:"bg-blue-500/20 text-blue-400",concluida:"bg-green-500/20 text-green-400",cancelada:"bg-red-500/20 text-red-400","A fazer":"bg-yellow-500/20 text-yellow-400","Em andamento":"bg-blue-500/20 text-blue-400",Concluído:"bg-green-500/20 text-green-400"};function Z({projectId:f,clientFilter:m,tasks:w,events:T}){const l=x.useMemo(()=>w.filter(s=>{var t;return m?(t=s.client)==null?void 0:t.toLowerCase().includes(m.toLowerCase()):s.projectId===f}),[w,f,m]),c=x.useMemo(()=>l.flatMap(s=>s.subtasks),[l]),y=x.useMemo(()=>T.filter(s=>{var t;return m?(t=s.client)==null?void 0:t.toLowerCase().includes(m.toLowerCase()):s.projectId===f}),[T,f,m]),a=x.useMemo(()=>{const s=l.length,t=l.filter(d=>d.status==="concluida").length,r=l.filter(d=>d.status==="em_andamento").length,i=l.filter(d=>d.status==="pendente").length,u=l.filter(d=>!d.dueDate||d.status==="concluida"||d.status==="cancelada"?!1:new Date(d.dueDate)<new Date).length,p=s>0?Math.round(t/s*100):0,n=c.length,C=c.filter(d=>d.status==="Concluído").length,E=n>0?Math.round(C/n*100):0;return{totalTarefas:s,concluidas:t,emAndamento:r,pendentes:i,atrasadas:u,progress:p,totalSub:n,subConcluidas:C,subProgress:E}},[l,c]),v=x.useMemo(()=>{const s=[];return l.forEach(t=>s.push({id:t.id,type:"tarefa",title:t.title,status:t.status,date:t.updatedAt||t.createdAt,priority:t.priority})),c.forEach(t=>s.push({id:t.id,type:"subtarefa",title:t.title,status:t.status,date:t.dueDate||""})),y.forEach(t=>s.push({id:t.id,type:"evento",title:t.title,status:t.status,date:t.date})),s.sort((t,r)=>new Date(r.date).getTime()-new Date(t.date).getTime()).slice(0,10)},[l,c,y]),D=x.useMemo(()=>{const s=new Date;s.setHours(0,0,0,0);const t=[];for(let r=0;r<14;r++){const i=new Date(s);i.setDate(i.getDate()+r);const u=i.toISOString().split("T")[0],p=[];y.forEach(n=>{n.date===u&&p.push({title:n.title,type:"evento"})}),l.forEach(n=>{n.dueDate===u&&p.push({title:n.title,type:"tarefa"})}),c.forEach(n=>{n.dueDate===u&&p.push({title:n.title,type:"subtarefa"})}),t.push({date:i,label:i.toLocaleDateString("pt-BR",{weekday:"short",day:"numeric"}),isToday:r===0,events:p})}return t},[y,l,c]),M=[{title:"PROGRESSO GERAL",value:`${a.progress}%`,subtitle:`${a.concluidas}/${a.totalTarefas} tarefas`,icon:O,color:"text-green-400",bgColor:"bg-green-500/10"},{title:"EM ANDAMENTO",value:a.emAndamento,subtitle:"tarefas ativas",icon:S,color:"text-blue-400",bgColor:"bg-blue-500/10"},{title:"PENDENTES",value:a.pendentes,subtitle:"aguardando início",icon:I,color:"text-yellow-400",bgColor:"bg-yellow-500/10"},{title:"ATRASADAS",value:a.atrasadas,subtitle:"precisam de atenção",icon:_,color:a.atrasadas>0?"text-red-400":"text-muted-foreground",bgColor:a.atrasadas>0?"bg-red-500/10":"bg-muted/30"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:M.map((s,t)=>{const r=s.icon;return e.jsx(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:t*.05},children:e.jsx(g,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[11px] font-medium text-muted-foreground uppercase tracking-wider",children:s.title}),e.jsx("p",{className:o("text-2xl font-bold",s.color),children:s.value}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:s.subtitle})]}),e.jsx("div",{className:o("rounded-lg p-2",s.bgColor),children:e.jsx(r,{className:o("h-4 w-4",s.color)})})]})})})},s.title)})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(g,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-primary"}),"Tarefas"]})}),e.jsxs(b,{className:"px-4 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[a.concluidas," concluídas"]}),e.jsxs("span",{className:"font-semibold text-foreground",children:[a.progress,"%"]})]}),e.jsx(k,{value:a.progress,className:"h-2"}),e.jsxs("div",{className:"flex gap-3 text-[10px] text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-green-400"}),a.concluidas," concluídas"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-blue-400"}),a.emAndamento," andamento"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-400"}),a.pendentes," pendentes"]})]})]})]})}),e.jsx(h.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.25},children:e.jsxs(g,{className:"border-border/50 bg-card/80 backdrop-blur-sm",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-primary"}),"Subtarefas"]})}),e.jsxs(b,{className:"px-4 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[a.subConcluidas," concluídas"]}),e.jsxs("span",{className:"font-semibold text-foreground",children:[a.subProgress,"%"]})]}),e.jsx(k,{value:a.subProgress,className:"h-2"}),e.jsxs("p",{className:"text-[10px] text-muted-foreground",children:[a.subConcluidas,"/",a.totalSub," subtarefas finalizadas"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-3",children:[e.jsx(h.div,{className:"lg:col-span-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(g,{className:"border-border/50 bg-card/80 backdrop-blur-sm h-full",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-primary"}),"Atividades Recentes"]})}),e.jsx(b,{className:"px-4 pb-4",children:v.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma atividade ainda."}):e.jsx("div",{className:"space-y-0",children:v.map((s,t)=>e.jsxs("div",{className:"flex items-start gap-3 py-2.5 border-b border-border/30 last:border-0",children:[e.jsxs("div",{className:"mt-1.5 flex flex-col items-center",children:[e.jsx("div",{className:o("h-2 w-2 rounded-full shrink-0",s.type==="evento"?"bg-purple-400":s.type==="subtarefa"?"bg-cyan-400":"bg-primary")}),t<v.length-1&&e.jsx("div",{className:"w-px h-full bg-border/40 mt-1"})]}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-foreground truncate",children:s.title}),e.jsx(L,{variant:"outline",className:o("text-[8px] px-1 py-0 shrink-0",$[s.status]||"bg-secondary text-secondary-foreground"),children:s.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-muted-foreground",children:[e.jsx("span",{className:"capitalize",children:s.type==="tarefa"?"Tarefa":s.type==="subtarefa"?"Subtarefa":"Evento"}),s.priority&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:R[s.priority]||"",children:P[s.priority]||s.priority})]}),s.date&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(s.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})})]})]})]})]},s.id))})})]})}),e.jsx(h.div,{className:"lg:col-span-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.35},children:e.jsxs(g,{className:"border-border/50 bg-card/80 backdrop-blur-sm h-full",children:[e.jsx(j,{className:"pb-3 pt-4 px-4",children:e.jsxs(N,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4 text-primary"}),"Próximos 14 dias"]})}),e.jsx(b,{className:"px-4 pb-4",children:e.jsx("div",{className:"space-y-0.5",children:D.map(s=>{const t=s.events.length>0;return e.jsxs("div",{className:o("flex items-start gap-3 py-1.5 px-2 rounded-md transition-colors",s.isToday&&"bg-primary/5 border border-primary/20",t&&!s.isToday&&"bg-muted/20"),children:[e.jsx("span",{className:o("text-[11px] w-16 shrink-0 capitalize",s.isToday?"font-bold text-primary":t?"font-medium text-foreground":"text-muted-foreground"),children:s.isToday?"Hoje":s.label}),e.jsx("div",{className:"flex-1 min-w-0",children:t?e.jsx("div",{className:"space-y-0.5",children:s.events.map((r,i)=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:o("h-1.5 w-1.5 rounded-full shrink-0",r.type==="evento"?"bg-purple-400":r.type==="subtarefa"?"bg-cyan-400":"bg-primary")}),e.jsx("span",{className:"text-[11px] text-foreground truncate",children:r.title})]},i))}):e.jsx("span",{className:"text-[10px] text-muted-foreground/50",children:"—"})})]},s.date.toISOString())})})})]})})]})]})}export{Z as P};
