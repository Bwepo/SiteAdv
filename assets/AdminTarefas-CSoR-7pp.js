import{c as jt,r as i,j as r,e as G,l as Br,Z as B,f as ht,$ as $r,ao as _r}from"./index-C0fbWft3.js";import{S as Ur,a as Vr,b as Kr,c as Yr,f as Xr,g as Hr,B as Le,F as ln,P as $n,A as Wr}from"./AdminLayout-ByDE43MT.js";import{T as qr}from"./TarefaSheet-NQ81dDPY.js";import{u as Gr,F as Jr,a as Je,b as Ze,c as Qe,d as et,e as tt,t as Zr}from"./form-Dl2HGJxz.js";import{I as It}from"./input-CwtS6LtH.js";import{B as de}from"./button-DKkDnD_H.js";import{T as Qr}from"./textarea-Da9_Pq1-.js";import{S as be,a as ye,b as Ne,d as we,e as z}from"./select-D1Ddc20P.js";import{P as _n,a as Un,b as Vn}from"./popover-DCdwJJXt.js";import{f as Kn,S as xt,g as cn,T as Ot,c as en,b as es,d as Yn}from"./crmTypes-C2SECzd8.js";import{S as dn}from"./search-DXqz9zkm.js";import{C as ts}from"./check-DnSg4QYN.js";import{U as ns}from"./separator-GcmbX5pz.js";import{L as rs}from"./loader-circle-Bp15b49c.js";import{o as ss,s as ut,e as as}from"./types-C9wiu8_K.js";import{C as vt,c as bt}from"./card-DQuJncvP.js";import{A as Xn,a as Hn,b as Wn,c as qn,d as Gn,e as Jn,f as Zn,g as Qn}from"./alert-dialog-DDafD9Ju.js";import{S as tn,C as os}from"./checkbox-BEusNVks.js";import{T as is}from"./triangle-alert-yRQmegML.js";import{C as ls}from"./clock-CohXX1Oy.js";import{L as er}from"./list-B1BdlcZo.js";import{U as tr}from"./users-BZ2IOsqf.js";import{C as nr}from"./calendar-DWFHOdAL.js";import{P as rr}from"./pencil-CklnTTYU.js";import{T as sr}from"./trash-2-DSrpR4-L.js";import{L as cs}from"./label-BsB-CMgW.js";import{T as ds,a as us,b as bn,c as yn}from"./tabs-BjhIswR8.js";import{S as fs}from"./SyncToolbar-DVqtpM26.js";import{T as hs,K as ms}from"./CrmSkeletons-CD22YbbE.js";import{C as gs}from"./chevron-up-DbQOH6o7.js";import{C as ps}from"./chevron-right-C5--IYVp.js";import"./dialog-2trSxfIN.js";import"./index-Bi9BIILL.js";import"./heart-CVPeks9w.js";import"./sparkles-BO127kSM.js";import"./house-BIxJB1_q.js";import"./menu-7TsGcqDU.js";import"./file-text-BiE4kwXJ.js";import"./circle-check-DKtEbzmU.js";import"./circle-JIQm6dKo.js";import"./index-Bipj6uqk.js";import"./index-2XTeQkZa.js";import"./index-B814gKR_.js";import"./skeleton-DLGYyiGB.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=jt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=jt("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=jt("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=jt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=jt("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),ys=ss({title:ut().trim().min(1,"Título obrigatório").max(200),parentTaskId:ut().min(1,"Tarefa-mãe obrigatória"),deadline:ut().optional(),status:as(["A fazer","Em andamento","Concluído"]),assignee:ut().optional(),notes:ut().max(2e3).optional()}),ws=Object.entries(xt);function js({open:e,onOpenChange:t,subtask:n,tasks:s,onSave:a}){const o=!n,[l,c]=i.useState(!1),[d,u]=i.useState(""),[g,m]=i.useState(!1),b=i.useMemo(()=>{if(!d.trim())return s;const v=d.toLowerCase();return s.filter(x=>x.title.toLowerCase().includes(v))},[s,d]),p=Gr({resolver:Zr(ys),defaultValues:{title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}});i.useEffect(()=>{e&&(n?p.reset({title:n.title,parentTaskId:n.parentTaskId,deadline:n.dueDate??"",status:n.status,assignee:n.assignee??"",notes:n.notes??""}):p.reset({title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}))},[e,n]);const j=async v=>{c(!0);try{await a(v,o,n==null?void 0:n.id),t(!1)}catch(x){Br.error("Erro ao salvar subtarefa: "+x.message),console.error("Erro ao salvar subtarefa:",x)}finally{c(!1)}};return r.jsx(Ur,{open:e,onOpenChange:t,children:r.jsxs(Vr,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[r.jsxs(Kr,{className:"mb-6",children:[r.jsx(Yr,{children:o?"Nova Subtarefa":"Editar Subtarefa"}),r.jsx(Xr,{children:o?"Preencha os dados e selecione a tarefa-mãe relacionada.":"Altere os campos e salve."})]}),r.jsx(Jr,{...p,children:r.jsxs("form",{onSubmit:p.handleSubmit(j),className:"space-y-5",children:[r.jsx(Je,{control:p.control,name:"title",render:({field:v})=>r.jsxs(Ze,{children:[r.jsx(Qe,{children:"Título *"}),r.jsx(et,{children:r.jsx(It,{placeholder:"Ex: Enviar documento",...v})}),r.jsx(tt,{})]})}),r.jsx(Je,{control:p.control,name:"parentTaskId",render:({field:v})=>{var x;return r.jsxs(Ze,{className:"flex flex-col",children:[r.jsx(Qe,{children:"Tarefa-mãe *"}),r.jsxs(_n,{open:g,onOpenChange:m,children:[r.jsx(Un,{asChild:!0,children:r.jsx(et,{children:r.jsxs(de,{variant:"outline",role:"combobox",className:G("w-full justify-between font-normal",!v.value&&"text-muted-foreground"),children:[r.jsx("span",{className:"truncate",children:v.value?((x=s.find(w=>w.id===v.value))==null?void 0:x.title)??"Tarefa não encontrada":"Selecione a tarefa-mãe..."}),r.jsx(xs,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),r.jsxs(Vn,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:[r.jsxs("div",{className:"flex items-center border-b px-3",children:[r.jsx(dn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),r.jsx("input",{className:"flex h-10 w-full bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground",placeholder:"Buscar tarefa...",value:d,onChange:w=>u(w.target.value)})]}),r.jsx("div",{className:"max-h-[200px] overflow-y-auto p-1",children:b.length===0?r.jsx("p",{className:"py-4 text-center text-sm text-muted-foreground",children:"Nenhuma tarefa encontrada."}):b.map(w=>r.jsxs("button",{type:"button",className:G("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",v.value===w.id&&"bg-accent"),onClick:()=>{v.onChange(w.id),m(!1),u("")},children:[r.jsx(ts,{className:G("mr-2 h-4 w-4",v.value===w.id?"opacity-100":"opacity-0")}),r.jsx("span",{className:"truncate",children:w.title})]},w.id))})]})]}),r.jsx(tt,{})]})}}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Je,{control:p.control,name:"deadline",render:({field:v})=>r.jsxs(Ze,{children:[r.jsx(Qe,{children:"Prazo"}),r.jsx(et,{children:r.jsx(It,{type:"date",...v})}),r.jsx(tt,{})]})}),r.jsx(Je,{control:p.control,name:"status",render:({field:v})=>r.jsxs(Ze,{children:[r.jsx(Qe,{children:"Status"}),r.jsxs(be,{onValueChange:v.onChange,value:v.value,children:[r.jsx(et,{children:r.jsx(ye,{children:r.jsx(Ne,{})})}),r.jsx(we,{children:ws.map(([x,w])=>r.jsx(z,{value:x,children:w},x))})]}),r.jsx(tt,{})]})})]}),r.jsx(Je,{control:p.control,name:"assignee",render:({field:v})=>r.jsxs(Ze,{children:[r.jsx(Qe,{children:"Responsável"}),r.jsxs(be,{onValueChange:x=>v.onChange(x==="_none_"?"":x),value:v.value||"_none_",children:[r.jsx(et,{children:r.jsx(ye,{children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ns,{className:"w-3.5 h-3.5 text-muted-foreground"}),r.jsx(Ne,{placeholder:"Responsável..."})]})})}),r.jsxs(we,{children:[r.jsx(z,{value:"_none_",children:"— Sem responsável —"}),Kn.map(x=>r.jsx(z,{value:x,children:x},x))]})]}),r.jsx(tt,{})]})}),r.jsx(Je,{control:p.control,name:"notes",render:({field:v})=>r.jsxs(Ze,{children:[r.jsx(Qe,{children:"Observações"}),r.jsx(et,{children:r.jsx(Qr,{placeholder:"Observações...",className:"resize-none min-h-[80px]",...v})}),r.jsx(tt,{})]})}),r.jsx(Hr,{children:r.jsxs(de,{type:"submit",disabled:l,className:"w-full",children:[l&&r.jsx(rs,{className:"w-4 h-4 mr-2 animate-spin"}),o?"Criar Subtarefa":"Salvar Alterações"]})})]})})]})})}function Ss(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const $t=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function rt(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function fn(e){return"nodeType"in e}function ue(e){var t,n;return e?rt(e)?e:fn(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function hn(e){const{Document:t}=ue(e);return e instanceof t}function St(e){return rt(e)?!1:e instanceof ue(e).HTMLElement}function or(e){return e instanceof ue(e).SVGElement}function st(e){return e?rt(e)?e.document:fn(e)?hn(e)?e:St(e)||or(e)?e.ownerDocument:document:document:document}const Te=$t?i.useLayoutEffect:i.useEffect;function _t(e){const t=i.useRef(e);return Te(()=>{t.current=e}),i.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function Cs(){const e=i.useRef(null),t=i.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function yt(e,t){t===void 0&&(t=[e]);const n=i.useRef(e);return Te(()=>{n.current!==e&&(n.current=e)},t),n}function Ct(e,t){const n=i.useRef();return i.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Mt(e){const t=_t(e),n=i.useRef(null),s=i.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function Lt(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}let Gt={};function Dt(e,t){return i.useMemo(()=>{if(t)return t;const n=Gt[e]==null?0:Gt[e]+1;return Gt[e]=n,e+"-"+n},[e,t])}function ir(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((o,l)=>{const c=Object.entries(l);for(const[d,u]of c){const g=o[d];g!=null&&(o[d]=g+e*u)}return o},{...t})}}const nt=ir(1),Pt=ir(-1);function Ds(e){return"clientX"in e&&"clientY"in e}function Ut(e){if(!e)return!1;const{KeyboardEvent:t}=ue(e.target);return t&&e instanceof t}function Ns(e){if(!e)return!1;const{TouchEvent:t}=ue(e.target);return t&&e instanceof t}function zt(e){if(Ns(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Ds(e)?{x:e.clientX,y:e.clientY}:null}const Pe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Pe.Translate.toString(e),Pe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),wn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ts(e){return e.matches(wn)?e:e.querySelector(wn)}const Rs={display:"none"};function Es(e){let{id:t,value:n}=e;return B.createElement("div",{id:t,style:Rs},n)}function As(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return B.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function ks(){const[e,t]=i.useState("");return{announce:i.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const lr=i.createContext(null);function Is(e){const t=i.useContext(lr);i.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Os(){const[e]=i.useState(()=>new Set),t=i.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[i.useCallback(s=>{let{type:a,event:o}=s;e.forEach(l=>{var c;return(c=l[a])==null?void 0:c.call(l,o)})},[e]),t]}const Ms={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Ls={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Ps(e){let{announcements:t=Ls,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=Ms}=e;const{announce:o,announcement:l}=ks(),c=Dt("DndLiveRegion"),[d,u]=i.useState(!1);if(i.useEffect(()=>{u(!0)},[]),Is(i.useMemo(()=>({onDragStart(m){let{active:b}=m;o(t.onDragStart({active:b}))},onDragMove(m){let{active:b,over:p}=m;t.onDragMove&&o(t.onDragMove({active:b,over:p}))},onDragOver(m){let{active:b,over:p}=m;o(t.onDragOver({active:b,over:p}))},onDragEnd(m){let{active:b,over:p}=m;o(t.onDragEnd({active:b,over:p}))},onDragCancel(m){let{active:b,over:p}=m;o(t.onDragCancel({active:b,over:p}))}}),[o,t])),!d)return null;const g=B.createElement(B.Fragment,null,B.createElement(Es,{id:s,value:a.draggable}),B.createElement(As,{id:c,announcement:l}));return n?ht.createPortal(g,n):g}var H;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(H||(H={}));function Ft(){}function cr(e,t){return i.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function dr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Re=Object.freeze({x:0,y:0});function zs(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Fs(e,t){const n=zt(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function Bs(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function $s(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function jn(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function _s(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const ur=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=jn(t),o=[];for(const l of s){const{id:c}=l,d=n.get(c);if(d){const u=jn(d),g=a.reduce((b,p,j)=>b+zs(u[j],p),0),m=Number((g/4).toFixed(4));o.push({id:c,data:{droppableContainer:l,value:m}})}}return o.sort(Bs)};function Us(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),l=a-s,c=o-n;if(s<a&&n<o){const d=t.width*t.height,u=e.width*e.height,g=l*c,m=g/(d+u-g);return Number(m.toFixed(4))}return 0}const Vs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const o of s){const{id:l}=o,c=n.get(l);if(c){const d=Us(c,t);d>0&&a.push({id:l,data:{droppableContainer:o,value:d}})}}return a.sort($s)};function Ks(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function fr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Re}function Ys(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];return a.reduce((l,c)=>({...l,top:l.top+e*c.y,bottom:l.bottom+e*c.y,left:l.left+e*c.x,right:l.right+e*c.x}),{...n})}}const Xs=Ys(1);function hr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Hs(e,t,n){const s=hr(t);if(!s)return e;const{scaleX:a,scaleY:o,x:l,y:c}=s,d=e.left-l-(1-a)*parseFloat(n),u=e.top-c-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),g=a?e.width/a:e.width,m=o?e.height/o:e.height;return{width:g,height:m,top:u,right:d+g,bottom:u+m,left:d}}const Ws={ignoreTransform:!1};function at(e,t){t===void 0&&(t=Ws);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:g}=ue(e).getComputedStyle(e);u&&(n=Hs(n,u,g))}const{top:s,left:a,width:o,height:l,bottom:c,right:d}=n;return{top:s,left:a,width:o,height:l,bottom:c,right:d}}function Sn(e){return at(e,{ignoreTransform:!0})}function qs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Gs(e,t){return t===void 0&&(t=ue(e).getComputedStyle(e)),t.position==="fixed"}function Js(e,t){t===void 0&&(t=ue(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const o=t[a];return typeof o=="string"?n.test(o):!1})}function mn(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(hn(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!St(a)||or(a)||n.includes(a))return n;const o=ue(e).getComputedStyle(a);return a!==e&&Js(a,o)&&n.push(a),Gs(a,o)?n:s(a.parentNode)}return e?s(e):n}function mr(e){const[t]=mn(e,1);return t??null}function Jt(e){return!$t||!e?null:rt(e)?e:fn(e)?hn(e)||e===st(e).scrollingElement?window:St(e)?e:null:null}function gr(e){return rt(e)?e.scrollX:e.scrollLeft}function pr(e){return rt(e)?e.scrollY:e.scrollTop}function nn(e){return{x:gr(e),y:pr(e)}}var q;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(q||(q={}));function xr(e){return!$t||!e?!1:e===document.scrollingElement}function vr(e){const t={x:0,y:0},n=xr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,l=e.scrollTop>=s.y,c=e.scrollLeft>=s.x;return{isTop:a,isLeft:o,isBottom:l,isRight:c,maxScroll:s,minScroll:t}}const Zs={x:.2,y:.2};function Qs(e,t,n,s,a){let{top:o,left:l,right:c,bottom:d}=n;s===void 0&&(s=10),a===void 0&&(a=Zs);const{isTop:u,isBottom:g,isLeft:m,isRight:b}=vr(e),p={x:0,y:0},j={x:0,y:0},v={height:t.height*a.y,width:t.width*a.x};return!u&&o<=t.top+v.height?(p.y=q.Backward,j.y=s*Math.abs((t.top+v.height-o)/v.height)):!g&&d>=t.bottom-v.height&&(p.y=q.Forward,j.y=s*Math.abs((t.bottom-v.height-d)/v.height)),!b&&c>=t.right-v.width?(p.x=q.Forward,j.x=s*Math.abs((t.right-v.width-c)/v.width)):!m&&l<=t.left+v.width&&(p.x=q.Backward,j.x=s*Math.abs((t.left+v.width-l)/v.width)),{direction:p,speed:j}}function ea(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:l}=window;return{top:0,left:0,right:o,bottom:l,width:o,height:l}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function br(e){return e.reduce((t,n)=>nt(t,nn(n)),Re)}function ta(e){return e.reduce((t,n)=>t+gr(n),0)}function na(e){return e.reduce((t,n)=>t+pr(n),0)}function yr(e,t){if(t===void 0&&(t=at),!e)return;const{top:n,left:s,bottom:a,right:o}=t(e);mr(e)&&(a<=0||o<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ra=[["x",["left","right"],ta],["y",["top","bottom"],na]];class gn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=mn(n),a=br(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,l,c]of ra)for(const d of l)Object.defineProperty(this,d,{get:()=>{const u=c(s),g=a[o]-u;return this.rect[d]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class mt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function sa(e){const{EventTarget:t}=ue(e);return e instanceof t?e:st(e)}function Zt(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var Ce;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ce||(Ce={}));function Cn(e){e.preventDefault()}function aa(e){e.stopPropagation()}var M;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(M||(M={}));const wr={start:[M.Space,M.Enter],cancel:[M.Esc],end:[M.Space,M.Enter,M.Tab]},oa=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case M.Right:return{...n,x:n.x+25};case M.Left:return{...n,x:n.x-25};case M.Down:return{...n,y:n.y+25};case M.Up:return{...n,y:n.y-25}}};class jr{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new mt(st(n)),this.windowListeners=new mt(ue(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ce.Resize,this.handleCancel),this.windowListeners.add(Ce.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ce.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&yr(s),n(Re)}handleKeyDown(t){if(Ut(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:o=wr,coordinateGetter:l=oa,scrollBehavior:c="smooth"}=a,{code:d}=t;if(o.end.includes(d)){this.handleEnd(t);return}if(o.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:u}=s.current,g=u?{x:u.left,y:u.top}:Re;this.referenceCoordinates||(this.referenceCoordinates=g);const m=l(t,{active:n,context:s.current,currentCoordinates:g});if(m){const b=Pt(m,g),p={x:0,y:0},{scrollableAncestors:j}=s.current;for(const v of j){const x=t.code,{isTop:w,isRight:S,isLeft:y,isBottom:N,maxScroll:T,minScroll:R}=vr(v),C=ea(v),D={x:Math.min(x===M.Right?C.right-C.width/2:C.right,Math.max(x===M.Right?C.left:C.left+C.width/2,m.x)),y:Math.min(x===M.Down?C.bottom-C.height/2:C.bottom,Math.max(x===M.Down?C.top:C.top+C.height/2,m.y))},I=x===M.Right&&!S||x===M.Left&&!y,L=x===M.Down&&!N||x===M.Up&&!w;if(I&&D.x!==m.x){const A=v.scrollLeft+b.x,X=x===M.Right&&A<=T.x||x===M.Left&&A>=R.x;if(X&&!b.y){v.scrollTo({left:A,behavior:c});return}X?p.x=v.scrollLeft-A:p.x=x===M.Right?v.scrollLeft-T.x:v.scrollLeft-R.x,p.x&&v.scrollBy({left:-p.x,behavior:c});break}else if(L&&D.y!==m.y){const A=v.scrollTop+b.y,X=x===M.Down&&A<=T.y||x===M.Up&&A>=R.y;if(X&&!b.x){v.scrollTo({top:A,behavior:c});return}X?p.y=v.scrollTop-A:p.y=x===M.Down?v.scrollTop-T.y:v.scrollTop-R.y,p.y&&v.scrollBy({top:-p.y,behavior:c});break}}this.handleMove(t,nt(Pt(m,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}jr.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=wr,onActivation:a}=t,{active:o}=n;const{code:l}=e.nativeEvent;if(s.start.includes(l)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Dn(e){return!!(e&&"distance"in e)}function Nn(e){return!!(e&&"delay"in e)}class pn{constructor(t,n,s){var a;s===void 0&&(s=sa(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:l}=o;this.props=t,this.events=n,this.document=st(l),this.documentListeners=new mt(this.document),this.listeners=new mt(s),this.windowListeners=new mt(ue(l)),this.initialCoordinates=(a=zt(o))!=null?a:Re,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ce.Resize,this.handleCancel),this.windowListeners.add(Ce.DragStart,Cn),this.windowListeners.add(Ce.VisibilityChange,this.handleCancel),this.windowListeners.add(Ce.ContextMenu,Cn),this.documentListeners.add(Ce.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Nn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Dn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ce.Click,aa,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ce.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:o}=this,{onMove:l,options:{activationConstraint:c}}=o;if(!a)return;const d=(n=zt(t))!=null?n:Re,u=Pt(a,d);if(!s&&c){if(Dn(c)){if(c.tolerance!=null&&Zt(u,c.tolerance))return this.handleCancel();if(Zt(u,c.distance))return this.handleStart()}if(Nn(c)&&Zt(u,c.tolerance))return this.handleCancel();this.handlePending(c,u);return}t.cancelable&&t.preventDefault(),l(d)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===M.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const ia={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Vt extends pn{constructor(t){const{event:n}=t,s=st(n.target);super(t,ia,s)}}Vt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const la={move:{name:"mousemove"},end:{name:"mouseup"}};var rn;(function(e){e[e.RightClick=2]="RightClick"})(rn||(rn={}));class ca extends pn{constructor(t){super(t,la,st(t.event.target))}}ca.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===rn.RightClick?!1:(s==null||s({event:n}),!0)}}];const Qt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class da extends pn{constructor(t){super(t,Qt)}static setup(){return window.addEventListener(Qt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Qt.move.name,t)};function t(){}}}da.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var gt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(gt||(gt={}));var Bt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Bt||(Bt={}));function ua(e){let{acceleration:t,activator:n=gt.Pointer,canScroll:s,draggingRect:a,enabled:o,interval:l=5,order:c=Bt.TreeOrder,pointerCoordinates:d,scrollableAncestors:u,scrollableAncestorRects:g,delta:m,threshold:b}=e;const p=ha({delta:m,disabled:!o}),[j,v]=Cs(),x=i.useRef({x:0,y:0}),w=i.useRef({x:0,y:0}),S=i.useMemo(()=>{switch(n){case gt.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case gt.DraggableRect:return a}},[n,a,d]),y=i.useRef(null),N=i.useCallback(()=>{const R=y.current;if(!R)return;const C=x.current.x*w.current.x,D=x.current.y*w.current.y;R.scrollBy(C,D)},[]),T=i.useMemo(()=>c===Bt.TreeOrder?[...u].reverse():u,[c,u]);i.useEffect(()=>{if(!o||!u.length||!S){v();return}for(const R of T){if((s==null?void 0:s(R))===!1)continue;const C=u.indexOf(R),D=g[C];if(!D)continue;const{direction:I,speed:L}=Qs(R,D,S,t,b);for(const A of["x","y"])p[A][I[A]]||(L[A]=0,I[A]=0);if(L.x>0||L.y>0){v(),y.current=R,j(N,l),x.current=L,w.current=I;return}}x.current={x:0,y:0},w.current={x:0,y:0},v()},[t,N,s,v,o,l,JSON.stringify(S),JSON.stringify(p),j,u,T,g,JSON.stringify(b)])}const fa={x:{[q.Backward]:!1,[q.Forward]:!1},y:{[q.Backward]:!1,[q.Forward]:!1}};function ha(e){let{delta:t,disabled:n}=e;const s=Lt(t);return Ct(a=>{if(n||!s||!a)return fa;const o={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[q.Backward]:a.x[q.Backward]||o.x===-1,[q.Forward]:a.x[q.Forward]||o.x===1},y:{[q.Backward]:a.y[q.Backward]||o.y===-1,[q.Forward]:a.y[q.Forward]||o.y===1}}},[n,t,s])}function ma(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return Ct(a=>{var o;return t==null?null:(o=s??a)!=null?o:null},[s,t])}function ga(e,t){return i.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,o=a.activators.map(l=>({eventName:l.eventName,handler:t(l.handler,s)}));return[...n,...o]},[]),[e,t])}var wt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(wt||(wt={}));var sn;(function(e){e.Optimized="optimized"})(sn||(sn={}));const Tn=new Map;function pa(e,t){let{dragging:n,dependencies:s,config:a}=t;const[o,l]=i.useState(null),{frequency:c,measure:d,strategy:u}=a,g=i.useRef(e),m=x(),b=yt(m),p=i.useCallback(function(w){w===void 0&&(w=[]),!b.current&&l(S=>S===null?w:S.concat(w.filter(y=>!S.includes(y))))},[b]),j=i.useRef(null),v=Ct(w=>{if(m&&!n)return Tn;if(!w||w===Tn||g.current!==e||o!=null){const S=new Map;for(let y of e){if(!y)continue;if(o&&o.length>0&&!o.includes(y.id)&&y.rect.current){S.set(y.id,y.rect.current);continue}const N=y.node.current,T=N?new gn(d(N),N):null;y.rect.current=T,T&&S.set(y.id,T)}return S}return w},[e,o,n,m,d]);return i.useEffect(()=>{g.current=e},[e]),i.useEffect(()=>{m||p()},[n,m]),i.useEffect(()=>{o&&o.length>0&&l(null)},[JSON.stringify(o)]),i.useEffect(()=>{m||typeof c!="number"||j.current!==null||(j.current=setTimeout(()=>{p(),j.current=null},c))},[c,m,p,...s]),{droppableRects:v,measureDroppableContainers:p,measuringScheduled:o!=null};function x(){switch(u){case wt.Always:return!1;case wt.BeforeDragging:return n;default:return!n}}}function xn(e,t){return Ct(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function xa(e,t){return xn(e,t)}function va(e){let{callback:t,disabled:n}=e;const s=_t(t),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(s)},[s,n]);return i.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Kt(e){let{callback:t,disabled:n}=e;const s=_t(t),a=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(s)},[n]);return i.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function ba(e){return new gn(at(e),e)}function Rn(e,t,n){t===void 0&&(t=ba);const[s,a]=i.useState(null);function o(){a(d=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=d??n)!=null?u:null}const g=t(e);return JSON.stringify(d)===JSON.stringify(g)?d:g})}const l=va({callback(d){if(e)for(const u of d){const{type:g,target:m}=u;if(g==="childList"&&m instanceof HTMLElement&&m.contains(e)){o();break}}}}),c=Kt({callback:o});return Te(()=>{o(),e?(c==null||c.observe(e),l==null||l.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),l==null||l.disconnect())},[e]),s}function ya(e){const t=xn(e);return fr(e,t)}const En=[];function wa(e){const t=i.useRef(e),n=Ct(s=>e?s&&s!==En&&e&&t.current&&e.parentNode===t.current.parentNode?s:mn(e):En,[e]);return i.useEffect(()=>{t.current=e},[e]),n}function ja(e){const[t,n]=i.useState(null),s=i.useRef(e),a=i.useCallback(o=>{const l=Jt(o.target);l&&n(c=>c?(c.set(l,nn(l)),new Map(c)):null)},[]);return i.useEffect(()=>{const o=s.current;if(e!==o){l(o);const c=e.map(d=>{const u=Jt(d);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,nn(u)]):null}).filter(d=>d!=null);n(c.length?new Map(c):null),s.current=e}return()=>{l(e),l(o)};function l(c){c.forEach(d=>{const u=Jt(d);u==null||u.removeEventListener("scroll",a)})}},[a,e]),i.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,l)=>nt(o,l),Re):br(e):Re,[e,t])}function An(e,t){t===void 0&&(t=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},t),i.useEffect(()=>{const s=e!==Re;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Pt(e,n.current):Re}function Sa(e){i.useEffect(()=>{if(!$t)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Ca(e,t){return i.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:o}=s;return n[a]=l=>{o(l,t)},n},{}),[e,t])}function Sr(e){return i.useMemo(()=>e?qs(e):null,[e])}const kn=[];function Da(e,t){t===void 0&&(t=at);const[n]=e,s=Sr(n?ue(n):null),[a,o]=i.useState(kn);function l(){o(()=>e.length?e.map(d=>xr(d)?s:new gn(t(d),d)):kn)}const c=Kt({callback:l});return Te(()=>{c==null||c.disconnect(),l(),e.forEach(d=>c==null?void 0:c.observe(d))},[e]),a}function Cr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return St(t)?t:e}function Na(e){let{measure:t}=e;const[n,s]=i.useState(null),a=i.useCallback(u=>{for(const{target:g}of u)if(St(g)){s(m=>{const b=t(g);return m?{...m,width:b.width,height:b.height}:b});break}},[t]),o=Kt({callback:a}),l=i.useCallback(u=>{const g=Cr(u);o==null||o.disconnect(),g&&(o==null||o.observe(g)),s(g?t(g):null)},[t,o]),[c,d]=Mt(l);return i.useMemo(()=>({nodeRef:c,rect:n,setRef:d}),[n,c,d])}const Ta=[{sensor:Vt,options:{}},{sensor:jr,options:{}}],Ra={current:{}},kt={draggable:{measure:Sn},droppable:{measure:Sn,strategy:wt.WhileDragging,frequency:sn.Optimized},dragOverlay:{measure:at}};class pt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const Ea={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new pt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ft},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:kt,measureDroppableContainers:Ft,windowRect:null,measuringScheduled:!1},Dr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ft,draggableNodes:new Map,over:null,measureDroppableContainers:Ft},Nt=i.createContext(Dr),Nr=i.createContext(Ea);function Aa(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new pt}}}function ka(e,t){switch(t.type){case H.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case H.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case H.DragEnd:case H.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case H.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new pt(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case H.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,o=e.droppable.containers.get(n);if(!o||s!==o.key)return e;const l=new pt(e.droppable.containers);return l.set(n,{...o,disabled:a}),{...e,droppable:{...e.droppable,containers:l}}}case H.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const o=new pt(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Ia(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=i.useContext(Nt),o=Lt(s),l=Lt(n==null?void 0:n.id);return i.useEffect(()=>{if(!t&&!s&&o&&l!=null){if(!Ut(o)||document.activeElement===o.target)return;const c=a.get(l);if(!c)return;const{activatorNode:d,node:u}=c;if(!d.current&&!u.current)return;requestAnimationFrame(()=>{for(const g of[d.current,u.current]){if(!g)continue;const m=Ts(g);if(m){m.focus();break}}})}},[s,t,a,l,o]),null}function Tr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,o)=>o({transform:a,...s}),n):n}function Oa(e){return i.useMemo(()=>({draggable:{...kt.draggable,...e==null?void 0:e.draggable},droppable:{...kt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...kt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Ma(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const o=i.useRef(!1),{x:l,y:c}=typeof a=="boolean"?{x:a,y:a}:a;Te(()=>{if(!l&&!c||!t){o.current=!1;return}if(o.current||!s)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const g=n(u),m=fr(g,s);if(l||(m.x=0),c||(m.y=0),o.current=!0,Math.abs(m.x)>0||Math.abs(m.y)>0){const b=mr(u);b&&b.scrollBy({top:m.y,left:m.x})}},[t,l,c,s,n])}const Yt=i.createContext({...Re,scaleX:1,scaleY:1});var Ye;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Ye||(Ye={}));const Rr=i.memo(function(t){var n,s,a,o;let{id:l,accessibility:c,autoScroll:d=!0,children:u,sensors:g=Ta,collisionDetection:m=Vs,measuring:b,modifiers:p,...j}=t;const v=i.useReducer(ka,void 0,Aa),[x,w]=v,[S,y]=Os(),[N,T]=i.useState(Ye.Uninitialized),R=N===Ye.Initialized,{draggable:{active:C,nodes:D,translate:I},droppable:{containers:L}}=x,A=C!=null?D.get(C):null,X=i.useRef({initial:null,translated:null}),$=i.useMemo(()=>{var re;return C!=null?{id:C,data:(re=A==null?void 0:A.data)!=null?re:Ra,rect:X}:null},[C,A]),Q=i.useRef(null),[se,Oe]=i.useState(null),[V,ze]=i.useState(null),J=yt(j,Object.values(j)),K=Dt("DndDescribedBy",l),fe=i.useMemo(()=>L.getEnabled(),[L]),F=Oa(b),{droppableRects:W,measureDroppableContainers:he,measuringScheduled:ae}=pa(fe,{dragging:R,dependencies:[I.x,I.y],config:F.droppable}),ee=ma(D,C),Ee=i.useMemo(()=>V?zt(V):null,[V]),je=it(),ge=xa(ee,F.draggable.measure);Ma({activeNode:C!=null?D.get(C):null,config:je.layoutShiftCompensation,initialRect:ge,measure:F.draggable.measure});const E=Rn(ee,F.draggable.measure,ge),Ae=Rn(ee?ee.parentElement:null),te=i.useRef({activatorEvent:null,active:null,activeNode:ee,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:L,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),De=L.getNodeFor((n=te.current.over)==null?void 0:n.id),oe=Na({measure:F.dragOverlay.measure}),ie=(s=oe.nodeRef.current)!=null?s:ee,h=R?(a=oe.rect)!=null?a:E:null,O=!!(oe.nodeRef.current&&oe.rect),P=ya(O?null:E),ne=Sr(ie?ue(ie):null),_=wa(R?De??ee:null),U=Da(_),le=Tr(p,{transform:{x:I.x-P.x,y:I.y-P.y,scaleX:1,scaleY:1},activatorEvent:V,active:$,activeNodeRect:E,containerNodeRect:Ae,draggingNodeRect:h,over:te.current.over,overlayNodeRect:oe.rect,scrollableAncestors:_,scrollableAncestorRects:U,windowRect:ne}),Xe=Ee?nt(Ee,I):null,Fe=ja(_),Xt=An(Fe),Ht=An(Fe,[E]),Be=nt(le,Xt),$e=h?Xs(h,le):null,He=$&&$e?m({active:$,collisionRect:$e,droppableRects:W,droppableContainers:fe,pointerCoordinates:Xe}):null,ot=_s(He,"id"),[f,k]=i.useState(null),Y=O?le:nt(le,Ht),me=Ks(Y,(o=f==null?void 0:f.rect)!=null?o:null,E),ce=i.useRef(null),_e=i.useCallback((re,pe)=>{let{sensor:xe,options:Ue}=pe;if(Q.current==null)return;const Se=D.get(Q.current);if(!Se)return;const ve=re.nativeEvent,ke=new xe({active:Q.current,activeNode:Se,event:ve,options:Ue,context:te,onAbort(Z){if(!D.get(Z))return;const{onDragAbort:Ie}=J.current,Me={id:Z};Ie==null||Ie(Me),S({type:"onDragAbort",event:Me})},onPending(Z,Ve,Ie,Me){if(!D.get(Z))return;const{onDragPending:ct}=J.current,Ke={id:Z,constraint:Ve,initialCoordinates:Ie,offset:Me};ct==null||ct(Ke),S({type:"onDragPending",event:Ke})},onStart(Z){const Ve=Q.current;if(Ve==null)return;const Ie=D.get(Ve);if(!Ie)return;const{onDragStart:Me}=J.current,lt={activatorEvent:ve,active:{id:Ve,data:Ie.data,rect:X}};ht.unstable_batchedUpdates(()=>{Me==null||Me(lt),T(Ye.Initializing),w({type:H.DragStart,initialCoordinates:Z,active:Ve}),S({type:"onDragStart",event:lt}),Oe(ce.current),ze(ve)})},onMove(Z){w({type:H.DragMove,coordinates:Z})},onEnd:Ge(H.DragEnd),onCancel:Ge(H.DragCancel)});ce.current=ke;function Ge(Z){return async function(){const{active:Ie,collisions:Me,over:lt,scrollAdjustedTranslate:ct}=te.current;let Ke=null;if(Ie&&ct){const{cancelDrop:dt}=J.current;Ke={activatorEvent:ve,active:Ie,collisions:Me,delta:ct,over:lt},Z===H.DragEnd&&typeof dt=="function"&&await Promise.resolve(dt(Ke))&&(Z=H.DragCancel)}Q.current=null,ht.unstable_batchedUpdates(()=>{w({type:Z}),T(Ye.Uninitialized),k(null),Oe(null),ze(null),ce.current=null;const dt=Z===H.DragEnd?"onDragEnd":"onDragCancel";if(Ke){const qt=J.current[dt];qt==null||qt(Ke),S({type:dt,event:Ke})}})}}},[D]),Tt=i.useCallback((re,pe)=>(xe,Ue)=>{const Se=xe.nativeEvent,ve=D.get(Ue);if(Q.current!==null||!ve||Se.dndKit||Se.defaultPrevented)return;const ke={active:ve};re(xe,pe.options,ke)===!0&&(Se.dndKit={capturedBy:pe.sensor},Q.current=Ue,_e(xe,pe))},[D,_e]),qe=ga(g,Tt);Sa(g),Te(()=>{E&&N===Ye.Initializing&&T(Ye.Initialized)},[E,N]),i.useEffect(()=>{const{onDragMove:re}=J.current,{active:pe,activatorEvent:xe,collisions:Ue,over:Se}=te.current;if(!pe||!xe)return;const ve={active:pe,activatorEvent:xe,collisions:Ue,delta:{x:Be.x,y:Be.y},over:Se};ht.unstable_batchedUpdates(()=>{re==null||re(ve),S({type:"onDragMove",event:ve})})},[Be.x,Be.y]),i.useEffect(()=>{const{active:re,activatorEvent:pe,collisions:xe,droppableContainers:Ue,scrollAdjustedTranslate:Se}=te.current;if(!re||Q.current==null||!pe||!Se)return;const{onDragOver:ve}=J.current,ke=Ue.get(ot),Ge=ke&&ke.rect.current?{id:ke.id,rect:ke.rect.current,data:ke.data,disabled:ke.disabled}:null,Z={active:re,activatorEvent:pe,collisions:xe,delta:{x:Se.x,y:Se.y},over:Ge};ht.unstable_batchedUpdates(()=>{k(Ge),ve==null||ve(Z),S({type:"onDragOver",event:Z})})},[ot]),Te(()=>{te.current={activatorEvent:V,active:$,activeNode:ee,collisionRect:$e,collisions:He,droppableRects:W,draggableNodes:D,draggingNode:ie,draggingNodeRect:h,droppableContainers:L,over:f,scrollableAncestors:_,scrollAdjustedTranslate:Be},X.current={initial:h,translated:$e}},[$,ee,He,$e,D,ie,h,W,L,f,_,Be]),ua({...je,delta:I,draggingRect:$e,pointerCoordinates:Xe,scrollableAncestors:_,scrollableAncestorRects:U});const We=i.useMemo(()=>({active:$,activeNode:ee,activeNodeRect:E,activatorEvent:V,collisions:He,containerNodeRect:Ae,dragOverlay:oe,draggableNodes:D,droppableContainers:L,droppableRects:W,over:f,measureDroppableContainers:he,scrollableAncestors:_,scrollableAncestorRects:U,measuringConfiguration:F,measuringScheduled:ae,windowRect:ne}),[$,ee,E,V,He,Ae,oe,D,L,W,f,he,_,U,F,ae,ne]),Wt=i.useMemo(()=>({activatorEvent:V,activators:qe,active:$,activeNodeRect:E,ariaDescribedById:{draggable:K},dispatch:w,draggableNodes:D,over:f,measureDroppableContainers:he}),[V,qe,$,E,w,K,D,f,he]);return B.createElement(lr.Provider,{value:y},B.createElement(Nt.Provider,{value:Wt},B.createElement(Nr.Provider,{value:We},B.createElement(Yt.Provider,{value:me},u)),B.createElement(Ia,{disabled:(c==null?void 0:c.restoreFocus)===!1})),B.createElement(Ps,{...c,hiddenTextDescribedById:K}));function it(){const re=(se==null?void 0:se.autoScrollEnabled)===!1,pe=typeof d=="object"?d.enabled===!1:d===!1,xe=R&&!re&&!pe;return typeof d=="object"?{...d,enabled:xe}:{enabled:xe}}}),La=i.createContext(null),In="button",Pa="Draggable";function za(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const o=Dt(Pa),{activators:l,activatorEvent:c,active:d,activeNodeRect:u,ariaDescribedById:g,draggableNodes:m,over:b}=i.useContext(Nt),{role:p=In,roleDescription:j="draggable",tabIndex:v=0}=a??{},x=(d==null?void 0:d.id)===t,w=i.useContext(x?Yt:La),[S,y]=Mt(),[N,T]=Mt(),R=Ca(l,t),C=yt(n);Te(()=>(m.set(t,{id:t,key:o,node:S,activatorNode:N,data:C}),()=>{const I=m.get(t);I&&I.key===o&&m.delete(t)}),[m,t]);const D=i.useMemo(()=>({role:p,tabIndex:v,"aria-disabled":s,"aria-pressed":x&&p===In?!0:void 0,"aria-roledescription":j,"aria-describedby":g.draggable}),[s,p,v,x,j,g.draggable]);return{active:d,activatorEvent:c,activeNodeRect:u,attributes:D,isDragging:x,listeners:s?void 0:R,node:S,over:b,setNodeRef:y,setActivatorNodeRef:T,transform:w}}function Er(){return i.useContext(Nr)}const Fa="Droppable",Ba={timeout:25};function vn(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const o=Dt(Fa),{active:l,dispatch:c,over:d,measureDroppableContainers:u}=i.useContext(Nt),g=i.useRef({disabled:n}),m=i.useRef(!1),b=i.useRef(null),p=i.useRef(null),{disabled:j,updateMeasurementsFor:v,timeout:x}={...Ba,...a},w=yt(v??s),S=i.useCallback(()=>{if(!m.current){m.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{u(Array.isArray(w.current)?w.current:[w.current]),p.current=null},x)},[x]),y=Kt({callback:S,disabled:j||!l}),N=i.useCallback((D,I)=>{y&&(I&&(y.unobserve(I),m.current=!1),D&&y.observe(D))},[y]),[T,R]=Mt(N),C=yt(t);return i.useEffect(()=>{!y||!T.current||(y.disconnect(),m.current=!1,y.observe(T.current))},[T,y]),i.useEffect(()=>(c({type:H.RegisterDroppable,element:{id:s,key:o,disabled:n,node:T,rect:b,data:C}}),()=>c({type:H.UnregisterDroppable,key:o,id:s})),[s]),i.useEffect(()=>{n!==g.current.disabled&&(c({type:H.SetDroppableDisabled,id:s,key:o,disabled:n}),g.current.disabled=n)},[s,o,n,c]),{active:l,rect:b,isOver:(d==null?void 0:d.id)===s,node:T,over:d,setNodeRef:R}}function $a(e){let{animation:t,children:n}=e;const[s,a]=i.useState(null),[o,l]=i.useState(null),c=Lt(n);return!n&&!s&&c&&a(c),Te(()=>{if(!o)return;const d=s==null?void 0:s.key,u=s==null?void 0:s.props.id;if(d==null||u==null){a(null);return}Promise.resolve(t(u,o)).then(()=>{a(null)})},[t,s,o]),B.createElement(B.Fragment,null,n,s?i.cloneElement(s,{ref:l}):null)}const _a={x:0,y:0,scaleX:1,scaleY:1};function Ua(e){let{children:t}=e;return B.createElement(Nt.Provider,{value:Dr},B.createElement(Yt.Provider,{value:_a},t))}const Va={position:"fixed",touchAction:"none"},Ka=e=>Ut(e)?"transform 250ms ease":void 0,Ya=i.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:o,className:l,rect:c,style:d,transform:u,transition:g=Ka}=e;if(!c)return null;const m=a?u:{...u,scaleX:1,scaleY:1},b={...Va,width:c.width,height:c.height,top:c.top,left:c.left,transform:Pe.Transform.toString(m),transformOrigin:a&&s?Fs(s,c):void 0,transition:typeof g=="function"?g(s):g,...d};return B.createElement(n,{className:l,style:b,ref:t},o)}),Xa=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:o,className:l}=e;if(o!=null&&o.active)for(const[c,d]of Object.entries(o.active))d!==void 0&&(a[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,d));if(o!=null&&o.dragOverlay)for(const[c,d]of Object.entries(o.dragOverlay))d!==void 0&&s.node.style.setProperty(c,d);return l!=null&&l.active&&n.node.classList.add(l.active),l!=null&&l.dragOverlay&&s.node.classList.add(l.dragOverlay),function(){for(const[d,u]of Object.entries(a))n.node.style.setProperty(d,u);l!=null&&l.active&&n.node.classList.remove(l.active)}},Ha=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Pe.Transform.toString(t)},{transform:Pe.Transform.toString(n)}]},Wa={duration:250,easing:"ease",keyframes:Ha,sideEffects:Xa({styles:{active:{opacity:"0"}}})};function qa(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return _t((o,l)=>{if(t===null)return;const c=n.get(o);if(!c)return;const d=c.node.current;if(!d)return;const u=Cr(l);if(!u)return;const{transform:g}=ue(l).getComputedStyle(l),m=hr(g);if(!m)return;const b=typeof t=="function"?t:Ga(t);return yr(d,a.draggable.measure),b({active:{id:o,data:c.data,node:d,rect:a.draggable.measure(d)},draggableNodes:n,dragOverlay:{node:l,rect:a.dragOverlay.measure(u)},droppableContainers:s,measuringConfiguration:a,transform:m})})}function Ga(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...Wa,...e};return o=>{let{active:l,dragOverlay:c,transform:d,...u}=o;if(!t)return;const g={x:c.rect.left-l.rect.left,y:c.rect.top-l.rect.top},m={scaleX:d.scaleX!==1?l.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?l.rect.height*d.scaleY/c.rect.height:1},b={x:d.x-g.x,y:d.y-g.y,...m},p=a({...u,active:l,dragOverlay:c,transform:{initial:d,final:b}}),[j]=p,v=p[p.length-1];if(JSON.stringify(j)===JSON.stringify(v))return;const x=s==null?void 0:s({active:l,dragOverlay:c,...u}),w=c.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(S=>{w.onfinish=()=>{x==null||x(),S()}})}}let On=0;function Ja(e){return i.useMemo(()=>{if(e!=null)return On++,On},[e])}const Ar=B.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:o,modifiers:l,wrapperElement:c="div",className:d,zIndex:u=999}=e;const{activatorEvent:g,active:m,activeNodeRect:b,containerNodeRect:p,draggableNodes:j,droppableContainers:v,dragOverlay:x,over:w,measuringConfiguration:S,scrollableAncestors:y,scrollableAncestorRects:N,windowRect:T}=Er(),R=i.useContext(Yt),C=Ja(m==null?void 0:m.id),D=Tr(l,{activatorEvent:g,active:m,activeNodeRect:b,containerNodeRect:p,draggingNodeRect:x.rect,over:w,overlayNodeRect:x.rect,scrollableAncestors:y,scrollableAncestorRects:N,transform:R,windowRect:T}),I=xn(b),L=qa({config:s,draggableNodes:j,droppableContainers:v,measuringConfiguration:S}),A=I?x.setRef:void 0;return B.createElement(Ua,null,B.createElement($a,{animation:L},m&&C?B.createElement(Ya,{key:C,id:m.id,ref:A,as:c,activatorEvent:g,adjustScale:t,className:d,transition:o,rect:I,style:{zIndex:u,...a},transform:D},n):null))});function kr(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Za(e,t){return e.reduce((n,s,a)=>{const o=t.get(s);return o&&(n[a]=o),n},Array(e.length))}function Rt(e){return e!==null&&e>=0}function Qa(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function eo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Ir=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const o=kr(t,s,n),l=t[a],c=o[a];return!c||!l?null:{x:c.left-l.left,y:c.top-l.top,scaleX:c.width/l.width,scaleY:c.height/l.height}},Et={scaleX:1,scaleY:1},Or=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:o,overIndex:l}=e;const c=(t=o[n])!=null?t:s;if(!c)return null;if(a===n){const u=o[l];return u?{x:0,y:n<l?u.top+u.height-(c.top+c.height):u.top-c.top,...Et}:null}const d=to(o,a,n);return a>n&&a<=l?{x:0,y:-c.height-d,...Et}:a<n&&a>=l?{x:0,y:c.height+d,...Et}:{x:0,y:0,...Et}};function to(e,t,n){const s=e[t],a=e[t-1],o=e[t+1];return s?n<t?a?s.top-(a.top+a.height):o?o.top-(s.top+s.height):0:o?o.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const Mr="Sortable",Lr=B.createContext({activeIndex:-1,containerId:Mr,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ir,disabled:{draggable:!1,droppable:!1}});function Pr(e){let{children:t,id:n,items:s,strategy:a=Ir,disabled:o=!1}=e;const{active:l,dragOverlay:c,droppableRects:d,over:u,measureDroppableContainers:g}=Er(),m=Dt(Mr,n),b=c.rect!==null,p=i.useMemo(()=>s.map(R=>typeof R=="object"&&"id"in R?R.id:R),[s]),j=l!=null,v=l?p.indexOf(l.id):-1,x=u?p.indexOf(u.id):-1,w=i.useRef(p),S=!Qa(p,w.current),y=x!==-1&&v===-1||S,N=eo(o);Te(()=>{S&&j&&g(p)},[S,p,j,g]),i.useEffect(()=>{w.current=p},[p]);const T=i.useMemo(()=>({activeIndex:v,containerId:m,disabled:N,disableTransforms:y,items:p,overIndex:x,useDragOverlay:b,sortedRects:Za(p,d),strategy:a}),[v,m,N.draggable,N.droppable,y,p,x,d,b,a]);return B.createElement(Lr.Provider,{value:T},t)}const no=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return kr(n,s,a).indexOf(t)},ro=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:o,newIndex:l,previousItems:c,previousContainerId:d,transition:u}=e;return!u||!s||c!==o&&a===l?!1:n?!0:l!==a&&t===d},so={duration:200,easing:"ease"},zr="transform",ao=Pe.Transition.toString({property:zr,duration:0,easing:"linear"}),oo={roleDescription:"sortable"};function io(e){let{disabled:t,index:n,node:s,rect:a}=e;const[o,l]=i.useState(null),c=i.useRef(n);return Te(()=>{if(!t&&n!==c.current&&s.current){const d=a.current;if(d){const u=at(s.current,{ignoreTransform:!0}),g={x:d.left-u.left,y:d.top-u.top,scaleX:d.width/u.width,scaleY:d.height/u.height};(g.x||g.y)&&l(g)}}n!==c.current&&(c.current=n)},[t,n,s,a]),i.useEffect(()=>{o&&l(null)},[o]),o}function Fr(e){let{animateLayoutChanges:t=ro,attributes:n,disabled:s,data:a,getNewIndex:o=no,id:l,strategy:c,resizeObserverConfig:d,transition:u=so}=e;const{items:g,containerId:m,activeIndex:b,disabled:p,disableTransforms:j,sortedRects:v,overIndex:x,useDragOverlay:w,strategy:S}=i.useContext(Lr),y=lo(s,p),N=g.indexOf(l),T=i.useMemo(()=>({sortable:{containerId:m,index:N,items:g},...a}),[m,a,N,g]),R=i.useMemo(()=>g.slice(g.indexOf(l)),[g,l]),{rect:C,node:D,isOver:I,setNodeRef:L}=vn({id:l,data:T,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...d}}),{active:A,activatorEvent:X,activeNodeRect:$,attributes:Q,setNodeRef:se,listeners:Oe,isDragging:V,over:ze,setActivatorNodeRef:J,transform:K}=za({id:l,data:T,attributes:{...oo,...n},disabled:y.draggable}),fe=Ss(L,se),F=!!A,W=F&&!j&&Rt(b)&&Rt(x),he=!w&&V,ae=he&&W?K:null,Ee=W?ae??(c??S)({rects:v,activeNodeRect:$,activeIndex:b,overIndex:x,index:N}):null,je=Rt(b)&&Rt(x)?o({id:l,items:g,activeIndex:b,overIndex:x}):N,ge=A==null?void 0:A.id,E=i.useRef({activeId:ge,items:g,newIndex:je,containerId:m}),Ae=g!==E.current.items,te=t({active:A,containerId:m,isDragging:V,isSorting:F,id:l,index:N,items:g,newIndex:E.current.newIndex,previousItems:E.current.items,previousContainerId:E.current.containerId,transition:u,wasDragging:E.current.activeId!=null}),De=io({disabled:!te,index:N,node:D,rect:C});return i.useEffect(()=>{F&&E.current.newIndex!==je&&(E.current.newIndex=je),m!==E.current.containerId&&(E.current.containerId=m),g!==E.current.items&&(E.current.items=g)},[F,je,m,g]),i.useEffect(()=>{if(ge===E.current.activeId)return;if(ge!=null&&E.current.activeId==null){E.current.activeId=ge;return}const ie=setTimeout(()=>{E.current.activeId=ge},50);return()=>clearTimeout(ie)},[ge]),{active:A,activeIndex:b,attributes:Q,data:T,rect:C,index:N,newIndex:je,items:g,isOver:I,isSorting:F,isDragging:V,listeners:Oe,node:D,overIndex:x,over:ze,setNodeRef:fe,setActivatorNodeRef:J,setDroppableNodeRef:L,setDraggableNodeRef:se,transform:De??Ee,transition:oe()};function oe(){if(De||Ae&&E.current.newIndex===N)return ao;if(!(he&&!Ut(X)||!u)&&(F||te))return Pe.Transition.toString({...u,property:zr})}}function lo(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}M.Down,M.Right,M.Up,M.Left;const Mn=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"title",label:"Título (A → Z)"},{value:"status",label:"Status"}],Ln={"A fazer":0,"Em andamento":1,Concluído:2},ft=["A fazer","Em andamento","Concluído"];function co(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"title":return n.title.localeCompare(s.title,"pt-BR");case"status":return(Ln[n.status]??0)-(Ln[s.status]??0);default:return 0}})}function uo({id:e,children:t}){const{attributes:n,listeners:s,setNodeRef:a,transform:o,transition:l,isDragging:c}=Fr({id:e}),d={transform:Pe.Transform.toString(o),transition:l};return r.jsx("div",{ref:a,style:d,...n,...s,className:G("touch-none",c&&"opacity-30"),children:t})}function fo({status:e,isOver:t,items:n,itemIds:s,today:a,onEdit:o,onDelete:l}){const{setNodeRef:c}=vn({id:e});return r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(Le,{variant:"secondary",className:cn[e],children:xt[e]}),r.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n.length,")"]})]}),r.jsx("div",{ref:c,"data-column-status":e,className:G("space-y-3 min-h-[400px] p-2 rounded-lg transition-colors duration-150",t?"bg-primary/10 border-2 border-dashed border-primary/40":"bg-muted/30 border-2 border-transparent"),children:r.jsx(Pr,{items:s,strategy:Or,children:n.length===0?r.jsx("p",{className:G("text-xs text-center py-8 transition-colors",t?"text-primary font-medium":"text-muted-foreground"),children:t?"↓ Soltar aqui":"Vazio"}):n.map(d=>r.jsx(uo,{id:d.id,children:r.jsx(an,{sub:d,today:a,onEdit:()=>o(d),onDelete:()=>l(d.id)})},d.id))})})]})}const an=i.memo(function({sub:t,today:n,showStatus:s,onEdit:a,onDelete:o}){const l=t.dueDate&&t.dueDate<n&&t.status!=="Concluído";return r.jsx(vt,{className:G("transition-shadow duration-150",l&&"border-destructive/50"),children:r.jsx(bt,{className:"p-3",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[s&&r.jsx(Le,{variant:"secondary",className:G("text-[10px]",cn[t.status]),children:xt[t.status]}),l&&r.jsx(Le,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),r.jsx("p",{className:G("font-medium text-sm",t.completed&&"line-through text-muted-foreground"),children:t.title}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[r.jsx("span",{className:"font-medium",children:"Tarefa:"})," ",t.parentTaskTitle]}),r.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[t.projectName&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(ln,{className:"w-3 h-3"}),t.projectName]}),t.assignee&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(tr,{className:"w-3 h-3"}),t.assignee]}),t.dueDate&&r.jsxs("span",{className:G("flex items-center gap-1",l&&"text-destructive font-medium"),children:[r.jsx(nr,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]}),t.notes&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.notes})]}),r.jsxs("div",{className:"flex gap-1 shrink-0",children:[r.jsx(de,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:a,children:r.jsx(rr,{className:"w-3.5 h-3.5"})}),r.jsx(de,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:o,children:r.jsx(sr,{className:"w-3.5 h-3.5"})})]})]})})})});function ho({tasks:e,projects:t,loading:n,onCreateSubtask:s,onUpdateSubtask:a,onDeleteSubtask:o}){var ie;const[l,c]=i.useState(!1),[d,u]=i.useState(null),[g,m]=i.useState("kanban"),[b,p]=i.useState(""),[j,v]=i.useState("all"),[x,w]=i.useState("all"),[S,y]=i.useState("all"),[N,T]=i.useState("all"),[R,C]=i.useState("all"),[D,I]=i.useState("deadline"),[L,A]=i.useState(!1),[X,$]=i.useState(null),[Q,se]=i.useState(null),[Oe,V]=i.useState(null),ze=dr(cr(Vt,{activationConstraint:{distance:8}})),J=i.useMemo(()=>{const h={};return t.forEach(O=>{h[O.id]=O.name}),h},[t]),K=i.useMemo(()=>e.flatMap(h=>h.subtasks.map(O=>({...O,parentTaskTitle:h.title,projectId:h.projectId,projectName:h.projectId?J[h.projectId]:void 0}))),[e,J]),fe=i.useMemo(()=>{const h=new Date,O=new Date(h.getFullYear(),h.getMonth(),h.getDate()),P=new Date(O);P.setDate(O.getDate()+(7-O.getDay()));const ne=new Date(h.getFullYear(),h.getMonth()+1,0),_=K.filter(U=>{if(b&&!U.title.toLowerCase().includes(b.toLowerCase())||j!=="all"&&U.status!==j||x!=="all"&&U.assignee!==x||S!=="all"&&U.projectId!==S||N!=="all"&&U.parentTaskId!==N)return!1;if(R!=="all"){if(!U.dueDate)return R==="sem_prazo";const le=new Date(U.dueDate+"T23:59:59");switch(R){case"atrasadas":return le<O&&U.status!=="Concluído";case"hoje":return U.dueDate===F;case"esta_semana":return le>=O&&le<=P;case"este_mes":return le>=O&&le<=ne;case"sem_prazo":return!1}}return!0});return co(_,D)},[K,b,j,x,S,N,D]),F=i.useMemo(()=>{const h=new Date;return`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}-${String(h.getDate()).padStart(2,"0")}`},[]),W=i.useMemo(()=>{const h={"A fazer":0,"Em andamento":0,Concluído:0},O=K.filter(P=>P.dueDate&&P.dueDate<F&&P.status!=="Concluído").length;return K.forEach(P=>{h[P.status]!==void 0&&h[P.status]++}),{...h,overdue:O,total:K.length}},[K,F]),he=i.useCallback(()=>{u(null),c(!0)},[]),ae=i.useCallback(h=>{u(h),c(!0)},[]),ee=i.useCallback(async(h,O,P)=>{O?await s(h.parentTaskId,{title:h.title,deadline:h.deadline||void 0,status:h.status,assignee:h.assignee||void 0,notes:h.notes||void 0}):P&&await a(P,{title:h.title,deadline:h.deadline||void 0,status:h.status,assignee:h.assignee||void 0,notes:h.notes||void 0})},[s,a]),Ee=i.useCallback(async()=>{X&&(await o(X),$(null))},[X,o]),je=i.useMemo(()=>{const h={"A fazer":[],"Em andamento":[],Concluído:[]};return fe.forEach(O=>{h[O.status]&&h[O.status].push(O)}),h},[fe]),ge=j!=="all"||x!=="all"||S!=="all"||N!=="all"||R!=="all"||b,E=i.useCallback(h=>{se(String(h.active.id))},[]),Ae=i.useCallback(h=>{const{over:O}=h;if(!O){V(null);return}const P=String(O.id),ne=K.find(U=>U.id===P),_=ne?ne.status:ft.includes(P)?P:null;V(_)},[K]),te=i.useCallback(async h=>{const{active:O,over:P}=h;if(se(null),V(null),!P)return;const ne=String(O.id),_=String(P.id);if(ne===_)return;const U=K.find(Fe=>Fe.id===ne);if(!U)return;const le=K.find(Fe=>Fe.id===_),Xe=le?le.status:ft.includes(_)?_:U.status;U.status!==Xe&&await a(ne,{status:Xe})},[K,a]),De=i.useCallback(()=>{se(null),V(null)},[]),oe=Q?K.find(h=>h.id===Q):null;return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 mb-4",children:[r.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-border bg-card p-2.5",children:[r.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-md bg-muted",children:r.jsx(mo,{className:"w-4 h-4 text-muted-foreground"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-lg font-bold leading-none",children:W.total}),r.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Total"})]})]}),ft.map(h=>r.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-border bg-card p-2.5",children:[r.jsx(Le,{variant:"secondary",className:G("text-[10px] shrink-0",cn[h]),children:W[h]}),r.jsx("p",{className:"text-xs text-muted-foreground truncate",children:xt[h]})]},h))]}),W.overdue>0&&r.jsxs("div",{className:"flex items-center gap-2 p-2.5 mb-4 rounded-lg bg-destructive/10 border border-destructive/20",children:[r.jsx(is,{className:"w-4 h-4 text-destructive shrink-0"}),r.jsxs("p",{className:"text-xs font-medium text-destructive",children:[W.overdue," subtarefa",W.overdue>1?"s":""," atrasada",W.overdue>1?"s":""]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(dn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(It,{placeholder:"Buscar subtarefa...",value:b,onChange:h=>p(h.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[r.jsxs(be,{value:j,onValueChange:v,children:[r.jsx(ye,{className:"w-[140px]",children:r.jsx(Ne,{placeholder:"Status"})}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todos"}),ft.map(h=>r.jsx(z,{value:h,children:xt[h]},h))]})]}),r.jsxs(be,{value:x,onValueChange:w,children:[r.jsx(ye,{className:"w-[140px]",children:r.jsx(Ne,{placeholder:"Responsável"})}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todos"}),Kn.map(h=>r.jsx(z,{value:h,children:h},h))]})]}),r.jsxs(be,{value:S,onValueChange:y,children:[r.jsxs(ye,{className:"w-[150px]",children:[r.jsx(ln,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),r.jsx(Ne,{placeholder:"Projeto"})]}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todos"}),t.map(h=>r.jsx(z,{value:h.id,children:h.name},h.id))]})]}),r.jsxs(be,{value:N,onValueChange:T,children:[r.jsx(ye,{className:"w-[160px]",children:r.jsx(Ne,{placeholder:"Tarefa-mãe"})}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todas"}),e.map(h=>r.jsx(z,{value:h.id,children:h.title},h.id))]})]}),r.jsxs(be,{value:R,onValueChange:C,children:[r.jsxs(ye,{className:"w-[150px]",children:[r.jsx(ls,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),r.jsx(Ne,{placeholder:"Período"})]}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todos"}),r.jsx(z,{value:"atrasadas",children:"Atrasadas"}),r.jsx(z,{value:"hoje",children:"Vence hoje"}),r.jsx(z,{value:"esta_semana",children:"Esta semana"}),r.jsx(z,{value:"este_mes",children:"Este mês"}),r.jsx(z,{value:"sem_prazo",children:"Sem prazo"})]})]}),r.jsxs(be,{value:D,onValueChange:h=>I(h),children:[r.jsxs(ye,{className:"w-[44px] sm:w-[170px] gap-1.5",children:[r.jsx(ar,{className:"w-3.5 h-3.5 shrink-0 text-muted-foreground"}),r.jsx("span",{className:"hidden sm:inline truncate",children:(ie=Mn.find(h=>h.value===D))==null?void 0:ie.label})]}),r.jsx(we,{children:Mn.map(h=>r.jsx(z,{value:h.value,children:h.label},h.value))})]}),ge&&r.jsx(de,{variant:"ghost",size:"sm",onClick:()=>{v("all"),w("all"),y("all"),T("all"),C("all"),p("")},className:"text-xs gap-1",children:"✕ Limpar filtros"}),r.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[r.jsx(de,{variant:g==="list"?"default":"ghost",size:"sm",onClick:()=>m("list"),className:"rounded-none",children:r.jsx(er,{className:"w-4 h-4"})}),r.jsx(de,{variant:g==="kanban"?"default":"ghost",size:"sm",onClick:()=>m("kanban"),className:"rounded-none",children:r.jsx(un,{className:"w-4 h-4"})})]}),g==="kanban"&&r.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-muted-foreground cursor-pointer select-none",children:[r.jsx(tn,{checked:L,onCheckedChange:A,className:"scale-75"}),"Ocultar concluídas"]}),r.jsxs(de,{size:"sm",onClick:he,className:"gap-1.5",children:[r.jsx($n,{className:"w-4 h-4"})," Nova Subtarefa"]})]})]}),r.jsx(js,{open:l,onOpenChange:c,subtask:d,tasks:e,onSave:ee}),r.jsx(Xn,{open:!!X,onOpenChange:h=>!h&&$(null),children:r.jsxs(Hn,{children:[r.jsxs(Wn,{children:[r.jsx(qn,{children:"Remover subtarefa?"}),r.jsx(Gn,{children:"Esta ação não pode ser desfeita. A subtarefa será removida permanentemente."})]}),r.jsxs(Jn,{children:[r.jsx(Zn,{children:"Cancelar"}),r.jsx(Qn,{onClick:Ee,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?r.jsx("div",{className:"space-y-3",children:[1,2,3].map(h=>r.jsx(vt,{children:r.jsx(bt,{className:"p-4",children:r.jsx("div",{className:"h-16 bg-muted animate-pulse rounded"})})},h))}):g==="list"?r.jsx("div",{className:"space-y-3",children:fe.length===0?r.jsx(vt,{children:r.jsx(bt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma subtarefa encontrada."})}):fe.map(h=>r.jsx(an,{sub:h,today:F,showStatus:!0,onEdit:()=>ae(h),onDelete:()=>$(h.id)},h.id))}):r.jsxs(Rr,{sensors:ze,collisionDetection:ur,onDragStart:E,onDragOver:Ae,onDragEnd:te,onDragCancel:De,children:[r.jsx("div",{className:G("grid gap-4",L?"grid-cols-1 sm:grid-cols-2":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"),children:ft.filter(h=>!L||h!=="Concluído").map(h=>{const O=Oe===h,P=je[h],ne=P.map(_=>_.id);return r.jsx(fo,{status:h,isOver:O,items:P,itemIds:ne,today:F,onEdit:ae,onDelete:$},h)})}),r.jsx(Ar,{children:oe&&r.jsx("div",{className:"shadow-xl ring-2 ring-primary/30 rotate-[2deg] scale-105",children:r.jsx(an,{sub:oe,today:F,showStatus:!0,onEdit:()=>{},onDelete:()=>{}})})})]})]})}function mo({className:e}){return r.jsx(un,{className:e})}const Pn=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"priority",label:"Prioridade (Alta → Baixa)"},{value:"title",label:"Título (A → Z)"},{value:"client",label:"Cliente (A → Z)"}],zn={alta:0,media:1,baixa:2};function Fn(e,t){return[...e].sort((n,s)=>{switch(t){case"deadline":return!n.dueDate&&!s.dueDate?0:n.dueDate?s.dueDate?n.dueDate.localeCompare(s.dueDate):-1:1;case"priority":return(zn[n.priority]??1)-(zn[s.priority]??1);case"title":return n.title.localeCompare(s.title,"pt-BR");case"client":return(n.client??"").localeCompare(s.client??"","pt-BR");default:return 0}})}const go={client:!0,dueDate:!0,priority:!0,subtasks:!0,tags:!0,description:!1},Bn={client:"Cliente",dueDate:"Data de entrega",priority:"Prioridade",subtasks:"Subtarefas",tags:"Tags",description:"Descrição"},At=["pendente","agendado","em_andamento","em_tramite","concluida","cancelada"],on=i.memo(function({task:t,cardFields:n,today:s,isExpanded:a,onToggleExpand:o,onToggleSubtask:l,onEdit:c,onDelete:d,showStatus:u,isDragging:g,isOverlay:m}){const b=t.subtasks.filter(x=>x.completed).length,p=t.subtasks.length,j=p>0?Math.round(b/p*100):0,v=t.dueDate&&t.dueDate<s&&t.status!=="concluida"&&t.status!=="cancelada";return r.jsx(vt,{className:G("transition-shadow duration-150",g&&"opacity-40",m&&"shadow-xl ring-2 ring-primary/30 rotate-[2deg]",v&&"border-destructive/50"),children:r.jsxs(bt,{className:"p-3",children:[r.jsxs("div",{className:"flex items-start gap-2",children:[!m&&r.jsx(vs,{className:"w-4 h-4 text-muted-foreground mt-0.5 shrink-0 cursor-grab active:cursor-grabbing"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[n.priority&&r.jsx(Le,{variant:"secondary",className:`text-[10px] ${es[t.priority]}`,children:en[t.priority]}),u&&r.jsx(Le,{variant:"secondary",className:`text-[10px] ${Yn[t.status]}`,children:Ot[t.status]}),v&&r.jsx(Le,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),r.jsx("p",{className:"font-medium text-sm",children:t.title}),n.description&&t.description&&r.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.description}),r.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[n.client&&t.client&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(tr,{className:"w-3 h-3"}),t.client]}),n.dueDate&&t.dueDate&&r.jsxs("span",{className:G("flex items-center gap-1",v&&"text-destructive font-medium"),children:[r.jsx(nr,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]})]}),!m&&r.jsxs("div",{className:"flex gap-1 shrink-0",children:[r.jsx(de,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>c==null?void 0:c(t),children:r.jsx(rr,{className:"w-3.5 h-3.5"})}),r.jsx(de,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>d(t.id),children:r.jsx(sr,{className:"w-3.5 h-3.5"})})]})]}),n.subtasks&&p>0&&!m&&r.jsxs("div",{className:"mt-2",children:[r.jsxs("button",{className:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground transition-colors w-full",onClick:()=>o(t.id),children:[a?r.jsx(gs,{className:"w-3 h-3"}):r.jsx(ps,{className:"w-3 h-3"}),r.jsxs("span",{children:[b,"/",p," subtarefas"]}),r.jsx("div",{className:"flex-1 mx-2 bg-muted rounded-full h-1.5",children:r.jsx("div",{className:"bg-primary rounded-full h-1.5 transition-all",style:{width:`${j}%`}})}),r.jsxs("span",{className:"text-[10px]",children:[j,"%"]})]}),a&&r.jsx("div",{className:"mt-2 space-y-1 pl-4",children:t.subtasks.map(x=>r.jsxs("label",{className:"flex items-center gap-2 text-xs cursor-pointer hover:bg-muted/50 rounded p-1 -ml-1",children:[r.jsx(os,{checked:x.completed,onCheckedChange:()=>l(t.id,x.id)}),r.jsx("span",{className:G(x.completed&&"line-through text-muted-foreground"),children:x.title})]},x.id))})]}),n.tags&&t.tags&&t.tags.length>0&&!m&&r.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.map(x=>r.jsx(Le,{variant:"outline",className:"text-[10px]",children:x},x))})]})})});function po(e){const{attributes:t,listeners:n,setNodeRef:s,transform:a,transition:o,isDragging:l}=Fr({id:e.task.id}),c={transform:Pe.Transform.toString(a),transition:o};return r.jsx("div",{ref:s,style:c,...t,...n,children:r.jsx(on,{...e,isDragging:l})})}function xo({status:e,tasks:t,isOver:n,cardFields:s,today:a,expandedTasks:o,onToggleExpand:l,onToggleSubtask:c,onEdit:d,onDelete:u}){const g=i.useMemo(()=>t.map(b=>b.id),[t]),{setNodeRef:m}=vn({id:e});return r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(Le,{variant:"secondary",className:Yn[e],children:Ot[e]}),r.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.length,")"]})]}),r.jsx("div",{ref:m,"data-column-status":e,className:G("space-y-3 min-h-[400px] p-2 rounded-lg transition-colors duration-150",n?"bg-primary/10 border-2 border-dashed border-primary/40":"bg-muted/30 border-2 border-transparent"),children:r.jsx(Pr,{items:g,strategy:Or,children:t.length===0?r.jsx("p",{className:G("text-xs text-center py-8 transition-colors",n?"text-primary font-medium":"text-muted-foreground"),children:n?"↓ Soltar aqui":"Vazio"}):t.map(b=>r.jsx(po,{task:b,cardFields:s,today:a,isExpanded:o.has(b.id),onToggleExpand:l,onToggleSubtask:c,onEdit:d,onDelete:u},b.id))})})]})}function li(){var ot;const{tasks:e,setTasks:t,loading:n,syncing:s,error:a,lastSync:o,sync:l,updateTaskStatus:c,deleteTask:d,createTask:u,updateTask:g,createSubtask:m,updateSubtask:b,deleteSubtask:p}=$r(),{projects:j}=_r(),[v,x]=i.useState(!1),[w,S]=i.useState(null),[y,N]=i.useState([]),[T,R]=i.useState("kanban"),[C,D]=i.useState(""),[I,L]=i.useState("all"),[A,X]=i.useState("all"),[$,Q]=i.useState("all"),[se,Oe]=i.useState("all"),[V,ze]=i.useState(new Set),[J,K]=i.useState(go),[fe,F]=i.useState(null),[W,he]=i.useState(null),[ae,ee]=i.useState("deadline"),[Ee,je]=i.useState(!1);i.useEffect(()=>{e.length>0&&N(e)},[e]);const ge=i.useMemo(()=>[...new Set(y.map(f=>f.client).filter(Boolean))],[y]),E=i.useMemo(()=>{const f=y.filter(k=>!(C&&!k.title.toLowerCase().includes(C.toLowerCase())||I!=="all"&&k.status!==I||A!=="all"&&k.priority!==A||$!=="all"&&k.client!==$||se!=="all"&&k.projectId!==se));return Fn(f,ae)},[y,C,I,A,$,se,ae]),Ae=i.useMemo(()=>fe?y.find(f=>f.id===fe):null,[fe,y]),te=i.useMemo(()=>{const f=new Date;return`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`},[]),De=i.useCallback(f=>{ze(k=>{const Y=new Set(k);return Y.has(f)?Y.delete(f):Y.add(f),Y})},[]),oe=i.useCallback((f,k)=>{N(Y=>Y.map(me=>me.id===f?{...me,subtasks:me.subtasks.map(ce=>ce.id===k?{...ce,completed:!ce.completed}:ce)}:me))},[]),[ie,h]=i.useState(null),O=i.useCallback(async()=>{ie&&(d(ie),N(f=>f.filter(k=>k.id!==ie)),h(null))},[ie,d]),P=i.useCallback(f=>{K(k=>({...k,[f]:!k[f]}))},[]),ne=i.useCallback(()=>{S(null),x(!0)},[]),_=i.useCallback(f=>{S(f),x(!0)},[]),U=i.useCallback(async(f,k,Y)=>{k?await u({title:f.title,deadline:f.deadline,priority:f.priority,status:f.status,clientName:f.clientName,projectId:f.projectId,assignee:f.assignee,description:f.description}):Y&&await g(Y,{title:f.title,deadline:f.deadline,priority:f.priority,status:f.status,clientName:f.clientName,projectId:f.projectId,assignee:f.assignee,description:f.description})},[u,g]),le=dr(cr(Vt,{activationConstraint:{distance:8}}));i.useCallback(f=>{const k=y.find(Y=>Y.id===f);return k==null?void 0:k.status},[y]);const Xe=i.useCallback(f=>{F(f.active.id)},[]),Fe=i.useCallback(f=>{const{over:k}=f;if(!k){he(null);return}const Y=k.id,me=y.find(_e=>_e.id===Y),ce=me?me.status:At.includes(Y)?Y:null;he(ce)},[y]),Xt=i.useCallback(f=>{const{active:k,over:Y}=f;if(F(null),he(null),!Y)return;const me=k.id,ce=Y.id;if(me===ce)return;const _e=y.find(We=>We.id===me);if(!_e)return;const Tt=y.find(We=>We.id===ce),qe=Tt?Tt.status:At.includes(ce)?ce:_e.status;_e.status!==qe&&(N(We=>{const Wt=We.map(it=>it.id===me?{...it,status:qe}:it);return Fn(Wt,ae)}),c(me,qe))},[y,c,ae]),Ht=i.useCallback(()=>{F(null),he(null)},[]),Be=i.useMemo(()=>{const f={};return At.forEach(k=>{f[k]=[]}),E.forEach(k=>{f[k.status]&&f[k.status].push(k)}),f},[E]),[$e,He]=i.useState("tarefas");return r.jsx(Wr,{title:"",children:r.jsxs(ds,{value:$e,onValueChange:He,className:"w-full",children:[r.jsxs(us,{className:"mb-4",children:[r.jsx(bn,{value:"tarefas",children:"Tarefas"}),r.jsx(bn,{value:"subtarefas",children:"Subtarefas"})]}),r.jsxs(yn,{value:"tarefas",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[r.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[r.jsx(dn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),r.jsx(It,{placeholder:"Buscar tarefa...",value:C,onChange:f=>D(f.target.value),className:"pl-9 w-full text-sm"})]}),r.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[r.jsxs(be,{value:I,onValueChange:L,children:[r.jsx(ye,{className:"w-[130px]",children:r.jsx(Ne,{placeholder:"Status"})}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todos"}),Object.keys(Ot).map(f=>r.jsx(z,{value:f,children:Ot[f]},f))]})]}),r.jsxs(be,{value:A,onValueChange:X,children:[r.jsx(ye,{className:"w-[110px]",children:r.jsx(Ne,{placeholder:"Prioridade"})}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todas"}),Object.keys(en).map(f=>r.jsx(z,{value:f,children:en[f]},f))]})]}),r.jsxs(be,{value:$,onValueChange:Q,children:[r.jsx(ye,{className:"w-[140px]",children:r.jsx(Ne,{placeholder:"Cliente"})}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todos"}),ge.map(f=>r.jsx(z,{value:f,children:f},f))]})]}),r.jsxs(be,{value:se,onValueChange:Oe,children:[r.jsxs(ye,{className:"w-[150px]",children:[r.jsx(ln,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),r.jsx(Ne,{placeholder:"Projeto"})]}),r.jsxs(we,{children:[r.jsx(z,{value:"all",children:"Todos"}),j.map(f=>r.jsx(z,{value:f.id,children:f.name},f.id))]})]}),r.jsxs(be,{value:ae,onValueChange:f=>ee(f),children:[r.jsxs(ye,{className:"w-[44px] sm:w-[170px] gap-1.5",children:[r.jsx(ar,{className:"w-3.5 h-3.5 shrink-0 text-muted-foreground"}),r.jsx("span",{className:"hidden sm:inline truncate",children:(ot=Pn.find(f=>f.value===ae))==null?void 0:ot.label})]}),r.jsx(we,{children:Pn.map(f=>r.jsx(z,{value:f.value,children:f.label},f.value))})]}),r.jsxs(_n,{children:[r.jsx(Un,{asChild:!0,children:r.jsxs(de,{variant:"outline",size:"sm",className:"gap-1.5",children:[r.jsx(bs,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Campos"})]})}),r.jsx(Vn,{className:"w-56",align:"end",children:r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"text-sm font-medium mb-2",children:"Mostrar nos cards"}),Object.keys(Bn).map(f=>r.jsxs("div",{className:"flex items-center justify-between py-1",children:[r.jsx(cs,{htmlFor:`field-${f}`,className:"text-sm cursor-pointer",children:Bn[f]}),r.jsx(tn,{id:`field-${f}`,checked:J[f],onCheckedChange:()=>P(f)})]},f))]})})]}),(I!=="all"||A!=="all"||$!=="all"||se!=="all"||C)&&r.jsx(de,{variant:"ghost",size:"sm",onClick:()=>{L("all"),X("all"),Q("all"),Oe("all"),D("")},className:"text-xs gap-1",children:"✕ Limpar filtros"}),r.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[r.jsx(de,{variant:T==="list"?"default":"ghost",size:"sm",onClick:()=>R("list"),className:"rounded-none",children:r.jsx(er,{className:"w-4 h-4"})}),r.jsx(de,{variant:T==="kanban"?"default":"ghost",size:"sm",onClick:()=>R("kanban"),className:"rounded-none",children:r.jsx(un,{className:"w-4 h-4"})})]}),T==="kanban"&&r.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-muted-foreground cursor-pointer select-none",children:[r.jsx(tn,{checked:Ee,onCheckedChange:je,className:"scale-75"}),"Ocultar concluídas"]}),r.jsx(fs,{syncing:s,lastSync:o,onSync:l,error:a}),r.jsxs(de,{size:"sm",onClick:ne,className:"gap-1.5",children:[r.jsx($n,{className:"w-4 h-4"})," Nova Tarefa"]})]})]}),r.jsx(qr,{open:v,onOpenChange:x,task:w,onSave:U,onCreateSubtask:m,onUpdateSubtask:b,onDeleteSubtask:p}),r.jsx(Xn,{open:!!ie,onOpenChange:f=>!f&&h(null),children:r.jsxs(Hn,{children:[r.jsxs(Wn,{children:[r.jsx(qn,{children:"Remover tarefa?"}),r.jsx(Gn,{children:"Esta ação não pode ser desfeita. A tarefa será removida permanentemente do Airtable e do banco local."})]}),r.jsxs(Jn,{children:[r.jsx(Zn,{children:"Cancelar"}),r.jsx(Qn,{onClick:O,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?T==="list"?r.jsx(hs,{}):r.jsx(ms,{}):T==="list"?r.jsx("div",{className:"space-y-3",children:E.length===0?r.jsx(vt,{children:r.jsx(bt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma tarefa encontrada."})}):E.map(f=>r.jsx(on,{task:f,cardFields:J,today:te,isExpanded:V.has(f.id),onToggleExpand:De,onToggleSubtask:oe,onEdit:_,onDelete:h,showStatus:!0},f.id))}):r.jsxs(Rr,{sensors:le,collisionDetection:ur,onDragStart:Xe,onDragOver:Fe,onDragEnd:Xt,onDragCancel:Ht,children:[r.jsx("div",{className:G("grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",Ee?"xl:grid-cols-4":"xl:grid-cols-6"),children:At.filter(f=>!Ee||f!=="concluida"&&f!=="cancelada").map(f=>r.jsx(xo,{status:f,tasks:Be[f],isOver:W===f&&fe!==null,cardFields:J,today:te,expandedTasks:V,onToggleExpand:De,onToggleSubtask:oe,onEdit:_,onDelete:h},f))}),r.jsx(Ar,{dropAnimation:{duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)"},children:Ae?r.jsx("div",{className:"w-[260px]",children:r.jsx(on,{task:Ae,cardFields:J,today:te,isExpanded:!1,onToggleExpand:()=>{},onToggleSubtask:()=>{},onDelete:()=>{},isOverlay:!0})}):null})]})]}),r.jsx(yn,{value:"subtarefas",children:r.jsx(ho,{tasks:y,projects:j,loading:n,onCreateSubtask:m,onUpdateSubtask:b,onDeleteSubtask:p})})]})})}export{li as default};
