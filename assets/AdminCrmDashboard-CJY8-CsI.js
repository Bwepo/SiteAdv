import{c as z,r as u,j as e,L as d}from"./index-RmZ73Lgq.js";import{A as M,L as f}from"./AdminLayout-C-HBNBFh.js";import{C as t,c as l,a as N,b}from"./card-DpbtTpxz.js";import{B as v}from"./badge-4-2Ehll8.js";import{B as w}from"./button-BRXBmgFe.js";import{S as p}from"./skeleton-r44SCx5J.js";import{S as V,a as Y,b as H,d as K,e as F}from"./select-XDxAV8wr.js";import{u as U,a as Z,b as q,E as G,c as J,T as Q,d as W}from"./crmTypes-d7spMBDn.js";import{C as y}from"./calendar-zD5AgT5f.js";import{C as X}from"./clock-CpqmR45M.js";import{T as ee,C as R}from"./triangle-alert-DE0emguS.js";import{C as se}from"./chart-column-CT7yFL6Y.js";import{A as P}from"./arrow-right-B8RdMXm8.js";import{U as C}from"./users-Ct0pe-DP.js";import"./index-CQ2FbGk6.js";import"./index-CEZSRBSU.js";import"./house-y5kz8rPK.js";import"./menu-BxsFgETN.js";import"./file-text-BKsISaE4.js";import"./index-CFPtB8l8.js";import"./index-ClTDSjCe.js";import"./chevron-up-IvZXGu3n.js";import"./check-BfGxA5t3.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=z("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function te(){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[1,2,3,4].map(i=>e.jsx(t,{children:e.jsxs(l,{className:"p-4 flex items-center gap-3",children:[e.jsx(p,{className:"h-10 w-10 rounded-lg"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(p,{className:"h-7 w-8"}),e.jsx(p,{className:"h-3 w-20"})]})]})},i))}),e.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:[1,2].map(i=>e.jsx(t,{children:e.jsxs(l,{className:"p-6 space-y-3",children:[e.jsx(p,{className:"h-5 w-40 mb-2"}),[1,2,3].map(g=>e.jsx(p,{className:"h-16 w-full rounded-lg"},g))]})},i))})]})}function le(){return new Intl.DateTimeFormat("sv-SE",{timeZone:"America/Sao_Paulo"}).format(new Date)}function De(){const{events:i,loading:g}=U(),{tasks:m,loading:$}=Z(),{clients:re,loading:B}=q(),[n,T]=u.useState("all"),_=g||$||B,j=le(),k=u.useMemo(()=>{const s=new Set;return m.forEach(a=>{a.client&&s.add(a.client)}),i.forEach(a=>{a.client&&s.add(a.client)}),[...s].sort()},[m,i]),c=u.useMemo(()=>n==="all"?m:m.filter(s=>s.client===n),[m,n]),A=u.useMemo(()=>n==="all"?i:i.filter(s=>s.client===n),[i,n]),I=A.filter(s=>s.date===j).length,S=c.filter(s=>s.dueDate&&s.dueDate<j&&s.status!=="concluida"&&s.status!=="cancelada").length,o=c.filter(s=>s.status==="em_andamento").length,x=c.filter(s=>s.status==="concluida").length,h=c.filter(s=>s.status==="pendente"||s.status==="agendado").length,E=A.filter(s=>s.date>=j&&s.status!=="cancelado").sort((s,a)=>s.date.localeCompare(a.date)||(s.time||"").localeCompare(a.time||"")).slice(0,6),D=c.filter(s=>s.status!=="concluida"&&s.status!=="cancelada").sort((s,a)=>{const r={alta:0,media:1,baixa:2};return r[s.priority]-r[a.priority]||(s.dueDate||"").localeCompare(a.dueDate||"")}).slice(0,6),O=s=>{const a=new Date(s+"T12:00:00"),r=new Date;r.setHours(12,0,0,0);const L=Math.round((a.getTime()-r.getTime())/864e5);return L===0?"Hoje":L===1?"Amanhã":a.toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"short"})};return e.jsx(M,{title:"CRM — Painel",children:_?e.jsx(te,{}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ae,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs(V,{value:n,onValueChange:T,children:[e.jsx(Y,{className:"w-[220px]",children:e.jsx(H,{placeholder:"Filtrar por cliente"})}),e.jsxs(K,{children:[e.jsx(F,{value:"all",children:"Todos os clientes"}),k.map(s=>e.jsx(F,{value:s,children:s},s))]})]}),n!=="all"&&e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>T("all"),className:"text-xs",children:"Limpar filtro"})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[e.jsx(t,{children:e.jsxs(l,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 text-blue-700",children:e.jsx(y,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:I}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Compromissos hoje"})]})]})}),e.jsx(t,{children:e.jsxs(l,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-slate-100 text-slate-700",children:e.jsx(f,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"A Fazer"})]})]})}),e.jsx(t,{children:e.jsxs(l,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-amber-100 text-amber-700",children:e.jsx(X,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:o}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Em andamento"})]})]})}),e.jsx(t,{children:e.jsxs(l,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-100 text-red-700",children:e.jsx(ee,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:S}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Atrasadas"})]})]})}),e.jsx(t,{children:e.jsxs(l,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-100 text-green-700",children:e.jsx(R,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:x}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Concluídas"})]})]})})]}),e.jsxs(t,{className:"mb-6",children:[e.jsx(N,{className:"pb-3",children:e.jsxs(b,{className:"text-base flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Distribuição de Tarefas",n!=="all"&&e.jsx(v,{variant:"secondary",className:"text-[10px] ml-2",children:n})]})}),e.jsxs(l,{children:[e.jsx("div",{className:"flex gap-2 h-3 rounded-full overflow-hidden bg-muted",children:c.length>0&&e.jsxs(e.Fragment,{children:[h>0&&e.jsx("div",{className:"bg-slate-400 transition-all",style:{width:`${h/c.length*100}%`},title:`A Fazer: ${h}`}),o>0&&e.jsx("div",{className:"bg-blue-500 transition-all",style:{width:`${o/c.length*100}%`},title:`Em Andamento: ${o}`}),x>0&&e.jsx("div",{className:"bg-green-500 transition-all",style:{width:`${x/c.length*100}%`},title:`Concluídas: ${x}`})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-slate-400"})," A Fazer (",h,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-blue-500"})," Em Andamento (",o,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-green-500"})," Concluídas (",x,")"]}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"w-2.5 h-2.5 rounded-full bg-red-400"})," Atrasadas (",S,")"]})]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(b,{className:"text-base flex items-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"}),"Próximos Compromissos"]}),e.jsx(d,{to:"/admin/agenda",children:e.jsxs(w,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todos ",e.jsx(P,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(l,{className:"space-y-3",children:E.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum compromisso próximo."}):E.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"text-center min-w-[3rem]",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:O(s.date)}),s.time&&e.jsx("p",{className:"text-sm font-bold",children:s.time})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),s.client&&e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-0.5",children:[e.jsx(C,{className:"w-3 h-3"}),s.client]})]}),e.jsx(v,{variant:"secondary",className:`text-[10px] shrink-0 ${G[s.type]}`,children:J[s.type]})]},s.id))})]}),e.jsxs(t,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(b,{className:"text-base flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Tarefas Pendentes"]}),e.jsx(d,{to:"/admin/tarefas",children:e.jsxs(w,{variant:"ghost",size:"sm",className:"text-xs",children:["Ver todas ",e.jsx(P,{className:"w-3 h-3 ml-1"})]})})]})}),e.jsx(l,{className:"space-y-3",children:D.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma tarefa pendente."}):D.map(s=>{const a=s.dueDate&&s.dueDate<j;return e.jsxs("div",{className:`p-3 rounded-lg border transition-colors hover:bg-muted/50 ${a?"border-red-300 bg-red-50/50":"border-border"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[s.client&&e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),s.client]}),s.dueDate&&e.jsxs("span",{className:`text-xs ${a?"text-red-600 font-medium":"text-muted-foreground"}`,children:[a?"⚠ ":"","Prazo: ",new Date(s.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]})]}),e.jsx(v,{variant:"secondary",className:`text-[10px] shrink-0 ${Q[s.priority]}`,children:W[s.priority]})]}),s.subtasks.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] text-muted-foreground mb-1",children:[e.jsxs("span",{children:[s.subtasks.filter(r=>r.completed).length,"/",s.subtasks.length," subtarefas"]}),e.jsxs("span",{children:[Math.round(s.subtasks.filter(r=>r.completed).length/s.subtasks.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-1.5",children:e.jsx("div",{className:"bg-primary rounded-full h-1.5 transition-all",style:{width:`${s.subtasks.filter(r=>r.completed).length/s.subtasks.length*100}%`}})})]})]},s.id)})})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsx(d,{to:"/admin/agenda",children:e.jsx(t,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(y,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"Agenda"})]})})}),e.jsx(d,{to:"/admin/tarefas",children:e.jsx(t,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(f,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"Tarefas"})]})})}),e.jsx(d,{to:"/admin/bosi",children:e.jsx(t,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(C,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"BOSI"})]})})}),e.jsx(d,{to:"/admin/posts/new",children:e.jsx(t,{className:"hover:border-primary/50 transition-colors cursor-pointer",children:e.jsxs(l,{className:"p-4 text-center",children:[e.jsx(R,{className:"w-6 h-6 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-sm font-medium",children:"Novo Post"})]})})})]})]})})}export{De as default};
