import{a as u,r as O,E as B,j as e,L as m,c as p}from"./index-B392kEpT.js";import{e as F,f as V}from"./usePosts-BGE_DbZ-.js";import{b as I}from"./usePostViews-BjG7nPim.js";import{B as n}from"./button-CrSVtYNo.js";import{B as b}from"./badge-va7kSsYP.js";import{T as L,a as R,b as f,c as i,d as H,e as l,A as $,f as q,g as U,h as G,i as J,j as K,k as Q,l as W}from"./alert-dialog-D8FdNWlo.js";import{D as N,a as v,b as w,c as t,d as X}from"./dropdown-menu-DzoT0yVL.js";import{g as y}from"./supabaseErrors-eYWJjREL.js";import{E as C}from"./external-link-DKiBy9bb.js";import{E as D,a as k}from"./eye-Bs-NRsiS.js";import{T as E}from"./trash-2-CoYFw-kF.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=u("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=u("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=u("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);function o(r){return r?new Date(r).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"}function oe({posts:r,isLoading:j}){const[h,d]=O.useState(null),A=F(),M=V(),{toast:c}=B(),{data:x}=I(),g=async s=>{const a=!s.published;try{await A.mutateAsync({id:s.id,published:a,published_at:a?new Date().toISOString():s.published_at}),c({title:a?"Post publicado!":"Post despublicado",description:a?"O artigo agora está visível no blog.":"O artigo foi movido para rascunhos."})}catch(S){const _=y(S,"Não foi possível atualizar o post.");c({title:"Erro",description:_,variant:"destructive"})}},z=async()=>{if(h)try{await M.mutateAsync(h),c({title:"Post excluído",description:"O artigo foi removido permanentemente."})}catch(s){const a=y(s,"Não foi possível excluir o post.");c({title:"Erro",description:a,variant:"destructive"})}finally{d(null)}};return r.length===0&&!j?e.jsxs("div",{className:"text-center py-12 border border-dashed border-border rounded-lg",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Nenhum post encontrado."}),e.jsx(m,{to:"/admin/posts/new",children:e.jsx(n,{children:"Criar primeiro post"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block border border-border rounded-lg overflow-hidden",children:e.jsxs(L,{children:[e.jsx(R,{children:e.jsxs(f,{children:[e.jsx(i,{className:"w-[35%]",children:"Título"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Views"}),e.jsx(i,{children:"Publicado em"}),e.jsx(i,{children:"Criado em"}),e.jsx(i,{className:"w-[100px]",children:"Ações"})]})}),e.jsx(H,{children:r.map(s=>e.jsxs(f,{children:[e.jsx(l,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground line-clamp-1",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-1",children:["/",s.slug]})]})}),e.jsx(l,{children:e.jsx(b,{variant:s.published?"default":"secondary",className:p(s.published?"bg-green-500/10 text-green-600 border-green-500/30":""),children:s.published?"Publicado":"Rascunho"})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:(x==null?void 0:x[s.id])||0})]})}),e.jsx(l,{className:"text-muted-foreground",children:o(s.published_at)}),e.jsx(l,{className:"text-muted-foreground",children:o(s.created_at)}),e.jsx(l,{children:e.jsxs(N,{children:[e.jsx(v,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"icon",children:e.jsx(P,{className:"w-4 h-4"})})}),e.jsxs(w,{align:"end",className:"bg-popover",children:[e.jsx(t,{asChild:!0,children:e.jsxs(m,{to:`/admin/posts/${s.id}/edit`,children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Editar"]})}),s.published&&e.jsx(t,{asChild:!0,children:e.jsxs("a",{href:`/blog/${s.slug}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Ver no blog"]})}),e.jsx(t,{onClick:()=>g(s),children:s.published?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Despublicar"]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Publicar"]})}),e.jsx(X,{}),e.jsxs(t,{onClick:()=>d(s.id),className:"text-destructive focus:text-destructive",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})})]},s.id))})]})}),e.jsx("div",{className:"lg:hidden space-y-3",children:r.map(s=>e.jsxs("div",{className:"bg-card rounded-lg border border-border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-foreground line-clamp-2 text-sm sm:text-base",children:s.title}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",children:["/",s.slug]})]}),e.jsx(b,{variant:s.published?"default":"secondary",className:p("shrink-0 text-xs",s.published?"bg-green-500/10 text-green-600 border-green-500/30":""),children:s.published?"Publicado":"Rascunho"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Publicado: ",o(s.published_at)]}),e.jsxs("span",{children:["Criado: ",o(s.created_at)]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-border",children:[e.jsx(m,{to:`/admin/posts/${s.id}/edit`,children:e.jsxs(n,{variant:"outline",size:"sm",className:"h-8 text-xs",children:[e.jsx(T,{className:"w-3.5 h-3.5 mr-1.5"}),"Editar"]})}),e.jsx(n,{variant:"outline",size:"sm",className:"h-8 text-xs",onClick:()=>g(s),children:s.published?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-3.5 h-3.5 mr-1.5"}),"Despublicar"]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-3.5 h-3.5 mr-1.5"}),"Publicar"]})}),e.jsxs(N,{children:[e.jsx(v,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(P,{className:"w-4 h-4"})})}),e.jsxs(w,{align:"end",className:"bg-popover",children:[s.published&&e.jsx(t,{asChild:!0,children:e.jsxs("a",{href:`/blog/${s.slug}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Ver no blog"]})}),e.jsxs(t,{onClick:()=>d(s.id),className:"text-destructive focus:text-destructive",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})]})]},s.id))}),e.jsx($,{open:!!h,onOpenChange:()=>d(null),children:e.jsxs(q,{children:[e.jsxs(U,{children:[e.jsx(G,{children:"Excluir post?"}),e.jsx(J,{children:"Esta ação não pode ser desfeita. O post será removido permanentemente."})]}),e.jsxs(K,{children:[e.jsx(Q,{children:"Cancelar"}),e.jsx(W,{onClick:z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}export{Y as C,oe as P};
