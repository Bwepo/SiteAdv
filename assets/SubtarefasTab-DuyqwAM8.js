import{c as Dt,r as l,j as o,e as le,l as tr,Y as L,f as rt}from"./index-BbYBTSnr.js";import{u as nr,F as rr,a as Ue,b as Ye,c as Ve,d as Xe,e as Ke,t as sr}from"./form-YWQ5eGdb.js";import{S as or,a as ar,b as ir,c as lr,f as cr,g as ur,B as mt,P as dr,F as mn}from"./AdminLayout-96K9ZAW6.js";import{I as Pt}from"./input-DG1fOFyT.js";import{B as Ae}from"./button-A1Qu9K1N.js";import{T as fr}from"./textarea-qOUF9bEB.js";import{S as Ne,a as Re,b as Oe,d as Ee,e as Y}from"./select-CXp2WOl0.js";import{P as hr,a as gr,b as pr}from"./popover-9DOqPUDK.js";import{f as xn,S as it,g as Vt}from"./crmTypes-C2SECzd8.js";import{S as bn}from"./search-AxxJVOh1.js";import{C as vr}from"./check-2jopwpsj.js";import{U as mr}from"./separator-BOlnme_o.js";import{L as xr}from"./loader-circle-DXmV-T6n.js";import{o as br,s as tt,e as yr}from"./types-C9wiu8_K.js";import{C as zt,c as Ft}from"./card-BrKoq-Dh.js";import{A as wr,a as Sr,b as Cr,c as Dr,d as jr,e as Nr,f as Rr,g as Er}from"./alert-dialog-Cy5Phfoi.js";import{S as Tr}from"./checkbox-DE9EhGfw.js";import{T as Ar}from"./triangle-alert-DeOibraT.js";import{L as Ir}from"./list-D2FUAJEi.js";import{C as Mr}from"./clock-BWCSRoEN.js";import{U as Or}from"./users-BPns1ADy.js";import{C as kr}from"./calendar-Bdfdodqk.js";import{P as Lr}from"./pencil-Cdi3DF-g.js";import{T as Pr}from"./trash-2-D5_UNS_X.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=Dt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=Dt("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=Dt("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=Dt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Br=br({title:tt().trim().min(1,"Título obrigatório").max(200),parentTaskId:tt().min(1,"Tarefa-mãe obrigatória"),deadline:tt().optional(),status:yr(["A fazer","Em andamento","Concluído"]),assignee:tt().optional(),notes:tt().max(2e3).optional()}),$r=Object.entries(it);function Ur({open:e,onOpenChange:t,subtask:n,tasks:r,onSave:s}){const a=!n,[i,c]=l.useState(!1),[u,d]=l.useState(""),[h,g]=l.useState(!1),x=l.useMemo(()=>{if(!u.trim())return r;const v=u.toLowerCase();return r.filter(m=>m.title.toLowerCase().includes(v))},[r,u]),p=nr({resolver:sr(Br),defaultValues:{title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}});l.useEffect(()=>{e&&(n?p.reset({title:n.title,parentTaskId:n.parentTaskId,deadline:n.dueDate??"",status:n.status,assignee:n.assignee??"",notes:n.notes??""}):p.reset({title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}))},[e,n]);const y=async v=>{c(!0);try{await s(v,a,n==null?void 0:n.id),t(!1)}catch(m){tr.error("Erro ao salvar subtarefa: "+m.message),console.error("Erro ao salvar subtarefa:",m)}finally{c(!1)}};return o.jsx(or,{open:e,onOpenChange:t,children:o.jsxs(ar,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[o.jsxs(ir,{className:"mb-6",children:[o.jsx(lr,{children:a?"Nova Subtarefa":"Editar Subtarefa"}),o.jsx(cr,{children:a?"Preencha os dados e selecione a tarefa-mãe relacionada.":"Altere os campos e salve."})]}),o.jsx(rr,{...p,children:o.jsxs("form",{onSubmit:p.handleSubmit(y),className:"space-y-5",children:[o.jsx(Ue,{control:p.control,name:"title",render:({field:v})=>o.jsxs(Ye,{children:[o.jsx(Ve,{children:"Título *"}),o.jsx(Xe,{children:o.jsx(Pt,{placeholder:"Ex: Enviar documento",...v})}),o.jsx(Ke,{})]})}),o.jsx(Ue,{control:p.control,name:"parentTaskId",render:({field:v})=>{var m;return o.jsxs(Ye,{className:"flex flex-col",children:[o.jsx(Ve,{children:"Tarefa-mãe *"}),o.jsxs(hr,{open:h,onOpenChange:g,children:[o.jsx(gr,{asChild:!0,children:o.jsx(Xe,{children:o.jsxs(Ae,{variant:"outline",role:"combobox",className:le("w-full justify-between font-normal",!v.value&&"text-muted-foreground"),children:[o.jsx("span",{className:"truncate",children:v.value?((m=r.find(b=>b.id===v.value))==null?void 0:m.title)??"Tarefa não encontrada":"Selecione a tarefa-mãe..."}),o.jsx(Fr,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),o.jsxs(pr,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:[o.jsxs("div",{className:"flex items-center border-b px-3",children:[o.jsx(bn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),o.jsx("input",{className:"flex h-10 w-full bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground",placeholder:"Buscar tarefa...",value:u,onChange:b=>d(b.target.value)})]}),o.jsx("div",{className:"max-h-[200px] overflow-y-auto p-1",children:x.length===0?o.jsx("p",{className:"py-4 text-center text-sm text-muted-foreground",children:"Nenhuma tarefa encontrada."}):x.map(b=>o.jsxs("button",{type:"button",className:le("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",v.value===b.id&&"bg-accent"),onClick:()=>{v.onChange(b.id),g(!1),d("")},children:[o.jsx(vr,{className:le("mr-2 h-4 w-4",v.value===b.id?"opacity-100":"opacity-0")}),o.jsx("span",{className:"truncate",children:b.title})]},b.id))})]})]}),o.jsx(Ke,{})]})}}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsx(Ue,{control:p.control,name:"deadline",render:({field:v})=>o.jsxs(Ye,{children:[o.jsx(Ve,{children:"Prazo"}),o.jsx(Xe,{children:o.jsx(Pt,{type:"date",...v})}),o.jsx(Ke,{})]})}),o.jsx(Ue,{control:p.control,name:"status",render:({field:v})=>o.jsxs(Ye,{children:[o.jsx(Ve,{children:"Status"}),o.jsxs(Ne,{onValueChange:v.onChange,value:v.value,children:[o.jsx(Xe,{children:o.jsx(Re,{children:o.jsx(Oe,{})})}),o.jsx(Ee,{children:$r.map(([m,b])=>o.jsx(Y,{value:m,children:b},m))})]}),o.jsx(Ke,{})]})})]}),o.jsx(Ue,{control:p.control,name:"assignee",render:({field:v})=>o.jsxs(Ye,{children:[o.jsx(Ve,{children:"Responsável"}),o.jsxs(Ne,{onValueChange:m=>v.onChange(m==="_none_"?"":m),value:v.value||"_none_",children:[o.jsx(Xe,{children:o.jsx(Re,{children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(mr,{className:"w-3.5 h-3.5 text-muted-foreground"}),o.jsx(Oe,{placeholder:"Responsável..."})]})})}),o.jsxs(Ee,{children:[o.jsx(Y,{value:"_none_",children:"— Sem responsável —"}),xn.map(m=>o.jsx(Y,{value:m,children:m},m))]})]}),o.jsx(Ke,{})]})}),o.jsx(Ue,{control:p.control,name:"notes",render:({field:v})=>o.jsxs(Ye,{children:[o.jsx(Ve,{children:"Observações"}),o.jsx(Xe,{children:o.jsx(fr,{placeholder:"Observações...",className:"resize-none min-h-[80px]",...v})}),o.jsx(Ke,{})]})}),o.jsx(ur,{children:o.jsxs(Ae,{type:"submit",disabled:i,className:"w-full",children:[i&&o.jsx(xr,{className:"w-4 h-4 mr-2 animate-spin"}),a?"Criar Subtarefa":"Salvar Alterações"]})})]})})]})})}function Yr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const jt=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function We(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Xt(e){return"nodeType"in e}function q(e){var t,n;return e?We(e)?e:Xt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Kt(e){const{Document:t}=q(e);return e instanceof t}function ut(e){return We(e)?!1:e instanceof q(e).HTMLElement}function wn(e){return e instanceof q(e).SVGElement}function He(e){return e?We(e)?e.document:Xt(e)?Kt(e)?e:ut(e)||wn(e)?e.ownerDocument:document:document:document}const ue=jt?l.useLayoutEffect:l.useEffect;function Nt(e){const t=l.useRef(e);return ue(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Vr(){const e=l.useRef(null),t=l.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function lt(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return ue(()=>{n.current!==e&&(n.current=e)},t),n}function dt(e,t){const n=l.useRef();return l.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function xt(e){const t=Nt(e),n=l.useRef(null),r=l.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function bt(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let Mt={};function ft(e,t){return l.useMemo(()=>{if(t)return t;const n=Mt[e]==null?0:Mt[e]+1;return Mt[e]=n,e+"-"+n},[e,t])}function Sn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((a,i)=>{const c=Object.entries(i);for(const[u,d]of c){const h=a[u];h!=null&&(a[u]=h+e*d)}return a},{...t})}}const _e=Sn(1),yt=Sn(-1);function Xr(e){return"clientX"in e&&"clientY"in e}function Rt(e){if(!e)return!1;const{KeyboardEvent:t}=q(e.target);return t&&e instanceof t}function Kr(e){if(!e)return!1;const{TouchEvent:t}=q(e.target);return t&&e instanceof t}function wt(e){if(Kr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Xr(e)?{x:e.clientX,y:e.clientY}:null}const Ie=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Ie.Translate.toString(e),Ie.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),tn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function _r(e){return e.matches(tn)?e:e.querySelector(tn)}const Wr={display:"none"};function Hr(e){let{id:t,value:n}=e;return L.createElement("div",{id:t,style:Wr},n)}function qr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return L.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function Gr(){const[e,t]=l.useState("");return{announce:l.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Cn=l.createContext(null);function Jr(e){const t=l.useContext(Cn);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Qr(){const[e]=l.useState(()=>new Set),t=l.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[l.useCallback(r=>{let{type:s,event:a}=r;e.forEach(i=>{var c;return(c=i[s])==null?void 0:c.call(i,a)})},[e]),t]}const Zr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},es={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function ts(e){let{announcements:t=es,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=Zr}=e;const{announce:a,announcement:i}=Gr(),c=ft("DndLiveRegion"),[u,d]=l.useState(!1);if(l.useEffect(()=>{d(!0)},[]),Jr(l.useMemo(()=>({onDragStart(g){let{active:x}=g;a(t.onDragStart({active:x}))},onDragMove(g){let{active:x,over:p}=g;t.onDragMove&&a(t.onDragMove({active:x,over:p}))},onDragOver(g){let{active:x,over:p}=g;a(t.onDragOver({active:x,over:p}))},onDragEnd(g){let{active:x,over:p}=g;a(t.onDragEnd({active:x,over:p}))},onDragCancel(g){let{active:x,over:p}=g;a(t.onDragCancel({active:x,over:p}))}}),[a,t])),!u)return null;const h=L.createElement(L.Fragment,null,L.createElement(Hr,{id:r,value:s.draggable}),L.createElement(qr,{id:c,announcement:i}));return n?rt.createPortal(h,n):h}var B;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(B||(B={}));function St(){}function ns(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function rs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const de=Object.freeze({x:0,y:0});function ss(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function os(e,t){const n=wt(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function as(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function is(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function nn(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function ls(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const cs=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=nn(t),a=[];for(const i of r){const{id:c}=i,u=n.get(c);if(u){const d=nn(u),h=s.reduce((x,p,y)=>x+ss(d[y],p),0),g=Number((h/4).toFixed(4));a.push({id:c,data:{droppableContainer:i,value:g}})}}return a.sort(as)};function us(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),i=s-r,c=a-n;if(r<s&&n<a){const u=t.width*t.height,d=e.width*e.height,h=i*c,g=h/(u+d-h);return Number(g.toFixed(4))}return 0}const ds=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const a of r){const{id:i}=a,c=n.get(i);if(c){const u=us(c,t);u>0&&s.push({id:i,data:{droppableContainer:a,value:u}})}}return s.sort(is)};function fs(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Dn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:de}function hs(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s.reduce((i,c)=>({...i,top:i.top+e*c.y,bottom:i.bottom+e*c.y,left:i.left+e*c.x,right:i.right+e*c.x}),{...n})}}const gs=hs(1);function jn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function ps(e,t,n){const r=jn(t);if(!r)return e;const{scaleX:s,scaleY:a,x:i,y:c}=r,u=e.left-i-(1-s)*parseFloat(n),d=e.top-c-(1-a)*parseFloat(n.slice(n.indexOf(" ")+1)),h=s?e.width/s:e.width,g=a?e.height/a:e.height;return{width:h,height:g,top:d,right:u+h,bottom:d+g,left:u}}const vs={ignoreTransform:!1};function qe(e,t){t===void 0&&(t=vs);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:h}=q(e).getComputedStyle(e);d&&(n=ps(n,d,h))}const{top:r,left:s,width:a,height:i,bottom:c,right:u}=n;return{top:r,left:s,width:a,height:i,bottom:c,right:u}}function rn(e){return qe(e,{ignoreTransform:!0})}function ms(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function xs(e,t){return t===void 0&&(t=q(e).getComputedStyle(e)),t.position==="fixed"}function bs(e,t){t===void 0&&(t=q(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const a=t[s];return typeof a=="string"?n.test(a):!1})}function _t(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(Kt(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!ut(s)||wn(s)||n.includes(s))return n;const a=q(e).getComputedStyle(s);return s!==e&&bs(s,a)&&n.push(s),xs(s,a)?n:r(s.parentNode)}return e?r(e):n}function Nn(e){const[t]=_t(e,1);return t??null}function Ot(e){return!jt||!e?null:We(e)?e:Xt(e)?Kt(e)||e===He(e).scrollingElement?window:ut(e)?e:null:null}function Rn(e){return We(e)?e.scrollX:e.scrollLeft}function En(e){return We(e)?e.scrollY:e.scrollTop}function Bt(e){return{x:Rn(e),y:En(e)}}var V;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(V||(V={}));function Tn(e){return!jt||!e?!1:e===document.scrollingElement}function An(e){const t={x:0,y:0},n=Tn(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:s,isLeft:a,isBottom:i,isRight:c,maxScroll:r,minScroll:t}}const ys={x:.2,y:.2};function ws(e,t,n,r,s){let{top:a,left:i,right:c,bottom:u}=n;r===void 0&&(r=10),s===void 0&&(s=ys);const{isTop:d,isBottom:h,isLeft:g,isRight:x}=An(e),p={x:0,y:0},y={x:0,y:0},v={height:t.height*s.y,width:t.width*s.x};return!d&&a<=t.top+v.height?(p.y=V.Backward,y.y=r*Math.abs((t.top+v.height-a)/v.height)):!h&&u>=t.bottom-v.height&&(p.y=V.Forward,y.y=r*Math.abs((t.bottom-v.height-u)/v.height)),!x&&c>=t.right-v.width?(p.x=V.Forward,y.x=r*Math.abs((t.right-v.width-c)/v.width)):!g&&i<=t.left+v.width&&(p.x=V.Backward,y.x=r*Math.abs((t.left+v.width-i)/v.width)),{direction:p,speed:y}}function Ss(e){if(e===document.scrollingElement){const{innerWidth:a,innerHeight:i}=window;return{top:0,left:0,right:a,bottom:i,width:a,height:i}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function In(e){return e.reduce((t,n)=>_e(t,Bt(n)),de)}function Cs(e){return e.reduce((t,n)=>t+Rn(n),0)}function Ds(e){return e.reduce((t,n)=>t+En(n),0)}function Mn(e,t){if(t===void 0&&(t=qe),!e)return;const{top:n,left:r,bottom:s,right:a}=t(e);Nn(e)&&(s<=0||a<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const js=[["x",["left","right"],Cs],["y",["top","bottom"],Ds]];class Wt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=_t(n),s=In(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[a,i,c]of js)for(const u of i)Object.defineProperty(this,u,{get:()=>{const d=c(r),h=s[a]-d;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class st{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Ns(e){const{EventTarget:t}=q(e);return e instanceof t?e:He(e)}function kt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ie;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ie||(ie={}));function sn(e){e.preventDefault()}function Rs(e){e.stopPropagation()}var E;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(E||(E={}));const On={start:[E.Space,E.Enter],cancel:[E.Esc],end:[E.Space,E.Enter,E.Tab]},Es=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case E.Right:return{...n,x:n.x+25};case E.Left:return{...n,x:n.x-25};case E.Down:return{...n,y:n.y+25};case E.Up:return{...n,y:n.y-25}}};class kn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new st(He(n)),this.windowListeners=new st(q(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ie.Resize,this.handleCancel),this.windowListeners.add(ie.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ie.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Mn(r),n(de)}handleKeyDown(t){if(Rt(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:a=On,coordinateGetter:i=Es,scrollBehavior:c="smooth"}=s,{code:u}=t;if(a.end.includes(u)){this.handleEnd(t);return}if(a.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:d}=r.current,h=d?{x:d.left,y:d.top}:de;this.referenceCoordinates||(this.referenceCoordinates=h);const g=i(t,{active:n,context:r.current,currentCoordinates:h});if(g){const x=yt(g,h),p={x:0,y:0},{scrollableAncestors:y}=r.current;for(const v of y){const m=t.code,{isTop:b,isRight:w,isLeft:C,isBottom:j,maxScroll:R,minScroll:N}=An(v),D=Ss(v),S={x:Math.min(m===E.Right?D.right-D.width/2:D.right,Math.max(m===E.Right?D.left:D.left+D.width/2,g.x)),y:Math.min(m===E.Down?D.bottom-D.height/2:D.bottom,Math.max(m===E.Down?D.top:D.top+D.height/2,g.y))},M=m===E.Right&&!w||m===E.Left&&!C,k=m===E.Down&&!j||m===E.Up&&!b;if(M&&S.x!==g.x){const I=v.scrollLeft+x.x,K=m===E.Right&&I<=R.x||m===E.Left&&I>=N.x;if(K&&!x.y){v.scrollTo({left:I,behavior:c});return}K?p.x=v.scrollLeft-I:p.x=m===E.Right?v.scrollLeft-R.x:v.scrollLeft-N.x,p.x&&v.scrollBy({left:-p.x,behavior:c});break}else if(k&&S.y!==g.y){const I=v.scrollTop+x.y,K=m===E.Down&&I<=R.y||m===E.Up&&I>=N.y;if(K&&!x.x){v.scrollTo({top:I,behavior:c});return}K?p.y=v.scrollTop-I:p.y=m===E.Down?v.scrollTop-R.y:v.scrollTop-N.y,p.y&&v.scrollBy({top:-p.y,behavior:c});break}}this.handleMove(t,_e(yt(g,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}kn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=On,onActivation:s}=t,{active:a}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const c=a.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function on(e){return!!(e&&"distance"in e)}function an(e){return!!(e&&"delay"in e)}class Ht{constructor(t,n,r){var s;r===void 0&&(r=Ns(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:a}=t,{target:i}=a;this.props=t,this.events=n,this.document=He(i),this.documentListeners=new st(this.document),this.listeners=new st(r),this.windowListeners=new st(q(i)),this.initialCoordinates=(s=wt(a))!=null?s:de,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ie.Resize,this.handleCancel),this.windowListeners.add(ie.DragStart,sn),this.windowListeners.add(ie.VisibilityChange,this.handleCancel),this.windowListeners.add(ie.ContextMenu,sn),this.documentListeners.add(ie.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(an(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(on(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ie.Click,Rs,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ie.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:a}=this,{onMove:i,options:{activationConstraint:c}}=a;if(!s)return;const u=(n=wt(t))!=null?n:de,d=yt(s,u);if(!r&&c){if(on(c)){if(c.tolerance!=null&&kt(d,c.tolerance))return this.handleCancel();if(kt(d,c.distance))return this.handleStart()}if(an(c)&&kt(d,c.tolerance))return this.handleCancel();this.handlePending(c,d);return}t.cancelable&&t.preventDefault(),i(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===E.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Ts={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class qt extends Ht{constructor(t){const{event:n}=t,r=He(n.target);super(t,Ts,r)}}qt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const As={move:{name:"mousemove"},end:{name:"mouseup"}};var $t;(function(e){e[e.RightClick=2]="RightClick"})($t||($t={}));class Is extends Ht{constructor(t){super(t,As,He(t.event.target))}}Is.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===$t.RightClick?!1:(r==null||r({event:n}),!0)}}];const Lt={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ms extends Ht{constructor(t){super(t,Lt)}static setup(){return window.addEventListener(Lt.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Lt.move.name,t)};function t(){}}}Ms.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var ot;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(ot||(ot={}));var Ct;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ct||(Ct={}));function Os(e){let{acceleration:t,activator:n=ot.Pointer,canScroll:r,draggingRect:s,enabled:a,interval:i=5,order:c=Ct.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:h,delta:g,threshold:x}=e;const p=Ls({delta:g,disabled:!a}),[y,v]=Vr(),m=l.useRef({x:0,y:0}),b=l.useRef({x:0,y:0}),w=l.useMemo(()=>{switch(n){case ot.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case ot.DraggableRect:return s}},[n,s,u]),C=l.useRef(null),j=l.useCallback(()=>{const N=C.current;if(!N)return;const D=m.current.x*b.current.x,S=m.current.y*b.current.y;N.scrollBy(D,S)},[]),R=l.useMemo(()=>c===Ct.TreeOrder?[...d].reverse():d,[c,d]);l.useEffect(()=>{if(!a||!d.length||!w){v();return}for(const N of R){if((r==null?void 0:r(N))===!1)continue;const D=d.indexOf(N),S=h[D];if(!S)continue;const{direction:M,speed:k}=ws(N,S,w,t,x);for(const I of["x","y"])p[I][M[I]]||(k[I]=0,M[I]=0);if(k.x>0||k.y>0){v(),C.current=N,y(j,i),m.current=k,b.current=M;return}}m.current={x:0,y:0},b.current={x:0,y:0},v()},[t,j,r,v,a,i,JSON.stringify(w),JSON.stringify(p),y,d,R,h,JSON.stringify(x)])}const ks={x:{[V.Backward]:!1,[V.Forward]:!1},y:{[V.Backward]:!1,[V.Forward]:!1}};function Ls(e){let{delta:t,disabled:n}=e;const r=bt(t);return dt(s=>{if(n||!r||!s)return ks;const a={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[V.Backward]:s.x[V.Backward]||a.x===-1,[V.Forward]:s.x[V.Forward]||a.x===1},y:{[V.Backward]:s.y[V.Backward]||a.y===-1,[V.Forward]:s.y[V.Forward]||a.y===1}}},[n,t,r])}function Ps(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return dt(s=>{var a;return t==null?null:(a=r??s)!=null?a:null},[r,t])}function zs(e,t){return l.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,a=s.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...a]},[]),[e,t])}var ct;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(ct||(ct={}));var Ut;(function(e){e.Optimized="optimized"})(Ut||(Ut={}));const ln=new Map;function Fs(e,t){let{dragging:n,dependencies:r,config:s}=t;const[a,i]=l.useState(null),{frequency:c,measure:u,strategy:d}=s,h=l.useRef(e),g=m(),x=lt(g),p=l.useCallback(function(b){b===void 0&&(b=[]),!x.current&&i(w=>w===null?b:w.concat(b.filter(C=>!w.includes(C))))},[x]),y=l.useRef(null),v=dt(b=>{if(g&&!n)return ln;if(!b||b===ln||h.current!==e||a!=null){const w=new Map;for(let C of e){if(!C)continue;if(a&&a.length>0&&!a.includes(C.id)&&C.rect.current){w.set(C.id,C.rect.current);continue}const j=C.node.current,R=j?new Wt(u(j),j):null;C.rect.current=R,R&&w.set(C.id,R)}return w}return b},[e,a,n,g,u]);return l.useEffect(()=>{h.current=e},[e]),l.useEffect(()=>{g||p()},[n,g]),l.useEffect(()=>{a&&a.length>0&&i(null)},[JSON.stringify(a)]),l.useEffect(()=>{g||typeof c!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},c))},[c,g,p,...r]),{droppableRects:v,measureDroppableContainers:p,measuringScheduled:a!=null};function m(){switch(d){case ct.Always:return!1;case ct.BeforeDragging:return n;default:return!n}}}function Gt(e,t){return dt(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Bs(e,t){return Gt(e,t)}function $s(e){let{callback:t,disabled:n}=e;const r=Nt(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:a}=window;return new a(r)},[r,n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Et(e){let{callback:t,disabled:n}=e;const r=Nt(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:a}=window;return new a(r)},[n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Us(e){return new Wt(qe(e),e)}function cn(e,t,n){t===void 0&&(t=Us);const[r,s]=l.useState(null);function a(){s(u=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=u??n)!=null?d:null}const h=t(e);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const i=$s({callback(u){if(e)for(const d of u){const{type:h,target:g}=d;if(h==="childList"&&g instanceof HTMLElement&&g.contains(e)){a();break}}}}),c=Et({callback:a});return ue(()=>{a(),e?(c==null||c.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),i==null||i.disconnect())},[e]),r}function Ys(e){const t=Gt(e);return Dn(e,t)}const un=[];function Vs(e){const t=l.useRef(e),n=dt(r=>e?r&&r!==un&&e&&t.current&&e.parentNode===t.current.parentNode?r:_t(e):un,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function Xs(e){const[t,n]=l.useState(null),r=l.useRef(e),s=l.useCallback(a=>{const i=Ot(a.target);i&&n(c=>c?(c.set(i,Bt(i)),new Map(c)):null)},[]);return l.useEffect(()=>{const a=r.current;if(e!==a){i(a);const c=e.map(u=>{const d=Ot(u);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,Bt(d)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),r.current=e}return()=>{i(e),i(a)};function i(c){c.forEach(u=>{const d=Ot(u);d==null||d.removeEventListener("scroll",s)})}},[s,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((a,i)=>_e(a,i),de):In(e):de,[e,t])}function dn(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const r=e!==de;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?yt(e,n.current):de}function Ks(e){l.useEffect(()=>{if(!jt)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function _s(e,t){return l.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:a}=r;return n[s]=i=>{a(i,t)},n},{}),[e,t])}function Ln(e){return l.useMemo(()=>e?ms(e):null,[e])}const fn=[];function Ws(e,t){t===void 0&&(t=qe);const[n]=e,r=Ln(n?q(n):null),[s,a]=l.useState(fn);function i(){a(()=>e.length?e.map(u=>Tn(u)?r:new Wt(t(u),u)):fn)}const c=Et({callback:i});return ue(()=>{c==null||c.disconnect(),i(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),s}function Pn(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return ut(t)?t:e}function Hs(e){let{measure:t}=e;const[n,r]=l.useState(null),s=l.useCallback(d=>{for(const{target:h}of d)if(ut(h)){r(g=>{const x=t(h);return g?{...g,width:x.width,height:x.height}:x});break}},[t]),a=Et({callback:s}),i=l.useCallback(d=>{const h=Pn(d);a==null||a.disconnect(),h&&(a==null||a.observe(h)),r(h?t(h):null)},[t,a]),[c,u]=xt(i);return l.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const qs=[{sensor:qt,options:{}},{sensor:kn,options:{}}],Gs={current:{}},vt={draggable:{measure:rn},droppable:{measure:rn,strategy:ct.WhileDragging,frequency:Ut.Optimized},dragOverlay:{measure:qe}};class at extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Js={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new at,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:St},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:vt,measureDroppableContainers:St,windowRect:null,measuringScheduled:!1},zn={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:St,draggableNodes:new Map,over:null,measureDroppableContainers:St},ht=l.createContext(zn),Fn=l.createContext(Js);function Qs(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new at}}}function Zs(e,t){switch(t.type){case B.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case B.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case B.DragEnd:case B.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case B.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new at(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case B.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,a=e.droppable.containers.get(n);if(!a||r!==a.key)return e;const i=new at(e.droppable.containers);return i.set(n,{...a,disabled:s}),{...e,droppable:{...e.droppable,containers:i}}}case B.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new at(e.droppable.containers);return a.delete(n),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function eo(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=l.useContext(ht),a=bt(r),i=bt(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!r&&a&&i!=null){if(!Rt(a)||document.activeElement===a.target)return;const c=s.get(i);if(!c)return;const{activatorNode:u,node:d}=c;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const h of[u.current,d.current]){if(!h)continue;const g=_r(h);if(g){g.focus();break}}})}},[r,t,s,i,a]),null}function Bn(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,a)=>a({transform:s,...r}),n):n}function to(e){return l.useMemo(()=>({draggable:{...vt.draggable,...e==null?void 0:e.draggable},droppable:{...vt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...vt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function no(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const a=l.useRef(!1),{x:i,y:c}=typeof s=="boolean"?{x:s,y:s}:s;ue(()=>{if(!i&&!c||!t){a.current=!1;return}if(a.current||!r)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const h=n(d),g=Dn(h,r);if(i||(g.x=0),c||(g.y=0),a.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const x=Nn(d);x&&x.scrollBy({top:g.y,left:g.x})}},[t,i,c,r,n])}const Tt=l.createContext({...de,scaleX:1,scaleY:1});var Te;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Te||(Te={}));const ro=l.memo(function(t){var n,r,s,a;let{id:i,accessibility:c,autoScroll:u=!0,children:d,sensors:h=qs,collisionDetection:g=ds,measuring:x,modifiers:p,...y}=t;const v=l.useReducer(Zs,void 0,Qs),[m,b]=v,[w,C]=Qr(),[j,R]=l.useState(Te.Uninitialized),N=j===Te.Initialized,{draggable:{active:D,nodes:S,translate:M},droppable:{containers:k}}=m,I=D!=null?S.get(D):null,K=l.useRef({initial:null,translated:null}),_=l.useMemo(()=>{var H;return D!=null?{id:D,data:(H=I==null?void 0:I.data)!=null?H:Gs,rect:K}:null},[D,I]),Q=l.useRef(null),[pe,ke]=l.useState(null),[$,Le]=l.useState(null),re=lt(y,Object.values(y)),U=ft("DndDescribedBy",i),ve=l.useMemo(()=>k.getEnabled(),[k]),P=to(x),{droppableRects:W,measureDroppableContainers:me,measuringScheduled:ye}=Fs(ve,{dragging:N,dependencies:[M.x,M.y],config:P.droppable}),G=Ps(S,D),Pe=l.useMemo(()=>$?wt($):null,[$]),fe=er(),ce=Bs(G,P.draggable.measure);no({activeNode:D!=null?S.get(D):null,config:fe.layoutShiftCompensation,initialRect:ce,measure:P.draggable.measure});const T=cn(G,P.draggable.measure,ce),Me=cn(G?G.parentElement:null),se=l.useRef({activatorEvent:null,active:null,activeNode:G,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:k,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),we=k.getNodeFor((n=se.current.over)==null?void 0:n.id),oe=Hs({measure:P.dragOverlay.measure}),xe=(r=oe.nodeRef.current)!=null?r:G,f=N?(s=oe.rect)!=null?s:T:null,A=!!(oe.nodeRef.current&&oe.rect),O=Ys(A?null:T),J=Ln(xe?q(xe):null),F=Vs(N?we??G:null),z=Ws(F),Z=Bn(p,{transform:{x:M.x-O.x,y:M.y-O.y,scaleX:1,scaleY:1},activatorEvent:$,active:_,activeNodeRect:T,containerNodeRect:Me,draggingNodeRect:f,over:se.current.over,overlayNodeRect:oe.rect,scrollableAncestors:F,scrollableAncestorRects:z,windowRect:J}),Ge=Pe?_e(Pe,M):null,ze=Xs(F),Wn=dn(ze),Hn=dn(ze,[T]),Fe=_e(Z,Wn),Be=f?gs(f,Z):null,Je=_&&Be?g({active:_,collisionRect:Be,droppableRects:W,droppableContainers:ve,pointerCoordinates:Ge}):null,Jt=ls(Je,"id"),[Se,Qt]=l.useState(null),qn=A?Z:_e(Z,Hn),Gn=fs(qn,(a=Se==null?void 0:Se.rect)!=null?a:null,T),At=l.useRef(null),Zt=l.useCallback((H,ee)=>{let{sensor:te,options:Ce}=ee;if(Q.current==null)return;const ae=S.get(Q.current);if(!ae)return;const ne=H.nativeEvent,he=new te({active:Q.current,activeNode:ae,event:ne,options:Ce,context:se,onAbort(X){if(!S.get(X))return;const{onDragAbort:ge}=re.current,be={id:X};ge==null||ge(be),w({type:"onDragAbort",event:be})},onPending(X,De,ge,be){if(!S.get(X))return;const{onDragPending:Ze}=re.current,je={id:X,constraint:De,initialCoordinates:ge,offset:be};Ze==null||Ze(je),w({type:"onDragPending",event:je})},onStart(X){const De=Q.current;if(De==null)return;const ge=S.get(De);if(!ge)return;const{onDragStart:be}=re.current,Qe={activatorEvent:ne,active:{id:De,data:ge.data,rect:K}};rt.unstable_batchedUpdates(()=>{be==null||be(Qe),R(Te.Initializing),b({type:B.DragStart,initialCoordinates:X,active:De}),w({type:"onDragStart",event:Qe}),ke(At.current),Le(ne)})},onMove(X){b({type:B.DragMove,coordinates:X})},onEnd:$e(B.DragEnd),onCancel:$e(B.DragCancel)});At.current=he;function $e(X){return async function(){const{active:ge,collisions:be,over:Qe,scrollAdjustedTranslate:Ze}=se.current;let je=null;if(ge&&Ze){const{cancelDrop:et}=re.current;je={activatorEvent:ne,active:ge,collisions:be,delta:Ze,over:Qe},X===B.DragEnd&&typeof et=="function"&&await Promise.resolve(et(je))&&(X=B.DragCancel)}Q.current=null,rt.unstable_batchedUpdates(()=>{b({type:X}),R(Te.Uninitialized),Qt(null),ke(null),Le(null),At.current=null;const et=X===B.DragEnd?"onDragEnd":"onDragCancel";if(je){const It=re.current[et];It==null||It(je),w({type:et,event:je})}})}}},[S]),Jn=l.useCallback((H,ee)=>(te,Ce)=>{const ae=te.nativeEvent,ne=S.get(Ce);if(Q.current!==null||!ne||ae.dndKit||ae.defaultPrevented)return;const he={active:ne};H(te,ee.options,he)===!0&&(ae.dndKit={capturedBy:ee.sensor},Q.current=Ce,Zt(te,ee))},[S,Zt]),en=zs(h,Jn);Ks(h),ue(()=>{T&&j===Te.Initializing&&R(Te.Initialized)},[T,j]),l.useEffect(()=>{const{onDragMove:H}=re.current,{active:ee,activatorEvent:te,collisions:Ce,over:ae}=se.current;if(!ee||!te)return;const ne={active:ee,activatorEvent:te,collisions:Ce,delta:{x:Fe.x,y:Fe.y},over:ae};rt.unstable_batchedUpdates(()=>{H==null||H(ne),w({type:"onDragMove",event:ne})})},[Fe.x,Fe.y]),l.useEffect(()=>{const{active:H,activatorEvent:ee,collisions:te,droppableContainers:Ce,scrollAdjustedTranslate:ae}=se.current;if(!H||Q.current==null||!ee||!ae)return;const{onDragOver:ne}=re.current,he=Ce.get(Jt),$e=he&&he.rect.current?{id:he.id,rect:he.rect.current,data:he.data,disabled:he.disabled}:null,X={active:H,activatorEvent:ee,collisions:te,delta:{x:ae.x,y:ae.y},over:$e};rt.unstable_batchedUpdates(()=>{Qt($e),ne==null||ne(X),w({type:"onDragOver",event:X})})},[Jt]),ue(()=>{se.current={activatorEvent:$,active:_,activeNode:G,collisionRect:Be,collisions:Je,droppableRects:W,draggableNodes:S,draggingNode:xe,draggingNodeRect:f,droppableContainers:k,over:Se,scrollableAncestors:F,scrollAdjustedTranslate:Fe},K.current={initial:f,translated:Be}},[_,G,Je,Be,S,xe,f,W,k,Se,F,Fe]),Os({...fe,delta:M,draggingRect:Be,pointerCoordinates:Ge,scrollableAncestors:F,scrollableAncestorRects:z});const Qn=l.useMemo(()=>({active:_,activeNode:G,activeNodeRect:T,activatorEvent:$,collisions:Je,containerNodeRect:Me,dragOverlay:oe,draggableNodes:S,droppableContainers:k,droppableRects:W,over:Se,measureDroppableContainers:me,scrollableAncestors:F,scrollableAncestorRects:z,measuringConfiguration:P,measuringScheduled:ye,windowRect:J}),[_,G,T,$,Je,Me,oe,S,k,W,Se,me,F,z,P,ye,J]),Zn=l.useMemo(()=>({activatorEvent:$,activators:en,active:_,activeNodeRect:T,ariaDescribedById:{draggable:U},dispatch:b,draggableNodes:S,over:Se,measureDroppableContainers:me}),[$,en,_,T,b,U,S,Se,me]);return L.createElement(Cn.Provider,{value:C},L.createElement(ht.Provider,{value:Zn},L.createElement(Fn.Provider,{value:Qn},L.createElement(Tt.Provider,{value:Gn},d)),L.createElement(eo,{disabled:(c==null?void 0:c.restoreFocus)===!1})),L.createElement(ts,{...c,hiddenTextDescribedById:U}));function er(){const H=(pe==null?void 0:pe.autoScrollEnabled)===!1,ee=typeof u=="object"?u.enabled===!1:u===!1,te=N&&!H&&!ee;return typeof u=="object"?{...u,enabled:te}:{enabled:te}}}),so=l.createContext(null),hn="button",oo="Draggable";function ao(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const a=ft(oo),{activators:i,activatorEvent:c,active:u,activeNodeRect:d,ariaDescribedById:h,draggableNodes:g,over:x}=l.useContext(ht),{role:p=hn,roleDescription:y="draggable",tabIndex:v=0}=s??{},m=(u==null?void 0:u.id)===t,b=l.useContext(m?Tt:so),[w,C]=xt(),[j,R]=xt(),N=_s(i,t),D=lt(n);ue(()=>(g.set(t,{id:t,key:a,node:w,activatorNode:j,data:D}),()=>{const M=g.get(t);M&&M.key===a&&g.delete(t)}),[g,t]);const S=l.useMemo(()=>({role:p,tabIndex:v,"aria-disabled":r,"aria-pressed":m&&p===hn?!0:void 0,"aria-roledescription":y,"aria-describedby":h.draggable}),[r,p,v,m,y,h.draggable]);return{active:u,activatorEvent:c,activeNodeRect:d,attributes:S,isDragging:m,listeners:r?void 0:N,node:w,over:x,setNodeRef:C,setActivatorNodeRef:R,transform:b}}function $n(){return l.useContext(Fn)}const io="Droppable",lo={timeout:25};function Un(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const a=ft(io),{active:i,dispatch:c,over:u,measureDroppableContainers:d}=l.useContext(ht),h=l.useRef({disabled:n}),g=l.useRef(!1),x=l.useRef(null),p=l.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:m}={...lo,...s},b=lt(v??r),w=l.useCallback(()=>{if(!g.current){g.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),p.current=null},m)},[m]),C=Et({callback:w,disabled:y||!i}),j=l.useCallback((S,M)=>{C&&(M&&(C.unobserve(M),g.current=!1),S&&C.observe(S))},[C]),[R,N]=xt(j),D=lt(t);return l.useEffect(()=>{!C||!R.current||(C.disconnect(),g.current=!1,C.observe(R.current))},[R,C]),l.useEffect(()=>(c({type:B.RegisterDroppable,element:{id:r,key:a,disabled:n,node:R,rect:x,data:D}}),()=>c({type:B.UnregisterDroppable,key:a,id:r})),[r]),l.useEffect(()=>{n!==h.current.disabled&&(c({type:B.SetDroppableDisabled,id:r,key:a,disabled:n}),h.current.disabled=n)},[r,a,n,c]),{active:i,rect:x,isOver:(u==null?void 0:u.id)===r,node:R,over:u,setNodeRef:N}}function co(e){let{animation:t,children:n}=e;const[r,s]=l.useState(null),[a,i]=l.useState(null),c=bt(n);return!n&&!r&&c&&s(c),ue(()=>{if(!a)return;const u=r==null?void 0:r.key,d=r==null?void 0:r.props.id;if(u==null||d==null){s(null);return}Promise.resolve(t(d,a)).then(()=>{s(null)})},[t,r,a]),L.createElement(L.Fragment,null,n,r?l.cloneElement(r,{ref:i}):null)}const uo={x:0,y:0,scaleX:1,scaleY:1};function fo(e){let{children:t}=e;return L.createElement(ht.Provider,{value:zn},L.createElement(Tt.Provider,{value:uo},t))}const ho={position:"fixed",touchAction:"none"},go=e=>Rt(e)?"transform 250ms ease":void 0,po=l.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:s,children:a,className:i,rect:c,style:u,transform:d,transition:h=go}=e;if(!c)return null;const g=s?d:{...d,scaleX:1,scaleY:1},x={...ho,width:c.width,height:c.height,top:c.top,left:c.left,transform:Ie.Transform.toString(g),transformOrigin:s&&r?os(r,c):void 0,transition:typeof h=="function"?h(r):h,...u};return L.createElement(n,{className:i,style:x,ref:t},a)}),vo=e=>t=>{let{active:n,dragOverlay:r}=t;const s={},{styles:a,className:i}=e;if(a!=null&&a.active)for(const[c,u]of Object.entries(a.active))u!==void 0&&(s[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,u));if(a!=null&&a.dragOverlay)for(const[c,u]of Object.entries(a.dragOverlay))u!==void 0&&r.node.style.setProperty(c,u);return i!=null&&i.active&&n.node.classList.add(i.active),i!=null&&i.dragOverlay&&r.node.classList.add(i.dragOverlay),function(){for(const[u,d]of Object.entries(s))n.node.style.setProperty(u,d);i!=null&&i.active&&n.node.classList.remove(i.active)}},mo=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Ie.Transform.toString(t)},{transform:Ie.Transform.toString(n)}]},xo={duration:250,easing:"ease",keyframes:mo,sideEffects:vo({styles:{active:{opacity:"0"}}})};function bo(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:s}=e;return Nt((a,i)=>{if(t===null)return;const c=n.get(a);if(!c)return;const u=c.node.current;if(!u)return;const d=Pn(i);if(!d)return;const{transform:h}=q(i).getComputedStyle(i),g=jn(h);if(!g)return;const x=typeof t=="function"?t:yo(t);return Mn(u,s.draggable.measure),x({active:{id:a,data:c.data,node:u,rect:s.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:i,rect:s.dragOverlay.measure(d)},droppableContainers:r,measuringConfiguration:s,transform:g})})}function yo(e){const{duration:t,easing:n,sideEffects:r,keyframes:s}={...xo,...e};return a=>{let{active:i,dragOverlay:c,transform:u,...d}=a;if(!t)return;const h={x:c.rect.left-i.rect.left,y:c.rect.top-i.rect.top},g={scaleX:u.scaleX!==1?i.rect.width*u.scaleX/c.rect.width:1,scaleY:u.scaleY!==1?i.rect.height*u.scaleY/c.rect.height:1},x={x:u.x-h.x,y:u.y-h.y,...g},p=s({...d,active:i,dragOverlay:c,transform:{initial:u,final:x}}),[y]=p,v=p[p.length-1];if(JSON.stringify(y)===JSON.stringify(v))return;const m=r==null?void 0:r({active:i,dragOverlay:c,...d}),b=c.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{b.onfinish=()=>{m==null||m(),w()}})}}let gn=0;function wo(e){return l.useMemo(()=>{if(e!=null)return gn++,gn},[e])}const So=L.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:s,transition:a,modifiers:i,wrapperElement:c="div",className:u,zIndex:d=999}=e;const{activatorEvent:h,active:g,activeNodeRect:x,containerNodeRect:p,draggableNodes:y,droppableContainers:v,dragOverlay:m,over:b,measuringConfiguration:w,scrollableAncestors:C,scrollableAncestorRects:j,windowRect:R}=$n(),N=l.useContext(Tt),D=wo(g==null?void 0:g.id),S=Bn(i,{activatorEvent:h,active:g,activeNodeRect:x,containerNodeRect:p,draggingNodeRect:m.rect,over:b,overlayNodeRect:m.rect,scrollableAncestors:C,scrollableAncestorRects:j,transform:N,windowRect:R}),M=Gt(x),k=bo({config:r,draggableNodes:y,droppableContainers:v,measuringConfiguration:w}),I=M?m.setRef:void 0;return L.createElement(fo,null,L.createElement(co,{animation:k},g&&D?L.createElement(po,{key:D,id:g.id,ref:I,as:c,activatorEvent:h,adjustScale:t,className:u,transition:a,rect:M,style:{zIndex:d,...s},transform:S},n):null))});function Yn(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Co(e,t){return e.reduce((n,r,s)=>{const a=t.get(r);return a&&(n[s]=a),n},Array(e.length))}function gt(e){return e!==null&&e>=0}function Do(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function jo(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Vn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const a=Yn(t,r,n),i=t[s],c=a[s];return!c||!i?null:{x:c.left-i.left,y:c.top-i.top,scaleX:c.width/i.width,scaleY:c.height/i.height}},pt={scaleX:1,scaleY:1},No=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:a,overIndex:i}=e;const c=(t=a[n])!=null?t:r;if(!c)return null;if(s===n){const d=a[i];return d?{x:0,y:n<i?d.top+d.height-(c.top+c.height):d.top-c.top,...pt}:null}const u=Ro(a,s,n);return s>n&&s<=i?{x:0,y:-c.height-u,...pt}:s<n&&s>=i?{x:0,y:c.height+u,...pt}:{x:0,y:0,...pt}};function Ro(e,t,n){const r=e[t],s=e[t-1],a=e[t+1];return r?n<t?s?r.top-(s.top+s.height):a?a.top-(r.top+r.height):0:a?a.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Xn="Sortable",Kn=L.createContext({activeIndex:-1,containerId:Xn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Vn,disabled:{draggable:!1,droppable:!1}});function Eo(e){let{children:t,id:n,items:r,strategy:s=Vn,disabled:a=!1}=e;const{active:i,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:h}=$n(),g=ft(Xn,n),x=c.rect!==null,p=l.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),y=i!=null,v=i?p.indexOf(i.id):-1,m=d?p.indexOf(d.id):-1,b=l.useRef(p),w=!Do(p,b.current),C=m!==-1&&v===-1||w,j=jo(a);ue(()=>{w&&y&&h(p)},[w,p,y,h]),l.useEffect(()=>{b.current=p},[p]);const R=l.useMemo(()=>({activeIndex:v,containerId:g,disabled:j,disableTransforms:C,items:p,overIndex:m,useDragOverlay:x,sortedRects:Co(p,u),strategy:s}),[v,g,j.draggable,j.droppable,C,p,m,u,x,s]);return L.createElement(Kn.Provider,{value:R},t)}const To=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Yn(n,r,s).indexOf(t)},Ao=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:a,newIndex:i,previousItems:c,previousContainerId:u,transition:d}=e;return!d||!r||c!==a&&s===i?!1:n?!0:i!==s&&t===u},Io={duration:200,easing:"ease"},_n="transform",Mo=Ie.Transition.toString({property:_n,duration:0,easing:"linear"}),Oo={roleDescription:"sortable"};function ko(e){let{disabled:t,index:n,node:r,rect:s}=e;const[a,i]=l.useState(null),c=l.useRef(n);return ue(()=>{if(!t&&n!==c.current&&r.current){const u=s.current;if(u){const d=qe(r.current,{ignoreTransform:!0}),h={x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height};(h.x||h.y)&&i(h)}}n!==c.current&&(c.current=n)},[t,n,r,s]),l.useEffect(()=>{a&&i(null)},[a]),a}function Lo(e){let{animateLayoutChanges:t=Ao,attributes:n,disabled:r,data:s,getNewIndex:a=To,id:i,strategy:c,resizeObserverConfig:u,transition:d=Io}=e;const{items:h,containerId:g,activeIndex:x,disabled:p,disableTransforms:y,sortedRects:v,overIndex:m,useDragOverlay:b,strategy:w}=l.useContext(Kn),C=Po(r,p),j=h.indexOf(i),R=l.useMemo(()=>({sortable:{containerId:g,index:j,items:h},...s}),[g,s,j,h]),N=l.useMemo(()=>h.slice(h.indexOf(i)),[h,i]),{rect:D,node:S,isOver:M,setNodeRef:k}=Un({id:i,data:R,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...u}}),{active:I,activatorEvent:K,activeNodeRect:_,attributes:Q,setNodeRef:pe,listeners:ke,isDragging:$,over:Le,setActivatorNodeRef:re,transform:U}=ao({id:i,data:R,attributes:{...Oo,...n},disabled:C.draggable}),ve=Yr(k,pe),P=!!I,W=P&&!y&&gt(x)&&gt(m),me=!b&&$,ye=me&&W?U:null,Pe=W?ye??(c??w)({rects:v,activeNodeRect:_,activeIndex:x,overIndex:m,index:j}):null,fe=gt(x)&&gt(m)?a({id:i,items:h,activeIndex:x,overIndex:m}):j,ce=I==null?void 0:I.id,T=l.useRef({activeId:ce,items:h,newIndex:fe,containerId:g}),Me=h!==T.current.items,se=t({active:I,containerId:g,isDragging:$,isSorting:P,id:i,index:j,items:h,newIndex:T.current.newIndex,previousItems:T.current.items,previousContainerId:T.current.containerId,transition:d,wasDragging:T.current.activeId!=null}),we=ko({disabled:!se,index:j,node:S,rect:D});return l.useEffect(()=>{P&&T.current.newIndex!==fe&&(T.current.newIndex=fe),g!==T.current.containerId&&(T.current.containerId=g),h!==T.current.items&&(T.current.items=h)},[P,fe,g,h]),l.useEffect(()=>{if(ce===T.current.activeId)return;if(ce!=null&&T.current.activeId==null){T.current.activeId=ce;return}const xe=setTimeout(()=>{T.current.activeId=ce},50);return()=>clearTimeout(xe)},[ce]),{active:I,activeIndex:x,attributes:Q,data:R,rect:D,index:j,newIndex:fe,items:h,isOver:M,isSorting:P,isDragging:$,listeners:ke,node:S,overIndex:m,over:Le,setNodeRef:ve,setActivatorNodeRef:re,setDroppableNodeRef:k,setDraggableNodeRef:pe,transform:we??Pe,transition:oe()};function oe(){if(we||Me&&T.current.newIndex===j)return Mo;if(!(me&&!Rt(K)||!d)&&(P||se))return Ie.Transition.toString({...d,property:_n})}}function Po(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}E.Down,E.Right,E.Up,E.Left;const pn=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"title",label:"Título (A → Z)"},{value:"status",label:"Status"}],vn={"A fazer":0,"Em andamento":1,Concluído:2},nt=["A fazer","Em andamento","Concluído"];function zo(e,t){return[...e].sort((n,r)=>{switch(t){case"deadline":return!n.dueDate&&!r.dueDate?0:n.dueDate?r.dueDate?n.dueDate.localeCompare(r.dueDate):-1:1;case"title":return n.title.localeCompare(r.title,"pt-BR");case"status":return(vn[n.status]??0)-(vn[r.status]??0);default:return 0}})}function Fo({id:e,children:t}){const{attributes:n,listeners:r,setNodeRef:s,transform:a,transition:i,isDragging:c}=Lo({id:e}),u={transform:Ie.Transform.toString(a),transition:i};return o.jsx("div",{ref:s,style:u,...n,...r,className:le("touch-none",c&&"opacity-30"),children:t})}function Bo({status:e,isOver:t,items:n,itemIds:r,today:s,onEdit:a,onDelete:i}){const{setNodeRef:c}=Un({id:e});return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx(mt,{variant:"secondary",className:Vt[e],children:it[e]}),o.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n.length,")"]})]}),o.jsx("div",{ref:c,"data-column-status":e,className:le("space-y-3 min-h-[400px] p-2 rounded-lg transition-colors duration-150",t?"bg-primary/10 border-2 border-dashed border-primary/40":"bg-muted/30 border-2 border-transparent"),children:o.jsx(Eo,{items:r,strategy:No,children:n.length===0?o.jsx("p",{className:le("text-xs text-center py-8 transition-colors",t?"text-primary font-medium":"text-muted-foreground"),children:t?"↓ Soltar aqui":"Vazio"}):n.map(u=>o.jsx(Fo,{id:u.id,children:o.jsx(Yt,{sub:u,today:s,onEdit:()=>a(u),onDelete:()=>i(u.id)})},u.id))})})]})}const Yt=l.memo(function({sub:t,today:n,showStatus:r,onEdit:s,onDelete:a}){const i=t.dueDate&&t.dueDate<n&&t.status!=="Concluído";return o.jsx(zt,{className:le("transition-shadow duration-150",i&&"border-destructive/50"),children:o.jsx(Ft,{className:"p-3",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[r&&o.jsx(mt,{variant:"secondary",className:le("text-[10px]",Vt[t.status]),children:it[t.status]}),i&&o.jsx(mt,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),o.jsx("p",{className:le("font-medium text-sm",t.completed&&"line-through text-muted-foreground"),children:t.title}),o.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[o.jsx("span",{className:"font-medium",children:"Tarefa:"})," ",t.parentTaskTitle]}),o.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[t.projectName&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(mn,{className:"w-3 h-3"}),t.projectName]}),t.assignee&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(Or,{className:"w-3 h-3"}),t.assignee]}),t.dueDate&&o.jsxs("span",{className:le("flex items-center gap-1",i&&"text-destructive font-medium"),children:[o.jsx(kr,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]}),t.notes&&o.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.notes})]}),o.jsxs("div",{className:"flex gap-1 shrink-0",children:[o.jsx(Ae,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:s,children:o.jsx(Lr,{className:"w-3.5 h-3.5"})}),o.jsx(Ae,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:a,children:o.jsx(Pr,{className:"w-3.5 h-3.5"})})]})]})})})});function fa({tasks:e,projects:t,loading:n,onCreateSubtask:r,onUpdateSubtask:s,onDeleteSubtask:a}){var xe;const[i,c]=l.useState(!1),[u,d]=l.useState(null),[h,g]=l.useState("kanban"),[x,p]=l.useState(""),[y,v]=l.useState("all"),[m,b]=l.useState("all"),[w,C]=l.useState("all"),[j,R]=l.useState("all"),[N,D]=l.useState("all"),[S,M]=l.useState("deadline"),[k,I]=l.useState(!1),[K,_]=l.useState(null),[Q,pe]=l.useState(null),[ke,$]=l.useState(null),Le=rs(ns(qt,{activationConstraint:{distance:8}})),re=l.useMemo(()=>{const f={};return t.forEach(A=>{f[A.id]=A.name}),f},[t]),U=l.useMemo(()=>e.flatMap(f=>f.subtasks.map(A=>({...A,parentTaskTitle:f.title,projectId:f.projectId,projectName:f.projectId?re[f.projectId]:void 0}))),[e,re]),ve=l.useMemo(()=>{const f=new Date,A=new Date(f.getFullYear(),f.getMonth(),f.getDate()),O=new Date(A);O.setDate(A.getDate()+(7-A.getDay()));const J=new Date(f.getFullYear(),f.getMonth()+1,0),F=U.filter(z=>{if(x&&!z.title.toLowerCase().includes(x.toLowerCase())||y!=="all"&&z.status!==y||m!=="all"&&z.assignee!==m||w!=="all"&&z.projectId!==w||j!=="all"&&z.parentTaskId!==j)return!1;if(N!=="all"){if(!z.dueDate)return N==="sem_prazo";const Z=new Date(z.dueDate+"T23:59:59");switch(N){case"atrasadas":return Z<A&&z.status!=="Concluído";case"hoje":return z.dueDate===P;case"esta_semana":return Z>=A&&Z<=O;case"este_mes":return Z>=A&&Z<=J;case"sem_prazo":return!1}}return!0});return zo(F,S)},[U,x,y,m,w,j,S]),P=l.useMemo(()=>{const f=new Date;return`${f.getFullYear()}-${String(f.getMonth()+1).padStart(2,"0")}-${String(f.getDate()).padStart(2,"0")}`},[]),W=l.useMemo(()=>{const f={"A fazer":0,"Em andamento":0,Concluído:0},A=U.filter(O=>O.dueDate&&O.dueDate<P&&O.status!=="Concluído").length;return U.forEach(O=>{f[O.status]!==void 0&&f[O.status]++}),{...f,overdue:A,total:U.length}},[U,P]),me=l.useCallback(()=>{d(null),c(!0)},[]),ye=l.useCallback(f=>{d(f),c(!0)},[]),G=l.useCallback(async(f,A,O)=>{A?await r(f.parentTaskId,{title:f.title,deadline:f.deadline||void 0,status:f.status,assignee:f.assignee||void 0,notes:f.notes||void 0}):O&&await s(O,{title:f.title,deadline:f.deadline||void 0,status:f.status,assignee:f.assignee||void 0,notes:f.notes||void 0})},[r,s]),Pe=l.useCallback(async()=>{K&&(await a(K),_(null))},[K,a]),fe=l.useMemo(()=>{const f={"A fazer":[],"Em andamento":[],Concluído:[]};return ve.forEach(A=>{f[A.status]&&f[A.status].push(A)}),f},[ve]),ce=y!=="all"||m!=="all"||w!=="all"||j!=="all"||N!=="all"||x,T=l.useCallback(f=>{pe(String(f.active.id))},[]),Me=l.useCallback(f=>{const{over:A}=f;if(!A){$(null);return}const O=String(A.id),J=U.find(z=>z.id===O),F=J?J.status:nt.includes(O)?O:null;$(F)},[U]),se=l.useCallback(async f=>{const{active:A,over:O}=f;if(pe(null),$(null),!O)return;const J=String(A.id),F=String(O.id);if(J===F)return;const z=U.find(ze=>ze.id===J);if(!z)return;const Z=U.find(ze=>ze.id===F),Ge=Z?Z.status:nt.includes(F)?F:z.status;z.status!==Ge&&await s(J,{status:Ge})},[U,s]),we=l.useCallback(()=>{pe(null),$(null)},[]),oe=Q?U.find(f=>f.id===Q):null;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-border bg-card p-2.5",children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-md bg-muted",children:o.jsx($o,{className:"w-4 h-4 text-muted-foreground"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-lg font-bold leading-none",children:W.total}),o.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Total"})]})]}),nt.map(f=>o.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-border bg-card p-2.5",children:[o.jsx(mt,{variant:"secondary",className:le("text-[10px] shrink-0",Vt[f]),children:W[f]}),o.jsx("p",{className:"text-xs text-muted-foreground truncate",children:it[f]})]},f))]}),W.overdue>0&&o.jsxs("div",{className:"flex items-center gap-2 p-2.5 mb-4 rounded-lg bg-destructive/10 border border-destructive/20",children:[o.jsx(Ar,{className:"w-4 h-4 text-destructive shrink-0"}),o.jsxs("p",{className:"text-xs font-medium text-destructive",children:[W.overdue," subtarefa",W.overdue>1?"s":""," atrasada",W.overdue>1?"s":""]})]}),o.jsxs("div",{className:"flex flex-col gap-3 mb-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[o.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[o.jsx(bn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),o.jsx(Pt,{placeholder:"Buscar subtarefa...",value:x,onChange:f=>p(f.target.value),className:"pl-9 w-full text-sm"})]}),o.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[o.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[o.jsx(Ae,{variant:h==="list"?"default":"ghost",size:"sm",onClick:()=>g("list"),className:"rounded-none",children:o.jsx(Ir,{className:"w-4 h-4"})}),o.jsx(Ae,{variant:h==="kanban"?"default":"ghost",size:"sm",onClick:()=>g("kanban"),className:"rounded-none",children:o.jsx(yn,{className:"w-4 h-4"})})]}),h==="kanban"&&o.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-muted-foreground cursor-pointer select-none",children:[o.jsx(Tr,{checked:k,onCheckedChange:I,className:"scale-75"}),"Ocultar concluídas"]}),o.jsxs(Ae,{size:"sm",onClick:me,className:"gap-1.5",children:[o.jsx(dr,{className:"w-4 h-4"})," Nova Subtarefa"]})]})]}),o.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[o.jsxs(Ne,{value:y,onValueChange:v,children:[o.jsx(Re,{className:"w-[130px] h-8 text-xs",children:o.jsx(Oe,{placeholder:"Status"})}),o.jsxs(Ee,{children:[o.jsx(Y,{value:"all",children:"Todos"}),nt.map(f=>o.jsx(Y,{value:f,children:it[f]},f))]})]}),o.jsxs(Ne,{value:m,onValueChange:b,children:[o.jsx(Re,{className:"w-[140px] h-8 text-xs",children:o.jsx(Oe,{placeholder:"Responsável"})}),o.jsxs(Ee,{children:[o.jsx(Y,{value:"all",children:"Todos"}),xn.map(f=>o.jsx(Y,{value:f,children:f},f))]})]}),o.jsxs(Ne,{value:w,onValueChange:C,children:[o.jsxs(Re,{className:"w-[150px] h-8 text-xs",children:[o.jsx(mn,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),o.jsx(Oe,{placeholder:"Projeto"})]}),o.jsxs(Ee,{children:[o.jsx(Y,{value:"all",children:"Todos"}),t.map(f=>o.jsx(Y,{value:f.id,children:f.name},f.id))]})]}),o.jsxs(Ne,{value:j,onValueChange:R,children:[o.jsx(Re,{className:"w-[160px] h-8 text-xs",children:o.jsx(Oe,{placeholder:"Tarefa-mãe"})}),o.jsxs(Ee,{children:[o.jsx(Y,{value:"all",children:"Todas"}),e.map(f=>o.jsx(Y,{value:f.id,children:f.title},f.id))]})]}),o.jsxs(Ne,{value:N,onValueChange:D,children:[o.jsxs(Re,{className:"w-[140px] h-8 text-xs",children:[o.jsx(Mr,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),o.jsx(Oe,{placeholder:"Período"})]}),o.jsxs(Ee,{children:[o.jsx(Y,{value:"all",children:"Todos"}),o.jsx(Y,{value:"atrasadas",children:"Atrasadas"}),o.jsx(Y,{value:"hoje",children:"Vence hoje"}),o.jsx(Y,{value:"esta_semana",children:"Esta semana"}),o.jsx(Y,{value:"este_mes",children:"Este mês"}),o.jsx(Y,{value:"sem_prazo",children:"Sem prazo"})]})]}),o.jsxs(Ne,{value:S,onValueChange:f=>M(f),children:[o.jsxs(Re,{className:"w-[44px] sm:w-[170px] h-8 text-xs gap-1.5",children:[o.jsx(zr,{className:"w-3.5 h-3.5 shrink-0 text-muted-foreground"}),o.jsx("span",{className:"hidden sm:inline truncate",children:(xe=pn.find(f=>f.value===S))==null?void 0:xe.label})]}),o.jsx(Ee,{children:pn.map(f=>o.jsx(Y,{value:f.value,children:f.label},f.value))})]}),ce&&o.jsx(Ae,{variant:"ghost",size:"sm",onClick:()=>{v("all"),b("all"),C("all"),R("all"),D("all"),p("")},className:"text-xs gap-1 h-8",children:"✕ Limpar"})]})]}),o.jsx(Ur,{open:i,onOpenChange:c,subtask:u,tasks:e,onSave:G}),o.jsx(wr,{open:!!K,onOpenChange:f=>!f&&_(null),children:o.jsxs(Sr,{children:[o.jsxs(Cr,{children:[o.jsx(Dr,{children:"Remover subtarefa?"}),o.jsx(jr,{children:"Esta ação não pode ser desfeita. A subtarefa será removida permanentemente."})]}),o.jsxs(Nr,{children:[o.jsx(Rr,{children:"Cancelar"}),o.jsx(Er,{onClick:Pe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?o.jsx("div",{className:"space-y-3",children:[1,2,3].map(f=>o.jsx(zt,{children:o.jsx(Ft,{className:"p-4",children:o.jsx("div",{className:"h-16 bg-muted animate-pulse rounded"})})},f))}):h==="list"?o.jsx("div",{className:"space-y-3",children:ve.length===0?o.jsx(zt,{children:o.jsx(Ft,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma subtarefa encontrada."})}):ve.map(f=>o.jsx(Yt,{sub:f,today:P,showStatus:!0,onEdit:()=>ye(f),onDelete:()=>_(f.id)},f.id))}):o.jsxs(ro,{sensors:Le,collisionDetection:cs,onDragStart:T,onDragOver:Me,onDragEnd:se,onDragCancel:we,children:[o.jsx("div",{className:le("grid gap-4",k?"grid-cols-1 sm:grid-cols-2":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"),children:nt.filter(f=>!k||f!=="Concluído").map(f=>{const A=ke===f,O=fe[f],J=O.map(F=>F.id);return o.jsx(Bo,{status:f,isOver:A,items:O,itemIds:J,today:P,onEdit:ye,onDelete:_},f)})}),o.jsx(So,{children:oe&&o.jsx("div",{className:"shadow-xl ring-2 ring-primary/30 rotate-[2deg] scale-105",children:o.jsx(Yt,{sub:oe,today:P,showStatus:!0,onEdit:()=>{},onDelete:()=>{}})})})]})]})}function $o({className:e}){return o.jsx(yn,{className:e})}export{zr as A,yn as C,ro as D,da as G,qt as P,fa as S,ns as a,So as b,cs as c,Un as d,Eo as e,Lo as f,Ie as g,rs as u,No as v};
