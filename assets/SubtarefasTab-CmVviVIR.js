import{c as it,r as l,j as a,e as ce,l as er,Z as P,f as tt}from"./index-Bs5i4_Nx.js";import{u as tr,F as nr,a as Ue,b as Ve,c as Xe,d as Ye,e as Ke,t as rr}from"./form-CGE2muSX.js";import{S as sr,a as or,b as ar,c as ir,f as lr,g as cr,P as ur,F as vn,B as kt}from"./AdminLayout-ByII4lUl.js";import{I as Lt}from"./input-BcLYvidQ.js";import{B as Ee}from"./button-ChJCpspy.js";import{T as dr}from"./textarea-DLQn4WKq.js";import{S as De,a as je,b as Oe,d as Ne,e as U}from"./select-B_mHtC95.js";import{P as fr,a as hr,b as gr}from"./popover-D4DHjAto.js";import{f as mn,S as St,g as xn}from"./crmTypes-DtRnJ06N.js";import{S as bn}from"./search-BjXta-JZ.js";import{C as pr}from"./check-CzuXt9it.js";import{U as vr}from"./separator-SwlziCGR.js";import{L as mr}from"./loader-circle-Bz0xf6ed.js";import{o as xr,s as et,e as br}from"./types-C9wiu8_K.js";import{C as Pt,c as zt}from"./card-AyMiqbzp.js";import{A as yr,a as wr,b as Sr,c as Cr,d as Dr,e as jr,f as Nr,g as Rr}from"./alert-dialog-BnjI_G-Q.js";import{S as Er}from"./checkbox-C407UXCm.js";import{L as Tr}from"./list-Cur1itsJ.js";import{C as Ar}from"./clock-3bKzHeRl.js";import{U as Mr}from"./users-Bw0Cefm6.js";import{C as Ir}from"./calendar-0iDMRsGj.js";import{P as Or}from"./pencil-VEf_QGPL.js";import{T as kr}from"./trash-2-CnHe4Ncs.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=it("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=it("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=it("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=it("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=it("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),Fr=xr({title:et().trim().min(1,"Título obrigatório").max(200),parentTaskId:et().min(1,"Tarefa-mãe obrigatória"),deadline:et().optional(),status:br(["A fazer","Em andamento","Concluído"]),assignee:et().optional(),notes:et().max(2e3).optional()}),Br=Object.entries(St);function $r({open:e,onOpenChange:t,subtask:n,tasks:r,onSave:s}){const o=!n,[i,c]=l.useState(!1),[u,d]=l.useState(""),[f,g]=l.useState(!1),x=l.useMemo(()=>{if(!u.trim())return r;const v=u.toLowerCase();return r.filter(m=>m.title.toLowerCase().includes(v))},[r,u]),p=tr({resolver:rr(Fr),defaultValues:{title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}});l.useEffect(()=>{e&&(n?p.reset({title:n.title,parentTaskId:n.parentTaskId,deadline:n.dueDate??"",status:n.status,assignee:n.assignee??"",notes:n.notes??""}):p.reset({title:"",parentTaskId:"",deadline:"",status:"A fazer",assignee:"",notes:""}))},[e,n]);const y=async v=>{c(!0);try{await s(v,o,n==null?void 0:n.id),t(!1)}catch(m){er.error("Erro ao salvar subtarefa: "+m.message),console.error("Erro ao salvar subtarefa:",m)}finally{c(!1)}};return a.jsx(sr,{open:e,onOpenChange:t,children:a.jsxs(or,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[a.jsxs(ar,{className:"mb-6",children:[a.jsx(ir,{children:o?"Nova Subtarefa":"Editar Subtarefa"}),a.jsx(lr,{children:o?"Preencha os dados e selecione a tarefa-mãe relacionada.":"Altere os campos e salve."})]}),a.jsx(nr,{...p,children:a.jsxs("form",{onSubmit:p.handleSubmit(y),className:"space-y-5",children:[a.jsx(Ue,{control:p.control,name:"title",render:({field:v})=>a.jsxs(Ve,{children:[a.jsx(Xe,{children:"Título *"}),a.jsx(Ye,{children:a.jsx(Lt,{placeholder:"Ex: Enviar documento",...v})}),a.jsx(Ke,{})]})}),a.jsx(Ue,{control:p.control,name:"parentTaskId",render:({field:v})=>{var m;return a.jsxs(Ve,{className:"flex flex-col",children:[a.jsx(Xe,{children:"Tarefa-mãe *"}),a.jsxs(fr,{open:f,onOpenChange:g,children:[a.jsx(hr,{asChild:!0,children:a.jsx(Ye,{children:a.jsxs(Ee,{variant:"outline",role:"combobox",className:ce("w-full justify-between font-normal",!v.value&&"text-muted-foreground"),children:[a.jsx("span",{className:"truncate",children:v.value?((m=r.find(b=>b.id===v.value))==null?void 0:m.title)??"Tarefa não encontrada":"Selecione a tarefa-mãe..."}),a.jsx(Pr,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})})}),a.jsxs(gr,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:[a.jsxs("div",{className:"flex items-center border-b px-3",children:[a.jsx(bn,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),a.jsx("input",{className:"flex h-10 w-full bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground",placeholder:"Buscar tarefa...",value:u,onChange:b=>d(b.target.value)})]}),a.jsx("div",{className:"max-h-[200px] overflow-y-auto p-1",children:x.length===0?a.jsx("p",{className:"py-4 text-center text-sm text-muted-foreground",children:"Nenhuma tarefa encontrada."}):x.map(b=>a.jsxs("button",{type:"button",className:ce("relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",v.value===b.id&&"bg-accent"),onClick:()=>{v.onChange(b.id),g(!1),d("")},children:[a.jsx(pr,{className:ce("mr-2 h-4 w-4",v.value===b.id?"opacity-100":"opacity-0")}),a.jsx("span",{className:"truncate",children:b.title})]},b.id))})]})]}),a.jsx(Ke,{})]})}}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsx(Ue,{control:p.control,name:"deadline",render:({field:v})=>a.jsxs(Ve,{children:[a.jsx(Xe,{children:"Prazo"}),a.jsx(Ye,{children:a.jsx(Lt,{type:"date",...v})}),a.jsx(Ke,{})]})}),a.jsx(Ue,{control:p.control,name:"status",render:({field:v})=>a.jsxs(Ve,{children:[a.jsx(Xe,{children:"Status"}),a.jsxs(De,{onValueChange:v.onChange,value:v.value,children:[a.jsx(Ye,{children:a.jsx(je,{children:a.jsx(Oe,{})})}),a.jsx(Ne,{children:Br.map(([m,b])=>a.jsx(U,{value:m,children:b},m))})]}),a.jsx(Ke,{})]})})]}),a.jsx(Ue,{control:p.control,name:"assignee",render:({field:v})=>a.jsxs(Ve,{children:[a.jsx(Xe,{children:"Responsável"}),a.jsxs(De,{onValueChange:m=>v.onChange(m==="_none_"?"":m),value:v.value||"_none_",children:[a.jsx(Ye,{children:a.jsx(je,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(vr,{className:"w-3.5 h-3.5 text-muted-foreground"}),a.jsx(Oe,{placeholder:"Responsável..."})]})})}),a.jsxs(Ne,{children:[a.jsx(U,{value:"_none_",children:"— Sem responsável —"}),mn.map(m=>a.jsx(U,{value:m,children:m},m))]})]}),a.jsx(Ke,{})]})}),a.jsx(Ue,{control:p.control,name:"notes",render:({field:v})=>a.jsxs(Ve,{children:[a.jsx(Xe,{children:"Observações"}),a.jsx(Ye,{children:a.jsx(dr,{placeholder:"Observações...",className:"resize-none min-h-[80px]",...v})}),a.jsx(Ke,{})]})}),a.jsx(cr,{children:a.jsxs(Ee,{type:"submit",disabled:i,className:"w-full",children:[i&&a.jsx(mr,{className:"w-4 h-4 mr-2 animate-spin"}),o?"Criar Subtarefa":"Salvar Alterações"]})})]})})]})})}function Ur(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const Ct=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function He(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Vt(e){return"nodeType"in e}function H(e){var t,n;return e?He(e)?e:Vt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Xt(e){const{Document:t}=H(e);return e instanceof t}function lt(e){return He(e)?!1:e instanceof H(e).HTMLElement}function yn(e){return e instanceof H(e).SVGElement}function We(e){return e?He(e)?e.document:Vt(e)?Xt(e)?e:lt(e)||yn(e)?e.ownerDocument:document:document:document}const ue=Ct?l.useLayoutEffect:l.useEffect;function Dt(e){const t=l.useRef(e);return ue(()=>{t.current=e}),l.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Vr(){const e=l.useRef(null),t=l.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=l.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function ot(e,t){t===void 0&&(t=[e]);const n=l.useRef(e);return ue(()=>{n.current!==e&&(n.current=e)},t),n}function ct(e,t){const n=l.useRef();return l.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function vt(e){const t=Dt(e),n=l.useRef(null),r=l.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function mt(e){const t=l.useRef();return l.useEffect(()=>{t.current=e},[e]),t.current}let At={};function ut(e,t){return l.useMemo(()=>{if(t)return t;const n=At[e]==null?0:At[e]+1;return At[e]=n,e+"-"+n},[e,t])}function wn(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((o,i)=>{const c=Object.entries(i);for(const[u,d]of c){const f=o[u];f!=null&&(o[u]=f+e*d)}return o},{...t})}}const _e=wn(1),xt=wn(-1);function Xr(e){return"clientX"in e&&"clientY"in e}function jt(e){if(!e)return!1;const{KeyboardEvent:t}=H(e.target);return t&&e instanceof t}function Yr(e){if(!e)return!1;const{TouchEvent:t}=H(e.target);return t&&e instanceof t}function bt(e){if(Yr(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Xr(e)?{x:e.clientX,y:e.clientY}:null}const Te=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Te.Translate.toString(e),Te.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),en="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Kr(e){return e.matches(en)?e:e.querySelector(en)}const _r={display:"none"};function Hr(e){let{id:t,value:n}=e;return P.createElement("div",{id:t,style:_r},n)}function Wr(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return P.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function qr(){const[e,t]=l.useState("");return{announce:l.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Sn=l.createContext(null);function Gr(e){const t=l.useContext(Sn);l.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Jr(){const[e]=l.useState(()=>new Set),t=l.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[l.useCallback(r=>{let{type:s,event:o}=r;e.forEach(i=>{var c;return(c=i[s])==null?void 0:c.call(i,o)})},[e]),t]}const Zr={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Qr={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function es(e){let{announcements:t=Qr,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=Zr}=e;const{announce:o,announcement:i}=qr(),c=ut("DndLiveRegion"),[u,d]=l.useState(!1);if(l.useEffect(()=>{d(!0)},[]),Gr(l.useMemo(()=>({onDragStart(g){let{active:x}=g;o(t.onDragStart({active:x}))},onDragMove(g){let{active:x,over:p}=g;t.onDragMove&&o(t.onDragMove({active:x,over:p}))},onDragOver(g){let{active:x,over:p}=g;o(t.onDragOver({active:x,over:p}))},onDragEnd(g){let{active:x,over:p}=g;o(t.onDragEnd({active:x,over:p}))},onDragCancel(g){let{active:x,over:p}=g;o(t.onDragCancel({active:x,over:p}))}}),[o,t])),!u)return null;const f=P.createElement(P.Fragment,null,P.createElement(Hr,{id:r,value:s.draggable}),P.createElement(Wr,{id:c,announcement:i}));return n?tt.createPortal(f,n):f}var F;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(F||(F={}));function yt(){}function ts(e,t){return l.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ns(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return l.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const de=Object.freeze({x:0,y:0});function rs(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ss(e,t){const n=bt(e);if(!n)return"0 0";const r={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return r.x+"% "+r.y+"%"}function os(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function as(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function tn(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function is(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const ls=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=tn(t),o=[];for(const i of r){const{id:c}=i,u=n.get(c);if(u){const d=tn(u),f=s.reduce((x,p,y)=>x+rs(d[y],p),0),g=Number((f/4).toFixed(4));o.push({id:c,data:{droppableContainer:i,value:g}})}}return o.sort(os)};function cs(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=s-r,c=o-n;if(r<s&&n<o){const u=t.width*t.height,d=e.width*e.height,f=i*c,g=f/(u+d-f);return Number(g.toFixed(4))}return 0}const us=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const o of r){const{id:i}=o,c=n.get(i);if(c){const u=cs(c,t);u>0&&s.push({id:i,data:{droppableContainer:o,value:u}})}}return s.sort(as)};function ds(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Cn(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:de}function fs(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return s.reduce((i,c)=>({...i,top:i.top+e*c.y,bottom:i.bottom+e*c.y,left:i.left+e*c.x,right:i.right+e*c.x}),{...n})}}const hs=fs(1);function Dn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function gs(e,t,n){const r=Dn(t);if(!r)return e;const{scaleX:s,scaleY:o,x:i,y:c}=r,u=e.left-i-(1-s)*parseFloat(n),d=e.top-c-(1-o)*parseFloat(n.slice(n.indexOf(" ")+1)),f=s?e.width/s:e.width,g=o?e.height/o:e.height;return{width:f,height:g,top:d,right:u+f,bottom:d+g,left:u}}const ps={ignoreTransform:!1};function qe(e,t){t===void 0&&(t=ps);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:f}=H(e).getComputedStyle(e);d&&(n=gs(n,d,f))}const{top:r,left:s,width:o,height:i,bottom:c,right:u}=n;return{top:r,left:s,width:o,height:i,bottom:c,right:u}}function nn(e){return qe(e,{ignoreTransform:!0})}function vs(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ms(e,t){return t===void 0&&(t=H(e).getComputedStyle(e)),t.position==="fixed"}function xs(e,t){t===void 0&&(t=H(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?n.test(o):!1})}function Yt(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(Xt(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!lt(s)||yn(s)||n.includes(s))return n;const o=H(e).getComputedStyle(s);return s!==e&&xs(s,o)&&n.push(s),ms(s,o)?n:r(s.parentNode)}return e?r(e):n}function jn(e){const[t]=Yt(e,1);return t??null}function Mt(e){return!Ct||!e?null:He(e)?e:Vt(e)?Xt(e)||e===We(e).scrollingElement?window:lt(e)?e:null:null}function Nn(e){return He(e)?e.scrollX:e.scrollLeft}function Rn(e){return He(e)?e.scrollY:e.scrollTop}function Ft(e){return{x:Nn(e),y:Rn(e)}}var V;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(V||(V={}));function En(e){return!Ct||!e?!1:e===document.scrollingElement}function Tn(e){const t={x:0,y:0},n=En(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,i=e.scrollTop>=r.y,c=e.scrollLeft>=r.x;return{isTop:s,isLeft:o,isBottom:i,isRight:c,maxScroll:r,minScroll:t}}const bs={x:.2,y:.2};function ys(e,t,n,r,s){let{top:o,left:i,right:c,bottom:u}=n;r===void 0&&(r=10),s===void 0&&(s=bs);const{isTop:d,isBottom:f,isLeft:g,isRight:x}=Tn(e),p={x:0,y:0},y={x:0,y:0},v={height:t.height*s.y,width:t.width*s.x};return!d&&o<=t.top+v.height?(p.y=V.Backward,y.y=r*Math.abs((t.top+v.height-o)/v.height)):!f&&u>=t.bottom-v.height&&(p.y=V.Forward,y.y=r*Math.abs((t.bottom-v.height-u)/v.height)),!x&&c>=t.right-v.width?(p.x=V.Forward,y.x=r*Math.abs((t.right-v.width-c)/v.width)):!g&&i<=t.left+v.width&&(p.x=V.Backward,y.x=r*Math.abs((t.left+v.width-i)/v.width)),{direction:p,speed:y}}function ws(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function An(e){return e.reduce((t,n)=>_e(t,Ft(n)),de)}function Ss(e){return e.reduce((t,n)=>t+Nn(n),0)}function Cs(e){return e.reduce((t,n)=>t+Rn(n),0)}function Mn(e,t){if(t===void 0&&(t=qe),!e)return;const{top:n,left:r,bottom:s,right:o}=t(e);jn(e)&&(s<=0||o<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ds=[["x",["left","right"],Ss],["y",["top","bottom"],Cs]];class Kt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Yt(n),s=An(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,i,c]of Ds)for(const u of i)Object.defineProperty(this,u,{get:()=>{const d=c(r),f=s[o]-d;return this.rect[u]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class nt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function js(e){const{EventTarget:t}=H(e);return e instanceof t?e:We(e)}function It(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var ae;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(ae||(ae={}));function rn(e){e.preventDefault()}function Ns(e){e.stopPropagation()}var T;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(T||(T={}));const In={start:[T.Space,T.Enter],cancel:[T.Esc],end:[T.Space,T.Enter,T.Tab]},Rs=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case T.Right:return{...n,x:n.x+25};case T.Left:return{...n,x:n.x-25};case T.Down:return{...n,y:n.y+25};case T.Up:return{...n,y:n.y-25}}};class On{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new nt(We(n)),this.windowListeners=new nt(H(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ae.Resize,this.handleCancel),this.windowListeners.add(ae.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(ae.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Mn(r),n(de)}handleKeyDown(t){if(jt(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:o=In,coordinateGetter:i=Rs,scrollBehavior:c="smooth"}=s,{code:u}=t;if(o.end.includes(u)){this.handleEnd(t);return}if(o.cancel.includes(u)){this.handleCancel(t);return}const{collisionRect:d}=r.current,f=d?{x:d.left,y:d.top}:de;this.referenceCoordinates||(this.referenceCoordinates=f);const g=i(t,{active:n,context:r.current,currentCoordinates:f});if(g){const x=xt(g,f),p={x:0,y:0},{scrollableAncestors:y}=r.current;for(const v of y){const m=t.code,{isTop:b,isRight:w,isLeft:C,isBottom:j,maxScroll:R,minScroll:N}=Tn(v),D=ws(v),S={x:Math.min(m===T.Right?D.right-D.width/2:D.right,Math.max(m===T.Right?D.left:D.left+D.width/2,g.x)),y:Math.min(m===T.Down?D.bottom-D.height/2:D.bottom,Math.max(m===T.Down?D.top:D.top+D.height/2,g.y))},I=m===T.Right&&!w||m===T.Left&&!C,k=m===T.Down&&!j||m===T.Up&&!b;if(I&&S.x!==g.x){const M=v.scrollLeft+x.x,Y=m===T.Right&&M<=R.x||m===T.Left&&M>=N.x;if(Y&&!x.y){v.scrollTo({left:M,behavior:c});return}Y?p.x=v.scrollLeft-M:p.x=m===T.Right?v.scrollLeft-R.x:v.scrollLeft-N.x,p.x&&v.scrollBy({left:-p.x,behavior:c});break}else if(k&&S.y!==g.y){const M=v.scrollTop+x.y,Y=m===T.Down&&M<=R.y||m===T.Up&&M>=N.y;if(Y&&!x.x){v.scrollTo({top:M,behavior:c});return}Y?p.y=v.scrollTop-M:p.y=m===T.Down?v.scrollTop-R.y:v.scrollTop-N.y,p.y&&v.scrollBy({top:-p.y,behavior:c});break}}this.handleMove(t,_e(xt(g,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}On.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=In,onActivation:s}=t,{active:o}=n;const{code:i}=e.nativeEvent;if(r.start.includes(i)){const c=o.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function sn(e){return!!(e&&"distance"in e)}function on(e){return!!(e&&"delay"in e)}class _t{constructor(t,n,r){var s;r===void 0&&(r=js(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:o}=t,{target:i}=o;this.props=t,this.events=n,this.document=We(i),this.documentListeners=new nt(this.document),this.listeners=new nt(r),this.windowListeners=new nt(H(i)),this.initialCoordinates=(s=bt(o))!=null?s:de,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(ae.Resize,this.handleCancel),this.windowListeners.add(ae.DragStart,rn),this.windowListeners.add(ae.VisibilityChange,this.handleCancel),this.windowListeners.add(ae.ContextMenu,rn),this.documentListeners.add(ae.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(on(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(sn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(ae.Click,Ns,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ae.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:o}=this,{onMove:i,options:{activationConstraint:c}}=o;if(!s)return;const u=(n=bt(t))!=null?n:de,d=xt(s,u);if(!r&&c){if(sn(c)){if(c.tolerance!=null&&It(d,c.tolerance))return this.handleCancel();if(It(d,c.distance))return this.handleStart()}if(on(c)&&It(d,c.tolerance))return this.handleCancel();this.handlePending(c,d);return}t.cancelable&&t.preventDefault(),i(u)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===T.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Es={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ht extends _t{constructor(t){const{event:n}=t,r=We(n.target);super(t,Es,r)}}Ht.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Ts={move:{name:"mousemove"},end:{name:"mouseup"}};var Bt;(function(e){e[e.RightClick=2]="RightClick"})(Bt||(Bt={}));class As extends _t{constructor(t){super(t,Ts,We(t.event.target))}}As.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===Bt.RightClick?!1:(r==null||r({event:n}),!0)}}];const Ot={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Ms extends _t{constructor(t){super(t,Ot)}static setup(){return window.addEventListener(Ot.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Ot.move.name,t)};function t(){}}}Ms.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var rt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(rt||(rt={}));var wt;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(wt||(wt={}));function Is(e){let{acceleration:t,activator:n=rt.Pointer,canScroll:r,draggingRect:s,enabled:o,interval:i=5,order:c=wt.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:f,delta:g,threshold:x}=e;const p=ks({delta:g,disabled:!o}),[y,v]=Vr(),m=l.useRef({x:0,y:0}),b=l.useRef({x:0,y:0}),w=l.useMemo(()=>{switch(n){case rt.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case rt.DraggableRect:return s}},[n,s,u]),C=l.useRef(null),j=l.useCallback(()=>{const N=C.current;if(!N)return;const D=m.current.x*b.current.x,S=m.current.y*b.current.y;N.scrollBy(D,S)},[]),R=l.useMemo(()=>c===wt.TreeOrder?[...d].reverse():d,[c,d]);l.useEffect(()=>{if(!o||!d.length||!w){v();return}for(const N of R){if((r==null?void 0:r(N))===!1)continue;const D=d.indexOf(N),S=f[D];if(!S)continue;const{direction:I,speed:k}=ys(N,S,w,t,x);for(const M of["x","y"])p[M][I[M]]||(k[M]=0,I[M]=0);if(k.x>0||k.y>0){v(),C.current=N,y(j,i),m.current=k,b.current=I;return}}m.current={x:0,y:0},b.current={x:0,y:0},v()},[t,j,r,v,o,i,JSON.stringify(w),JSON.stringify(p),y,d,R,f,JSON.stringify(x)])}const Os={x:{[V.Backward]:!1,[V.Forward]:!1},y:{[V.Backward]:!1,[V.Forward]:!1}};function ks(e){let{delta:t,disabled:n}=e;const r=mt(t);return ct(s=>{if(n||!r||!s)return Os;const o={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[V.Backward]:s.x[V.Backward]||o.x===-1,[V.Forward]:s.x[V.Forward]||o.x===1},y:{[V.Backward]:s.y[V.Backward]||o.y===-1,[V.Forward]:s.y[V.Forward]||o.y===1}}},[n,t,r])}function Ls(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return ct(s=>{var o;return t==null?null:(o=r??s)!=null?o:null},[r,t])}function Ps(e,t){return l.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,o=s.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,r)}));return[...n,...o]},[]),[e,t])}var at;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(at||(at={}));var $t;(function(e){e.Optimized="optimized"})($t||($t={}));const an=new Map;function zs(e,t){let{dragging:n,dependencies:r,config:s}=t;const[o,i]=l.useState(null),{frequency:c,measure:u,strategy:d}=s,f=l.useRef(e),g=m(),x=ot(g),p=l.useCallback(function(b){b===void 0&&(b=[]),!x.current&&i(w=>w===null?b:w.concat(b.filter(C=>!w.includes(C))))},[x]),y=l.useRef(null),v=ct(b=>{if(g&&!n)return an;if(!b||b===an||f.current!==e||o!=null){const w=new Map;for(let C of e){if(!C)continue;if(o&&o.length>0&&!o.includes(C.id)&&C.rect.current){w.set(C.id,C.rect.current);continue}const j=C.node.current,R=j?new Kt(u(j),j):null;C.rect.current=R,R&&w.set(C.id,R)}return w}return b},[e,o,n,g,u]);return l.useEffect(()=>{f.current=e},[e]),l.useEffect(()=>{g||p()},[n,g]),l.useEffect(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),l.useEffect(()=>{g||typeof c!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},c))},[c,g,p,...r]),{droppableRects:v,measureDroppableContainers:p,measuringScheduled:o!=null};function m(){switch(d){case at.Always:return!1;case at.BeforeDragging:return n;default:return!n}}}function Wt(e,t){return ct(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Fs(e,t){return Wt(e,t)}function Bs(e){let{callback:t,disabled:n}=e;const r=Dt(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Nt(e){let{callback:t,disabled:n}=e;const r=Dt(t),s=l.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[n]);return l.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function $s(e){return new Kt(qe(e),e)}function ln(e,t,n){t===void 0&&(t=$s);const[r,s]=l.useState(null);function o(){s(u=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=u??n)!=null?d:null}const f=t(e);return JSON.stringify(u)===JSON.stringify(f)?u:f})}const i=Bs({callback(u){if(e)for(const d of u){const{type:f,target:g}=d;if(f==="childList"&&g instanceof HTMLElement&&g.contains(e)){o();break}}}}),c=Nt({callback:o});return ue(()=>{o(),e?(c==null||c.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(c==null||c.disconnect(),i==null||i.disconnect())},[e]),r}function Us(e){const t=Wt(e);return Cn(e,t)}const cn=[];function Vs(e){const t=l.useRef(e),n=ct(r=>e?r&&r!==cn&&e&&t.current&&e.parentNode===t.current.parentNode?r:Yt(e):cn,[e]);return l.useEffect(()=>{t.current=e},[e]),n}function Xs(e){const[t,n]=l.useState(null),r=l.useRef(e),s=l.useCallback(o=>{const i=Mt(o.target);i&&n(c=>c?(c.set(i,Ft(i)),new Map(c)):null)},[]);return l.useEffect(()=>{const o=r.current;if(e!==o){i(o);const c=e.map(u=>{const d=Mt(u);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,Ft(d)]):null}).filter(u=>u!=null);n(c.length?new Map(c):null),r.current=e}return()=>{i(e),i(o)};function i(c){c.forEach(u=>{const d=Mt(u);d==null||d.removeEventListener("scroll",s)})}},[s,e]),l.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,i)=>_e(o,i),de):An(e):de,[e,t])}function un(e,t){t===void 0&&(t=[]);const n=l.useRef(null);return l.useEffect(()=>{n.current=null},t),l.useEffect(()=>{const r=e!==de;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?xt(e,n.current):de}function Ys(e){l.useEffect(()=>{if(!Ct)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Ks(e,t){return l.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:o}=r;return n[s]=i=>{o(i,t)},n},{}),[e,t])}function kn(e){return l.useMemo(()=>e?vs(e):null,[e])}const dn=[];function _s(e,t){t===void 0&&(t=qe);const[n]=e,r=kn(n?H(n):null),[s,o]=l.useState(dn);function i(){o(()=>e.length?e.map(u=>En(u)?r:new Kt(t(u),u)):dn)}const c=Nt({callback:i});return ue(()=>{c==null||c.disconnect(),i(),e.forEach(u=>c==null?void 0:c.observe(u))},[e]),s}function Ln(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return lt(t)?t:e}function Hs(e){let{measure:t}=e;const[n,r]=l.useState(null),s=l.useCallback(d=>{for(const{target:f}of d)if(lt(f)){r(g=>{const x=t(f);return g?{...g,width:x.width,height:x.height}:x});break}},[t]),o=Nt({callback:s}),i=l.useCallback(d=>{const f=Ln(d);o==null||o.disconnect(),f&&(o==null||o.observe(f)),r(f?t(f):null)},[t,o]),[c,u]=vt(i);return l.useMemo(()=>({nodeRef:c,rect:n,setRef:u}),[n,c,u])}const Ws=[{sensor:Ht,options:{}},{sensor:On,options:{}}],qs={current:{}},pt={draggable:{measure:nn},droppable:{measure:nn,strategy:at.WhileDragging,frequency:$t.Optimized},dragOverlay:{measure:qe}};class st extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Gs={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new st,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:yt},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:pt,measureDroppableContainers:yt,windowRect:null,measuringScheduled:!1},Pn={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:yt,draggableNodes:new Map,over:null,measureDroppableContainers:yt},dt=l.createContext(Pn),zn=l.createContext(Gs);function Js(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new st}}}function Zs(e,t){switch(t.type){case F.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case F.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case F.DragEnd:case F.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case F.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new st(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case F.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const i=new st(e.droppable.containers);return i.set(n,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:i}}}case F.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const o=new st(e.droppable.containers);return o.delete(n),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Qs(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=l.useContext(dt),o=mt(r),i=mt(n==null?void 0:n.id);return l.useEffect(()=>{if(!t&&!r&&o&&i!=null){if(!jt(o)||document.activeElement===o.target)return;const c=s.get(i);if(!c)return;const{activatorNode:u,node:d}=c;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const f of[u.current,d.current]){if(!f)continue;const g=Kr(f);if(g){g.focus();break}}})}},[r,t,s,i,o]),null}function Fn(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...r}),n):n}function eo(e){return l.useMemo(()=>({draggable:{...pt.draggable,...e==null?void 0:e.draggable},droppable:{...pt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...pt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function to(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const o=l.useRef(!1),{x:i,y:c}=typeof s=="boolean"?{x:s,y:s}:s;ue(()=>{if(!i&&!c||!t){o.current=!1;return}if(o.current||!r)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const f=n(d),g=Cn(f,r);if(i||(g.x=0),c||(g.y=0),o.current=!0,Math.abs(g.x)>0||Math.abs(g.y)>0){const x=jn(d);x&&x.scrollBy({top:g.y,left:g.x})}},[t,i,c,r,n])}const Rt=l.createContext({...de,scaleX:1,scaleY:1});var Re;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Re||(Re={}));const no=l.memo(function(t){var n,r,s,o;let{id:i,accessibility:c,autoScroll:u=!0,children:d,sensors:f=Ws,collisionDetection:g=us,measuring:x,modifiers:p,...y}=t;const v=l.useReducer(Zs,void 0,Js),[m,b]=v,[w,C]=Jr(),[j,R]=l.useState(Re.Uninitialized),N=j===Re.Initialized,{draggable:{active:D,nodes:S,translate:I},droppable:{containers:k}}=m,M=D!=null?S.get(D):null,Y=l.useRef({initial:null,translated:null}),K=l.useMemo(()=>{var _;return D!=null?{id:D,data:(_=M==null?void 0:M.data)!=null?_:qs,rect:Y}:null},[D,M]),G=l.useRef(null),[ve,ke]=l.useState(null),[B,Le]=l.useState(null),ne=ot(y,Object.values(y)),$=ut("DndDescribedBy",i),me=l.useMemo(()=>k.getEnabled(),[k]),z=eo(x),{droppableRects:ie,measureDroppableContainers:fe,measuringScheduled:Ae}=zs(me,{dragging:N,dependencies:[I.x,I.y],config:z.droppable}),W=Ls(S,D),Pe=l.useMemo(()=>B?bt(B):null,[B]),he=Qn(),le=Fs(W,z.draggable.measure);to({activeNode:D!=null?S.get(D):null,config:he.layoutShiftCompensation,initialRect:le,measure:z.draggable.measure});const A=ln(W,z.draggable.measure,le),Me=ln(W?W.parentElement:null),re=l.useRef({activatorEvent:null,active:null,activeNode:W,collisionRect:null,collisions:null,droppableRects:ie,draggableNodes:S,draggingNode:null,draggingNodeRect:null,droppableContainers:k,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),xe=k.getNodeFor((n=re.current.over)==null?void 0:n.id),se=Hs({measure:z.dragOverlay.measure}),h=(r=se.nodeRef.current)!=null?r:W,E=N?(s=se.rect)!=null?s:A:null,O=!!(se.nodeRef.current&&se.rect),J=Us(O?null:A),q=kn(h?H(h):null),L=Vs(N?xe??W:null),Z=_s(L),Ie=Fn(p,{transform:{x:I.x-J.x,y:I.y-J.y,scaleX:1,scaleY:1},activatorEvent:B,active:K,activeNodeRect:A,containerNodeRect:Me,draggingNodeRect:E,over:re.current.over,overlayNodeRect:se.rect,scrollableAncestors:L,scrollableAncestorRects:Z,windowRect:q}),ze=Pe?_e(Pe,I):null,qt=Xs(L),_n=un(qt),Hn=un(qt,[A]),Fe=_e(Ie,_n),Be=E?hs(E,Ie):null,Ge=K&&Be?g({active:K,collisionRect:Be,droppableRects:ie,droppableContainers:me,pointerCoordinates:ze}):null,Gt=is(Ge,"id"),[ye,Jt]=l.useState(null),Wn=O?Ie:_e(Ie,Hn),qn=ds(Wn,(o=ye==null?void 0:ye.rect)!=null?o:null,A),Et=l.useRef(null),Zt=l.useCallback((_,Q)=>{let{sensor:ee,options:we}=Q;if(G.current==null)return;const oe=S.get(G.current);if(!oe)return;const te=_.nativeEvent,ge=new ee({active:G.current,activeNode:oe,event:te,options:we,context:re,onAbort(X){if(!S.get(X))return;const{onDragAbort:pe}=ne.current,be={id:X};pe==null||pe(be),w({type:"onDragAbort",event:be})},onPending(X,Se,pe,be){if(!S.get(X))return;const{onDragPending:Ze}=ne.current,Ce={id:X,constraint:Se,initialCoordinates:pe,offset:be};Ze==null||Ze(Ce),w({type:"onDragPending",event:Ce})},onStart(X){const Se=G.current;if(Se==null)return;const pe=S.get(Se);if(!pe)return;const{onDragStart:be}=ne.current,Je={activatorEvent:te,active:{id:Se,data:pe.data,rect:Y}};tt.unstable_batchedUpdates(()=>{be==null||be(Je),R(Re.Initializing),b({type:F.DragStart,initialCoordinates:X,active:Se}),w({type:"onDragStart",event:Je}),ke(Et.current),Le(te)})},onMove(X){b({type:F.DragMove,coordinates:X})},onEnd:$e(F.DragEnd),onCancel:$e(F.DragCancel)});Et.current=ge;function $e(X){return async function(){const{active:pe,collisions:be,over:Je,scrollAdjustedTranslate:Ze}=re.current;let Ce=null;if(pe&&Ze){const{cancelDrop:Qe}=ne.current;Ce={activatorEvent:te,active:pe,collisions:be,delta:Ze,over:Je},X===F.DragEnd&&typeof Qe=="function"&&await Promise.resolve(Qe(Ce))&&(X=F.DragCancel)}G.current=null,tt.unstable_batchedUpdates(()=>{b({type:X}),R(Re.Uninitialized),Jt(null),ke(null),Le(null),Et.current=null;const Qe=X===F.DragEnd?"onDragEnd":"onDragCancel";if(Ce){const Tt=ne.current[Qe];Tt==null||Tt(Ce),w({type:Qe,event:Ce})}})}}},[S]),Gn=l.useCallback((_,Q)=>(ee,we)=>{const oe=ee.nativeEvent,te=S.get(we);if(G.current!==null||!te||oe.dndKit||oe.defaultPrevented)return;const ge={active:te};_(ee,Q.options,ge)===!0&&(oe.dndKit={capturedBy:Q.sensor},G.current=we,Zt(ee,Q))},[S,Zt]),Qt=Ps(f,Gn);Ys(f),ue(()=>{A&&j===Re.Initializing&&R(Re.Initialized)},[A,j]),l.useEffect(()=>{const{onDragMove:_}=ne.current,{active:Q,activatorEvent:ee,collisions:we,over:oe}=re.current;if(!Q||!ee)return;const te={active:Q,activatorEvent:ee,collisions:we,delta:{x:Fe.x,y:Fe.y},over:oe};tt.unstable_batchedUpdates(()=>{_==null||_(te),w({type:"onDragMove",event:te})})},[Fe.x,Fe.y]),l.useEffect(()=>{const{active:_,activatorEvent:Q,collisions:ee,droppableContainers:we,scrollAdjustedTranslate:oe}=re.current;if(!_||G.current==null||!Q||!oe)return;const{onDragOver:te}=ne.current,ge=we.get(Gt),$e=ge&&ge.rect.current?{id:ge.id,rect:ge.rect.current,data:ge.data,disabled:ge.disabled}:null,X={active:_,activatorEvent:Q,collisions:ee,delta:{x:oe.x,y:oe.y},over:$e};tt.unstable_batchedUpdates(()=>{Jt($e),te==null||te(X),w({type:"onDragOver",event:X})})},[Gt]),ue(()=>{re.current={activatorEvent:B,active:K,activeNode:W,collisionRect:Be,collisions:Ge,droppableRects:ie,draggableNodes:S,draggingNode:h,draggingNodeRect:E,droppableContainers:k,over:ye,scrollableAncestors:L,scrollAdjustedTranslate:Fe},Y.current={initial:E,translated:Be}},[K,W,Ge,Be,S,h,E,ie,k,ye,L,Fe]),Is({...he,delta:I,draggingRect:Be,pointerCoordinates:ze,scrollableAncestors:L,scrollableAncestorRects:Z});const Jn=l.useMemo(()=>({active:K,activeNode:W,activeNodeRect:A,activatorEvent:B,collisions:Ge,containerNodeRect:Me,dragOverlay:se,draggableNodes:S,droppableContainers:k,droppableRects:ie,over:ye,measureDroppableContainers:fe,scrollableAncestors:L,scrollableAncestorRects:Z,measuringConfiguration:z,measuringScheduled:Ae,windowRect:q}),[K,W,A,B,Ge,Me,se,S,k,ie,ye,fe,L,Z,z,Ae,q]),Zn=l.useMemo(()=>({activatorEvent:B,activators:Qt,active:K,activeNodeRect:A,ariaDescribedById:{draggable:$},dispatch:b,draggableNodes:S,over:ye,measureDroppableContainers:fe}),[B,Qt,K,A,b,$,S,ye,fe]);return P.createElement(Sn.Provider,{value:C},P.createElement(dt.Provider,{value:Zn},P.createElement(zn.Provider,{value:Jn},P.createElement(Rt.Provider,{value:qn},d)),P.createElement(Qs,{disabled:(c==null?void 0:c.restoreFocus)===!1})),P.createElement(es,{...c,hiddenTextDescribedById:$}));function Qn(){const _=(ve==null?void 0:ve.autoScrollEnabled)===!1,Q=typeof u=="object"?u.enabled===!1:u===!1,ee=N&&!_&&!Q;return typeof u=="object"?{...u,enabled:ee}:{enabled:ee}}}),ro=l.createContext(null),fn="button",so="Draggable";function oo(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const o=ut(so),{activators:i,activatorEvent:c,active:u,activeNodeRect:d,ariaDescribedById:f,draggableNodes:g,over:x}=l.useContext(dt),{role:p=fn,roleDescription:y="draggable",tabIndex:v=0}=s??{},m=(u==null?void 0:u.id)===t,b=l.useContext(m?Rt:ro),[w,C]=vt(),[j,R]=vt(),N=Ks(i,t),D=ot(n);ue(()=>(g.set(t,{id:t,key:o,node:w,activatorNode:j,data:D}),()=>{const I=g.get(t);I&&I.key===o&&g.delete(t)}),[g,t]);const S=l.useMemo(()=>({role:p,tabIndex:v,"aria-disabled":r,"aria-pressed":m&&p===fn?!0:void 0,"aria-roledescription":y,"aria-describedby":f.draggable}),[r,p,v,m,y,f.draggable]);return{active:u,activatorEvent:c,activeNodeRect:d,attributes:S,isDragging:m,listeners:r?void 0:N,node:w,over:x,setNodeRef:C,setActivatorNodeRef:R,transform:b}}function Bn(){return l.useContext(zn)}const ao="Droppable",io={timeout:25};function $n(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const o=ut(ao),{active:i,dispatch:c,over:u,measureDroppableContainers:d}=l.useContext(dt),f=l.useRef({disabled:n}),g=l.useRef(!1),x=l.useRef(null),p=l.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:m}={...io,...s},b=ot(v??r),w=l.useCallback(()=>{if(!g.current){g.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{d(Array.isArray(b.current)?b.current:[b.current]),p.current=null},m)},[m]),C=Nt({callback:w,disabled:y||!i}),j=l.useCallback((S,I)=>{C&&(I&&(C.unobserve(I),g.current=!1),S&&C.observe(S))},[C]),[R,N]=vt(j),D=ot(t);return l.useEffect(()=>{!C||!R.current||(C.disconnect(),g.current=!1,C.observe(R.current))},[R,C]),l.useEffect(()=>(c({type:F.RegisterDroppable,element:{id:r,key:o,disabled:n,node:R,rect:x,data:D}}),()=>c({type:F.UnregisterDroppable,key:o,id:r})),[r]),l.useEffect(()=>{n!==f.current.disabled&&(c({type:F.SetDroppableDisabled,id:r,key:o,disabled:n}),f.current.disabled=n)},[r,o,n,c]),{active:i,rect:x,isOver:(u==null?void 0:u.id)===r,node:R,over:u,setNodeRef:N}}function lo(e){let{animation:t,children:n}=e;const[r,s]=l.useState(null),[o,i]=l.useState(null),c=mt(n);return!n&&!r&&c&&s(c),ue(()=>{if(!o)return;const u=r==null?void 0:r.key,d=r==null?void 0:r.props.id;if(u==null||d==null){s(null);return}Promise.resolve(t(d,o)).then(()=>{s(null)})},[t,r,o]),P.createElement(P.Fragment,null,n,r?l.cloneElement(r,{ref:i}):null)}const co={x:0,y:0,scaleX:1,scaleY:1};function uo(e){let{children:t}=e;return P.createElement(dt.Provider,{value:Pn},P.createElement(Rt.Provider,{value:co},t))}const fo={position:"fixed",touchAction:"none"},ho=e=>jt(e)?"transform 250ms ease":void 0,go=l.forwardRef((e,t)=>{let{as:n,activatorEvent:r,adjustScale:s,children:o,className:i,rect:c,style:u,transform:d,transition:f=ho}=e;if(!c)return null;const g=s?d:{...d,scaleX:1,scaleY:1},x={...fo,width:c.width,height:c.height,top:c.top,left:c.left,transform:Te.Transform.toString(g),transformOrigin:s&&r?ss(r,c):void 0,transition:typeof f=="function"?f(r):f,...u};return P.createElement(n,{className:i,style:x,ref:t},o)}),po=e=>t=>{let{active:n,dragOverlay:r}=t;const s={},{styles:o,className:i}=e;if(o!=null&&o.active)for(const[c,u]of Object.entries(o.active))u!==void 0&&(s[c]=n.node.style.getPropertyValue(c),n.node.style.setProperty(c,u));if(o!=null&&o.dragOverlay)for(const[c,u]of Object.entries(o.dragOverlay))u!==void 0&&r.node.style.setProperty(c,u);return i!=null&&i.active&&n.node.classList.add(i.active),i!=null&&i.dragOverlay&&r.node.classList.add(i.dragOverlay),function(){for(const[u,d]of Object.entries(s))n.node.style.setProperty(u,d);i!=null&&i.active&&n.node.classList.remove(i.active)}},vo=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Te.Transform.toString(t)},{transform:Te.Transform.toString(n)}]},mo={duration:250,easing:"ease",keyframes:vo,sideEffects:po({styles:{active:{opacity:"0"}}})};function xo(e){let{config:t,draggableNodes:n,droppableContainers:r,measuringConfiguration:s}=e;return Dt((o,i)=>{if(t===null)return;const c=n.get(o);if(!c)return;const u=c.node.current;if(!u)return;const d=Ln(i);if(!d)return;const{transform:f}=H(i).getComputedStyle(i),g=Dn(f);if(!g)return;const x=typeof t=="function"?t:bo(t);return Mn(u,s.draggable.measure),x({active:{id:o,data:c.data,node:u,rect:s.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:i,rect:s.dragOverlay.measure(d)},droppableContainers:r,measuringConfiguration:s,transform:g})})}function bo(e){const{duration:t,easing:n,sideEffects:r,keyframes:s}={...mo,...e};return o=>{let{active:i,dragOverlay:c,transform:u,...d}=o;if(!t)return;const f={x:c.rect.left-i.rect.left,y:c.rect.top-i.rect.top},g={scaleX:u.scaleX!==1?i.rect.width*u.scaleX/c.rect.width:1,scaleY:u.scaleY!==1?i.rect.height*u.scaleY/c.rect.height:1},x={x:u.x-f.x,y:u.y-f.y,...g},p=s({...d,active:i,dragOverlay:c,transform:{initial:u,final:x}}),[y]=p,v=p[p.length-1];if(JSON.stringify(y)===JSON.stringify(v))return;const m=r==null?void 0:r({active:i,dragOverlay:c,...d}),b=c.node.animate(p,{duration:t,easing:n,fill:"forwards"});return new Promise(w=>{b.onfinish=()=>{m==null||m(),w()}})}}let hn=0;function yo(e){return l.useMemo(()=>{if(e!=null)return hn++,hn},[e])}const wo=P.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:r,style:s,transition:o,modifiers:i,wrapperElement:c="div",className:u,zIndex:d=999}=e;const{activatorEvent:f,active:g,activeNodeRect:x,containerNodeRect:p,draggableNodes:y,droppableContainers:v,dragOverlay:m,over:b,measuringConfiguration:w,scrollableAncestors:C,scrollableAncestorRects:j,windowRect:R}=Bn(),N=l.useContext(Rt),D=yo(g==null?void 0:g.id),S=Fn(i,{activatorEvent:f,active:g,activeNodeRect:x,containerNodeRect:p,draggingNodeRect:m.rect,over:b,overlayNodeRect:m.rect,scrollableAncestors:C,scrollableAncestorRects:j,transform:N,windowRect:R}),I=Wt(x),k=xo({config:r,draggableNodes:y,droppableContainers:v,measuringConfiguration:w}),M=I?m.setRef:void 0;return P.createElement(uo,null,P.createElement(lo,{animation:k},g&&D?P.createElement(go,{key:D,id:g.id,ref:M,as:c,activatorEvent:f,adjustScale:t,className:u,transition:o,rect:I,style:{zIndex:d,...s},transform:S},n):null))});function Un(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function So(e,t){return e.reduce((n,r,s)=>{const o=t.get(r);return o&&(n[s]=o),n},Array(e.length))}function ft(e){return e!==null&&e>=0}function Co(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Do(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Vn=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const o=Un(t,r,n),i=t[s],c=o[s];return!c||!i?null:{x:c.left-i.left,y:c.top-i.top,scaleX:c.width/i.width,scaleY:c.height/i.height}},ht={scaleX:1,scaleY:1},jo=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:o,overIndex:i}=e;const c=(t=o[n])!=null?t:r;if(!c)return null;if(s===n){const d=o[i];return d?{x:0,y:n<i?d.top+d.height-(c.top+c.height):d.top-c.top,...ht}:null}const u=No(o,s,n);return s>n&&s<=i?{x:0,y:-c.height-u,...ht}:s<n&&s>=i?{x:0,y:c.height+u,...ht}:{x:0,y:0,...ht}};function No(e,t,n){const r=e[t],s=e[t-1],o=e[t+1];return r?n<t?s?r.top-(s.top+s.height):o?o.top-(r.top+r.height):0:o?o.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Xn="Sortable",Yn=P.createContext({activeIndex:-1,containerId:Xn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Vn,disabled:{draggable:!1,droppable:!1}});function Ro(e){let{children:t,id:n,items:r,strategy:s=Vn,disabled:o=!1}=e;const{active:i,dragOverlay:c,droppableRects:u,over:d,measureDroppableContainers:f}=Bn(),g=ut(Xn,n),x=c.rect!==null,p=l.useMemo(()=>r.map(N=>typeof N=="object"&&"id"in N?N.id:N),[r]),y=i!=null,v=i?p.indexOf(i.id):-1,m=d?p.indexOf(d.id):-1,b=l.useRef(p),w=!Co(p,b.current),C=m!==-1&&v===-1||w,j=Do(o);ue(()=>{w&&y&&f(p)},[w,p,y,f]),l.useEffect(()=>{b.current=p},[p]);const R=l.useMemo(()=>({activeIndex:v,containerId:g,disabled:j,disableTransforms:C,items:p,overIndex:m,useDragOverlay:x,sortedRects:So(p,u),strategy:s}),[v,g,j.draggable,j.droppable,C,p,m,u,x,s]);return P.createElement(Yn.Provider,{value:R},t)}const Eo=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Un(n,r,s).indexOf(t)},To=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:o,newIndex:i,previousItems:c,previousContainerId:u,transition:d}=e;return!d||!r||c!==o&&s===i?!1:n?!0:i!==s&&t===u},Ao={duration:200,easing:"ease"},Kn="transform",Mo=Te.Transition.toString({property:Kn,duration:0,easing:"linear"}),Io={roleDescription:"sortable"};function Oo(e){let{disabled:t,index:n,node:r,rect:s}=e;const[o,i]=l.useState(null),c=l.useRef(n);return ue(()=>{if(!t&&n!==c.current&&r.current){const u=s.current;if(u){const d=qe(r.current,{ignoreTransform:!0}),f={x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height};(f.x||f.y)&&i(f)}}n!==c.current&&(c.current=n)},[t,n,r,s]),l.useEffect(()=>{o&&i(null)},[o]),o}function ko(e){let{animateLayoutChanges:t=To,attributes:n,disabled:r,data:s,getNewIndex:o=Eo,id:i,strategy:c,resizeObserverConfig:u,transition:d=Ao}=e;const{items:f,containerId:g,activeIndex:x,disabled:p,disableTransforms:y,sortedRects:v,overIndex:m,useDragOverlay:b,strategy:w}=l.useContext(Yn),C=Lo(r,p),j=f.indexOf(i),R=l.useMemo(()=>({sortable:{containerId:g,index:j,items:f},...s}),[g,s,j,f]),N=l.useMemo(()=>f.slice(f.indexOf(i)),[f,i]),{rect:D,node:S,isOver:I,setNodeRef:k}=$n({id:i,data:R,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...u}}),{active:M,activatorEvent:Y,activeNodeRect:K,attributes:G,setNodeRef:ve,listeners:ke,isDragging:B,over:Le,setActivatorNodeRef:ne,transform:$}=oo({id:i,data:R,attributes:{...Io,...n},disabled:C.draggable}),me=Ur(k,ve),z=!!M,ie=z&&!y&&ft(x)&&ft(m),fe=!b&&B,Ae=fe&&ie?$:null,Pe=ie?Ae??(c??w)({rects:v,activeNodeRect:K,activeIndex:x,overIndex:m,index:j}):null,he=ft(x)&&ft(m)?o({id:i,items:f,activeIndex:x,overIndex:m}):j,le=M==null?void 0:M.id,A=l.useRef({activeId:le,items:f,newIndex:he,containerId:g}),Me=f!==A.current.items,re=t({active:M,containerId:g,isDragging:B,isSorting:z,id:i,index:j,items:f,newIndex:A.current.newIndex,previousItems:A.current.items,previousContainerId:A.current.containerId,transition:d,wasDragging:A.current.activeId!=null}),xe=Oo({disabled:!re,index:j,node:S,rect:D});return l.useEffect(()=>{z&&A.current.newIndex!==he&&(A.current.newIndex=he),g!==A.current.containerId&&(A.current.containerId=g),f!==A.current.items&&(A.current.items=f)},[z,he,g,f]),l.useEffect(()=>{if(le===A.current.activeId)return;if(le!=null&&A.current.activeId==null){A.current.activeId=le;return}const h=setTimeout(()=>{A.current.activeId=le},50);return()=>clearTimeout(h)},[le]),{active:M,activeIndex:x,attributes:G,data:R,rect:D,index:j,newIndex:he,items:f,isOver:I,isSorting:z,isDragging:B,listeners:ke,node:S,overIndex:m,over:Le,setNodeRef:me,setActivatorNodeRef:ne,setDroppableNodeRef:k,setDraggableNodeRef:ve,transform:xe??Pe,transition:se()};function se(){if(xe||Me&&A.current.newIndex===j)return Mo;if(!(fe&&!jt(Y)||!d)&&(z||re))return Te.Transition.toString({...d,property:Kn})}}function Lo(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}T.Down,T.Right,T.Up,T.Left;const gn=[{value:"deadline",label:"Prazo (mais próximo)"},{value:"title",label:"Título (A → Z)"},{value:"status",label:"Status"}],pn={"A fazer":0,"Em andamento":1,Concluído:2},gt=["A fazer","Em andamento","Concluído"];function Po(e,t){return[...e].sort((n,r)=>{switch(t){case"deadline":return!n.dueDate&&!r.dueDate?0:n.dueDate?r.dueDate?n.dueDate.localeCompare(r.dueDate):-1:1;case"title":return n.title.localeCompare(r.title,"pt-BR");case"status":return(pn[n.status]??0)-(pn[r.status]??0);default:return 0}})}function zo({id:e,children:t}){const{attributes:n,listeners:r,setNodeRef:s,transform:o,transition:i,isDragging:c}=ko({id:e}),u={transform:Te.Transform.toString(o),transition:i};return a.jsx("div",{ref:s,style:u,...n,...r,className:ce("touch-none",c&&"opacity-30"),children:t})}function Fo({status:e,isOver:t,items:n,itemIds:r,today:s,onEdit:o,onDelete:i}){const{setNodeRef:c}=$n({id:e});return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(kt,{variant:"secondary",className:xn[e],children:St[e]}),a.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n.length,")"]})]}),a.jsx("div",{ref:c,"data-column-status":e,className:ce("space-y-3 min-h-[400px] p-2 rounded-lg transition-colors duration-150",t?"bg-primary/10 border-2 border-dashed border-primary/40":"bg-muted/30 border-2 border-transparent"),children:a.jsx(Ro,{items:r,strategy:jo,children:n.length===0?a.jsx("p",{className:ce("text-xs text-center py-8 transition-colors",t?"text-primary font-medium":"text-muted-foreground"),children:t?"↓ Soltar aqui":"Vazio"}):n.map(u=>a.jsx(zo,{id:u.id,children:a.jsx(Ut,{sub:u,today:s,onEdit:()=>o(u),onDelete:()=>i(u.id)})},u.id))})})]})}const Ut=l.memo(function({sub:t,today:n,showStatus:r,onEdit:s,onDelete:o}){const i=t.dueDate&&t.dueDate<n&&t.status!=="Concluído";return a.jsx(Pt,{className:ce("transition-shadow duration-150",i&&"border-destructive/50"),children:a.jsx(zt,{className:"p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[r&&a.jsx(kt,{variant:"secondary",className:ce("text-[10px]",xn[t.status]),children:St[t.status]}),i&&a.jsx(kt,{variant:"destructive",className:"text-[10px]",children:"Atrasada"})]}),a.jsx("p",{className:ce("font-medium text-sm",t.completed&&"line-through text-muted-foreground"),children:t.title}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-0.5",children:[a.jsx("span",{className:"font-medium",children:"Tarefa:"})," ",t.parentTaskTitle]}),a.jsxs("div",{className:"flex flex-wrap gap-3 mt-1 text-xs text-muted-foreground",children:[t.projectName&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(vn,{className:"w-3 h-3"}),t.projectName]}),t.assignee&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Mr,{className:"w-3 h-3"}),t.assignee]}),t.dueDate&&a.jsxs("span",{className:ce("flex items-center gap-1",i&&"text-destructive font-medium"),children:[a.jsx(Ir,{className:"w-3 h-3"}),new Date(t.dueDate+"T12:00:00").toLocaleDateString("pt-BR")]})]}),t.notes&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:t.notes})]}),a.jsxs("div",{className:"flex gap-1 shrink-0",children:[a.jsx(Ee,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:s,children:a.jsx(Or,{className:"w-3.5 h-3.5"})}),a.jsx(Ee,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:o,children:a.jsx(kr,{className:"w-3.5 h-3.5"})})]})]})})})});function ua({tasks:e,projects:t,loading:n,onCreateSubtask:r,onUpdateSubtask:s,onDeleteSubtask:o}){var se;const[i,c]=l.useState(!1),[u,d]=l.useState(null),[f,g]=l.useState("kanban"),[x,p]=l.useState(""),[y,v]=l.useState("all"),[m,b]=l.useState("all"),[w,C]=l.useState("all"),[j,R]=l.useState("all"),[N,D]=l.useState("all"),[S,I]=l.useState("deadline"),[k,M]=l.useState(!1),[Y,K]=l.useState(null),[G,ve]=l.useState(null),[ke,B]=l.useState(null),Le=ns(ts(Ht,{activationConstraint:{distance:8}})),ne=l.useMemo(()=>{const h={};return t.forEach(E=>{h[E.id]=E.name}),h},[t]),$=l.useMemo(()=>e.flatMap(h=>h.subtasks.map(E=>({...E,parentTaskTitle:h.title,projectId:h.projectId,projectName:h.projectId?ne[h.projectId]:void 0}))),[e,ne]),me=l.useMemo(()=>{const h=new Date,E=new Date(h.getFullYear(),h.getMonth(),h.getDate()),O=new Date(E);O.setDate(E.getDate()+(7-E.getDay()));const J=new Date(h.getFullYear(),h.getMonth()+1,0),q=$.filter(L=>{if(x&&!L.title.toLowerCase().includes(x.toLowerCase())||y!=="all"&&L.status!==y||m!=="all"&&L.assignee!==m||w!=="all"&&L.projectId!==w||j!=="all"&&L.parentTaskId!==j)return!1;if(N!=="all"){if(!L.dueDate)return N==="sem_prazo";const Z=new Date(L.dueDate+"T23:59:59");switch(N){case"atrasadas":return Z<E&&L.status!=="Concluído";case"hoje":return L.dueDate===z;case"esta_semana":return Z>=E&&Z<=O;case"este_mes":return Z>=E&&Z<=J;case"sem_prazo":return!1}}return!0});return Po(q,S)},[$,x,y,m,w,j,S]),z=l.useMemo(()=>{const h=new Date;return`${h.getFullYear()}-${String(h.getMonth()+1).padStart(2,"0")}-${String(h.getDate()).padStart(2,"0")}`},[]);l.useMemo(()=>{const h={"A fazer":0,"Em andamento":0,Concluído:0},E=$.filter(O=>O.dueDate&&O.dueDate<z&&O.status!=="Concluído").length;return $.forEach(O=>{h[O.status]!==void 0&&h[O.status]++}),{...h,overdue:E,total:$.length}},[$,z]);const ie=l.useCallback(()=>{d(null),c(!0)},[]),fe=l.useCallback(h=>{d(h),c(!0)},[]),Ae=l.useCallback(async(h,E,O)=>{E?await r(h.parentTaskId,{title:h.title,deadline:h.deadline||void 0,status:h.status,assignee:h.assignee||void 0,notes:h.notes||void 0}):O&&await s(O,{title:h.title,deadline:h.deadline||void 0,status:h.status,assignee:h.assignee||void 0,notes:h.notes||void 0})},[r,s]),W=l.useCallback(async()=>{Y&&(await o(Y),K(null))},[Y,o]),Pe=l.useMemo(()=>{const h={"A fazer":[],"Em andamento":[],Concluído:[]};return me.forEach(E=>{h[E.status]&&h[E.status].push(E)}),h},[me]),he=y!=="all"||m!=="all"||w!=="all"||j!=="all"||N!=="all"||x,le=l.useCallback(h=>{ve(String(h.active.id))},[]),A=l.useCallback(h=>{const{over:E}=h;if(!E){B(null);return}const O=String(E.id),J=$.find(L=>L.id===O),q=J?J.status:gt.includes(O)?O:null;B(q)},[$]),Me=l.useCallback(async h=>{const{active:E,over:O}=h;if(ve(null),B(null),!O)return;const J=String(E.id),q=String(O.id);if(J===q)return;const L=$.find(ze=>ze.id===J);if(!L)return;const Z=$.find(ze=>ze.id===q),Ie=Z?Z.status:gt.includes(q)?q:L.status;L.status!==Ie&&await s(J,{status:Ie})},[$,s]),re=l.useCallback(()=>{ve(null),B(null)},[]),xe=G?$.find(h=>h.id===G):null;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-3 mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[a.jsxs("div",{className:"relative w-full sm:min-w-[220px] sm:max-w-xs",children:[a.jsx(bn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground pointer-events-none"}),a.jsx(Lt,{placeholder:"Buscar subtarefa...",value:x,onChange:h=>p(h.target.value),className:"pl-9 w-full text-sm"})]}),a.jsxs("div",{className:"flex gap-2 items-center ml-auto flex-wrap",children:[a.jsxs("div",{className:"flex border border-border rounded-md overflow-hidden",children:[a.jsx(Ee,{variant:f==="list"?"default":"ghost",size:"sm",onClick:()=>g("list"),className:"rounded-none",children:a.jsx(Tr,{className:"w-4 h-4"})}),a.jsx(Ee,{variant:f==="kanban"?"default":"ghost",size:"sm",onClick:()=>g("kanban"),className:"rounded-none",children:a.jsx(zr,{className:"w-4 h-4"})})]}),f==="kanban"&&a.jsxs("label",{className:"flex items-center gap-1.5 text-xs text-muted-foreground cursor-pointer select-none",children:[a.jsx(Er,{checked:k,onCheckedChange:M,className:"scale-75"}),"Ocultar concluídas"]}),a.jsxs(Ee,{size:"sm",onClick:ie,className:"gap-1.5",children:[a.jsx(ur,{className:"w-4 h-4"})," Nova Subtarefa"]})]})]}),a.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[a.jsxs(De,{value:y,onValueChange:v,children:[a.jsx(je,{className:"w-[130px] h-8 text-xs",children:a.jsx(Oe,{placeholder:"Status"})}),a.jsxs(Ne,{children:[a.jsx(U,{value:"all",children:"Todos"}),gt.map(h=>a.jsx(U,{value:h,children:St[h]},h))]})]}),a.jsxs(De,{value:m,onValueChange:b,children:[a.jsx(je,{className:"w-[140px] h-8 text-xs",children:a.jsx(Oe,{placeholder:"Responsável"})}),a.jsxs(Ne,{children:[a.jsx(U,{value:"all",children:"Todos"}),mn.map(h=>a.jsx(U,{value:h,children:h},h))]})]}),a.jsxs(De,{value:w,onValueChange:C,children:[a.jsxs(je,{className:"w-[150px] h-8 text-xs",children:[a.jsx(vn,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),a.jsx(Oe,{placeholder:"Projeto"})]}),a.jsxs(Ne,{children:[a.jsx(U,{value:"all",children:"Todos"}),t.map(h=>a.jsx(U,{value:h.id,children:h.name},h.id))]})]}),a.jsxs(De,{value:j,onValueChange:R,children:[a.jsx(je,{className:"w-[160px] h-8 text-xs",children:a.jsx(Oe,{placeholder:"Tarefa-mãe"})}),a.jsxs(Ne,{children:[a.jsx(U,{value:"all",children:"Todas"}),e.map(h=>a.jsx(U,{value:h.id,children:h.title},h.id))]})]}),a.jsxs(De,{value:N,onValueChange:D,children:[a.jsxs(je,{className:"w-[140px] h-8 text-xs",children:[a.jsx(Ar,{className:"w-3.5 h-3.5 mr-1 text-muted-foreground"}),a.jsx(Oe,{placeholder:"Período"})]}),a.jsxs(Ne,{children:[a.jsx(U,{value:"all",children:"Todos"}),a.jsx(U,{value:"atrasadas",children:"Atrasadas"}),a.jsx(U,{value:"hoje",children:"Vence hoje"}),a.jsx(U,{value:"esta_semana",children:"Esta semana"}),a.jsx(U,{value:"este_mes",children:"Este mês"}),a.jsx(U,{value:"sem_prazo",children:"Sem prazo"})]})]}),a.jsxs(De,{value:S,onValueChange:h=>I(h),children:[a.jsxs(je,{className:"w-[44px] sm:w-[170px] h-8 text-xs gap-1.5",children:[a.jsx(Lr,{className:"w-3.5 h-3.5 shrink-0 text-muted-foreground"}),a.jsx("span",{className:"hidden sm:inline truncate",children:(se=gn.find(h=>h.value===S))==null?void 0:se.label})]}),a.jsx(Ne,{children:gn.map(h=>a.jsx(U,{value:h.value,children:h.label},h.value))})]}),he&&a.jsx(Ee,{variant:"ghost",size:"sm",onClick:()=>{v("all"),b("all"),C("all"),R("all"),D("all"),p("")},className:"text-xs gap-1 h-8",children:"✕ Limpar"})]})]}),a.jsx($r,{open:i,onOpenChange:c,subtask:u,tasks:e,onSave:Ae}),a.jsx(yr,{open:!!Y,onOpenChange:h=>!h&&K(null),children:a.jsxs(wr,{children:[a.jsxs(Sr,{children:[a.jsx(Cr,{children:"Remover subtarefa?"}),a.jsx(Dr,{children:"Esta ação não pode ser desfeita. A subtarefa será removida permanentemente."})]}),a.jsxs(jr,{children:[a.jsx(Nr,{children:"Cancelar"}),a.jsx(Rr,{onClick:W,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})}),n?a.jsx("div",{className:"space-y-3",children:[1,2,3].map(h=>a.jsx(Pt,{children:a.jsx(zt,{className:"p-4",children:a.jsx("div",{className:"h-16 bg-muted animate-pulse rounded"})})},h))}):f==="list"?a.jsx("div",{className:"space-y-3",children:me.length===0?a.jsx(Pt,{children:a.jsx(zt,{className:"p-8 text-center text-muted-foreground",children:"Nenhuma subtarefa encontrada."})}):me.map(h=>a.jsx(Ut,{sub:h,today:z,showStatus:!0,onEdit:()=>fe(h),onDelete:()=>K(h.id)},h.id))}):a.jsxs(no,{sensors:Le,collisionDetection:ls,onDragStart:le,onDragOver:A,onDragEnd:Me,onDragCancel:re,children:[a.jsx("div",{className:ce("grid gap-4",k?"grid-cols-1 sm:grid-cols-2":"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3"),children:gt.filter(h=>!k||h!=="Concluído").map(h=>{const E=ke===h,O=Pe[h],J=O.map(q=>q.id);return a.jsx(Fo,{status:h,isOver:E,items:O,itemIds:J,today:z,onEdit:fe,onDelete:K},h)})}),a.jsx(wo,{children:xe&&a.jsx("div",{className:"shadow-xl ring-2 ring-primary/30 rotate-[2deg] scale-105",children:a.jsx(Ut,{sub:xe,today:z,showStatus:!0,onEdit:()=>{},onDelete:()=>{}})})})]})]})}export{Lr as A,zr as C,no as D,la as G,Ht as P,ca as S,ts as a,wo as b,ls as c,ua as d,$n as e,Ro as f,ko as g,Te as h,ns as u,jo as v};
