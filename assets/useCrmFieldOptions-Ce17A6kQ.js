import{u as O}from"./useQuery-0ht4tlfE.js";import{$ as g,s,h as a}from"./index-BfmK7XUd.js";import{u as d}from"./useMutation-DxfAsfsl.js";const n="crm-field-options";function b(){const i=g(),{data:c=[],isLoading:m}=O({queryKey:[n],queryFn:async()=>{const{data:e,error:r}=await s.from("mladv_crm_field_options").select("*").order("sort_order",{ascending:!0});if(r)throw r;return e},staleTime:1e3*60*5}),l=e=>c.filter(r=>r.field_name===e),f=e=>{const r=l(e);return Object.fromEntries(r.map(o=>[o.value,o.label]))},p=e=>{const r=l(e);return Object.fromEntries(r.map(o=>[o.value,o.color]))},_=d({mutationFn:async e=>{const r=c.filter(u=>u.field_name===e.field_name),o=r.length>0?Math.max(...r.map(u=>u.sort_order)):0,{error:t}=await s.from("mladv_crm_field_options").insert({field_name:e.field_name,value:e.value,label:e.label,color:e.color,sort_order:o+1});if(t)throw t},onSuccess:()=>{i.invalidateQueries({queryKey:[n]}),a.success("Opção adicionada!")},onError:e=>a.error("Erro ao adicionar: "+e.message)}),y=d({mutationFn:async e=>{const{id:r,...o}=e,{error:t}=await s.from("mladv_crm_field_options").update(o).eq("id",r);if(t)throw t},onSuccess:()=>{i.invalidateQueries({queryKey:[n]}),a.success("Opção atualizada!")},onError:e=>a.error("Erro ao atualizar: "+e.message)}),v=d({mutationFn:async e=>{const{error:r}=await s.from("mladv_crm_field_options").delete().eq("id",e);if(r)throw r},onSuccess:()=>{i.invalidateQueries({queryKey:[n]}),a.success("Opção removida!")},onError:e=>a.error("Erro ao remover: "+e.message)});return{allOptions:c,isLoading:m,getOptions:l,getLabelsMap:f,getColorsMap:p,addOption:_,updateOption:y,deleteOption:v}}export{b as u};
